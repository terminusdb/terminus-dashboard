{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./src/html/HTMLHelper.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/utils.js","webpack://TerminusDashboard/./node_modules/axios/lib/utils.js","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlRule.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/viewConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/errorMessage.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/frameRule.js","webpack://TerminusDashboard/./src/html/TerminusViewer.js","webpack://TerminusDashboard/./src/html/query/TerminusCodeSnippet.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/const.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/bind.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/buildURL.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/isCancel.js","webpack://TerminusDashboard/./node_modules/axios/lib/defaults.js","webpack://TerminusDashboard/./node_modules/axios/lib/adapters/xhr.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/createError.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/mergeConfig.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/Cancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionCapabilities.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/terminusIDParser.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlResult.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woql.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/terminusRule.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/tableConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/woqlTable.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/chooserConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/woqlChooser.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/graphConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/woqlGraph.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/chartConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/woqlChart.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/streamConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/woqlStream.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/frameConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/viewer/documentFrame.js","webpack://TerminusDashboard/./src/html/Datatypes.js","webpack://TerminusDashboard/./src/html/datatypes/DateHelper.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapHelper.js","webpack://TerminusDashboard/./src/html/DatatypeRenderers.js","webpack://TerminusDashboard/./src/html/TerminusViolation.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlClient.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/buffer/index.js","webpack://TerminusDashboard/(webpack)/buildin/global.js","webpack://TerminusDashboard/./node_modules/base64-js/index.js","webpack://TerminusDashboard/./node_modules/ieee754/index.js","webpack://TerminusDashboard/./node_modules/isarray/index.js","webpack://TerminusDashboard/./node_modules/axios/index.js","webpack://TerminusDashboard/./node_modules/axios/lib/axios.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/Axios.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/InterceptorManager.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/transformData.js","webpack://TerminusDashboard/./node_modules/process/browser.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/normalizeHeaderName.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/settle.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/enhanceError.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/buildFullPath.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/isAbsoluteURL.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/combineURLs.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/parseHeaders.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/isURLSameOrigin.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/cookies.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/CancelToken.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/spread.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlView.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/objectFrame.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/TerminusDB.js","webpack://TerminusDashboard/./src/html/QueryPane.js","webpack://TerminusDashboard/./src/html/ResultPane.js","webpack://TerminusDashboard/./src/html/datatypes/String.js","webpack://TerminusDashboard/./src/html/datatypes/StringEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Boolean.js","webpack://TerminusDashboard/./src/html/datatypes/BooleanEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Choice.js","webpack://TerminusDashboard/./src/html/datatypes/ChoiceEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Coordinate.js","webpack://TerminusDashboard/./src/html/datatypes/CoordinateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Date.js","webpack://TerminusDashboard/./src/html/datatypes/DateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Entity.js","webpack://TerminusDashboard/./src/html/datatypes/EntityEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Image.js","webpack://TerminusDashboard/./src/html/datatypes/ImageEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Link.js","webpack://TerminusDashboard/./src/html/datatypes/Number.js","webpack://TerminusDashboard/./src/html/datatypes/Range.js","webpack://TerminusDashboard/./src/html/datatypes/RangeEditor.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapEditor.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapViewer.js","webpack://TerminusDashboard/./src/html/datatypes/HTMLMarkupEditor.js","webpack://TerminusDashboard/./src/html/datatypes/S2EntityEditor.js","webpack://TerminusDashboard/./src/html/table/SimpleTable.js","webpack://TerminusDashboard/./src/html/graph/SimpleGraph.js","webpack://TerminusDashboard/./src/html/graph/GraphResultsViewer.js","webpack://TerminusDashboard/./src/html/stream/SimpleStream.js","webpack://TerminusDashboard/./src/html/chooser/SimpleChooser.js","webpack://TerminusDashboard/./src/html/DocumentPane.js","webpack://TerminusDashboard/./src/html/document/SimpleFrameViewer.js","webpack://TerminusDashboard/./src/TerminusQuery.js","webpack://TerminusDashboard/./src/html/ScriptPane.js","webpack://TerminusDashboard/./src/TerminusSchema.js","webpack://TerminusDashboard/./src/TerminusServer.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","TerminusClient","require","HTMLHelper","view","icon","document","createElement","setAttribute","control","type","options","selected","callback","sel","length","opt","label","createTextNode","UTILS","labelFromURL","appendChild","addEventListener","this","which","renderer","viewsDOM","setMode","getActionControl","isNew","cancel","url","window","location","href","loc","split","sh","getShorthand","bits","htmlid","prop","wrap","text","max_cell_size","max_word_size","substring","replacements","words","word","newstr","k","replace","varname","lastIndexOf","obj","scope","frame","orientation","hfeatures","features","display_options","hidden","framedom","getFrameHolderDOM","header","hd","getFrameHeaderDOM","header_style","getFrameBodyDOM","pcls","sp","css","parent","subjectClass","subject","hid","hash","index","idm","objDOM","vholder","charCodeAt","feature","args","rend","val","getInfoboxDOM","sum","getSummary","status","lab","getLabel","getComment","isClassChoice","getClassChoiceTypeSelector","range","getType","disabled","cardControlAllows","show_disabled_buttons","clone","reset","isUpdated","show","save","getViewEntryDOM","getCardinalityDOM","getAddDOM","viewers","mpropDOM","currentViewer","getSelectionControl","viewer","setViewer","viewables","getFilledPropertyList","unshift","add","goToEntry","restriction","getRestriction","min","max","help","cs","getAvailableClassChoices","mlabDOM","cls","changeClass","addClass","addables","getMissingPropertyList","addNewProperty","addNewValue","input","infoDOM","linfo","headerStyle","lval","removePrefixes","bodyStyle","style","dpropDOM","tag","button","title","node","hasChildNodes","removeChild","childNodes","scriptid","src","existingScript","getElementById","script","body","onload","id","cssid","link","rel","parentNode","WOQLClient","ConnectionCapabilities","ConnectionConfig","IDParser","ErrorMessage","WOQLResult","WOQLRule","FrameRule","View","DocumentFrame","WOQLGraph","WOQLTable","WOQLChooser","WOQLChart","WOQLStream","WOQL","Utils","rdf","rdfs","xsd","owl","tcs","xdd","v","terminus","vio","payload","encodeURIComponent","payloadArr","keys","keyElement","valueElement","push","join","prefix","standard_urls","Math","random","toString","Date","getTime","pref","full","ida","idb","unshorten","sha","shb","prefixes","validURL","str","nurl","urlFragment","charAt","toUpperCase","slice","urlStr","baseUrl","urlFirst","urlTmp","ext","vars","nvars","addNamespaceToVariable","mvar","removeNamespaceFromVariable","row","rad","TypeHelper","isStringType","stype","isDatatype","shorten","numberWithCommas","separator","parts","datatypes","parseRangeValue","dividor","vals","indexOf","DateHelper","parseXsdTime","tz","extractXsdTimezone","hour","minute","second","timezone","parseXsdDate","year","parsed","abs","month","parseInt","day","parseDate","ty","parseXsdDateTime","addXsdPadding","nparsed","xsdFromParsed","xparsed","ret","convertTimestampToXsd","a","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","datetime","ptime","isArray","isUndefined","isObject","isFunction","forEach","fn","isArrayBuffer","isBuffer","constructor","isFormData","FormData","isArrayBufferView","ArrayBuffer","isView","buffer","isString","isNumber","isDate","isFile","isBlob","isStream","pipe","isURLSearchParams","URLSearchParams","isStandardBrowserEnv","navigator","product","merge","result","assignValue","arguments","deepMerge","extend","b","thisArg","trim","Codemirror","readFile","file","XMLHttpRequest","xmlhttp","ActiveXObject","open","send","xmlDoc","responseText","getFunctionSignature","sigs","spec","descr","server_url","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","getHeaderDom","h","innerHTML","getButton","getInfoAlertDom","msg","ald","txt","getResponse","currForm","action","response","terminator","rd","br","data","JSON","stringify","pre","stylizeCodeDisplay","showHttpResult","retHttpHeaders","headers","hdres","json","then","deleteStylizedEditor","ui","qip","pluginAvailable","cm","nextElementSibling","removeChildren","stylizeEditor","cmConfig","ar","colorizeTextArea","updateTextArea","dom","pr","colorizePre","removeSelectedNavClass","el","getElementsByClassName","classList","remove","setSelectedSubMenu","setSelected","className","par","parentElement","contains","tolggleContent","content","display","activateSelectedNav","nav","hideDocumentSubMenus","checkDocumentSubMenus","showControl","toggleVisibility","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","displayDocumentSubMenus","showSubMenus","checkForMandatoryId","objId","background","getCurrentWoqlQueryObject","query","settings","qval","limit","pageLength","start","elementMetadata","classMetadata","getEverything","getAllDocuments","documentMetadata","and","quad","sub","propertyMetadata","console","log","trimValue","getqObjFromInput","q","qObj","eval","e","TerminusRule","pattern","WOQLPattern","TerminusPattern","setVariables","variables","addNamespacesToVariables","current_variable","varlist","edge","vs","rownum","in","list","constraints","filter","tester","matchRow","rules","matches","rule","matchCell","matchColumn","matchNode","nid","matchPair","keya","keyb","matchEdge","prettyPrint","literal","unpack","numberMatch","testVariableConstraints","testBasics","testVariableConstraint","testValue","setPattern","ViewConfig","WOQLViewRule","render","func","view_render","view_renderer","getRulesJSON","jr","getBasicJSON","loadBasicJSON","getBasicprettyPrint","color","size","border","click","hover","mjson","onClick","onHover","getErrorAsMessage","api","err","formatErrorMessage","method","nmsg","getAPIErrorMessage","getAccessDeniedMessage","accessDenied","db","server","getInvalidURIMessage","parseAPIError","error","redirected","FramePattern","testRules","onmatch","matched_rules","patternMatchesFrame","checkFrame","frame_type","depth","children","kid","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkType","checkLiteral","checkParent","checkChildren","checkIndex","checkStatus","frameType","kids","rsubj","IDsMatch","found","properties","j","values","propertyIDsMatch","Array","isDatatypeProperty","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","ftype","Error","stringMatch","isProperty","isData","renderer_type","QueryPane","DocumentPane","TerminusViewer","client","getDocumentPane","docid","docConfig","docPaneConfig","dp","defaultPaneView","getDocument","docJSON","getNewDocumentPane","getQueryPane","resultConfigs","results","resultPaneConfigs","queryPaneConfig","qp","defaultQueryView","rpc","defaultResultView","addView","getResult","resultConfig","connect","terminus_server_url","terminus_server_key","tutorial","loadConsole","create_json","import_json","query_json","view_json","TerminusCodeSnippet","language","width","height","placeholder","formats","snippet","setQuery","refreshContents","setInput","refreshCodeMirror","readInput","serialise","undefined","parseText","nw","parse","loadConfig","getInputElement","innerText","getAsDOM","with_buttons","scont","snpc","getFormatButtons","serial","ssb","actbtn","getSubmitButton","changeRuleView","nview","submit","getIconsDOM","bsp","view_types","isp","self","cursor","f","btn","qobj","alert","removeCodeMirror","nextSibling","removeElement","stylizeSnippet","freeze","CONNECT","GET_SCHEMA","UPDATE_SCHEMA","UPDATE_DOCUMENT","CLASS_FRAME","WOQL_SELECT","TERMINUS_MESSAGE","GET_DOCUMENT","DELETE_DATABASE","DELETE_DOCUMENT","CREATE_DATABASE","CREATE_DOCUMENT","WOQL_UPDATE","TerminusPluginManager","preloaded","loaded","loading","precluded","plugins","css_base","js","requires","setPluginOptions","opts","init","calculatePreloaded","toload","calculateRequiredInitPlugins","loadPlugins","pins","pid","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","plugin","version_check","pluginmeta","version","jQuery","slider","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","element","span","insertBefore","getComputedStyle","getPropertyValue","ticker","cback","loadPlugin","pug","loadDynamicCSS","scripts","sid","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","cssurl","pluginLoadable","pluginLoadedOrLoading","getPluginDOM","plugid","cl","cbox","checked","clab","togglePlugin","redraw","unloadPlugin","drawPlugins","num","dm","clh","showPlugins","apply","utils","encode","params","paramsSerializer","serializedParams","toISOString","hashmarkIndex","__CANCEL__","normalizeHeaderName","DEFAULT_CONTENT_TYPE","setContentTypeIfUnset","adapter","defaults","process","transformRequest","transformResponse","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","validateStatus","common","settle","buildURL","buildFullPath","parseHeaders","isURLSameOrigin","createError","config","Promise","resolve","reject","requestData","requestHeaders","request","auth","username","password","Authorization","btoa","fullPath","baseURL","onreadystatechange","readyState","responseURL","responseHeaders","getAllResponseHeaders","responseType","statusText","onabort","onerror","ontimeout","timeoutErrorMessage","cookies","xsrfValue","withCredentials","read","toLowerCase","setRequestHeader","onDownloadProgress","onUploadProgress","upload","cancelToken","promise","abort","enhanceError","message","code","config1","config2","valueFromConfig2Keys","mergeDeepPropertiesKeys","defaultToConfig2Keys","axiosKeys","concat","otherKeys","Cancel","CONST","connectionConfig","connection","setClientKey","getClientKey","serverURL","curl","addConnection","capabilities","capabilitiesKeys","pred","auths","actions","actionsArr","map","item","nrec","getJSONContext","dbid","con","ncon","doc","scm","serverConnected","getServerRecord","srvr","connectionObj","okeys","oid","getDBRecord","dbCapabilityID","getServerDBRecords","dbrecs","removeDB","dbidCap","capabilitiesPermit","rec","newParams","setServer","setDB","setDocument","include_key","inputStr","context","parser","parseServerURL","parseDBID","dbURL","setSchemaURL","parseSchemaURL","schemaURL","setQueryURL","parseQueryURL","queryURL","setClassFrameURL","parseClassFrameURL","frameURL","parseDocumentURL","docURL","includeKey","setContext","validPrefixedURL","expandPrefixed","validIDString","stripOptionalPath","bit","bindings","no_compress","compress","getContext","nprop","nval","hasBindings","count","getBindings","getVariableList","first","last","next","res","prev","sort","asc_or_desc","compareValues","WOQLQuery","chain_ended","contains_update","paging_transitive_properties","vocab","loadDefaultVocabulary","tripleBuilder","nspaces","spaces","TripleBuilder","g","when","Query","Update","from","dburl","into","select","or","queries","not","triple","isa","eq","delete","JSON_or_IRI","delete_triple","S","P","O","delete_quad","G","add_triple","add_quad","cols","put","as","with","graph","vari","remote","post","order_by","asc","varlist_or_var","desc","group_by","gvarlist","groupedvar","groupquery","output","lower","u","pad","len","glue","member","El","List","unique","idgen","typecast","vara","varb","cast","re","test","less","v1","v2","greater","arith","plus","minus","times","divide","exp","div","comment","arg","var1","star","nodeid","add_class","classid","add_property","propid","boxClasses","classes","except","libs","generateChoiceList","clslabel","clsdesc","choices","delete_class","delete_property","insert","Node","Type","Graph","cleanType","doctype","arr1","arr2","buildAsClauses","gid","remq","subq","clauses","va","vb","ovars","sq","nvaris","vr","packString","nlist","packStrings","upd","advanceCursor","embedquery","nquery","cleanSubject","cleanPredicate","cleanObject","chainable","cleanGraph","cleanClass","last_index","abstract","gname","lastUpdate","Subject","Predicate","Object_or_Literal","chainableUpdate","update","adding_class","subs","nsubs","idgens","domain","confs","clist","listid","lastid","nextid","oneof","loadXDD","loadXDDBoxes","loadXSDBoxes","addDatatype","boxDatatype","dt","datatype","box_class_id","box_prop_id","box_class","box_prop","asArray","card","cardinality","addPO","lang","pn","entity","relationship","nwoql","GraphIRI","Subj","Pred","Obj","concreteDocumentClasses","getDataOfClass","chosen","getDataOfProperty","documentProperties","getDocumentConnections","getAllDocumentConnections","getInstanceMeta","simpleGraphQuery","loadVocabulary","execute","spl","setVocabulary","getVocabulary","getLimit","getPagingProperty","setLimit","setPagingProperty","isPaged","getPage","psize","hasStart","getStart","setPage","pagenum","pstart","setStart","addStart","nextPage","firstPage","previousPage","npage","setPageSize","hasSelect","getSelectVariables","nq","fileList","nv","defaultContext","DB_IRI","def","subj","pageprop","nc","indent","show_context","fluent","newlining_operators","operator","getWOQLPrelude","isChainable","uncleanArguments","hasShortcut","inline","lastArg","getShortcut","argIsSubQuery","myas","lhs","rhs","uncleanArgument","allArgs","unclean","cstr","oval","uncleanObjectArgument","nstr","part","suff","printLine","ttype","evstr","unit","addEntry","getO","clause","os","od","cardcls","tb","tf","njson","constraint","vundertest","arr","nonstring","compareIDs","vala","valb","RegExp","Config","WOQLTableConfig","WOQLTableRule","conf","column_order","pagesize","pager","page","changesize","loadJSON","nr","x","trenderer","order","show_pager","change_pagesize","show_pagesize","show_pagenumber","column","hdr","DataValue","datavalue","setResult","canAdvancePage","canChangePage","canRetreatPage","getPageSize","getColumnsToRender","hasColumnOrder","getColumnOrder","col","getColumnHeaderContents","colid","hr","nresult","notify","hasDefinedEvent","getDefinedEvent","getRowClick","getCellClick","getRowHover","getCellHover","hasCellClick","hasRowClick","hasCellHover","hasRowHover","getRenderer","getSpecificRender","getRendererForDatatype","createRenderer","renderValue","dv","nvalue","WOQLChooserConfig","WOQLChooserRule","getBasicPrettyPrint","change","show_empty","labels","titles","direction","onChange","value_variable","label_variable","title_variable","sort_variable","sort_direction","set","ch","rows","includeRow","rowToChoice","choice","getRowID","getLabelFromBinding","getTitleFromBinding","getSelectedFromBinding","rval","getSpecialRenderer","renderSpecial","setRenderer","WOQLGraphConfig","WOQLGraphRule","literals","show_literals","source_variable","fontfamily","fontfam","show_force","force","fix_nodes","fixed","explode_out","explode","selected_grows","bigsel","gwidth","gheight","edges","nedges","show_edges","estrs","charge","collisionRadius","arrow","distance","symmetric","weight","w","nodes","calculateVariableTypes","extractFromBinding","combineEdges","combineNodes","lits","includeNode","includeLiteralNode","genBNID","getLiteralOwner","addAdornedNode","addAdornedEdge","createEdgesFromIDs","ndid","ks","kt","radius","getConfigValue","nodetype","es","getEdges","nnodes","nodes_referenced_by_edges","fedges","k2","getNodes","WOQLChartConfig","WOQLChartRule","margin","layout","_title","_description","_layout","marginObj","_margin","xAxis","woqlRule","bar","line","point","area","legendType","fill","stroke","strokeWidth","dot","isVisible","labelRotate","angle","padding","paddingObj","axisDomain","domainArr","barSize","WOQLStreamConfig","WOQLStreamRule","wqt","template","mtemplate","wqrs","FrameConfig","DocumentRule","load_schema","json_rules","get_schema","show_all","all","show_parts","fp","setFrameDisplayOptions","showDisabledButtons","collapse","setFrameFeatures","headerFeatures","header_features","showEmpty","dataviewer","setFrameArgs","existing","fresh","got","fkey","rep","props","compare","hf","feats","applyFeatureProperty","nfeats","nfeat","unpackFeatures","extensions","fstr","fid","ObjectFrame","FrameHelper","load","loadComplete","loadDocument","loadSchema","encoding","loadDataFrames","ncls","getClassFrame","loadSchemaFrames","loadDocumentSchema","clsid","dataframes","classframes","loadClassFrames","subjid","newDoc","fillFromSchema","applyRules","mymatch","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","GoogleMapEditor","GoogleMapViewer","HTMLMarkupEditor","S2EntityEditor","initialiseDataRenderers","RenderingMap","registerViewerForTypes","registerEditorForTypes","hevopts","universalEditor","universalViewer","addPlugins","createDataRenderer","registerEditorForFrameType","HTMLDateHelper","months","getMonthName","GoogleMapHelper","polygon","polyline","markers","mapLat","mapLong","zoom","opacity","destroy","clear","translatePolygonToArray","vertices","getPath","seenValue","getLength","xy","getAt","lat","lng","translateArrayToPolygon","array","jsonified","latlong","createPolygon","coords","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","setMap","createPolyline","Polyline","clearMarkers","addMarker","position","marker","Marker","addListener","getCoordsFromMarkers","initMap","mapContainer","center","parseFloat","setPath","event","trigger","DatatypeRenderers","registeredDataViewers","registeredDataEditors","defaultViewers","defaultEditors","specials","editor","getValidDataViewerList","valids","getValidDataEditorList","nftypes","getEditorForDataFrame","getViewerForDataFrame","record","types","getEditor","TerminusViolations","vios","nvios","TerminusViolation","context_msg","vdom","vioHeading","getPropertyAsDOM","pdom","ldom","mval","TerminusUI","ApiExplorer","TerminusDBsdk","TerminusQueryViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","controls","setOptions","showBusy","clearBusy","connectToDB","showView","showDocumentPage","schema","showSchemaPage","showQueryPage","explorer","showExplorer","showDBMainPage","showServerMainPage","showError","createDatabase","dbdets","getBadArguments","dbdoc","generateNewDatabaseDocument","refreshDBList","crec","getCrashString","showMessage","deleteDatabase","delrec","lid","dbn","dets","fname","getConnectionEndpoint","clearServer","addURLPrefix","clearDB","TerminusServerViewer","redrawMainPage","showCollaboratePage","showLoadURLPage","TerminusDBViewer","showCreateDBPage","TerminusDBCreator","durl","showCreateDocument","TerminusDocumentViewer","getDocCreatorOptions","loadCreateDocument","mainDOM","deleteDBPermitted","getDeleteDBButton","confirm","showResult","showWarning","setAttachedServer","attached_server","attachedServer","clearMessages","messages","clearMainPage","main","setMessageDOM","setbuttonControls","buttons","setControllerDOM","controller","setExplorerDOM","setPluginsDOM","setViewerDOM","draw","comps","slocation","endpoint","apiKey","redrawControls","toggleDashboardWidget","widget","toggleControl","drawControls","loadControls","ncontrol","nd","drawExplorer","ae","sc","TerminusServerController","TerminusDBController","show_controls","pseudoCapability","show_views","busy","getBusyLoader","bsyDom","pd","pbc","pbsa","pbia","md","msgHolder","showViolations","cmsg","views","document_options","schema_options","attach_server","piman","getDocViewerOptions","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getSchema","updateSchema","getClassFrames","viewDocument","createDocument","updateDocument","deleteDocument","use_fetch","return_full_response","pman","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","navOnSelect","createNavs","navConfig","ul","navDom","cont","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","getSignature","getForm","getServerForm","form","fd","inpLabel","cd","inpId","keyLabel","resd","gatherips","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","inpKey","docLabel","inpDoc","inp","docUrl","getApiSendButton","getApiForm","enc","schurl","buttonSelf","connected_mode","gtxtar","txtar","dcurl","schemaUrlDom","htmlEditor","getValue","sg","ic","sig","DispatchRequest","URIError","dispatch","makeDocumentConsistentWithURL","addOptionsToDocument","docurl","qurl","addOptionsToWOQL","serverLog","cfurl","pdoc","_","addKeyToPayload","dispatchFetch","redirect","referrer","hdrs","URIEncodePayload","cache","Headers","fetch","ok","btoaImplementation","Buffer","axios","catch","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","Uint8Array","__proto__","encodingOrOffset","allocUnsafe","TypeError","byteOffset","byteLength","fromArrayLike","fromArrayBuffer","string","isEncoding","actual","write","fromString","copy","fromObject","assertSize","loweredCase","utf8ToBytes","base64ToBytes","slowToString","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","indexSize","arrLength","valLength","String","buf","readUInt16BE","foundIndex","hexWrite","offset","Number","remaining","strLen","substr","utf8Write","blitBuffer","asciiWrite","byteArray","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","allocUnsafeSlow","_isBuffer","y","pos","swap16","swap32","swap64","equals","inspect","match","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","out","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","dst","Function","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","Axios","mergeConfig","createInstance","defaultConfig","instance","instanceConfig","CancelToken","isCancel","promises","spread","default","InterceptorManager","dispatchRequest","interceptors","chain","interceptor","fulfilled","rejected","shift","getUri","handlers","use","eject","transformData","throwIfCancellationRequested","throwIfRequested","reason","fns","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","run","runClearTimeout","Item","noop","nextTick","browser","env","argv","versions","on","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","umask","normalizedName","isAxiosError","number","fileName","lineNumber","columnNumber","stack","isAbsoluteURL","combineURLs","requestedURL","relativeURL","ignoreDuplicateOf","originURL","msie","userAgent","urlParsingNode","resolveURL","protocol","host","search","hostname","port","pathname","requestURL","expires","path","secure","cookie","toGMTString","decodeURIComponent","now","executor","resolvePromise","token","table","chooser","chart","stream","parentframe","empty","originalFrames","PropertyFrame","cframe","predicate","DataFrame","ClassFrame","Restriction","loadRestriction","jsonld_context","cf","isValid","hasSchema","frames","domainValue","getPropertyClassFrame","getChosenClassFrame","isLogic","getChosenFrame","addFrame","getAsFrame","ff","getAsFrames","restrictions","getProperties","filled","missing","nmissing","newb","newid","pf","cloned","getChild","childid","pframe","getProperty","addProperty","ndata","createEmpty","createEmptyChoice","clss","getClassChoices","addValueFrame","addPropertyValue","addValue","removeProperty","removePropertyValue","removeValue","extract","extracts","extracted","extractJSONLD","parentObject","root","renderProperties","sortProperties","nprops","unsorted","standardCompare","hasRestriction","rest","currentnum","propcount","long","df","oframe","nframe","updated","childUpdated","hasCardinalityRestriction","deletePropertyValue","gets","cvalues","fs","renderValues","sortedVals","sortValues","rangeValue","originalValue","nrend","setNew","isValidType","hasCardRestriction","isObjectProperty","isRestriction","isDocument","isChoice","getStdURL","getChoiceOptions","elements","option","getTypeShorthand","contents","normalizer","objlit","loadFromObjectFrame","child","getChosenClassFrames","objframe","operands","dataframe","cloneDataFrame","other","domcls","operand","maxCardinality","minCardinality","nrest","textdom","objectIsEmpty","darkMode","jsonldCheck","dimensions","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","foldCode","getCursor","refresh","foldGutter","gutters","Pos","setCodemirrorSize","defaultCharWidth","setOption","setSize","runMode","theme","tv","container","pages","getDatabaseDocumentConfig","property_style","label_style","value_style","getDocumentsQueryPane","docs","docClasses","getCreateDataPaneConfig","showQuery","editQuery","getCreateDocumentConfig","getShowDocumentConfig","getDocumentsGraphConfig","showDocumentGraph","insertDOM","dloader","getLoaderDOM","graph_query_pane","showDocumentConnections","targetDOM","introdom","intro","createFullDocumentPane","result_options","dpoptions","q2","result2","bdom","getBodyAsDOM","getDocumentsDOM","getHomeDOM","showHappyBox","mydb","insertDocument","dchooser","getCreateDataChooser","delw","getDeleteDatabaseWidget","mactions","getDocumentsMenu","tableDOM","graphDOM","document_table","dcDOM","getNavigationDOM","dx","loadCreateDocumentPage","documentLoader","getShowDocumentControl","setClassLoader","page_actions","show_doc_action","tgtd","getToggleGraphTableDOM","redrawDocumentPage","docview","tisp","gisp","ticon","gicon","hov","del","di","icss","dbrec","dbdel","delbut","styleCreateDocumentChooser","pholder","happy","hbox","sets","nm","ispan","htit","pp","pop","nuke","scd","dcip","nbut","is","preventDefault","keyCode","sct","mfd","dht","sci","slab","idip","titip","descip","butfield","cancbut","loadbut","dbc","stopPropagation","getControlHTML","ResultPane","showConfig","editConfig","updateResult","fireDefaultQueries","qcres","classMetaDataRes","qpres","propertyMetaDataRes","showHeader","addViews","saved","getSection","sName","clearSubMenus","smenus","getResults","sampleQueryDOM","AddEvents","aval","choosen","getQueryMenu","qName","getSubDataMenu","getSchemaSection","section","checkIfDataMenuOpen","isOpen","showDataOfTypeEvent","subPar","showPropertyOfTypeEvent","addCheveronIcon","getDataSection","bd","fireDocumentEvent","getEnterDocumentIdDOM","getDocumentSection","getQueryMenuBlock","getSampleQueriesDOM","showQueryConfig","configspan","ipdom","qicon","sqd","hideQueryConfig","querySnippet","createInput","showingQuery","resultDOM","getAddViewControl","getResultPaneHeader","closable","savePaneButton","closePaneButton","collapsePaneButton","submitQuery","updateQuery","qr","refreshViews","nrp","showNoBindings","nor","clearResults","delta","clearResult","vd","newView","selector","Datatypes","SimpleTable","SimpleGraph","SimpleStream","SimpleChooser","querypane","changeViewType","renderers","getResultDOM","getViewConfigIconClass","cvicons","getViewTypeIconDOM","prepend","getDefaultViewerIcon","getIconForViewer","changeViewerType","updateView","wres","html_renderer","show_types","renderFrame","wrapShortenedText","big","isBigType","getTypeSize","vallab","elt","foptions","inputs","parseValue","lldom","getInputDOMs","latdom","longdom","getLatLongDOM","firstcol","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","allowbce","date_spacer","time_spacer","datetime_separator","helper","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","mdom","mlab","sdom","dadom","ydom","ddom","tdom","opdom","onclick","holder","showValue","getEntityViewHTML","internalLink","getController","getEntityLabel","nspan","il","getVariableValueFromBinding","tit","img","commas","delimiter","rvals","svals","useCommas","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","mapcontainer","ghelper","latLng","coo","inner","quill","ctl","getClient","d2ch","TerminusDocumentChooser","woqltable","ctls","getControlsDOM","tab","getTableDOM","ctrls","paging","getPaging","columns","thead","getTableHeader","tbody","getTableBody","thr","th","getColumnHeader","tr","getHTMLRow","td","getCell","rc","getCellData","psdom","getFirst","getPrev","getPageNumber","getNext","showPaging","chunk","clabel","pval","GraphResultsViewer","wgraph","getGraphDOM","gviz","gdom","setData","initDOM","svg","visid","chars","randomString","currentDate","link_elements","node_elements","loadedNodes","focusNodes","links","selected_id","setConfigOptions","initD3","d3DOM","loadNewData","updateGraph","updateSimulation","dqr","copyNodes","narr","nobj","updateData","setFocusNodeFromResult","reload","getFocusNode","setFilter","simulation","stop","wake","hibernate","no_animate","getNodesAndFringes","snode","nnode","fx","fy","getLinks","scale_factor","setWidth","setHeight","clientWidth","clientHeight","jqid","append","attr","forceSimulation","forceLink","getLinkDistance","forceManyBody","strength","getCharge","forceCollide","getCollisionRadius","forceCenter","drag_drop","drag","restart","zoomed","link_group","classed","node_group","current_transform","transform","follow_node_wrapper","graph_node","nodeSelected","selectAll","exit","node_enter","enter","getRadius","isFringe","getNodeIconUnicode","styleNodeElements","link_enter","styleLinkElements","alpha","each","getNodeColour","getNodeText","getNodeIconWeight","getNodeIconSize","getNodeIconColour","getLineWidth","getEdgeArrow","getEdgeColour","getLinkText","getEdgeDirection","reference","getArrowWidth","getArrowHeight","selected_node","selection_grows","getScaleTransform","scale","min_ratio","new_mol_width","new_mol_height","y_trans","x_trans","transition","duration","scaleToFit","min_x","min_y","max_x","max_y","mol_width","mol_height","width_ratio","height_ratio","recentre","translated","dcx","dcy","text_elements","unicode","faclass","getMultiplier","mult","colrad","linkDistance","getNodeIcon","isNeighbourLink","added","upgraded","ccdom","ccsel","getEmptyOption","createOptionFromChoice","SimpleFrameViewer","owner","filterFrame","loadRenderer","fframe","loadClass","cloader","classLoader","queryPane","pane","showDocConfig","ndom","hideDocConfig","showingConfig","renderResult","fpt","rendname","termframe","evalstr","applyRulesToDocument","tdv","setDatatypes","getScope","setDatatypeViewers","getDatatypeViewer","getFeaturesDOM","orient","getFrameDOM","replaceWith","flist","featuresToCSS","getFeatureDOM","ScriptPane","panes","new_pane","new_pane_type","meta","newPaneOptions","defaultResultOptions","getNewQueryPane","addQueryPane","qpane","addScriptPane","addScriptPaneDOM","addNewPaneDOM","addQueryPaneDOM","setNewDocumentPaneDOM","qdom","qhdr","getPaneHeader","paneDOM","getPanesDOM","controlDOM","newPaneButton","panesDOM","npd","nqhdr","getNewPaneHeader","headerDOM","removePane","showPane","hidePane","isnew","newScriptButton","newDocButton","executeScript","showOKMessage","confirm_before_update","views_dom","current_view","retrieveViews","getClassesPane","getPropertiesPane","refreshPanes","getOWLView","controldom","getTabsDOM","pagedom","owldom","updateOWLContents","getSchemaEditButton","getSchemaViewDOM","getSchemaSaveButtons","getSchemaEditDOM","getTabDOM","switchView","toggleTabs","msgtype","getCancelButton","getSaveButton","is_import","getSchemaButton","schema_edit_dom","schema_edit_dom_name","np","getSchemaNameInputDOM","ipval","Datatables","rsc","getServerLabelDOM","srec","getServerDetailsDOM","csbut","crbut","getDBListDOM","scl","wrapTableLinkCell","tdElement","sec","th1","th2","th3","th4","th5","th6","fullid","td1","td2","td3","td4","td5","td6","CspDatatables","wResViewer","qPage","wrViewer","wQuery","currDTSettings","convertToDatatable","DataTable","searching","lengthMenu","initComplete","oInstance","$","html","columnDefs","targets","createdRow","find","cell","dbInfo","parents","dbId","dtResult","executeQuery","pageInfo","formatResultsForDatatableDisplay","generateNewQueryOnPageChange","qTextDom","queryMode","getCallbackSettings","dtAPIChangeSettings","_iDisplayLength","_iDisplayStart","iDraw","chosenValue","setUp","dtdom","updateCurrDTSettings","getNewDataOnChange","drawnTab","aSettings","getDataFromServer","serverSide","processing","autoWidth","ajax","entries","scrollX","showDocument","selectDocumentNavBar","url_input","key_input","getLabelDOM","getFormFieldDOM","ip","ltxt","loadbuts","keyval"],"mappings":"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","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 44);\n","const TerminusClient = require('@terminusdb/terminus-client');\nlet HTMLHelper = {};\n\nHTMLHelper.getSettingsControl = function(view){\n\tvar icon = document.createElement('icon');\n\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\n\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\n\ticon.setAttribute('style', 'margin: 10px;')\n\treturn icon;\n}\n\nHTMLHelper.getControlIcon = function(control){\n\tvar icon;\n\tswitch(control){\n\t\tcase 'delete':\n\t\t\ticon = '-alt-delete';\n\t\tbreak;\n\t\tcase 'add':\n\t\t\ticon = '-plus';\n\t\tbreak;\n\t\tcase 'reset':\n\t\t\ticon = '-undo';\n\t\tbreak;\n\t\tcase 'save':\n\t\t\ticon = '-save';\n\t\tbreak;\n\t\tcase 'hide':\n\t\t\ticon = '-eye-slash';\n\t\tbreak;\n\t}\n\treturn icon;\n}\n\nHTMLHelper.getSelectionControl = function(type, options, selected, callback){\n\tvar sel = document.createElement(\"select\");\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\n\tfor(var i = 0; i < options.length; i++){\n\t\tvar opt = document.createElement(\"option\");\n\t\tif(typeof options[i] == \"object\"){\n\t\t\topt.value = options[i].value;\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.UTILS.labelFromURL(options[i].value)));\n\t\t\topt.appendChild(label);\n\t\t}\n\t\telse {\n\t\t\topt.value = options[i];\n\t\t\tlabel = TerminusClient.UTILS.labelFromURL(opt.value);\n\t\t\topt.appendChild(document.createTextNode(label));\n\t\t}\n\t\tif(selected == opt.value){\n\t\t\topt.setAttribute(\"selected\", \"selected\");\n\t\t}\n\t\tsel.appendChild(opt);\n\t}\n\tsel.addEventListener(\"change\", function(){\n\t\tcallback(this.value);\n\t});\n\treturn sel;\n}\n\nHTMLHelper.getModeSelectorDOM = function(which, renderer){\n\tvar viewsDOM = document.createElement(\"span\");\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\n\tif(renderer.mode == \"view\"){\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\n\t\tviewsDOM.appendChild(HTMLHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\n\t}\n\telse if(renderer.isNew()){\n\t\treturn false;\n\t}\n\telse {\n\t\tvar callback = function(){ renderer.cancel();}\n\t\tviewsDOM.appendChild(HTMLHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\n\t}\n\treturn viewsDOM;\n}\n\nHTMLHelper.goToName = function(s, p, i){\n\tvar url = window.location.href;\n\tif(url){\n\t\tvar wbits = url.split(\"#\");\n\t\tvar loc = wbits[0];\n\t\tvar sh = TerminusClient.UTILS.getShorthand(s);\n\t    if(!sh) sh = s;\n\t\tvar bits = sh.split(\":\");\n\t\tif(bits.length > 1) sh = bits[1];\n\t\tvar htmlid = sh;\n\t\tif(p){\n\t\t\tvar prop = TerminusClient.UTILS.getShorthand(p);\n\t\t\tif(!prop ) prop = p;\n\t\t\tvar bits = prop.split(\":\");\n\t\t\tif(bits.length > 1) prop = bits[1];\n\t\t\thtmlid += \"_\" + prop;\n\t\t\tif(i){\n\t\t\t\thtmlid += \"_\" + i;\n\t\t\t}\n\t\t}\n\t\twindow.location = loc + \"#\" + htmlid;\n\t}\n}\n\nHTMLHelper.wrapShortenedText = function(wrap, text, max_cell_size, max_word_size){\n\tif(max_cell_size && (text.length > max_cell_size)){\n\t\twrap.setAttribute(\"title\", text);\n\t\ttext = text.substring(0, max_cell_size) + \"...\";\n\t}\n\tif(text && text.length > max_word_size){\n\t\tconst replacements = {}\n\t\tconst words = text.split(\" \");\n\t\tfor(var i = 0; i < words.length; i++){\n\t\t\tvar word = words[i];\n\t\t\tif(word.length > max_word_size){\n\t\t\t\twrap.setAttribute(\"title\", text);\n\t\t\t\tvar newstr = word.substring(0, max_word_size) + \"...\";\n\t\t\t\treplacements[word] = newstr;\n\t\t\t}\n\t\t}\n\t\tfor(var k in replacements){\n\t\t\ttext = text.replace(k, replacements[k]);\n\t\t}\n\t}\n\twrap.appendChild(document.createTextNode(text));\n}\n\nHTMLHelper.getVariableValueFromBinding = function(varname, bind){\n\tfor(var key in bind){\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\n\t\tif(skey == varname){\n\t\t\tconst obj = bind[key];\n\t\t\tif(typeof obj == \"object\" && obj['@value']) return obj['@value'];\n\t\t\treturn obj;\n\t\t}\n\t}\n\treturn false;\n}\n\n\n\n/*\n * HTML drawing function for document rendering \n */\n\nHTMLHelper.getFrameDOM = function(scope, frame, orientation, hfeatures, features){\n\tif(frame.display_options.hidden) return false;\n\tvar framedom = HTMLHelper.getFrameHolderDOM(scope, frame, orientation);\n\tif(typeof frame.display_options.header == \"function\"){\n\t\tvar hd = frame.display_options.header(hfeatures);\n\t\tframedom.appendChild(hd);\n\t}\n\telse {\n\t\tvar hd = HTMLHelper.getFrameHeaderDOM(scope, frame, orientation, hfeatures);\n\t\tif(typeof frame.display_options.header_style != \"undefined\"){\n\t\t\thd.setAttribute(\"style\", frame.display_options.header_style);\n\t\t}\n\t\tframedom.appendChild(hd);\n\t}\n\tframedom.appendChild(HTMLHelper.getFrameBodyDOM(scope, frame, orientation, features));\n\treturn framedom;\n}\n\nHTMLHelper.getFrameHolderDOM = function(scope, frame, orientation){\n\tvar pcls = \"terminus-\" + scope + \"-frame\";\n\tif(orientation == \"page\"){\n\t\tvar sp = document.createElement(\"div\");\n\t}\n\telse {\n\t\tvar sp = document.createElement(\"span\");\n\t}\n\tvar css = pcls + \" \" + pcls + \"-\" + orientation + \n\t\t(scope == \"object\" && frame.parent ? \"\" : \" terminus-root-frame\") \n\t\t+ \" \" + pcls + \"-\" + frame.display_options.mode;\n\tsp.setAttribute(\"class\", css);\n\tif(scope == \"object\"){\n\t\tsp.setAttribute(\"data-class\", frame.subjectClass());\n\t\tsp.setAttribute(\"data-id\", frame.subject());\t\t\n\t\tvar hid = this.hash(frame.subject());\n\t}\n\telse if(scope == \"property\"){\n\t\tsp.setAttribute('data-property', frame.property());\t\n\t\tvar hid = this.hash(frame.subject()+frame.property());\n\t}\n\telse if(scope == \"data\"){\n\t\tsp.setAttribute('data-value', frame.get());\n\t\tvar hid = this.hash(frame.subject() + frame.property() + frame.index);\n\t}\n\tvar idm = document.createElement(\"a\");\n\tidm.setAttribute(\"class\", \"terminus-\" + scope + \"-idmarker\");\n\tidm.setAttribute(\"name\", hid);\t\t\t\t\n\tsp.appendChild(idm);\n\treturn sp;\n}\n\nHTMLHelper.getFrameHeaderDOM = function(scope, frame, orientation, features){\n\tvar css = \"terminus-\" + scope + \"-header\";\n\tif(orientation == \"page\"){\n\t\tvar objDOM = document.createElement(\"div\");\n\t}\n\telse {\n\t\tvar objDOM = document.createElement(\"span\");\n\t}\n\tobjDOM.setAttribute(\"class\", css + \" \" + css + \"-\" + orientation);\n\tif(features) objDOM.appendChild(features);\n\treturn objDOM;\n}\n\nHTMLHelper.getFrameBodyDOM = function(scope, frame, orientation, features){\n\tvar css = \"terminus-\" + scope + \"-properties\";\n\tif(orientation == \"page\"){\n\t\tvar vholder = document.createElement(\"div\");\n\t}\n\telse {\n\t\tvar vholder = document.createElement(\"span\");\n\t}\n    vholder.setAttribute('class', css + \" \" + css + \"-\" + orientation);\n    if(features) vholder.appendChild(features);\n    return vholder;\n}\n\nHTMLHelper.hash = function(s) {\n\tvar hash = 0, i, chr;\n\tif (s.length === 0) return hash;\n\tfor (i = 0; i < s.length; i++) {\n\t    chr   = s.charCodeAt(i);\n\t    hash  = ((hash << 5) - hash) + chr;\n\t    hash |= 0; // Convert to 32bit integer\n\t}\n\treturn hash;\n};\n\nHTMLHelper.getFeatureDOM = function(frame, feature, scope, mode, args, rend){\n\n\tif(feature == \"id\"){\t\n\t\tif(scope == \"object\") var val = frame.subject();\n\t\telse if(scope == \"property\") var val = frame.property();\n\t\tif(val == \"_:\") var val = \"New Document\";\n\t\treturn HTMLHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"The ID that identifies this document\", mode, args, rend);\n\t}\n\telse if(feature == \"summary\"){\n\t\tvar sum = frame.getSummary();\n\t\treturn HTMLHelper.getInfoboxDOM(scope + \"-summary\", false, sum.long, sum.status, mode, args);\n\t}\n\telse if(feature == \"label\"){\n\t\tvar lab = frame.getLabel();\n\t\tif(lab){\n\t\t\treturn HTMLHelper.getInfoboxDOM(scope + \"-type\", false, lab, false, mode, args);\n\t\t}\n\t\treturn false;\n\t}\n\telse if(feature == \"status\"){\n\t\tvar sum = frame.getSummary();\n\t\treturn HTMLHelper.getInfoboxDOM(scope + \"-status-\"+sum.status, false, sum.status, sum.status, mode, args);\n\t}\n\telse if(feature == \"comment\"){\n\t\tvar lab = frame.getComment();\n\t\treturn HTMLHelper.getInfoboxDOM(\"property-comment\", false, lab, false, mode, args);\n\t}\n\telse if(feature == \"type\"){\n\t\tif(scope == \"property\" && mode == \"edit\" && frame.parent && frame.parent.isClassChoice() && frame.isNew()){\n\t\t\treturn this.getClassChoiceTypeSelector(frame, mode, args);\n\t\t}\n\t\tif(scope == \"object\") var lab = frame.subjectClass();\n\t\telse if(scope == \"property\") var lab = frame.range();\n\t\telse if(scope == \"data\") var lab = frame.getType();\n\t\tif(lab){\n\t\t\treturn HTMLHelper.getInfoboxDOM(scope + \"-type\", \"Type\", lab, false, mode, args);\n\t\t}\n\t\treturn false;\n\t}\n\telse if(feature == \"delete\"){\n\t\tvar callback = function(){frame.delete()};\n\t\tvar disabled = false;\n\t\tif(!frame.cardControlAllows(\"delete\", scope)){\n\t\t\tif(!frame.display_options.show_disabled_buttons){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdisabled = \"Cardinality rules prevent deleting this element\";\n\t\t}\n\t\treturn HTMLHelper.getActionControl(scope, \"delete\", \"Delete\", callback, disabled, mode, args);\n\t}\n\telse if(feature == \"clone\"){\n\t\tvar callback = function(){frame.clone()};\n\t\tvar disabled = false;\n\t\tif(!frame.cardControlAllows(\"clone\", scope)){\n\t\t\tif(!frame.display_options.show_disabled_buttons){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdisabled = \"Cardinality rules prevent cloning this element\";\n\t\t}\n\t\treturn HTMLHelper.getActionControl(scope, \"clone\", \"Clone\", callback, disabled, mode, args);\n\t}\n\telse if(feature == \"reset\"){\n\t\tvar callback = function(){frame.reset()};\n\t\tvar disabled = false;\n\t\tif(!frame.isUpdated()){\n\t\t\tif(!frame.display_options.show_disabled_buttons){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdisabled = \"No changes have been made to this element\";\n\t\t}\n\t\treturn HTMLHelper.getActionControl(scope, \"reset\", \"Reset\", callback, disabled, mode, args);\n\t}\n\telse if(feature == \"mode\"){\n\t\tvar callback = function(){frame.mode(\"edit\")};\n\t\treturn HTMLHelper.getActionControl(scope, \"mode\", \"Edit\", callback, mode, args);\n\t}\n\telse if(feature == \"hide\"){\n\t\tvar callback = function(){frame.show()};\n\t\treturn HTMLHelper.getActionControl(scope, \"hide\", \"Hide\", callback, mode, args);\n\t}\n\telse if(feature == \"update\"){\n\t\tvar callback = function(){frame.save()};\n\t\tif(!frame.isUpdated() && !frame.display_options.show_disabled_buttons, mode, args){\n\t\t\treturn false;\n\t\t}\n\t\tvar disabled = frame.isUpdated() ? false : \"No changes have been made to this element\";\n\t\treturn HTMLHelper.getActionControl(scope, \"save\", \"Save\", callback, disabled, mode, args);\n\t}\n\telse if(feature == \"viewer\"){\n\t\treturn false;//this.getViewerSelectorDOM(scope, frame, mode, args);\n\t}\n\telse if(feature == \"view\"){\n\t\treturn this.getViewEntryDOM(scope, frame, mode, args);\n\t}\n\telse if(feature == \"cardinality\"){\n\t\treturn this.getCardinalityDOM(scope, frame, mode, args);\n\t}\n\telse if(feature == \"add\"){\n\t\treturn this.getAddDOM(scope, frame, mode, args);\n\t}\n}\n\nHTMLHelper.getViewerSelectorDOM = function(scope, frame, mode, args){\n\t//var viewers = frame.datatypes.getAvailableViewers();\n\t//var r = frame.datatypes.getRenderer(t);\n\n\tif(viewers && viewers.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-\" + scope + \"-viewer\");\n\t\tvar callback = function(viewer){\n\t\t\tif(viewer){\n\t\t\t\tframe.setViewer(viewer);\n\t\t\t}\n\t\t}\n\t\tvar selected = frame.currentViewer();\n\t\tvar sel = HTMLHelper.getSelectionControl(scope + '-viewer', viewers, selected, callback, mode, args);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\n\n/* needs html viewer context for goto */\nHTMLHelper.getViewEntryDOM = function(scope, frame, mode, args){\n\tif(scope == \"object\"){\n\t\tvar viewables = frame.getFilledPropertyList();\n\t}\n\telse if(scope == \"property\"){\n\t\t\n\t}\n\tvar self = this;\n\tif(viewables && viewables.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-\"+scope + \"-view-entry\");\n\t\tviewables.unshift({ value: \"\", label: \"View \" + scope});\n\t\tvar callback = function(add){\n\t\t\tif(add){\n\t\t\t\tframe.goToEntry(add);\n\t\t\t}\n\t\t}\n\t\tvar sel = HTMLHelper.getSelectionControl(scope + \"-view-entry\", viewables, \"\", callback, mode, args);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n\t\n}\n\nHTMLHelper.getCardinalityDOM = function(scope, frame, mode, args){\n\tvar restriction = frame.getRestriction();\n\tif(restriction.min && restriction.max){\n\t\tif(restriction.min == restriction.max){\n\t\t\tvar lab = restriction.min;\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\n\t\t}\n\t\telse {\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\n\t\t}\n\t}\n\telse if(restriction.min){\n\t\tvar lab = \">\"+(restriction.min-1);\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\n\t}\n\telse if(restriction.max){\n\t\tvar lab = \"<\"+(restriction.max+1);\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\n\t}\n\telse {\n\t\treturn false;\n\t}\n\treturn HTMLHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help, mode, args);\n}\n\nHTMLHelper.getClassChoiceTypeSelector = function(frame, mode, args){\n\tvar cs = frame.parent.getAvailableClassChoices();\n\tif(cs && cs.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\n\t\tvar mlabDOM = document.createElement(\"span\");\n\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\n\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\n\t\tmpropDOM.appendChild(mlabDOM);\n\t\tvar callback = function(cls){\n\t\t\tif(cls){\n\t\t\t\tframe.changeClass(cls);\n\t\t\t}\n\t\t}\n\t\tvar sel = HTMLHelper.getSelectionControl(\"change-class\", cs, frame.subjectClass(), callback, mode, args);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\nHTMLHelper.getAddDOM = function(scope, frame, mode, args){\n\tif(scope == \"property\"){\n\t\tif(frame.isClassChoice()){\n\t\t\tvar cs = frame.getAvailableClassChoices();\n\t\t\tif(cs && cs.length){\n\t\t\t\tvar mpropDOM = document.createElement(\"span\");\n\t\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\n\t\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\n\t\t\t\tvar callback = function(cls){\n\t\t\t\t\tif(cls){\n\t\t\t\t\t\tframe.addClass(cls);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar sel = HTMLHelper.getSelectionControl(\"add-property\", cs, \"\", callback, mode, args);\n\t\t\t\tmpropDOM.appendChild(sel);\n\t\t\t\treturn mpropDOM;\n\t\t\t}\n\t\t}\n\t\tif(frame.cardControlAllows(\"add\") || frame.display_options.show_disabled_buttons){\n\t\t\tvar callback = function(){frame.add(\"edit\")};\n\t\t\tvar disabled = (frame.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\n\t\t\treturn HTMLHelper.getActionControl(scope + \"-add-entry\", \"add\", \"Add\", callback, disabled, mode, args);\n\t\t}\n\t}\n\telse {\n\t\tvar addables = frame.getMissingPropertyList();\n\t\tif(addables && addables.length){\n\t\t\tvar mpropDOM = document.createElement(\"span\");\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-\" + scope + \"-add-entry\");\n\t\t\taddables.unshift({ value: \"\", label: \"Add new \" + scope});\n\t\t\tvar callback = function(add){\n\t\t\t\tif(add){\n\t\t\t\t\tif(scope == \"object\") frame.addNewProperty(add);\n\t\t\t\t\telse if(scope == \"property\") frame.addNewValue(add);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(frame.cardControlAllows(\"add\") || frame.display_options.show_disabled_buttons){\n\t\t\t\tvar disabled = (frame.cardControlAllows(\"add\") ? false : \"Cardinality rules forbid adding element\");\n\t\t\t\tvar sel = HTMLHelper.getSelectionControl(scope + \"-add-entry\", addables, \"\", callback, disabled, mode, args);\n\t\t\t\tmpropDOM.appendChild(sel);\n\t\t\t\treturn mpropDOM;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nHTMLHelper.getInfoboxDOM = function(type, label, value, help, mode, args, input){\n\t/*var frow = this.getFrameRow();\n\tvar fgroup = this.getFrameGroup(frow);*/\n\tvar infoDOM = document.createElement(\"span\");\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\n\t//fgroup.appendChild(infoDOM);\n\tif(help){\n\t\tinfoDOM.setAttribute(\"title\", help);\n\t}\n\tif(args && typeof args.label != \"undefined\") label = args.label;\n\tif(label !== false){\n\t\tlabel = (args && args.label ? args.label : label);\n\t\tvar linfo = document.createElement(\"span\");\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\n\t\tlinfo.appendChild(document.createTextNode(label));\n\t\tif(args && args.headerStyle){\n\t\t\tlinfo.setAttribute(\"style\", args.headerStyle);\t\t\t\n\t\t}\n\t\tinfoDOM.appendChild(linfo);\n\t}\n\tvar lval = document.createElement(\"span\");\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value\");\n\tif(input){\n\t\tinput.value = value;\n\t\tlval.appendChild(input);\n\t}\n\telse if(args && args.removePrefixes && value && value.split(\":\").length == 2) {\n\t\tvar bits = value.split(\":\");\n\t\tsh = bits[1];\n\t\tlval.setAttribute(\"title\", value);\n\t\tlval.appendChild(document.createTextNode(sh));\n\t}\n\telse {\n\t\tlval.appendChild(document.createTextNode(value));\n\t}\n\tif(args && args.bodyStyle){\n\t\tlval.setAttribute(\"style\", args.bodyStyle);\n\t}\n\tinfoDOM.appendChild(lval);\n\tif(args && args.style){\n\t\tinfoDOM.setAttribute(\"style\", args.style)\n\t}\n\treturn infoDOM;\n}\n\n\nHTMLHelper.getActionControl = function(type, control, label, callback, disabled, mode, args){\n\t//var pman = new TerminusPluginManager();\n\tvar dpropDOM = document.createElement(\"span\");\n\t//dpropDOM.setAttribute(\"class\", \"terminus-action-control terminus-save-btn \" + type + \"-\" + control);\n\tlabel = (args && typeof args.label != \"undefined\" ? args.label : label);\n\ticon = (args && args.icon ? args.icon : false);\n\tif(icon){\n\t\tvar i = document.createElement(\"i\");\n\t\ti.setAttribute(\"class\", \"fa \" + icon);\n\t\ticon = i;\n\t}\n\tvar tag = (args && args.tag ? args.tag : \"button\");\n\tvar button = document.createElement(tag);\n\tif(icon){\n\t\tbutton.appendChild(icon);\n\t}\n\tif(label) button.appendChild(document.createTextNode(\" \" + label + \" \"));\n\tif(args && args.title){\n\t\tbutton.setAttribute(\"title\", args.title);\n\t}\n\tif(disabled){\n\t\t//button.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\n\t\tbutton.setAttribute(\"title\", disabled);\n\t}\n\telse {\n\t\t//button.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action \" + type + \"-\" + control);\n\t\t\n\t}\n\tdpropDOM.appendChild(button);\n\treturn dpropDOM;\n}\n\nHTMLHelper.removeChildren = function (node) {\n\tif (node) {\n\t\twhile (node.hasChildNodes()) {\n\t\t\tnode.removeChild(node.childNodes[0]);\n\t\t}\n\t}\n};\n\nHTMLHelper.loadDynamicScript = function (scriptid, src, callback) {\n\tconst existingScript = document.getElementById(scriptid);\n\tif (!existingScript) {\n\t\tconst script = document.createElement('script');\n\t\tscript.src = src; // URL for the third-party library being loaded.\n\t\tdocument.body.appendChild(script);\n\t\tscript.onload = function () {\n\t\t\tscript.id = scriptid; // do it here so it doesn't trigger the callback below on multiple calls\n\t\t\tif (callback) callback(scriptid);\n\t\t};\n\t}\n\tif (existingScript && callback) {\n\t\tcallback(scriptid);\n\t}\n};\n\nHTMLHelper.loadDynamicCSS = function (cssid, src, callback) {\n\tconst existingScript = document.getElementById(cssid);\n\tif (!existingScript) {\n\t\tconst link = document.createElement('link');\n\t\tlink.href = src; // URL for the third-party library being loaded.\n\t\tlink.id = cssid; // e.g., googleMaps or stripe\n\t\tlink.rel = 'stylesheet';\n\t\tdocument.body.appendChild(link);\n\t\tlink.onload = function () {\n\t\t\tif (callback) callback(cssid);\n\t\t};\n\t}\n\tif (existingScript && callback) callback(cssid);\n};\n\n\nHTMLHelper.removeElement = function (node) {\n\tif (node) {\n\t\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\nmodule.exports=HTMLHelper\n","\nmodule.exports = {\n\t         WOQLClient:require('./lib/woqlClient'),\n                 ConnectionCapabilities:require('./lib/connectionCapabilities'),\n                 ConnectionConfig:require('./lib/connectionConfig'),\n                 IDParser:require('./lib/terminusIDParser'),\n                 ErrorMessage:require('./lib/errorMessage'),\n                 UTILS:require('./lib/utils'),\n                 WOQLResult:require('./lib/woqlResult'),\n                 WOQLRule:require('./lib/woqlRule'),\n                 FrameRule:require('./lib/frameRule'),\n                 View:require('./lib/woqlView'),\n                 DocumentFrame:require('./lib/viewer/documentFrame'),\n                 WOQLGraph:require('./lib/viewer/woqlGraph'),\n                 WOQLTable:require('./lib/viewer/woqlTable'),\n                 WOQLChooser:require('./lib/viewer/woqlChooser'),\n                 WOQLChart:require('./lib/viewer/woqlChart'),\n                 WOQLStream:require('./lib/viewer/woqlStream'),\n                 WOQL:require('./lib/woql')};","/**\n * @file Terminus Client Utility Functions\n * @license Apache Version 2\n * Object for bunding up common Terminus Utility Functions \n */\nconst Utils = {}\n\n\n/**\n * default set of prefixes that will be used for URL compression\n */\nUtils.standard_urls = {\n\trdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\n\trdfs: 'http://www.w3.org/2000/01/rdf-schema#',\n\txsd: 'http://www.w3.org/2001/XMLSchema#',\n\towl: 'http://www.w3.org/2002/07/owl#',\n\ttcs: 'http://terminusdb.com/schema/tcs#',\n\txdd: 'http://terminusdb.com/schema/xdd#',\n\tv: 'http://terminusdb.com/woql/variable/',\n\tterminus: 'http://terminusdb.com/schema/terminus#',\n\tvio: 'http://terminusdb.com/schema/vio#'\n}\n\n/**\n * Encode document payload for GET  \n */\nUtils.URIEncodePayload = function(payload) {\n\tif (typeof payload === 'string') return encodeURIComponent(payload);\n\tconst payloadArr = [];\n\tfor (const key of Object.keys(payload)) {\n\t\tif (typeof payload[key] === 'object') {\n\t\t\tfor (const keyElement of Object.keys(payload[key])) {\n\t\t\t\t const valueElement = payload[key][keyElement];\n\t\t\t\t payloadArr.push(`${encodeURIComponent(keyElement)}=${encodeURIComponent(valueElement)}`);\n\t\t\t}\n\t\t} else {\n\t\t\tpayloadArr.push(`${encodeURIComponent(key)}=${encodeURIComponent(payload[key])}`);\n\t\t}\n\t}\n\treturn payloadArr.join('&');\n}\n\n\n\n/**\n * Adds an entry to the list of known standard URL prefixes \n */\nUtils.addURLPrefix = function (prefix, url) {\n\tthis.standard_urls[prefix] = url;\n};\n\n\n/**\n * is the object empty? \n * returns true if the json object is empty \n */\nUtils.empty = function (obj) {\n\t   // null and undefined are \"empty\"\n\tif (!obj) return true;\n\t// Assume if it has a length property with a non-zero value\n\t// that that property is correct.\n\tif (obj.length > 0) return false;\n\tif (obj.length === 0) return true;\n\t// Otherwise, does it have any properties of its own?\n\t// Note that this doesn't handle\n\t// toString and valueOf enumeration bugs in IE < 9\n\t// for (const key in obj) {\n\tif (typeof obj === 'object') {\n\t\tfor (const key of Object.keys(obj)) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) return false;\n\t\t}\n\t}\n\treturn true;\n};\n\n/**\n * Generates a unique blank node id \n */\nUtils.genBNID = function () {\n\tconst r = Math.random().toString(36).substring(7);\n\tconst d = new Date();\n\tconst bnid = `_:${r}${d.getTime()}`;\n\treturn bnid;\n};\n\n/**\n * Returns the shorthand version (compressed to prefix:id ) of a url or false if there is none known for that URL\n */\nUtils.getShorthand = function (link) {\n\tif (typeof link === 'object' && link.length) link = link[0];\n\tif (link && typeof link === 'string') {\n\t\tfor (const pref of Object.keys(this.standard_urls)) {\n\t\t\tconst full = this.standard_urls[pref];\n\t\t\tif (link.substring(0, full.length) === full) {\n\t\t\t\tconst sh = `${pref}:${link.substring(full.length)}`;\n\t\t\t\treturn sh;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n\n/**\n * Compares 2 IRIs for equality by checking compressed and expanded versions of both sides\n */\nUtils.compareIDs = function (ida, idb) {\n\tif (ida === idb) return true;\n\tif (this.unshorten(ida) === idb) return true;\n\tif (this.unshorten(ida) === this.unshorten(idb)) return true;\n\tconst sha = this.getShorthand(ida);\n\tconst shb = this.getShorthand(idb);\n\tif (sha && ((sha === idb) || (sha === shb))) return true;\n\tif (shb && shb === ida) return true;\n\treturn false;\n};\n\n\n/**\n * Shortens a URL to its compressed format - returns the full URL if not possible\n */\nUtils.shorten = function (url, prefixes) {\n\tprefixes = prefixes || this.standard_urls;\n\tfor (const pref in prefixes) {\n\t\tif (prefixes[pref] == url.substring(0, prefixes[pref].length)) {\n\t\t\treturn (`${pref}:${url.substring(prefixes[pref].length)}`);\n\t\t}\n\t}\n\treturn url;\n};\n\n/**\n * Expands a URL to its full URL format - returns the passed string if not possible to expand\n */\nUtils.unshorten = function (url) {\n\tif (this.validURL(url)) return url;\n\tif (!url) return url;\n\tconst bits = url.split(':');\n\tif (bits[1]) {\n\t\tif (this.standard_urls[bits[0]]) {\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\n\t\t}\n\t}\n\treturn url;\n};\n\n/**\n * Tests a string to see if it is a valid URL - \n * Valid URLs are those that start with http:// or https://\n */\nUtils.validURL = function (str) {\n\tif (str && (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://')) return true;\n\treturn false;\n};\n\n\n/**\n * Generates a text label from a URL\n */\nUtils.labelFromURL = function (url) {\n\tlet nurl = this.urlFragment(url);\n\tnurl = (nurl || url);\n\tif (nurl.lastIndexOf('/') < nurl.length - 1) {\n\t\tnurl = nurl.substring(nurl.lastIndexOf('/') + 1);\n\t}\n\tnurl = nurl.replace(/_/g, ' ');\n\treturn nurl.charAt(0).toUpperCase() + nurl.slice(1);\n};\n\n/**\n * returns the fragment part of a URL (whether compressed or not)\n */\nUtils.urlFragment = function (url) {\n\turl = (typeof url !== 'string') ? window.location.href : url;\n\tlet bits = url.split('#');\n\tif (bits.length <= 1) {\n\t\tif (!this.validURL(url)) {\n\t\t\tbits = url.split(':');\n\t\t}\n\t}\n\tif (bits.length >= 1) {\n\t\tconst [, urlStr] = bits;\n\n\t\tif (urlStr) {\n\t\t\tconst [baseUrl] = urlStr.split('?');\n\t\t\turl = baseUrl;\n\t\t}\n\t}\n\treturn url;\n};\n\n/**\n * returns the last part of a URL after the last /\n */\nUtils.lastURLBit = function (url) {\n\turl = (typeof url === 'undefined') ? window.location.href : url;\n\tconst [urlFirst] = url.split('#');\n\tconst [urlTmp] = urlFirst.split('?');\n\turl = urlTmp.substring(url.lastIndexOf('/') + 1);\n\treturn url;\n};\n\n/**\n * returns the a standard URL associated with a given prefix and extension\n */\nUtils.getStdURL = function (pref, ext, url) {\n\tif (this.standard_urls[pref]) {\n\t\tif (url) {\n\t\t\tif (url === this.standard_urls[pref] + ext) return url;\n\t\t} else {\n\t\t\treturn this.standard_urls[pref] + ext;\n\t\t}\n\t}\n\treturn false;\n};\n\n/*\n * Utility function adds v: to variables...\n */\nUtils.addNamespacesToVariables = function(vars){\n\tvar nvars = [];\n\tfor(var i = 0; i<vars.length; i++){\n\t\tif(vars[i]) nvars.push(this.addNamespaceToVariable(vars[i]));\t\t\n\t}\n\treturn nvars;\n}\n\nUtils.addNamespaceToVariable = function(v){\n\tif(typeof v == \"string\" && v.substring(0, 2) != \"v:\") return \"v:\" + v;\n\treturn v;\n}\n\n/*\n * Utility function removes v: prefix from a variable...\n */\nUtils.removeNamespaceFromVariable = function(mvar){\n\tif(mvar.substring(0, 2) == \"v:\") return mvar.substring(2)\n\treturn mvar;\n}\n\n/*\n * Utility function removes v: prefix from an array of variables\n */\nUtils.removeNamespacesFromVariables = function(vars){\n\tvar nvars = [];\n\tfor(var i = 0; i<vars.length; i++){\n\t\tnvars.push(this.removeNamespaceFromVariable(vars[i]));\n\t}\n\treturn nvars;\n}\n\n/*\n * Utility function to extract a value from a config rule - if the value is a variable, take the value of that variable instead\n */\nUtils.getConfigValue = function(val, row){\n    if(typeof val == \"string\" && val.substring(0, 2) == \"v:\"){\n\t    var rad = row[val];\n\t    if(rad && rad['@value']) return rad['@value'];\n\t    return rad;\n   }\n   else {\n\t   return val;\n   }\n}\n\n\n/**\n * TypeHelper bundles together utility functions dealing with datatypes\n */\nUtils.TypeHelper = {};\n\n/**\n * Returns true if the passed type is an xsd:string (compressed or not)\n */\nUtils.TypeHelper.isStringType = function (stype) {\n\tif (stype === 'http://www.w3.org/2001/XMLSchema#string') return true;\n\tif (stype === 'xsd:string') return true;\n\treturn false;\n};\n\nUtils.TypeHelper.isDatatype = function (stype) {\n\tvar sh = Utils.shorten(stype);\n\tif(sh.substring(0, 4) == \"xsd:\" || sh.substring(0, 4) == \"xdd:\") return true;\n\treturn false;\n};\n\n/** \n * Adds 3 order magnitude separators ( default ,) into big numbers for legibility\n */\nUtils.TypeHelper.numberWithCommas = function (value, separator) {\n\tseparator = separator || \",\";\n\tif (value >= 1000 || value <= -1000) {\n\t    const parts = value.toString().split('.');\n\t    if (value <= -1000) parts[0] = parts[0].substring(1);\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, separator);\n\t    if (value <= -1000) value = `-${parts.join('.')}`;\n\t    else value = parts.join('.');\n\t}\n\treturn value;\n};\n\n/**\n * List of supported datatypes\n */\nUtils.TypeHelper.datatypes = [\n\t'xdd:coordinate', 'xdd:coordinatePolyline',\n\t'xdd:coordinatePolygon', 'xdd:dateRange', 'xdd:gYearRange', 'xdd:integerRange',\n\t'xdd:decimalRange', 'xdd:cc', 'xdd:email', 'xdd:html', 'xdd:url', 'xsd:anySimpleType',\n\t'xsd:string', 'xsd:boolean', 'xsd:decimal', 'xsd:double', 'xsd:float', 'xsd:time', 'xsd:date',\n\t'xsd:dateTime', 'xsd:dateTimeStamp', 'xsd:gYear', 'xsd:gMonth', 'xsd:gDay', 'xsd:gYearMonth',\n\t'xsd:gMonthDay', 'xsd:duration', 'xsd:yearMonthDuration', 'xsd:dayTimeDuration',\n\t'xsd:byte', 'xsd:short', 'xsd:integer', 'xsd:long', 'xsd:unsignedByte',\t'xsd:unsignedInt',\n\t'xsd:unsignedLong',\t'xsd:nonNegativeInteger', 'xsd:positiveInteger', 'xsd:negativeInteger',\n\t'xsd:nonPositiveInteger', 'xsd:base64Binary', 'xsd:anyURI', 'xsd:language', 'xsd:normalizedString',\n\t'xsd:token', 'xsd:NMTOKEN',\t'xsd:Name',\t'xsd:NCName', 'xsd:NOTATION', 'xsd:QName', 'xsd:ID',\n\t'xsd:IDREF', 'xsd:ENTITY', 'rdf:XMLLiteral', 'rdf:PlainLiteral', 'rdfs:Literal', 'xdd:json'\n];\n\nUtils.TypeHelper.parseRangeValue = function (val, dividor) {\n\tdividor = (dividor || ',');\n\tlet vals = [];\n\tif (typeof val === 'object' && val.length) {\n\t\tvals = val;\n\t} else if (val) {\n\t\tif (typeof val !== 'string') {\n\t\t\tval = `${val}`;\n\t\t}\n\t\tif (val.length && (val.charAt(0) === '[') && val.charAt(val.length - 1) === ']') {\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length - 1));\n\t\t} else {\n\t\t\tvals.push(val);\n\t\t}\n\t}\n\treturn vals;\n};\n\n/**\n * DateHelper bundles together utility functions dealing with xsd date types\n */\nUtils.DateHelper = {};\n\n/**\n * Takes an xsd time string and returns a structure {hour: HH, minute: MM, second ss.ssssss, timezone: tz}\n */\nUtils.DateHelper.parseXsdTime = function (val) {\n\tif (!val) return {};\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tconst parsed = {\n\t\thour: val.substring(0, 2),\n\t\tminute: val.substring(3, 5),\n\t\tsecond: val.substring(6),\n\t\ttimezone: tz\n\t};\n\treturn parsed;\n};\n\n/**\n * Takes an xsd time string and returns a structure {year: [-]YYYY, month: MM, day: dd}\n */\nUtils.DateHelper.parseXsdDate = function (val) {\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tlet year;\n\tif (val.substring(0, 1) === '-') {\n\t\tyear = val.substring(0, 5);\n\t} else {\n\t\tyear = val.substring(0, 4);\n\t}\n\tlet parsed;\n\tif (year && Math.abs(year) < 10000) {\n\t\tlet month = val.substring(year.length + 1, year.length + 3);\n\t\tif (month) { month = parseInt(month, 10); } else return false;\n\t\tlet day = val.substring(year.length + 4);\n\t\tif (day) day = parseInt(day, 10);\n\t\telse return false;\n\t\tparsed = {\n\t\t\tyear,\n\t\t\t   month,\n\t\t\t   day,\n\t\t\t   timezone: tz\n\t\t};\n\t}\n\treturn parsed;\n};\n\n/**\n * Parses a date string of type ty\n */\nUtils.DateHelper.parseDate = function (ty, value) {\n\tlet parsed;\n\tif (ty === 'xsd:date') {\n\t\tparsed = this.parseXsdDate(value);\n\t} else if (ty === 'xsd:time') {\n\t\tparsed = this.parseXsdTime(value);\n\t} else if (ty === 'xsd:dateTime') {\n\t\tparsed = this.parseXsdDateTime(value);\n\t} else if (ty === 'xsd:gYear') {\n\t\tparsed = { year: value };\n\t} else if (ty === 'xsd:gYearRange') {\n\t\tparsed = { year: value };\n\t} else if (ty === 'xsd:gMonth') {\n\t\tparsed = { month: value.substring(2) };\n\t} else if (ty === 'xsd:gDay') {\n\t\tparsed = { day: value };\n\t} else if (ty === 'xsd:gYearMonth') {\n\t\tconst bits = value.split('-');\n\t\twhile (bits.length < 2) bits.push('');\n\t\tparsed = { year: bits[0], month: bits[1] };\n\t} else if (ty === 'xsd:gMonthDay') {\n\t\tconst bits = value.split('-');\n\t\twhile (bits.length < 2) bits.push('');\n\t\tparsed = { month: bits[0], day: bits[1] };\n\t} else if (ty === 'xsd:dateTimeStamp') {\n\t\tparsed = this.parseXsdDateTime(value);\n\t}\n\treturn parsed;\n};\n\n/**\n * adds appropriate padding to date type for xsd rules\n */\nUtils.DateHelper.addXsdPadding = function (parsed) {\n\tconst nparsed = {};\n\tif (typeof parsed.year !== 'undefined' && parsed.year !== false && parsed.year < 1000) {\n\t\tif (Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? `-000${Math.abs(parsed.year)}` : `000${parsed.year}`);\n\t\telse if (Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? `-00${Math.abs(parsed.year)}` : `00${parsed.year}`);\n\t\telse nparsed.year = (parsed.year < 0 ? `-0${Math.abs(parsed.year)}` : `0${parsed.year}`);\n\t} else if (parsed.year) {\n\t\tnparsed.year = parsed.year;\n\t}\n\tif (typeof parsed.month !== 'undefined' && parsed.month !== false && parsed.month < 10) {\n\t\tnparsed.month = `0${parsed.month}`;\n\t} else if (parsed.month) {\n\t\tnparsed.month = parsed.month;\n\t}\n\tif (typeof parsed.day !== 'undefined' && parsed.day !== false && parsed.day < 10) {\n\t\tnparsed.day = `0${parsed.day}`;\n\t} else if (parsed.day) {\n\t\tnparsed.day = parsed.day;\n\t}\n\tif (typeof parsed.hour !== 'undefined' && parsed.hour !== false && parsed.hour < 10) {\n\t\tnparsed.hour = `0${parsed.hour}`;\n\t} else if (parsed.hour) {\n\t\tnparsed.hour = parsed.hour;\n\t}\n\tif (typeof parsed.minute !== 'undefined' && parsed.minute !== false && parsed.minute < 10) {\n\t\tnparsed.minute = `0${parsed.minute}`;\n\t} else if (parsed.minute) {\n\t\tnparsed.minute = parsed.minute;\n\t}\n\tif (typeof parsed.second !== 'undefined' && parsed.second !== false && parsed.second < 10) {\n\t\tnparsed.second = `0${parsed.second}`;\n\t} else if (parsed.second) {\n\t\tnparsed.second = parsed.second;\n\t}\n\treturn nparsed;\n};\n\n/**\n * generates an xsd string of type ty for the passed parsed structure (year, month, day, hour, minute, second, timezone)\n */\nUtils.DateHelper.xsdFromParsed = function (parsed, ty) {\n\tconst xparsed = this.addXsdPadding(parsed);\n\tlet ret;\n\tif (ty === 'xsd:gYear') {\n\t\tret = (xparsed.year ? xparsed.year : false);\n\t} else if (ty === 'xsd:time') {\n\t\treturn (xparsed.hour && xparsed.minute && xparsed.second) ? `${xparsed.hour}:${xparsed.minute}:${xparsed.second}` : false;\n\t} else if (ty === 'xsd:date') {\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}` : false;\n\t} else if (ty === 'xsd:dateTime' || ty === 'xsd:dateTimeStamp') {\n\t\tret = (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}T` : false;\n\t\tif (ret) ret += `${xparsed.hour ? xparsed.hour : '12'}:${xparsed.minute ? xparsed.minute : '00'}:${xparsed.second ? xparsed.second : '00'}`;\n\t} else if (ty === 'xsd:gMonth') {\n\t\tret = (xparsed.month ? `--${xparsed.month}` : false);\n\t} else if (ty === 'xsd:gDay') {\n\t\tret = (xparsed.day ? `---${xparsed.day}` : false);\n\t} else if (ty === 'xsd:gYearMonth') {\n\t\tret = (xparsed.year && xparsed.month) ? `${xparsed.year}-${xparsed.month}` : false;\n\t} else if (ty === 'xsd:gMonthDay') {\n\t\tret = (xparsed.day && xparsed.month) ? `--${xparsed.month}-${xparsed.day}` : false;\n\t}\n\tif (xparsed.timezone) {\n\t\tret += xparsed.timezone;\n\t}\n\treturn ret;\n};\n\n/**\n * Converts between a unix timestamp and a parsed structure \n */\nUtils.DateHelper.convertTimestampToXsd = function (val) {\n\t  const a = new Date(val * 1000);\n\t  const parsed = {\n\t\tyear: a.getFullYear(),\n\t\tmonth: a.getMonth() + 1,\n\t\tday: a.getDate(),\n\t\thour: a.getHours(),\n\t\tminute: a.getMinutes(),\n\t\tsecond: a.getSeconds()\n\t  };\n\t  return parsed;\n};\n\n/**\n * Parses an xsd date time into a structure\n */\nUtils.DateHelper.parseXsdDateTime = function (val) {\n\tif (!val) return {};\n\tif (typeof val === 'number') {\n\t\treturn this.convertTimestampToXsd(val);\n\t}\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tconst datetime = this.parseXsdDate(val);\n\tconst ptime = this.parseXsdTime(val.substring(val.indexOf('T') + 1));\n\n\tfor (const i of Object.keys(ptime)) {\n\t\tdatetime[i] = ptime[i];\n\t}\n\tdatetime.timezone = tz;\n\treturn datetime;\n};\n\n/**\n * Extracts the timezone data from an xsd date string\n */\nUtils.DateHelper.extractXsdTimezone = function (val) {\n\tif (val && val.charAt(val.length - 1) === 'Z') {\n\t\treturn 'Z';\n\t}\n\tif (val && (val.charAt(val.length - 6) === '+' || val.charAt(val.length - 6) === '-')) {\n\t\tval.substring(val.length - 6);\n\t}\n\treturn false;\n};\n\nmodule.exports = Utils;\n\n\n","'use strict';\n\nvar bind = require('./helpers/bind');\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && typeof val.constructor.isBuffer === 'function' && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||\n                                           navigator.product === 'NativeScript' ||\n                                           navigator.product === 'NS')) {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = merge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Function equal to merge with the difference being that no reference\n * to original objects is kept.\n *\n * @see merge\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction deepMerge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = deepMerge(result[key], val);\n    } else if (typeof val === 'object') {\n      result[key] = deepMerge({}, val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  deepMerge: deepMerge,\n  extend: extend,\n  trim: trim\n};\n","/**\n * @file Javascript Api explorer tool\n * @author Kitty Jose\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\n *\n * @summary Set of functions used across scripts\n */\nconst Codemirror= require('./plugins/codemirror.terminus');\nconst TerminusClient = require('@terminusdb/terminus-client');\nconst HTMLHelper = require('./html/HTMLHelper');\n\n// function to read Files\nfunction readFile(file){\n    if (window.XMLHttpRequest){\n        // code for IE7+, Firefox, Chrome, Opera, Safari\n        xmlhttp=new XMLHttpRequest();\n    }\n    else{\n        // code for IE6, IE5\n        xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\n    }\n    xmlhttp.open(\"GET\",file,false);\n    xmlhttp.send();\n    xmlDoc=xmlhttp.responseText;\n    return xmlDoc;\n} // readFile()\n\n// function to write api call signatures from woql client\nfunction getFunctionSignature(which){\n  var sigs = {};\n  sigs.connect = {\n    spec   : \"WOQLClient.connect(surl, key)\",\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\n                + \" or the promise will be rejected.\"\n                + \"\\n1)The first (surl) argument: {string} argument it is the Server Url\"\n                + \"\\n2)The second(key) argument: {string} argument contains an API key\",\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\n    args   : {server_url : 'url', key: 'Api key'},\n    options: { title: \"\", description: \"\" }\n  };\n  sigs.create = {\n    spec    : \"WOQLClient.createDatabase(dburl, details, key)\",\n    descr   : \"\\n\\nCreate a Terminus Database\"\n                + \"\\n1)The first (dburl) argument:{string}, it is a terminusDB Url or a terminusDB Id \"\n                + \"\\n2)The second(details) argument:{object}, details which is the payload\"\n                + \"\\n which included information of the new database to be created\"\n                +  \"\\n3)The third (key) argument:{string}, contains an API key \",\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\n    args   : {database_url : 'url', details: '', key: ' Api key'},\n    options: { title: \"\", description: \"\" }\n  };\n  sigs.delete = {\n      spec  : \"WOQLClient.deleteDatabase(dburl, key)\",\n      descr : \"\\n\\nDeletes a Database\"\n                + \"\\n1)The first (dburl) argument: {string}, it is a terminusDB Url or a terminusDB Id \"\n                + \"\\n2)The second(key) argument: {string}, contains an API key\",\n      result: \"HTTP 200 on success, otherwise error code\",\n  };\n  sigs.getSchema = {\n    spec   : \"WOQLClient.getSchema(surl, options)\",\n    descr  : \"\\n\\nGets the schema of a database.\"\n             +\"\\n1)The first (surl) argument: {string}, it is a dbUrl/schema\"\n             + \"\\n2)The second(key) argument: {string}, contains an API key\",\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    options: { format: \"turtle\" }\n  };\n  sigs.getClassFrames = {\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\n              +  \"\\nThe first (cfurl) argument can be\"\n              + \"\\n1) a valid URL of a terminus database or\"\n              +  \"\\n2) omitted - the current database will be used\"\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    options: { format: \"turtle\" }\n  };\n  sigs.updateSchema = {\n    spec    : \"WOQLClient.updateSchema(schurl, docs, options)\",\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\n                +\"\\n1)The first (surl) argument :{string}, is a dbUrl/schema\"\n                + \"\\n2)The second(docs) argument:{object}, is a valid owl ontology (new schema to be updated) in turtle format\"\n                + \"\\n3)The third (key) argument:{string}, contains an API key\",\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    args   : {document : 'doc'},\n    options: { format: \"turtle\", editmode: \"replace\"}\n  };\n  sigs.createDocument = {\n    spec   : \"WOQLClient.createDocument(docurl, document, options)\",\n    descr  : \"\\n\\nCreates a new document in the specified database\"\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\n              + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\n    args   : {document_url : 'url', document: \"doc\"},\n    options: { format: \"turtle\", fail_on_id_denied: false}\n  };\n  sigs.viewDocument = {\n    spec    : \"WOQLClient.getDocument(docurl, options)\",\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\n              + \"\\n2)The second (key) argument: {string}, contains an API key\",\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\n    args   : {document_url : 'url'},\n    options: { format: \"turtle\"}\n  };\n  sigs.updateDocument = {\n    spec   : \"WOQLClient.updateDocument(docurl, document, options)\",\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\n                + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\n                + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\n                + \"\\n3)The third (key) argument:{string} argument contains an API key\",\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    args   : {document_url : 'url', document: \"doc\"},\n    options: { format: \"turtle\", editmode: \"replace\"}\n  };\n  sigs.deleteDocument = {\n    spec  : \"WOQLClient.deleteDocument(docurl, key)\",\n    descr : \"\\n\\nDeletes a document from the specified database\"\n            + \"\\n1)The first (docurl) argument: {string},is a dbUrl/document/document_id\"\n            + \"\\n2)The second (key) argument: {string}, contains an API key\",\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    args  : {document_url : 'url'},\n  };\n  sigs.select = {\n    spec: \"WOQLClient.select(dburl, query, options)\",\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\n              + \"\\n1)The first (docurl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {woql: 'woql'},\n  };\n  sigs.update = {\n    spec  : \"WOQLClient.update(dburl, query, options)\",\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\n              + \"\\n1)The first (dburl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args  : {woql: 'woql'},\n  };\n  sigs.lookup = {\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {class: 'url', term: 'string'},\n  };\n  sigs.map = {\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {source: 'json', target: \"json\", woql: 'json'},\n  };\n  sigs.getClassFrame = {\n    spec: \"WOQLClient.getClassFrame(class, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {class: 'url'},\n  };\n  sigs.getPropertyFrame = {\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {class: 'url', property: 'url'},\n  };\n  sigs.getFilledPropertyFrame = {\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {document_url: 'url', property: 'url'},\n  };\n  sigs.getSubClasses = {\n    spec: \"WOQLClient.getSubClasses(class, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {class: 'url'},\n  };\n  return sigs[which];\n}//getFunctionSignature\n\n// returns dom element for header text\nfunction getHeaderDom(text){\n  var hd = document.createElement('div');\n  hd.setAttribute('class', 'terminus-module-head');\n  var h = document.createElement('h3');\n  h.innerHTML = text;\n  hd.appendChild(h);\n  return hd;\n} // getHeaderTextDom\n\nfunction getButton(text){\n  var button = document.createElement('button');\n  button.setAttribute('class', 'terminus-btn');\n  button.setAttribute('value', text);\n  button.appendChild(document.createTextNode(text));\n  return button;\n}\n\n// returns dom for alert banner\nfunction getInfoAlertDom(type, label, msg){\n  var ald = document.createElement('div');\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\n  else ald.setAttribute('class', 'alert');\n  var str = document.createElement('STRONG');\n  str.innerHTML = label;\n  ald.appendChild(str);\n  var txt = document.createTextNode(msg);\n  ald.appendChild(txt);\n  return ald;\n} // getInfoAlertDom()\n\n// formats response results from platform\nfunction getResponse(currForm, action, response, terminator){\n\n  var rd = document.createElement('div');\n\n  // get header result\n  rd.appendChild(getHeaderDom('Result'));\n  var br = document.createElement('BR');\n  rd.appendChild(br);\n\n  var data = JSON.stringify(response, 0, 4);\n\n  var pre = document.createElement('pre');\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\n  pre.innerHTML = data;\n\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\n  if(!cm) rd.appendChild(pre);\n\n  var br = document.createElement('BR');\n  rd.appendChild(br);\n\n  currForm.appendChild(rd);\n\n  return currForm;\n}\n\n// formats the response from fetch call and spits out Http header and result\nfunction showHttpResult(response, action, currForm, terminator){\n    //var currForm = document.createElement('div');\n\n    var br = document.createElement('BR');\n    currForm.appendChild(br);\n    var br = document.createElement('BR');\n    currForm.appendChild(br);\n\n    // get header result\n    currForm.appendChild(getHeaderDom('HTTP Header'));\n\n    var br = document.createElement('BR');\n    currForm.appendChild(br);\n\n     var retHttpHeaders  = '';\n\n     // iterate over all headers\n     for (let [key, value] of response.headers) {\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\n     }\n\n    // http header result\n    var hdres = document.createElement('pre');\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\n    var txt = document.createTextNode(retHttpHeaders);\n    hdres.appendChild(txt);\n\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\n    if(!cm) currForm.appendChild(hdres);\n\n    return response.json()\n    .then(function(response){\n      getResponse(currForm, action, response, terminator); // get return response\n    })\n\n} // UTILS.showHttpResult()\n\n\nfunction deleteStylizedEditor(ui, qip){\n    if(ui.pluginAvailable(\"codemirror\")){\n\t\tvar cm = qip.nextElementSibling;\n\t\tcm.setAttribute('class', 'terminus-hide');\n\t\tHTMLHelper.removeChildren(cm);\n\t}\n}\n\n/* ui: terminus ui reference\n   txt: text area to be stylized\n   view: defines the size of editor to appear in pages (schema/ query)\n   mode: format to be displayed in\n*/\nfunction stylizeEditor(ui, txt, view, mode){\n  if(ui){\n      var cmConfig = ui.pluginAvailable(\"codemirror\");\n      if(!(cmConfig)) return;\n      var cm = new Codemirror(txt, mode, cmConfig);\n  }\n  else{\n      var cm = new Codemirror(txt, mode, {});\n  }\n\tvar ar = cm.colorizeTextArea(view);\n\tcm.updateTextArea(ar);\n}\n\n/* ui: terminus ui reference\n   txt: text area to be stylized\n   dom: stylized pre area is appended to dom\n   mode: format to be displayed in\n*/\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\n    if(ui){\n        var cmConfig = ui.pluginAvailable(\"codemirror\");\n        if(!(cmConfig)) return false;\n        var cm = new Codemirror(txt, mode, cmConfig);\n    }\n    else var cm = new Codemirror(txt, mode, {});\n    var pr = cm.colorizePre();\n    if(dom) dom.appendChild(pr);\n    return true;\n}\n\n/* name: classname to find and remove classes from elements\n*/\nfunction removeSelectedNavClass(name){\n    var el = document.getElementsByClassName(name);\n    if (el.length < 1) return;\n    for(var i=0; i<(el.length + 1); i++){\n        el[i].classList.remove(name);\n    }\n}\n\nfunction setSelectedSubMenu(a){\n    removeSelectedNavClass(\"terminus-submenu-selected\");\n    a.classList.add(\"terminus-submenu-selected\");\n}\n\nfunction setSelected(el, className){\n    var par = el.parentElement;\n    for(var i=0; i<par.childNodes.length; i++){\n        if(par.childNodes[i].classList.contains(className))\n            par.childNodes[i].classList.remove(className);\n    }\n    el.classList.add(className);\n}\n\n// toggles between contents\nfunction tolggleContent(icon, content){\n    if (content.style.display === \"block\"){\n        removeSelectedNavClass(\"fa-chevron-up\");\n        icon.classList.add(\"fa-chevron-down\");\n        content.style.display = \"none\";\n    }\n    else{\n        removeSelectedNavClass(\"fa-chevron-down\");\n        icon.classList.add(\"fa-chevron-up\");\n        content.style.display = \"block\";\n    }\n}\n\n// controls current selected nav bar\nfunction activateSelectedNav(nav, terminator){\n    removeSelectedNavClass(\"terminus-selected\");\n\t//checkDocumentSubMenus(terminator);\n\tnav.classList.add(\"terminus-selected\");\n}\n\nfunction hideDocumentSubMenus(el){\n\tif(el.classList.contains('terminus-display')){\n\t\tel.classList.remove('terminus-display');\n\t\tel.classList.add('terminus-hide');\n\t}\n}\n\nfunction checkDocumentSubMenus(terminator){\n\tif(terminator.ui.showControl(\"get_document\")) {\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\n\t\thideDocumentSubMenus(gd[0]);\n\t}\n\tif(terminator.ui.showControl(\"create_document\")) {\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\n\t\thideDocumentSubMenus(cd[0]);\n\t}\n}\n\nfunction toggleVisibility(el){\n\tif(el.classList.contains('terminus-display')){\n\t\tel.classList.remove('terminus-display');\n\t\tel.classList.add('terminus-hide');\n\t}\n    else if(el.classList.contains('terminus-hide')){\n        el.classList.remove('terminus-hide');\n\t\tel.classList.add('terminus-display');\n\t}\n}\n\nfunction extractValueFromCell(cellValue){\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\n    return ihtml.firstChild.innerHTML;\n}\n\nfunction displayDocumentSubMenus(ui) {\n\t//display submenus on click of documents\n\tif(ui.showControl(\"get_document\")) {\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\n\t\tshowSubMenus(gd[0]);\n\t}\n\tif(ui.showControl(\"create_document\")) {\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\n\t\tshowSubMenus(cd[0]);\n\t}\n}\n\nfunction checkForMandatoryId(){\n    var objId = document.getElementsByClassName('terminus-object-id-input');\n    if(objId.length>0){\n        if(!objId[0].value){\n            objId[0].setAttribute('placeholder', 'Required field');\n            objId[0].style.background = '#f8d7da';\n            return false;\n        }\n        else return true;\n    }\n}\n\nfunction showSubMenus (el){\n\tel.classList.remove('terminus-hide');\n\tel.classList.add('terminus-display');\n}\n\n// function which generates query based on current settings from different screens of dashboard\nfunction getCurrentWoqlQueryObject(query, settings){\n\tvar qval;\n    if(!query) query = settings.query;\n\tswitch(query){\n\t\tcase 'Show_All_Schema_Elements':\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\n                        .start(settings.start)\n                        .elementMetadata();\n\t\tbreak;\n\t\tcase 'Show_All_Classes':\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\n                        .start(settings.start)\n                        .classMetadata();\n\t\tbreak;\n\t\tcase 'Show_All_Data':\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\n                        .start(settings.start)\n                        .getEverything();\n\t\tbreak;\n\t\tcase 'Show_All_Documents':\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\n                        .start(settings.start)\n                        .getAllDocuments();\n\t\tbreak;\n        case 'Show_All_Document_classes':\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\n                        .start(settings.start)\n                        .documentMetadata();\n        break;\n        case 'Show_Document_Classes':\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\n                        .start(settings.start).and(\n                        TerminusClient.WOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\n                        TerminusClient.WOQL.abstract(\"v:Element\"),\n                        TerminusClient.WOQL.sub(\"v:Element\", \"tcs:Document\"),\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"));\n        break;\n        case 'Show_All_Properties':\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\n                        .start(settings.start)\n                        .propertyMetadata();\n        break;\n\t\tdefault:\n\t\t\tconsole.log('Invalid query ' + query + ' passed in WOQLTextboxGenerator');\n\t\tbreak;\n\t}\n\treturn qval;\n}\n\n// removes spaces\nfunction trimValue(text){\n    (text).replace(/[\\s\\t\\r\\n\\f]/g,'');\n    return text;\n}\n\n// query string\nfunction getqObjFromInput(q){\n    const WOQL = TerminusClient.WOQL ;\n    //var query = 'WOQL.' + q;\n    var query = q;\n    try {\n        var qObj = eval(query);\n        this.qObj = qObj;\n        return qObj;\n    }\n    catch(e){\n        console.log('Error in getting woql object ',e.toString());\n    }\n}\n\nmodule.exports={tolggleContent,\n               removeSelectedNavClass,\n               stylizeCodeDisplay,\n               stylizeEditor,\n               deleteStylizedEditor,\n               showHttpResult,\n               getHeaderDom,\n               getInfoAlertDom,\n               getFunctionSignature,\n               toggleVisibility,\n               extractValueFromCell,\n               displayDocumentSubMenus,\n               setSelectedSubMenu,\n               checkForMandatoryId,\n               activateSelectedNav,\n               getCurrentWoqlQueryObject,\n               getButton,\n               trimValue,\n               setSelected,\n               getqObjFromInput}\n","const TerminusRule = require('./terminusRule.js');\nconst UTILS = require('./utils.js');\n\n/**\n * @file WOQL Rules \n * @license Apache Version 2\n * WOQL Rules support pattern matching on results of WOQL Queries \n */\n\nfunction WOQLRule(){\n\tTerminusRule.TerminusRule.call(this); \n\tthis.pattern = new WOQLPattern();\n}\nWOQLRule.prototype = Object.create(TerminusRule.TerminusRule.prototype);\nWOQLRule.prototype.constructor = TerminusRule.TerminusRule;\n\n/** \n * Specifies that the rule only applies to specific variables returned by the WOQL query\n * @param {[String]} - array of strings, each representing a variable name, variable prefixes (\"v:\") are added automatically if absent\n */\nWOQLRule.prototype.setVariables = function(vars){\n\tif(vars && vars.length){\n\t\tthis.pattern.variables = UTILS.addNamespacesToVariables(vars);\n\t\tthis.current_variable = this.pattern.variables[this.pattern.variables.length - 1];\n\t}\n\treturn this;\n}\n\n/**\n * Shorthand to the above using spread operator\n */\nWOQLRule.prototype.vars = function(...varlist){\n\treturn this.setVariables(varlist);\n}\n\n/**\n * Specifies that the rule applies to a specific variable, variable prefix (\"v:\") is added automatically if absent\n */\nWOQLRule.prototype.v = function(v){\n\tif(v){\n\t\tthis.current_variable = UTILS.addNamespaceToVariable(v);\n\t\treturn this;\n\t}\n\treturn this.current_variable;\n}\n\n\n/**\n * Specifies that the rule applies to a specific edge, a source -> target pair of variables\n */\nWOQLRule.prototype.edge = function(source, target){\n\tthis.scope(\"edge\");\n\tif(source){\n\t\tlet vs = UTILS.addNamespaceToVariable(source);\n\t\tthis.setVariables([vs]);\n\t\tthis.pattern.source = vs;\n\t} \n\tif(target){\n\t\tlet vs = UTILS.addNamespaceToVariable(target);\n\t\tif(!source) this.setVariables([vs]);\n\t\tthis.pattern.target = vs;\n\t}\n\treturn this;\n}\n\n/**\n * Specifies that the rule applies to a specific edge, a source -> target pair of variables\n */\nWOQLRule.prototype.rownum = function(rownum){\n\tif(typeof rownum == \"undefined\") return this.pattern.rownum; \n\tthis.pattern.rownum = rownum;\n\treturn this;\n}\n\n/**\n * Specifies that the value of a variable must be one of the values contained in the list\n * @param {[String|Number]} list - parameters are any atomic value (string | number) - the rule will match only cells that have one of these values\n */\nWOQLRule.prototype.in = function(...list){\n\tif(this.current_variable){\n\t\tif(!this.pattern.constraints) this.pattern.constraints = {};\n\t\tif(!this.pattern.constraints[this.current_variable]) this.pattern.constraints[this.current_variable] = [];\n\t\tthis.pattern.constraints[this.current_variable].push(list);\n\t}\n\treturn this;\n}\n\n/**\n * Specifies a filter function to apply to each element - only those values that return true when this filter is invoked will be matched\n * @param {function} tester - test function that will be used to filter values\n */\nWOQLRule.prototype.filter = function(tester){\n\tif(this.current_variable){\n\t\tif(!this.pattern.constraints) this.pattern.constraints = {};\n\t\tif(!this.pattern.constraints[this.current_variable]) this.pattern.constraints[this.current_variable] = [];\n\t\tthis.pattern.constraints[this.current_variable].push(tester);\n\t}\n\treturn this;\n}\n\nWOQLRule.prototype.matchRow = function(rules, row, rownum, action){\n\tvar matches = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tif(action && this.rule && typeof this.rule[action] == \"undefined\") continue;\n\t\tif(rules[i].pattern.matchRow(row, rownum)){\n\t\t\tmatches.push(rules[i]);\n\t\t}\n\t}\n\treturn matches;\n}\n\nWOQLRule.prototype.matchCell = function(rules, row, key, rownum, action){\n\tvar matches = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tif(action && this.rule && typeof this.rule[action] == \"undefined\") continue;\n\t\tif(rules[i].pattern.matchCell(row, key, rownum)){\n\t\t\tmatches.push(rules[i]);\n\t\t}\n\t}\n\treturn matches;\n}\n\nWOQLRule.prototype.matchColumn = function(rules, key, action){\n\tvar matches = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tif(action && this.rule && typeof this.rule[action] == \"undefined\") continue;\n\t\tif(rules[i].pattern.matchColumn(key)){\n\t\t\tmatches.push(rules[i]);\n\t\t}\n\t}\n\treturn matches;   \n}\n\nWOQLRule.prototype.matchNode = function(rules, row, key, nid, action){\n\tvar matches = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tif(action && this.rule && typeof this.rule[action] == \"undefined\") continue;\n\t\tif(rules[i].pattern.matchNode(row, key, nid)){\n\t\t\tmatches.push(rules[i]);\n\t\t}\n\t}\n\treturn matches;\n}\n\nWOQLRule.prototype.matchPair = function(rules, row, keya, keyb, action){\n\tvar matches = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tif(action && this.rule && typeof this.rule[action] == \"undefined\") continue;\n\t\tif(rules[i].pattern.matchPair(row, keya, keyb)){\n\t\t\tmatches.push(rules[i]);\n\t\t}\n\t}\n\treturn matches;\n}\n\n//alias\nWOQLRule.prototype.matchEdge = WOQLRule.prototype.matchPair;\n\n\n/**\n * Object to encapsulate the matching of woql result patterns - inherits from TerminusRule\n * @param {Object} pattern \n */\nfunction WOQLPattern(pattern){\n\tTerminusRule.TerminusPattern.call(this,pattern); \n};\nWOQLPattern.prototype = Object.create(TerminusRule.TerminusPattern.prototype);\nWOQLPattern.prototype.constructor = TerminusRule.TerminusPattern;\n\nWOQLPattern.prototype.prettyPrint = function(type){\n\t//starts with obj. ...\n\tvar str = this.scope + \"('\";\n\tif(this.variables){\n\t\tstr += this.variables.join(\"', '\");\n\t }\n\t str += \"')\";\n\tif(typeof this.literal != \"undefined\"){\n\t\tstr += \".literal(\" + this.literal + \")\";\n\t}\n\tif(typeof this.type != \"undefined\"){\n\t\tstr += \".type(\" + this.unpack(this.type) + \")\";\n\t}\n\tif(typeof this.value != \"undefined\"){\n\t\tstr += \".value(\" + this.unpack(this.value, true) + \")\";\n\t}\n\tfor(var v in this.constraints){\n\t\tstr += \".v('\" + v + \"')\";\n\t\tfor(var i = 0; i<this.constraints[v].length; i++){\n\t\t\tif(typeof(this.constraints[v][i]) == \"function\"){\n\t\t\t\tstr += \".filter(\" + this.constraints[v][i] + \")\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstr += \".in(\" + json.unpack(this.constraints[v][i]) + \")\";\n\t\t\t}\n\t\t}\n\t}\n\treturn str;\n}\n\n/**\n * @param {String|Object} data\n * @param {String|[String, String]} [key] - a variable or an array of two variables (in the case of edge scope) which constitutes the key being tested\n * @param {String} [scope] - the scope in which the test is being carried out (row, column, cell)\n */\n\nWOQLPattern.prototype.matchRow = function(row, rownum){\n\tif(typeof this.rownum != \"undefined\" && typeof rownum != \"undefined\"){\n\t\tif(!this.numberMatch(this.rownum, rownum)) return false;\n\t}\n\tif(this.scope && this.scope != \"row\") return false;\n\tif(!this.testVariableConstraints(row)) return false;\n\treturn true;\n}\n\nWOQLPattern.prototype.matchCell = function(row, key, rownum){\n\tif(typeof this.rownum != \"undefined\" && typeof rownum != \"undefined\"){\n\t\tif(!this.numberMatch(this.rownum, rownum)) return false;\n\t}\n\tif(!this.testBasics(\"column\", row[key])) return false;\n\tif(this.variables && this.variables.length && this.variables.indexOf(key) == -1) return false;\n\tif(!this.testVariableConstraints(row)) return false;\n\treturn true;\t\n}\n\nWOQLPattern.prototype.matchNode = function(row, key, nid){\n\tif(!this.testBasics(\"node\", row[key])) return false;\n\tif(this.variables && this.variables.length && this.variables.indexOf(key) == -1) return false;\n\tif(!this.testVariableConstraints(row)) return false;\n\treturn true;\t\n}\n\nWOQLPattern.prototype.matchColumn = function(key){\n\tif(this.scope && this.scope != \"column\") return false;\t\n\tif(this.variables && this.variables.length && this.variables.indexOf(key) == -1) return false;\n\treturn true;\n}\n\nWOQLPattern.prototype.matchPair = function(row, keya, keyb){\n\tif(this.scope && this.scope != \"edge\") return false;\t\n\tif(this.source && this.source != keya) return false;\n\tif(this.target && this.target != keyb) return false;\n\tif(!this.testVariableConstraints(row)) return false;\n\treturn true;\n}\n\nWOQLPattern.prototype.testVariableConstraints = function(row){\n\tfor(var k in this.constraints){\n\t\tif(!this.testVariableConstraint(k, row[k])) return false;\n\t}\n\treturn true;\n}\n\nWOQLPattern.prototype.testVariableConstraint = function(name, val){\n\tif(!this.constraints[name]) return true;\n\tfor(var i = 0; i<this.constraints[name].length; i++){\n\t\tif(!this.testValue(val, this.constraints[name][i])){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nWOQLPattern.prototype.setPattern = function(pattern){\n\tfor(var key in pattern){\n\t\tthis[key] = pattern[key];\n\t}\n}\n\nWOQLPattern.prototype.json = function(){\n\tvar json = {};\n\tif(this.scope){\n\t\tjson.scope = this.scope;\n\t}\n\tif(this.value){\n\t\tjson.value = this.value;\n\t}\n\tif(this.rownum) json.rownum = this.rownum;\n\tif(this.variables) json.variables = this.variables;\n\tif(this.literal) json.literal = this.literal;\n\tif(this.type) json.type = this.type;\n\tif(this.constraints) json.constraints = this.constraints;\n\tif(this.source) json.source = this.source;\n\tif(this.target) json.target = this.target;\n\treturn json;\n}\n\n\nmodule.exports = WOQLRule ;\n","\nconst WOQLRule = require(\"../woqlRule\");\n\n/**\n * Generic functions / configs that are available to all config types\n */\nfunction ViewConfig(){\n    this.rules = [];\n}\n\nViewConfig.prototype.render = function(func){\n\tif(func) this.view_render = func;\n\treturn this.view_render;\n}\n\nViewConfig.prototype.renderer = function(val){\n\tif(val) this.view_renderer = val;\n\treturn this.view_renderer;\n}\n\nViewConfig.prototype.getRulesJSON = function(){\n\tlet jr = [];\n\tfor(var i = 0; i<this.rules.length; i++){\n\t\tjr.push(this.rules[i].json());\n\t}\n\treturn jr;\n}\n\nViewConfig.prototype.getBasicJSON = function(){\n\tlet jr = {};\n\tif(this.view_render) jr.render = this.view_render;\n\tif(this.view_renderer) jr.renderer = this.view_renderer;\n\treturn jr;\n}\n\nViewConfig.prototype.loadBasicJSON = function(json){\n\tif(json.render) this.view_render = json.view_render;\n\tif(json.renderer) this.view_renderer = json.view_renderer;\n}\n\nViewConfig.prototype.getBasicprettyPrint = function(){\n\tlet str = \"\";\n\tif(typeof this.render() != \"undefined\"){\n\t\tstr += \"view.render(\" + this.render() + \")\\n\";\n\t}\n\tif(typeof this.renderer() != \"undefined\"){\n\t\tstr += \"view.renderer('\" + this.renderer() + \"')\\n\";\n\t}\n\treturn str;\n}\n\n\nfunction WOQLViewRule(){\n\tWOQLRule.call(this);\n\tthis.rule = {}; \n};\n\t\nWOQLViewRule.prototype = Object.create(WOQLRule.prototype);\nWOQLViewRule.prototype.constructor = WOQLRule;\n\nWOQLViewRule.prototype.prettyPrint = function(type){\n\tlet str = \"\";\n\tif(this.pattern){\n\t\tstr = this.pattern.prettyPrint(type);\n\t}\n\tif(typeof this.color() != \"undefined\"){\n\t\tstr += \".color([\" + this.color().join(\",\") + \"])\";\n\t}\n\tif(typeof this.hidden() != \"undefined\"){\n\t\tstr += \".hidden(\" + this.hidden() + \")\";\n\t}\n\tif(typeof this.size() != \"undefined\"){\n\t\tstr += \".size('\" + this.size() + \"')\";\n\t}\n\tif(typeof this.icon() != \"undefined\"){\n\t\tstr += \".icon(\" + JSON.stringify(this.icon()) + \")\";\n\t}\n\tif(typeof this.text() != \"undefined\"){\n\t\tstr += \".text(\" + JSON.stringify(this.text()) + \")\";\n\t}\n\tif(typeof this.border() != \"undefined\"){\n\t\tstr += \".border(\" + JSON.stringify(this.border()) + \")\";\n\t}\n\tif(typeof this.args() != \"undefined\"){\n\t\tstr += \".args(\" + JSON.stringify(this.args()) + \")\";\n\t}\n\tif(typeof this.renderer() != \"undefined\"){\n\t\tstr += \".renderer('\" + this.renderer() + \"')\";\n\t}\n\tif(typeof this.render() != \"undefined\"){\n\t\tstr += \".render(\" + this.render() + \")\";\n\t}\n\tif(typeof this.click() != \"undefined\"){\n\t\tstr += \".click(\" + this.click() + \")\";\n\t}\n\tif(typeof this.hover() != \"undefined\"){\n\t\tstr += \".hover(\" + this.hover() + \")\";\n\t}\n\treturn str;\n}\n\nWOQLViewRule.prototype.json = function(mjson){\n\tif(!mjson) {\n\t\tvar json = { }\n\t\tif(this.pattern) json.pattern = this.pattern.json();\n\t\tjson.rule = this.rule;\n\t    return json;\n\t}\n\tthis.rule = mjson.rule || {};\n\tif(mjson.pattern) this.pattern.setPattern(mjson.pattern);\n\treturn this;\n}\n\n\nWOQLViewRule.prototype.size = function(size){\n\tif(typeof size == \"undefined\"){\n\t\treturn this.rule.size;\n\t}\n\tthis.rule.size = size;\n\treturn this;\n}\n\nWOQLViewRule.prototype.color = function(color){\n\tif(typeof color == \"undefined\"){\n\t\treturn this.rule.color;\n\t}\n\tthis.rule.color = color;\n\treturn this;\n}\n\nWOQLViewRule.prototype.icon = function(json){\n\tif(json){\n\t\tthis.rule.icon = json;\n\t\treturn this;\n\t}\n\treturn this.rule.icon;\n}\n\nWOQLViewRule.prototype.text = function(json){\n\tif(json){\n\t\tthis.rule.text = json;\n\t\treturn this;\n\t}\n\treturn this.rule.text;\n}\n\nWOQLViewRule.prototype.border = function(json){\n\tif(json){\n\t\tthis.rule.border = json;\n\t\treturn this;\n\t}\n\treturn this.rule.border;\n}\n\nWOQLViewRule.prototype.renderer = function(rend){\n\tif(typeof rend == \"undefined\"){\n\t\treturn this.rule.renderer;\n\t}\n\tthis.rule.renderer = rend;\n\treturn this;\n}\n\n\nWOQLViewRule.prototype.render = function(func){\n\tif(typeof func == \"undefined\"){\n\t\treturn this.rule.render;\n\t}\n\tthis.rule.render = func;\n\treturn this;\n}\n\nWOQLViewRule.prototype.click = function(onClick){\n\tif(onClick){\n\t\tthis.rule.click = onClick;\n\t\treturn this;\n\t}\n\treturn this.rule.click;\n}\n\nWOQLViewRule.prototype.hover = function(onHover){\n\tif(onHover){\n\t\tthis.rule.hover = onHover;\n\t\treturn this;\n\t}\n\treturn this.rule.hover;\n}\n\nWOQLViewRule.prototype.hidden = function(hidden){\n\tif(typeof hidden == \"undefined\"){\n\t\treturn this.rule.hidden;\n\t}\n\tthis.rule.hidden = hidden;\n\treturn this;\n}\n\nWOQLViewRule.prototype.args = function(args){\n\tif(typeof args == \"undefined\"){\n\t\treturn this.rule.args;\n\t}\n\tthis.rule.args = args;\n\treturn this;\n}\n\nmodule.exports = {WOQLViewRule, ViewConfig}\n\n","function getErrorAsMessage(url, api, err) {\n\tlet str = '';\n\tif (err.response) {\n\t\terr = err.response;\n\t\tif (err.data) str += `${formatErrorMessage(err.data)}`;\n\t} else if (err.body) str += `${formatErrorMessage(err.body)}`;\n\turl = url.split(\"?\")[0];\n\n\tif (err.status) str += `Code: ${err.status}`;\n\tif (err.action) str += ` Action: ${err.action}`;\n\tif (err.type) str += ` Type: ${err.type}`;\n\tif (url) str += ` url: ${url}`;\n\tif (api && api.method) str += ` method: ${api.method}`;\n\treturn str;\n}\n\nfunction formatErrorMessage(msg) {\n\tif (typeof msg === 'object') {\n\t\tlet nmsg = '';\n\t\tfor (const key of Object.keys(msg)) {\n\t\t\tif(msg[key] && typeof msg[key] != \"object\")\n\t\t\tnmsg += `${key} ${msg[key]} `;\n\t\t}\n\t\treturn nmsg;\n\t}\n\treturn msg;\n}\n\nfunction accessDenied(action, db, server) {\n\tconst err = {};\n\terr.status = 403;\n\terr.url = (server || '') + (db || '');\n\terr.type = 'client';\n\terr.action = action;\n\terr.body = `${err.action} not permitted for ${err.url}`;\n\treturn err;\n}\n\nfunction getAPIErrorMessage(url, api, err) {\n\treturn `API Error ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getAccessDeniedMessage(url, api, err) {\n\treturn `Access Denied ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getInvalidURIMessage(url, call) {\n\tconst str = `Invalid argument to\n            ${call}. \n            ${url}\n            is not a valid Terminus DB API endpoint`;\n\treturn str;\n}\n\n/**\n * Utility functions for generating and retrieving error messages\n * and storing error state\n */\n\nfunction parseAPIError(response) {\n\tconst err = {};\n\terr.status = response.status;\n\terr.type = response.type;\n\tif (response.data && typeof response.data === 'object') {\n\t\tlet msg;\n\t\ttry {\n\t\t\tmsg = response.text();\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tmsg = response.json();\n\t\t\t} catch (error) {\n\t\t\t\tmsg = response.toString();\n\t\t\t}\n\t\t}\n\t\terr.body = msg;\n\t} else if (response.data) err.body = response.data;\n\terr.url = response.url;\n\terr.headers = response.headers;\n\terr.redirected = response.redirected;\n\treturn err;\n}\n\n\nmodule.exports = {\n\tgetErrorAsMessage,\n\tgetAPIErrorMessage,\n\tgetAccessDeniedMessage,\n\taccessDenied,\n\tgetInvalidURIMessage,\n\tparseAPIError\n};\n","const TerminusRule = require('./terminusRule.js');\n\n/**\n * @file Frame Rule\n * @license Apache Version 2\n */\n\nfunction FrameRule(){\n\tTerminusRule.TerminusRule.call(this); \n\tthis.pattern = new FramePattern();\n}\nFrameRule.prototype = Object.create(TerminusRule.TerminusRule.prototype);\nFrameRule.prototype.constructor = TerminusRule.TerminusRule;\n\n/**\n * Returns an array of rules that match the paased frame\n * @param {[FrameRule]} rules - array of rules to be tested\n * @param {Frame} frame - object frame, property frame or data from to be tested\n * @param {function} [onmatch] - optional function to be called with args (frame, rule) on each match \n */\nFrameRule.prototype.testRules = function(rules, frame, onmatch){\n\tvar matched_rules = [];\n\tif(rules && rules.length){\n\t\tfor(var i = 0; i<rules.length; i++){\n\t\t\tvar match = (!rules[i].pattern || this.patternMatchesFrame(rules[i].pattern, frame));\n\t\t\tif(match){\n\t\t\t\tmatched_rules.push(rules[i]);\n\t\t\t\tif(onmatch && typeof onmatch == \"function\"){\n\t\t\t\t\tonmatch(frame, rules[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn matched_rules;\n}\n\n/**\n * Determines whether a given pattern matches a given frame\n */\nFrameRule.prototype.patternMatchesFrame = function(pattern, frame){\n\tif(pattern.checkFrame) {\n\t\treturn pattern.checkFrame(frame);\n\t}\n\telse {\n\t\tvar fp = new FramePattern().setPattern(pattern);\n\t\treturn fp.checkFrame(frame);\n\t}\n}\n\n/**\n * Specifies that only one from among the list of properties will match \n */\nFrameRule.prototype.property = function(...prop){\n    if(!prop || prop.length == 0) return this.pattern.property;\n    this.pattern.property = prop;\n    return this;\n}\n\n/**\n * Specifies that only one from among the list of frame_types will match\n * frame_types are: data, oneOf, document, object? \n */\nFrameRule.prototype.frame_type = function(...frame_type){\n    if(!frame_type || frame_type.length == 0) return this.pattern.frame_type;\n    this.pattern.frame_type = frame_type;\n    return this;\n}\n\n/**\n * Specifies that only one from among the list of labels will match\n */\nFrameRule.prototype.label = function(...prop){\n    if(!prop || prop.length == 0) return this.pattern.label;\n    this.pattern.label = prop;\n    return this;\n}\n\n/**\n * Specifies that only one from among the list of subject ids will match\n */\nFrameRule.prototype.subject = function(...prop){\n    if(!prop|| prop.length == 0) return this.pattern.subject;\n    this.pattern.subject = prop;\n    return this;\n}\n\n/**\n * Specifies that only one from among the list of subject classes will match\n */\nFrameRule.prototype.subjectClass = function(...prop){\n    if(!prop || prop.length == 0) return this.pattern.subjectClass;\n    this.pattern.subjectClass = prop;\n    return this;\n}\n\n/**\n * Specifies that only one from among the list of range types will match\n */\nFrameRule.prototype.range = function(...prop){\n    if(!prop || prop.length == 0) return this.pattern.range;\n    this.pattern.range = prop;\n    return this;\n}\n\n/**\n * Specifies that only frames of the specified depth will match the rule\n */\nFrameRule.prototype.depth = function(depth){\n    if(typeof depth == \"undefined\") return this.pattern.depth;\n    this.pattern.depth=depth;\n    return this;\n}\n\n/**\n * Specifies that only frames of the specified index will match the rule (index is the order of a value in the property frame)\n */\nFrameRule.prototype.index = function(...index){\n    if(!index || index.length == 0) return this.pattern.index;\n    this.pattern.index=index;\n    return this;\n}\n\n/**\n * Specifies that only frames with the given statuses will match the rule\n */\nFrameRule.prototype.status = function(...status){\n    if(!status || status.length == 0) return this.pattern.status;\n    this.pattern.status=status;\n    return this;\n}\n\n/**\n * Specifies that the frame will only match if its parent matches the pattern passed as par\n */\nFrameRule.prototype.parent = function(par){\n    if(!par) return this.pattern.parent;\n    this.pattern.parent = par;\n    return this;\n}\n\nFrameRule.prototype.children = function(...children){\n\tif(typeof children == \"undefined\" || children.length == 0) return this.pattern.children;\n\tif(typeof this.pattern.children == \"undefined\"){\n\t\tthis.pattern.children = [];\n\t}\n\tfor (let i = 0; i < children.length; i++) {\n\t\tthis.pattern.children.push(children[i]);\n\t}\n\treturn this;\n};\n\n\n/**\n * @file Frame Pattern\n * A frame pattern can have the following variables\n * scope : object, property, data, * - matches a specific part of the frame\n * label : matches the label of a property\n * frame_type: object, data, document, id, oneOf\n * subject: id of the subject\n * subjectClass: class of the subject\n * range: type of a property (applies to property and data)\n * property: property id or list of property ids (parent property if it is an object or data)\n * value: value of the property\n * parent: a pattern relating to the parent of this frame\n * children: patterns for matching on the children of a frame\n * depth: how deep are we in the document? starts from 0\n * index: the index of a value in an array\n * status: updated, error, new, ok,\n */\n\nfunction FramePattern(){\n\tTerminusRule.TerminusPattern.call(this); \n};\n\nFramePattern.prototype = Object.create(TerminusRule.TerminusPattern.prototype);\nFramePattern.prototype.constructor = TerminusRule.TerminusPattern;\n\n\n\nFramePattern.prototype.setPattern = function(pattern){\n\tif(pattern.scope) this.scope = pattern.scope;\n\tif(typeof pattern.literal != \"undefined\") this.literal = pattern.literal;\n\tif(typeof pattern.type != \"undefined\") this.type = pattern.type;\n\tif(typeof pattern.label != \"undefined\") this.label = pattern.label;\n\tif(typeof pattern.frame_type != \"undefined\") this.frame_type = pattern.frame_type ;\n\tif(typeof pattern.subject != \"undefined\") this.subject = pattern.subject;\n\tif(typeof pattern.subjectClass != \"undefined\") this.subjectClass = pattern.subjectClass;\n\tif(typeof pattern.range != \"undefined\") this.range = pattern.range;\n\tif(typeof pattern.property != \"undefined\") this.property = pattern.property;\n\tif(typeof pattern.value != \"undefined\") this.value = pattern.value;\n\tif(typeof pattern.parent != \"undefined\"){\n\t\tlet parent = pattern.parent;\n\t\tif(typeof parent.json != \"function\"){ \n\t\t\tparent = new FramePattern().setPattern(parent);\n\t\t}\n\t\tthis.parent = parent;\n\t} \n\tif (pattern.children) {\n\t\tthis.children = [];\n\t\tfor (let i = 0; i < pattern.children.length; i++) {\n\t\t\tvar kid = pattern.children[i];\n\t\t\tif(typeof kid.json != \"function\"){ \n\t\t\t\tkid = new FramePattern().setPattern(kid);\n\t\t\t}\n\t\t\tthis.children.push(kid);\n\t\t}\n\t}\n\tif(typeof pattern.depth != \"undefined\") this.depth = pattern.depth;\n\tif(typeof pattern.index != \"undefined\") this.index = pattern.index;\n\tif(typeof pattern.status != \"undefined\") this.status = pattern.status;\n}\n\nFramePattern.prototype.json = function(){\n    var json = {};\n\tif(typeof this.literal != \"undefined\") json.literal = this.literal;\n\tif(this.type) json.type = this.type;\n    if(this.scope) json.scope = this.scope;\n    if(typeof this.value != \"undefined\") json.value = this.value;\n    if(typeof this.label != \"undefined\") json.label = this.label;\n    if(typeof this.frame_type != \"undefined\") json.frame_type = this.frame_type;\n    if(typeof this.subject != \"undefined\") json.subject = this.subject;\n    if(typeof this.subjectClass != \"undefined\") json.subjectClass = this.subjectClass;\n    if(typeof this.range != \"undefined\") json.range = this.range;\n    if(typeof this.property != \"undefined\") json.property = this.property;\n    if(typeof this.parent != \"undefined\") json.parent = (this.parent.json ? this.parent.json() : this.parent);\n    if(typeof this.children != \"undefined\") {\n\t\tjson.children = [];\n\t\tfor(var i = 0; i<this.children.length; i++){\n\t\t\tjson.children.push((this.children[i].json ? this.children[i].json() : this.children[i]));\n\t\t}\n\t}\n    if(typeof this.depth != \"undefined\") json.depth = this.depth;\n    if(typeof this.index != \"undefined\") json.index = this.index;\n    if(typeof this.status != \"undefined\") json.status = this.status;\n    return json;\n}\n\nFramePattern.prototype.checkFrame = function(frame){\n\tvar rtype = this.getRendererType(frame);\n\tif(!rtype) return false;\n\tif(this.scope && (this.scope != rtype) && (this.scope != \"*\" )) return false;\n\tif(this.illegalRuleType(rtype)) return false;\n\tif(this.frame_type && !this.checkFrameType(rtype, frame)) return false;\n\tif(this.label && !this.checkLabel(rtype, frame)) return false;\n\tif(this.subject && !this.checkSubject(rtype, frame)) return false;\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, frame)) return false;\n\tif(this.property && !this.checkProperty(rtype, frame)) return false;\n\tif(typeof this.depth !== \"undefined\" && !this.checkDepth(rtype, frame)) return false;\n\tif(this.range && !this.checkRange(rtype, frame)) return false;\n\tif(typeof this.value != \"undefined\" && !this.checkValue(rtype, frame)) return false;\n\tif(this.type && !this.checkType(rtype, frame)) return false;\n\tif(typeof this.literal != \"undefined\" && !this.checkLiteral(rtype, frame)) return false;\n\tif(this.parent && !this.checkParent(rtype, frame)) return false;\n\tif(this.children && this.children.length && !this.checkChildren(rtype, frame)) return false;\n\tif(this.index && !this.checkIndex(rtype, frame)) return false;\n\tif(this.status && !this.checkStatus(rtype, frame)) return false;\n\treturn true;\n};\n\nFramePattern.prototype.prettyPrint = function(type){\n\t//starts with obj. ...\n\tif(this.scope == \"*\"){\n\t\tvar str = \"all()\";\n\t}\n\telse {\n\t\tvar str = this.scope + \"()\";\n    }\n    if(typeof this.literal != \"undefined\"){\n\t\tstr += \".literal(\" + this.literal + \")\";\n\t}\n\tif(typeof this.type != \"undefined\"){\n\t\tstr += \".type(\" + this.unpack(this.type) + \")\";\n\t}\n\tif(typeof this.range != \"undefined\"){\n\t\tstr += \".range(\" + this.unpack(this.range) + \")\";\n\t}\n\tif(typeof this.frame_type != \"undefined\"){\n\t\tstr += \".frame_type(\" + this.unpack(this.frameType) + \")\";\n\t}\n\tif(typeof this.label != \"undefined\"){\n\t\tstr += \".label(\" + this.unpack(this.label) + \")\";\n\t}\n\tif(typeof this.subject != \"undefined\"){\n\t\tstr += \".subject(\" + this.unpack(this.subject) + \")\";\n\t}\n\tif(typeof this.subjectClass != \"undefined\"){\n\t\tstr += \".subjectClass(\" + this.unpack(this.subjectClass) + \")\";\n\t}\n\tif(typeof this.property != \"undefined\"){\n\t\tstr += \".property(\" + this.unpack(this.property) + \")\";\n\t}\n\tif(typeof this.value != \"undefined\"){\n\t\tstr += \".value(\" + this.unpack(this.value, true) + \")\";\n\t}\n\tif(typeof this.children != \"undefined\" && this.children.length > 0){\n\t\tstr += \".children(\\n\";\n\t\tvar kids = this.children;\n\t\tfor(var i = 0; i< kids.length; i++){\n\t\t\tstr += \"View.pattern().\" + kids[i].prettyPrint();\n\t\t\tif(i < kids.length-1) str += \",\";\n\t\t\tstr += \"\\n\";\n\t\t}\n\t\tstr += \")\";\n\t}\n\tif(typeof this.parent != \"undefined\"){\n\t\tstr += \".parent(View.pattern().\" + this.parent.prettyPrint() + \")\";\n\t}\n\tif(typeof this.depth != \"undefined\"){\n\t\tstr += \".depth(\" + this.unpack(this.depth, true) + \")\";\n\t}\n\tif(typeof this.index != \"undefined\"){\n\t\tstr += \".index(\" + this.unpack(this.index, true) + \")\";\n\t}\n\tif(typeof this.status != \"undefined\"){\n\t\tstr += \".status(\" + this.unpack(this.status) + \")\";\n\t}\n\treturn str;\n}\n\nFramePattern.prototype.illegalRuleType = function (rtype) {\n\t// data frames have no children\n\tif (rtype == 'data' && this.children && this.children.length) return true;\n\t// object frames have no range\n\tif (rtype == 'object' && this.range) return true;\n\treturn false;\n};\n\n/* subject is an id or an array of ids,\n/* match is positive if the renderer's subject appears in the array or is the id\n */\nFramePattern.prototype.checkSubject = function (subject, frame) {\n\tif (typeof this.subject !== 'object' || !this.subject.length) this.subject = [this.subject];\n\tconst rsubj = frame.subject();\n\tfor (let i = 0; i < this.subject.length; i++) {\n\t\tif (this.IDsMatch(subject[i], rsubj)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\n// at least one child must match all child rules\nFramePattern.prototype.checkChildren = function (rtype, frame) {\n\tfor (let i = 0; i < this.children.length; i++) {\n\t\tlet found = false;\n\t\tif (rtype == 'object') {\n\t\t\tfor (const prop in frame.properties) {\n\t\t\t\tif (this.children[i].checkFrame(frame.properties[prop])) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (rtype == 'property') {\n\t\t\tfor (let j = 0; j <= renderer.values.length; j++) {\n\t\t\t\tif (this.children[j].checkFrame(frame.values[j])) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!found) return false;\n\t}\n\treturn true;\n};\n\nFramePattern.prototype.checkStatus = function (rtype, frame) {\n\tif (typeof this.status !== 'object' || this.status.length == 0) this.status = [this.status];\n\tfor (let i = 0; i < this.status.length; i++) {\n\t\tif (this.status[i] == 'updated' && !frame.isUpdated()) return false;\n\t\tif (this.status[i] == 'new' && !frame.isNew()) return false;\n\t\tif (this.status[i] == 'unchanged' && frame.isUpdated()) return false;\n\t}\n\treturn true;\n};\n\nFramePattern.prototype.checkDepth = function (rtype, frame) {\n\treturn this.numberMatch(this.depth, frame.depth());\n};\n\nFramePattern.prototype.checkParent = function (rtype, frame) {\n\treturn this.parent.checkFrame(frame.parent);\n};\n\nFramePattern.prototype.checkIndex = function (rtype, frame) {\n\tif (rtype == 'data') {\n\t\treturn this.index == frame.index;\n\t}\n\treturn false;\n};\n\nFramePattern.prototype.checkProperty = function (rtype, frame) {\n\tif (typeof this.property !== 'object' || !this.property.length) this.property = [this.property];\n\tfor (let i = 0; i < this.property.length; i++) {\n\t\tif (this.propertyIDsMatch(frame.property(), this.property[i])) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\n\n/**\n * Checks to make sure the frame is among the specified types \n */\nFramePattern.prototype.checkType = function (rtype, frame) {\n\tif(rtype == \"object\") var vs = frame.subjectClass();\n\telse var vs = frame.range();\n\tif(!Array.isArray(this.type)) this.type = [this.type];\n\tif(this.type.indexOf(vs) === -1) return false;\n\treturn true;\n}\n\nFramePattern.prototype.checkLiteral = function (rtype, frame) {\n\tif(rtype == \"object\") return false;\n\tif(rtype == \"property\") return false;\n\tif(rtype == \"data\") return frame.isDatatypeProperty();\n\treturn true;\n}\n\n\n// returns true if any of the values are found\nFramePattern.prototype.checkValue = function (rtype, frame) {\n\tif (typeof this.value !== 'object' || !this.value.length) this.value = [this.value];\n\tfor (let i = 0; i < this.value.length; i++) {\n\t\tif (rtype == 'data') {\n\t\t\tif (this.valuesMatch(frame.value(), this.value[i])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else if (rtype == 'property') {\n\t\t\tfor (let j = 0; j <= frame.values.length; j++) {\n\t\t\t\tif (this.getRendererType(frame.values[i]) == 'data'\n\t\t\t\t\t\t&& this.valuesMatch(frame.values[i].get(), this.value[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (rtype == 'object') {\n\t\t\tfor (const prop in frame.properties) {\n\t\t\t\tif (this.checkValue(this.getRendererType(frame.properties[prop]), frame.properties[prop])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n\nFramePattern.prototype.checkRange = function (rtype, frame) {\n\tif (typeof this.range !== 'object' || !this.range.length) this.range = [this.range];\n\tfor (let i = 0; i < this.range.length; i++) {\n\t\tif (this.rangeIDsMatch(frame.range(), this.range[i])) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nFramePattern.prototype.checkSubjectClass = function (rtype, frame) {\n\tif (typeof this.subjectClass !== 'object' || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\n\tconst rcls = frame.subjectClass();\n\tfor (let i = 0; i < this.subjectClass.length; i++) {\n\t\tif (this.classIDsMatch(this.subjectClass[i], rcls)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nFramePattern.prototype.checkFrameType = function (rtype, frame) {\n\tif (rtype == 'object') return (this.frame_type.indexOf('object') != -1);\n\tif (rtype == 'data') {\n\t\tif (frame.frame) {\n\t\t\treturn (this.frame_type.indexOf(frame.frame.ftype()) != -1);\n\t\t}\n\t}\n\tif (rtype == 'property') return false;\n};\n\nFramePattern.prototype.checkLabel = function (rtype, frame) {\n\tif (typeof frame.getLabel !== 'function') {\n\t\tconsole.log(new Error('Rule passed to check label with broken renderer object - no getLabel'));\n\t\treturn false;\n\t}\n\tfor (let i = 0; i < this.label.length; i++) {\n\t\tif(this.stringMatch(this.label[i], frame.getLabel())) return true;\n\t}\n\treturn false;\n};\n\n\nFramePattern.prototype.getRendererType = function (frame) {\n\tif (frame.isProperty()) return 'property';\n\tif (frame.isObject()) return 'object';\n\tif (frame.isData()) return 'data';\n\tif (frame.renderer_type) return frame.renderer_type;\n\tconsole.log(new Error(`frame configuration passed non-renderer type ${frame.constructor.name}`));\n\tconsole.log(renderer);\n\treturn false;\n};\n\nmodule.exports = FrameRule;","const QueryPane = require(\"./QueryPane\");\nconst DocumentPane = require(\"./DocumentPane\");\nconst TerminusClient = require('@terminusdb/terminus-client');\n\nfunction TerminusViewer(client){\n    this.client = client;\n}\n\nTerminusViewer.prototype.TerminusClient = function(){\n    return TerminusClient;\n}\n\nTerminusViewer.prototype.getDocumentPane = function(docid, docConfig, docPaneConfig){\n    var dp = new DocumentPane(this.client, docid);\n    dp.view = docConfig;\n    if(docPaneConfig) dp.options(docPaneConfig);\n    else dp.options(dp.defaultPaneView);\n    return dp;   \n}\n\nTerminusViewer.prototype.getDocument = function(docid, docConfig, docJSON){\n    return this.getDocumentPane(docid, docConfig);\n}\n\nTerminusViewer.prototype.getNewDocumentPane = function(cls, docConfig, docPaneConfig){\n    var dp = new DocumentPane(this.client, false, cls);\n    dp.view = docConfig;\n    if(docPaneConfig) dp.options(docPaneConfig);\n    else dp.options(dp.defaultPaneView);\n    return dp;   \n}\n\n\nTerminusViewer.prototype.getQueryPane = function(query, resultConfigs, results, resultPaneConfigs, queryPaneConfig){\n    var qp = new QueryPane(this.client, query, results);\n    if(queryPaneConfig) qp.options(queryPaneConfig);\n    else qp.options(qp.defaultQueryView);\n    if(resultConfigs && resultConfigs.length){\n        for(var i = 0 ; i < resultConfigs.length; i++){\n            var rpc = (resultPaneConfigs && resultPaneConfigs[i] ? resultPaneConfigs[i] : qp.defaultResultView);\n            qp.addView(resultConfigs[i], rpc);\n        }\n    }\n    return qp;\n}\n\nTerminusViewer.prototype.getResult = function(query, resultConfig, results){\n    return this.getQueryPane(query, [resultConfig], results);\n}\n\nTerminusViewer.prototype.connect = function(terminus_server_url, terminus_server_key){\n    var client = new TerminusClient.WOQLClient();\n    return client.connect(terminus_server_url, terminus_server_key)\n    .then(() => {\n        this.client = client;\n    });\n}\n\nTerminusViewer.prototype.tutorial = function(terminus_server_url, terminus_server_key){\n    \n}\n\n\nTerminusViewer.prototype.loadConsole = function(create_json, import_json, query_json, view_json){}\n\nmodule.exports = TerminusViewer;","const TerminusClient = require('@terminusdb/terminus-client');\nconst UTILS = require('../../Utils');\nconst HTMLHelper = require(\"../HTMLHelper\")\n/*\nqObj: WOQL object\nwidth: width of snippet in px\nheight: height of snippet in px\n*/\nfunction TerminusCodeSnippet(language, mode, format, width, height, placeholder){\n\tthis.language = (language ? language : \"woql\");//woql / rule\n\tthis.mode = (mode ? mode : \"view\");\n    this.width = (width ? width : 1200);\n\tthis.height = (height ? height : 300);\n\tthis.placeholder = (placeholder ? placeholder : \"\");\n    this.format = (format ? format : \"js\");\n    this.formats = {'js': \"WOQL.js\", 'jsonld': \"JSON-LD\"};\n    if(this.mode == 'view')\n        this.snippet = document.createElement('pre');\n    else {\n    \tthis.snippet = document.createElement('textarea');\n    \tthis.snippet.setAttribute(\"spellcheck\", \"false\");\n\t\tthis.snippet.setAttribute(\"class\", \"terminus-code-snippet\");\n    }\n}\n\nTerminusCodeSnippet.prototype.setQuery = function(q){\n\tthis.qObj = q;\n\tthis.refreshContents();\n}\n\nTerminusCodeSnippet.prototype.setInput = function(q){\n\tif(this.mode == \"edit\"){\n\t\tthis.snippet.value = q;\n\t}\n\telse {\n\t\tHTMLHelper.removeChildren(this.snippet);\n\t\tthis.snippet.appendChild(document.createTextNode(q));\n\t}\n\tthis.refreshCodeMirror();\n\treturn this.readInput();\n}\n\nTerminusCodeSnippet.prototype.serialise = function(query, format){\n\tif(format == \"js\"){\n\t\treturn query.prettyPrint(4);\n\t}\n\telse {\n\t\treturn JSON.stringify(query.json(), undefined, 2);\n\t}\n}\n\n//parses a string encoding a woql in either json or js notation\nTerminusCodeSnippet.prototype.parseText = function(text, format){\n\ttry {\n\t\tvar WOQL = TerminusClient.WOQL;\n\t\tvar View = TerminusClient.View;\n\t\tif(format == \"js\"){\n\t\t\tvar nw = eval(text);\n\t\t\tif(this.language == \"rule\"){\n\t\t\t\tthis.view = view;\n\t\t\t\treturn view;\n\t\t\t}\n\t\t\treturn nw;\n\t\t}\n\t\telse {\n\t\t\tvar qval = JSON.parse(text);\n\t\t\tif(this.language == \"woql\"){\n\t\t\t\treturn WOQL.json(qval);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn View.loadConfig(qval);\n\t\t\t}\n\t\t}\n\t}\n\tcatch(e){\n\t\tthis.error = \"Failed to parse Query \" + e.toString() + \" \" + text;\n\t\treturn this.error;\n\t\t//return false;\n\t}\n}\n\nTerminusCodeSnippet.prototype.getInputElement = function(){\n\treturn this.snippet;\n}\n\nTerminusCodeSnippet.prototype.readInput = function(){\n\tif(this.mode == \"edit\") {\n\t\tthis.qObj = this.parseText(this.snippet.value, this.format);\n\t}\n\telse {\n\t\tthis.qObj = this.parseText(this.snippet.innerText, this.format);\n\t}\n\treturn this.qObj;\n}\n\nTerminusCodeSnippet.prototype.get = function(){\n\treturn this.readInput();\n}\n\nTerminusCodeSnippet.prototype.getAsDOM = function(with_buttons){\n    var scont = document.createElement('div');\n\tscont.setAttribute('class', 'terminus-snippet-container')\n    // query\n    var snpc = document.createElement('div');\n    if(this.placeholder){\n\t\tthis.snippet.setAttribute(\"placeholder\", this.placeholder);\n\t}\n    snpc.appendChild(this.getFormatButtons());\n    if(this.qObj){\n    \tvar serial = this.serialise(this.qObj, this.format);\n\t\tif(this.mode == \"edit\"){\n    \t\tthis.snippet.value = serial;\n    \t}\n    \telse {\n\t\t\tHTMLHelper.removeChildren(this.snippet);\n    \t\tthis.snippet.appendChild(document.createTextNode(serial));\n    \t}\n\t}\n\telse {\n\t\tthis.snippet.value = \"\";\n\t}\n    snpc.appendChild(this.snippet);\n    if(this.mode == \"edit\"){\n\t\tvar ssb = document.createElement(\"span\");\n\t\tssb.setAttribute(\"class\", \"terminus-query-submit-buttons\");\n\t\tvar actbtn = this.getSubmitButton();\n\t\tssb.appendChild(actbtn);\n    \tsnpc.appendChild(ssb);\n    }\n    scont.appendChild(snpc);\n    return scont;\n}\n\nTerminusCodeSnippet.prototype.changeRuleView = function(nview){\n\tthis.snippet.value = \"view = WOQL.\"+ nview + \"()\";\n\tthis.readInput();\n\tthis.submit(this.qObj);\n}\n\n\nTerminusCodeSnippet.prototype.getIconsDOM = function(){\n    var bsp = document.createElement('span');\n    bsp.setAttribute('class', 'terminus-snippet-icons');\n    for(var i = 0; i<this.view_types.length; i++){\n\t\tvar isp = document.createElement('span');\n\t\tvar icon = document.createElement(\"i\");\n\t\ticon.title = this.view_types[i].label;\n\t\ticon.setAttribute(\"class\", this.view_types[i].icon);\n\t\tisp.appendChild(icon);\n\t\tisp.name = this.view_types[i].id;\n\t\tvar self = this;\n\t\tisp.addEventListener('click', function(){\n\t\t\tif(!(self.view && self.view.type == this.name)){\n\t\t\t\tself.changeRuleView(this.name);\n\t\t\t}\n\t\t});\n\t\tisp.addEventListener('mouseover', function(){\n\t\t\tif(!(self.view && self.view.type == this.name)){\n\t\t\t\tthis.style.cursor = \"pointer\";\n\t\t\t}\n\t\t});\n\t\tbsp.appendChild(isp);\n    }\n    return bsp;\n}\n\nTerminusCodeSnippet.prototype.getFormatButtons = function(){\n    var bsp = document.createElement('span');\n    bsp.setAttribute('class', 'terminus-snippet-panel');\n    //if(this.width) bsp.setAttribute(\"style\", \"width: \"+ this.width +\"px;\");\n    for(f in this.formats){\n        var btn = document.createElement('button');\n        btn.setAttribute('value', f);\n        btn.setAttribute('class', 'terminus-snippet-button');\n\t\tif(f == 'js') btn.classList.add('terminus-snippet-format-selected');\n        btn.appendChild(document.createTextNode(this.formats[f]));\n        var self = this;\n        btn.addEventListener('click', function(){\n\t\t\tUTILS.setSelected(this, 'terminus-snippet-format-selected');\n\t\t\tvar src = (self.mode == \"edit\" ? self.snippet.value : self.snippet.innerText)\n\t\t\tvar qobj = self.parseText(src, self.format);\n\t\t\tself.format = this.value;\n\t\t\tif(qobj) self.qObj = qobj;\n\t\t\tself.refreshContents();\n        })\n        bsp.appendChild(btn);\n    }\n    return bsp;\n}\n\nTerminusCodeSnippet.prototype.getSubmitButton = function(){\n    var actbtn = document.createElement('button');\n    actbtn.setAttribute('class', 'terminus-btn');\n\tactbtn.setAttribute('type', 'submit');\n\tvar txt = \"Submit\";\n\tif(this.language == \"WOQL\"){\n\t\ttxt = \"Submit Query\";\n\t}\n\telse if(this.language == \"rule\") {\n\t\ttxt = \"Update View\";\n\t}\n\telse if(this.language == \"code\"){\n\t\ttxt = \"Run Script\";\n\t}\n    actbtn.appendChild(document.createTextNode(txt));\n    actbtn.addEventListener('click', () => {\n\t\tthis.readInput();\n\t\tthis.submit(this.qObj);\n    });\n    return actbtn;\n}\n\nTerminusCodeSnippet.prototype.submit = function(){\n\talert(\"Submitted \" + JSON.stringify(this.qObj));\n}\n\nTerminusCodeSnippet.prototype.removeCodeMirror = function(){\n\tvar cm = this.snippet.nextSibling;\n\tif(!cm) return;\n\tif(cm.classList.contains('CodeMirror')) // remove code mirror\n\tHTMLHelper.removeElement(cm);\n}\n\nTerminusCodeSnippet.prototype.stylizeSnippet = function(){\n\tvar dimensions = \"query\";\n\t//dimensions.width = \"1000\";//this.width;\n\t//dimensions.height = \"1000\";//this.height;\n\n\tthis.removeCodeMirror();\n\tif(this.mode == 'view')\n\t\tUTILS.stylizeCodeDisplay(null, this.snippet, null, 'javascript');\n\telse UTILS.stylizeEditor(null, this.snippet, dimensions, 'javascript'); // default view is js\n}\n\nTerminusCodeSnippet.prototype.refreshContents = function(qObj){\n\tqObj = qObj || this.qObj;\n\tHTMLHelper.removeChildren(this.snippet);\n\tif(this.mode == \"edit\") this.snippet.value == \"\";\n\tif(!qObj) return;\n\tvar serial = this.serialise(this.qObj, this.format);\n\tif(this.mode == \"edit\"){\n\t\tthis.snippet.value = serial;\n\t\tif(this.snippet.nextSibling){\n\t\t\tthis.removeCodeMirror();\n\t\t\tif(this.format == 'js') var mode = 'javascript';\n\t\t\telse var mode = 'application/ld+json';\n\t\t\tUTILS.stylizeEditor(null,\n\t\t\t\t\t\t\t\tthis.snippet,\n\t\t\t\t\t\t\t\t{width: this.width, height: this.height},\n\t\t\t\t\t\t\t\tmode);\n\t\t}\n\t}\n\telse {\n\t\tthis.snippet.appendChild(document.createTextNode(serial));\n\t\tUTILS.stylizeCodeDisplay(null, this.snippet, null, mode);\n\t}\n}\n\nTerminusCodeSnippet.prototype.refreshCodeMirror = function(){\n\tif(this.snippet.nextSibling){\n\t\tthis.removeCodeMirror();\n\t}\n\tif(this.format == 'js') var mode = 'javascript';\n\telse var mode = 'application/ld+json';\n\tif(this.mode == \"edit\"){\n\t\tUTILS.stylizeEditor(null,\n\t\t\t\t\t\tthis.snippet,\n\t\t\t\t\t\t{width: this.width, height: this.height},\n\t\t\t\t\t\tmode);\n\t}\n\telse {\n\t\tUTILS.stylizeCodeDisplay(null, this.snippet, null, mode);\n\t}\n\n}\n\nmodule.exports = TerminusCodeSnippet;\n","/**\n * @file Terminus Constants\n * @license Apache Version 2\n * Constants representing API actions\n */\n\nmodule.exports = Object.freeze({\n\tCONNECT: 'connect',\n\tGET_SCHEMA: 'get_schema',\n\tUPDATE_SCHEMA: 'update_schema',\n\tUPDATE_DOCUMENT: 'update_document',\n\tCLASS_FRAME: 'class_frame',\n\tWOQL_SELECT: 'woql_select',\n    TERMINUS_MESSAGE: 'terminus_message',\n\tGET_DOCUMENT: 'get_document',\n\tDELETE_DATABASE: 'delete_database',\n\tDELETE_DOCUMENT: 'delete_document',\n\tCREATE_DATABASE: 'create_database',\n\tCREATE_DOCUMENT: 'create_document',\n\tWOQL_UPDATE: 'woql_update'\n});\n","const HTMLHelper = require('../html/HTMLHelper');\n\nfunction TerminusPluginManager(){\n\tthis.preloaded = [];\n\tthis.loaded = [];\n\tthis.loading = [];\n\tthis.precluded = [];\n\tthis.plugins = {};\n\tthis.css_base = \"\";//\"https://terminusdb.github.io/terminus-dashboard/dist/\";\n\tthis.plugins[\"font-awesome\"] = {\n\t\tlabel: \"Font Awesome\",\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\n\t};\n\tthis.plugins[\"quill\"] = {\n\t\tlabel: \"Quill\",\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\n\t};\n\tthis.plugins[\"codemirror\"] = {\n\t\tlabel : \"Code Mirror\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldgutter.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldcode.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/indent-fold.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/markdown-fold.js\"\n\t  ],\n\t\tcss: [\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldgutter.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\n\t\t]\n\t};\n\tthis.plugins[\"jquery\"] = {\n\t\tlabel: \"jQuery\",\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\n\t};\n\tthis.plugins[\"jqueryui\"] = {\n\t\tlabel: \"jQuery UI\",\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\n\t\trequires: ['jquery']\n\t};\n\tthis.plugins[\"datatables\"] = {\n\t\tlabel: \"Data Tables\",\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\n\t\trequires: ['jquery']\n\t};\n\t/*this.plugins[\"prettify\"] = {\n\t\tlabel: \"Prettify\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\n\t\trequires: ['jquery']\n\t};*/\n\tthis.plugins[\"gmaps\"] = {\n\t\tlabel: \"Google Maps\",\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\n\t\t//plugin: \"gmaps.terminus.js\"\n\t};\n\tthis.plugins[\"d3\"] = {\n\t\tlabel: \"d3\",\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\n\t\trequires: ['jquery']\n\t};\n\tthis.plugins[\"select2\"] = {\n\t\tlabel: \"Select 2\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\n\t\trequires: ['jquery']\n\t};\n\t/*this.plugins[\"jsoneditor\"] = {\n\t\tlabel: \"JSON Editor\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.js\"],\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.css\"],\n\t\t//plugin: \"jsoneditor.terminus.js\"\n\t};\n\tthis.plugins[\"bootstrap\"] = {\n\t\tlabel: \"Bootstrap\",\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\n\t};\n\tthis.plugins[\"flot\"] = {\n\t\tlabel: \"Flot\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\n\t\trequires: [\"jquery\"]\n\t};*/\n}\n\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\n\tfor(var p in opts){\n\t\tif(!this.plugins[p]) continue;\n\t\tfor(var k in opts[p]){\n\t\t\tthis.plugins[p][k] = opts[p][k];\n\t\t}\n\t}\n}\n\nTerminusPluginManager.prototype.init = function(opts, then){\n\tif(opts) this.setPluginOptions(opts);\n\tthis.calculatePreloaded();\n\tvar toload = this.calculateRequiredInitPlugins(opts);\n\tif(toload && toload[0].length) {\n\t\tif(toload[1].length){\n\t\t\tvar self = this;\n\t\t\tvar nthen = function(){\n\t\t\t\tself.loadPlugins(toload[1], then);\n\t\t\t}\n\t\t\tthis.loadPlugins(toload[0], nthen);\n\t\t}\n\t\telse {\n\t\t\tthis.loadPlugins(toload[0], then);\n\t\t}\n\t}\n\telse if(then){\n\t\tthen();\n\t}\n}\n\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\n\tif(opts){\n\t\tvar pins = [];\n\t\tfor(var pid in opts){\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\n\t\t\t\t\tpins.push(pid);\n\t\t\t\t}\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\n\t\t\t\t\t\tpins.push(pid);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tvar pins = this.getDefaultPlugins();\n\t}\n\tvar needed_pins = [];\n\tfor(var i = 0; i<pins.length; i++){\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\n\t\t\tneeded_pins.push(pins[i])\n\t\t}\n\t}\n\tvar loading_order = [[], []];\n\tfor(var i = 0; i<needed_pins.length; i++){\n\t\tif(this.plugins[needed_pins[i]]){\n\t\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\n\t\t\t\tloading_order[1].push(needed_pins[i]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tloading_order[0].push(needed_pins[i]);\n\t\t\t}\n\t\t}\n\t}\n\treturn loading_order;\n}\n\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\n\treturn this.plugins;\n}\n\nTerminusPluginManager.prototype.calculatePreloaded = function(){\n\tfor(var pl in this.plugins){\n\t\tif(this.pluginAvailable(pl)){\n\t\t\tthis.preloaded.push(pl);\n\t\t}\n\t}\n}\n\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\n\tif(typeof this.plugins[plugin] == \"object\"){\n\t\tvar pluginmeta = this.plugins[plugin];\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\n\t\tswitch(plugin){\n\t\t\tcase \"jquery\": {\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\n\t\t\t\tif(version_check && required_version){}\n\t\t\t\treturn true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"jqueryui\": {\n\t\t\t\ttry{\n\t\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\n\t\t\t\t}\n\t\t\t\tcatch(e){}\n\t\t\t\treturn false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"quill\": {\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"jsoneditor\": {\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"codemirror\": {\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\n\t\t\t}\n\t\t\tcase \"font-awesome\": {\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\n\t\t\t\treturn this.fontAwesomeCheck();\n\t\t\t}\n\t\t\tcase \"datatables\": {\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\n\t\t\t\t return false;\n\t\t\t}\n\t\t\tcase \"select2\": {\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\n\t\t\t\t return false;\n\t\t\t}\n\t\t\tcase \"gmaps\": {\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcase \"openlayers\": {\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcase \"d3\": {\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\n\t}\n\treturn false;\n};\n\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\n\tvar span = document.createElement('span');\n\tspan.className = 'fa';\n\tspan.style.display = 'none';\n\tif(document.body){\n\t\tdocument.body.insertBefore(span, document.body.firstChild);\n\t\tfunction css(element, property) {\n\t\t  return window.getComputedStyle(element, null).getPropertyValue(property);\n\t\t}\n\t\tvar loaded = false;\n\t\tvar fontAwsm = css(span, 'font-family');\n\t\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\n\t\t\tloaded = true;\n\t\t}\n\t\tdocument.body.removeChild(span);\n\t\treturn loaded;\n\t}\n\treturn false;\n}\n\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\n\tvar defplugs = [\"font-awesome\"];\n\treturn defplugs;\n}\n\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\n\tvar ticker = plugins.length;\n\tvar cback = function(){\n\t\tif(--ticker <= 1 && then){\n\t\t\tthen();\n\t\t}\n\t};\n\tfor(var i = 0; i < plugins.length; i++){\n\t\tthis.loadPlugin(plugins[i], cback);\n\t}\n}\n\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\n\tvar pug = this.plugins[plugin];\n\tif(pug.css){\n\t\tfor(var i=0; i<pug.css.length; i++){\n\t\t\tvar cssid = plugin + \"_css_\" + i;\n\t\t\tHTMLHelper.loadDynamicCSS(cssid, pug.css[i]);\n\t\t}\n\t}\n\tvar scripts = (pug.js ? pug.js : []);\n\tif(plugin == \"gmaps\" && pug.key){\n\t\tscripts[0] += \"?key=\" + pug.key;\n\t}\n\tif(pug.plugin){\n\t\t//scripts.push(\"plugins/\" + pug.plugin);\n\t}\n\tif(plugin == \"codemirror\"){\n\t\tvar cm = scripts[0];\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\n\t\tscripts.splice(0, 1);\n\t\tvar self = this;\n\t\tvar cback = function(){\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\n\t\t}\n\t\tHTMLHelper.loadDynamicScript(sid, cm, cback);\n\t}\n\telse {\n\t\tthis.loadPluginScripts(plugin, scripts, then);\n\t}\n}\n\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\n\tvar ticker = scripts.length - 1;\n\tvar self = this;\n\tvar cback = function(){\n\t\tif(ticker == 0) {\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\n\t\t\t\tself.loaded.push(plugin);\n\t\t\t}\n\t\t\tif(self.loading.indexOf(plugin) != -1){\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\n\t\t\t}\n\t\t\tthen();\n\t\t}\n\t\tticker--;\n\t};\n\tif(scripts.length == 0){\n\t\tthis.loaded.push(plugin);\n\t}\n\telse {\n\t\tthis.loading.push(plugin);\n\t}\n\tfor(var i = 0; i<scripts.length; i++){\n\t\tvar sid = plugin + \"_js_\" + i;\n\t\tHTMLHelper.loadDynamicScript(sid, scripts[i], cback);\n\t}\n}\n\nTerminusPluginManager.prototype.loadPageCSS = function(css){\n\tcssfid = \"terminus_client_css\";\n\tvar cssdom = document.getElementById(cssfid);\n\tif(cssdom){\n\t\tcssdom.parentNode.removeChild(cssdom);\n\t}\n\tif(css){\n\t\tcssurl = this.css_base + \"css/\" + css + \".css\";\n\t\tHTMLHelper.loadDynamicCSS(cssfid, cssurl);\n\t}\n}\n\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\n}\n\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\n\tif(this.loaded.indexOf(pid) != -1) return true;\n\tif(this.preloaded.indexOf(pid) != -1) return true;\n\tif(this.loading.indexOf(pid) != -1) return true;\n\treturn false;\n}\n\nTerminusPluginManager.prototype.disabled = function(pid, obj){\n\tif(this.precluded.indexOf(pid) != -1) return true;\n\tif(obj.requires){\n\t\tfor(var i = 0; i<obj.requires.length; i++){\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\n\t\t}\n\t}\n\treturn false;\n}\n\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\n\tvar a = document.createElement(\"a\");\n\tvar cl = document.createElement(\"span\");\n\ta.appendChild(cl);\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\n\tvar cbox = document.createElement(\"input\");\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\n\tcbox.type = \"checkbox\";\n\tif(this.preloaded.indexOf(plugid) != -1){\n\t\tcbox.checked = true;\n\t\tcbox.disabled = true;\n\t}\n\telse if(this.loaded.indexOf(plugid) != -1){\n\t\tcbox.checked = true;\n\t}\n\telse if(this.loading.indexOf(plugid) != -1){\n\t\tcbox.checked = true;\n\t}\n\telse if(this.disabled(plugid, obj)){\n\t\tcbox.disabled = true;\n\t}\n\tvar clab = document.createElement(\"label\");\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\n\tclab.setAttribute(\"for\", cbox.id);\n\tclab.appendChild(document.createTextNode(obj.label));\n\tcl.appendChild(clab);\n\tcl.appendChild(cbox);\n\tvar self = this;\n\tcbox.addEventListener(\"change\", function(){\n\t\tself.togglePlugin(plugid, ui);\n\t});\n\treturn a;\n}\n\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\n\tif(this.loaded.indexOf(plugid) == -1){\n\t\tvar then = function(){\n\t\t\tui.redraw();\n\t\t}\n\t\tthis.loadPlugin(plugid, then);\n\t}\n\telse {\n\t\tthis.unloadPlugin(plugid);\n\t}\n\tHTMLHelper.removeChildren(ui.plugins);\n\tui.drawPlugins();\n}\n\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\n\t\treturn false;\n\t}\n\tvar pug = this.plugins[plugid];\n\tvar num = (pug.js) ? pug.js.length : 0;\n\tif(pug.plugin) num++;\n\tfor(var i=0; i< num; i++){\n\t\tvar cssfid = plugid + \"_js_\" + i;\n\t\tvar cssdom = document.getElementById(cssfid);\n\t\tif(cssdom){\n\t\t\tcssdom.parentNode.removeChild(cssdom);\n\t\t}\n\t}\n\tnum = (pug.css ? pug.css.length : 0);\n\tfor(var i=0; i< num; i++){\n\t\tvar cssfid = plugid + \"_css_\" + i;\n\t\tvar cssdom = document.getElementById(cssfid);\n\t\tif(cssdom){\n\t\t\tcssdom.parentNode.removeChild(cssdom);\n\t\t}\n\t}\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\n}\n\nTerminusPluginManager.prototype.getAsDOM = function(ui){\n\tvar dm = document.createElement(\"span\");\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\n\tvar clh = document.createElement(\"span\");\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\n\tdm.appendChild(clh);\n\tvar a = document.createElement('a');\n\tthis.showPlugins(a, ui);\n\tclh.appendChild(a);\n\ta.style.display = 'none';\n\tclh.addEventListener('click', function(){\n\t\tif(a.style.display == 'none')\n\t\t\ta.style.display = 'block';\n\t\telse a.style.display = 'none';\n\t})\n\treturn dm;\n}\n\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\n\ta.setAttribute('style', 'background-color: #111;');\n\tfor(var pid in this.plugins){\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\n\t}\n}\n\nmodule.exports=TerminusPluginManager\n","'use strict';\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%40/gi, '@').\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    var hashmarkIndex = url.indexOf('#');\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n","'use strict';\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar normalizeHeaderName = require('./helpers/normalizeHeaderName');\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  } else if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Accept');\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n","'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildURL = require('./../helpers/buildURL');\nvar buildFullPath = require('../core/buildFullPath');\nvar parseHeaders = require('./../helpers/parseHeaders');\nvar isURLSameOrigin = require('./../helpers/isURLSameOrigin');\nvar createError = require('../core/createError');\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    var fullPath = buildFullPath(config.baseURL, config.url);\n    request.open(config.method.toUpperCase(), buildURL(fullPath, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(createError('Request aborted', config, 'ECONNABORTED', request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      var timeoutErrorMessage = 'timeout of ' + config.timeout + 'ms exceeded';\n      if (config.timeoutErrorMessage) {\n        timeoutErrorMessage = config.timeoutErrorMessage;\n      }\n      reject(createError(timeoutErrorMessage, config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      var cookies = require('./../helpers/cookies');\n\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(fullPath)) && config.xsrfCookieName ?\n        cookies.read(config.xsrfCookieName) :\n        undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(config.withCredentials)) {\n      request.withCredentials = !!config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (requestData === undefined) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n","'use strict';\n\nvar enhanceError = require('./enhanceError');\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n","'use strict';\n\nvar utils = require('../utils');\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n * @returns {Object} New object resulting from merging config2 to config1\n */\nmodule.exports = function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  var config = {};\n\n  var valueFromConfig2Keys = ['url', 'method', 'params', 'data'];\n  var mergeDeepPropertiesKeys = ['headers', 'auth', 'proxy'];\n  var defaultToConfig2Keys = [\n    'baseURL', 'url', 'transformRequest', 'transformResponse', 'paramsSerializer',\n    'timeout', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',\n    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress',\n    'maxContentLength', 'validateStatus', 'maxRedirects', 'httpAgent',\n    'httpsAgent', 'cancelToken', 'socketPath'\n  ];\n\n  utils.forEach(valueFromConfig2Keys, function valueFromConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    }\n  });\n\n  utils.forEach(mergeDeepPropertiesKeys, function mergeDeepProperties(prop) {\n    if (utils.isObject(config2[prop])) {\n      config[prop] = utils.deepMerge(config1[prop], config2[prop]);\n    } else if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (utils.isObject(config1[prop])) {\n      config[prop] = utils.deepMerge(config1[prop]);\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  utils.forEach(defaultToConfig2Keys, function defaultToConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  var axiosKeys = valueFromConfig2Keys\n    .concat(mergeDeepPropertiesKeys)\n    .concat(defaultToConfig2Keys);\n\n  var otherKeys = Object\n    .keys(config2)\n    .filter(function filterAxiosKeys(key) {\n      return axiosKeys.indexOf(key) === -1;\n    });\n\n  utils.forEach(otherKeys, function otherKeysDefaultToConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  return config;\n};\n","'use strict';\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n","const CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n\n/**\n * @file Connection Capabilities \n * @license Apache Version 2\n * @description Object which helps manage the capabilities available for a given TerminusDB connection \n * Creates an entry in the connection registry for the server\n * and all the databases that the client has access to\n * maps the input authorties to a per-db array for internal storage and easy\n * access control checks\n * @param {connectionConfig} connectionConfig connectionConfig object containing the connection parameters \n * @param {String} key API key\n */\nfunction ConnectionCapabilities(connectionConfig, key) {\n\tthis.connection = {};\n\tthis.connectionConfig = connectionConfig;\n\tif (this.connectionConfig.server && key) {\n\t\tthis.setClientKey(this.connectionConfig.server, key);\n\t}\n}\n\n/**\n * Retrieves the API key for the given TerminusDB Server\n * @param {String} serverURL optional - URL of TerminusDB - if ommited the current server URL is used\n */\nConnectionCapabilities.prototype.getClientKey = function (serverURL) {\n\tif (!serverURL) serverURL = this.connectionConfig.serverURL();\n\tif (serverURL && this.connection[serverURL]) return this.connection[serverURL].key;\n\treturn false;\n};\n\n\n/*\n * Utility functions for changing the state of connections with Terminus servers\n */\n\n/**\n * sets the api key for the given url\n * @param {String} curl a valid terminusDB server URL\n * @param {String} key an optional API key\n */\nConnectionCapabilities.prototype.setClientKey = function (curl, key) {\n\tif (typeof key === 'string' && key.trim()) {\n\t\tif (typeof this.connection[curl] === 'undefined') {\n\t\t\tthis.connection[curl] = {};\n\t\t}\n\t\tthis.connection[curl].key = key.trim();\n\t}\n};\n\n\n/**\n * @param {string} curl a valid terminusDB server URL\n * @param {object} capabilities the JSON object returned by the connect API call \n */\nConnectionCapabilities.prototype.addConnection = function (curl, capabilities) {\n\tif (typeof this.connection[curl] === 'undefined') {\n\t\tthis.connection[curl] = {};\n\t}\n\tconst capabilitiesKeys = capabilities ? Object.keys(capabilities) : [];\n\n\tfor (const pred of capabilitiesKeys) {\n\t    if (pred === 'terminus:authority' && capabilities[pred]) {\n\t      const auths = Array.isArray(capabilities[pred]) === true\n\t        ? capabilities[pred]\n\t        : [capabilities[pred]];\n\n\t      for (let i = 0; i < auths.length; i += 1) {\n\t        let scope = auths[i]['terminus:authority_scope'];\n\t        const actions = auths[i]['terminus:action'];\n\n\t\t\tif (Array.isArray(scope) === false) scope = [scope];\n\t\t\tconst actionsArr = ((Array.isArray(actions)) ? actions.map(item => item['@id']) : [] );\n\t        for (let j = 0; j < scope.length; j += 1) {\n\t          const nrec = scope[j];\n\t          if (typeof this.connection[curl][nrec['@id']] === 'undefined') {\n\t            this.connection[curl][nrec['@id']] = nrec;\n\t          }\n\t\t\t  this.connection[curl][nrec['@id']]['terminus:authority'] = actionsArr;\n\t        }\n\t      }\n\t    } else {\n\t      this.connection[curl][pred] = capabilities[pred];\n\t    }\n\t}\n};\n\nConnectionCapabilities.prototype.getJSONContext = function (serverURL, dbid) {\n\tif (!serverURL) serverURL = this.connectionConfig.serverURL();\n\tif (!dbid) dbid = this.connectionConfig.dbid;\n\tif (serverURL && this.connection[serverURL] && this.connection[serverURL][\"@context\"]){\n\t\tlet con = this.connection[serverURL][\"@context\"];\n\t\tvar ncon = {};\n\t\tlet db = con.doc.substring(0, (con.doc.length - \"terminus/document/\".length)) + dbid + \"/\";\n\t\tvar ncon = { doc : db + \"document/\", scm: db + \"schema#\", db: db};\n\t\tfor(var k in con){\n\t\t\tif(typeof ncon[k] == \"undefined\") ncon[k] = con[k];\n\t\t}\n\t\treturn ncon;\n\t}\n\treturn false;\n};\n\n\n/**\n * returns true if the client is currently connected to a server\n * @returns {Boolean}\n */\nConnectionCapabilities.prototype.serverConnected = function () {\n\treturn typeof this.connection[this.connectionConfig.server] !== 'undefined';\n};\n\n\n/**\n * retrieves the meta-data record returned by connect for a particular server\n * @param {String} [srvr] optional server URL - if omitted current connection config will be used\n * @returns {terminus:Server} JSON server record as returned by WOQLClient.connect\n */\nConnectionCapabilities.prototype.getServerRecord = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst connectionObj = this.connection[url] || {};\n\tconst okeys = Object.keys(connectionObj);\n\n\tfor (const oid of okeys) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Server') {\n\t\t\treturn this.connection[url][oid];\n\t\t}\n\t}\n\treturn false;\n};\n\n/**\n * retrieves the meta-data record returned by connect for a particular database\n * @param {String} [dbid] optional database id - if omitted current connection config db will be used\n * @param {String} [srvr] optional server URL - if omitted current connection config server will be used\n * @returns {terminus:Database} terminus:Database JSON document as returned by WOQLClient.connect\n */\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tdbid = (dbid || this.connectionConfig.dbid);\n\tif (typeof this.connection[url] !== 'object') {\n\t\treturn false;\n\t}\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\tdbid = this.dbCapabilityID(dbid);\n\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\treturn undefined;\n};\n\n/**\n * retrieves all the db meta-data records returned by connect for a particular server\n * @param {String} [srvr] optional server URL - if omitted current connection config server will be used\n * @returns {[terminus:Database]} array of terminus:Database JSON documents as returned by WOQLClient.connect\n */\nConnectionCapabilities.prototype.getServerDBRecords = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst dbrecs = {};\n\tconst connectionObj = this.connection[url] || {};\n\n\tfor (const oid of Object.keys(connectionObj)) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Database') {\n\t\t\tdbrecs[oid] = this.connection[url][oid];\n\t\t}\n\t}\n\treturn dbrecs;\n};\n\n/**\n * removes a database record from the connection registry (after deletion, for example)\n * @param {String} [dbid] optional DB ID - if omitted current connection config db will be used\n * @param {String} [srvr] optional server URL - if omitted current connection config server will be used\n * @returns {[terminus:Database]} array of terminus:Database JSON documents as returned by WOQLClient.connect\n */\nConnectionCapabilities.prototype.removeDB = function (dbid, srvr) {\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tif (dbid && this.connectionConfig.dbid && this.connectionConfig.dbid === dbid) {\n\t\tthis.connectionConfig.dbid = false;\n\t}\n\n\tconst url = srvr || this.connectionConfig.server;\n\tconst dbidCap = this.dbCapabilityID(dbid);\n\tif (dbidCap && this.connection[url] && this.connection[url][dbidCap]) {\n\t\tdelete this.connection[url][dbidCap];\n\t}\t\n};\n\n/**\n * @param {String} dbid local id of database\n * @returns {String} the id of the terminus:Document describing the DB\n * Generates the ID of the terminus:Database document from the database ID\n */\nConnectionCapabilities.prototype.dbCapabilityID = function (dbid) {\n\treturn `doc:${dbid}`;\n};\n\n/**\n * @param {String} action - the action that will be carried out\n * @param {String} [dbid] optional DB ID - if omitted current connection config db will be used\n * @param {String} [srvr] optional server URL - if omitted current connection config server will be used\n * @returns {Boolean} true if the client's capabilities allow the action on the given server / db\n * supports client side access control checks (in addition to server side)\n */\nConnectionCapabilities.prototype.capabilitiesPermit = function (action, dbid, server) {\n\tserver = server || this.connectionConfig.server;\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tlet rec;\n\n\tif (action === CONST.CREATE_DATABASE) {\n\t\trec = this.getServerRecord(server);\n\t} else if (dbid) rec = this.getDBRecord(dbid);\n\telse console.log('no dbid provided in capabilities check ', server, dbid);\n\tif (rec) {\n\t\tconst auths = rec['terminus:authority'];\n\t\tif (auths && auths.indexOf(`terminus:${action}`) !== -1) return true;\n\t} else {\n\t\tconsole.log('No record found for connection: ', this.connection, action, server, dbid);\n\t}\n\tthis.error = ErrorMessage.accessDenied(action, dbid, server);\n\treturn false;\n};\n\n\nmodule.exports = ConnectionCapabilities;\n","\nconst IDParser = require('./terminusIDParser');\n\n/**\n * @file Terminus DB connection configuration\n * @license Apache Version 2\n * @description Object representing the state of a connection to a terminus db - server url, current dbid, document id\n * along with some configuration information (key, connected mode, client_side_access_control)\n * provides methods for getting and setting connection parameters\n */\nfunction ConnectionConfig(params) {\n\tconst newParams = params || {};\n\tthis.server = false;\n\tthis.dbid = false;\n\tthis.docid = false;\n\tif (newParams.server) this.setServer(newParams.server);\n\tif (newParams.db) this.setDB(newParams.db);\n\tif (newParams.doc) this.setDocument(newParams.doc);\n\t/*\n     * client configuration options - connected_mode = connected\n     * tells the client to first connect to the server before invoking other services\n     */\n\n\t// include a terminus:user_key API key in the calls\n\tthis.include_key = newParams.include_key || true;\n}\n\n/**\n * Server URL will always end in a / character - automatically appended if missing\n */\nConnectionConfig.prototype.setServer = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseServerURL(inputStr)) {\n\t\tthis.server = parser.server();\n\t\tthis.dbid = false;\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n\nConnectionConfig.prototype.serverURL = function () {\n\treturn this.server;\n};\n\n/**\n * Database URL does not have a trailing slash \"/\" character and it will be chopped if it is passed in at the end of the input string\n * @param {String} inputStr - URL of DB or local id of DB\n */\nConnectionConfig.prototype.setDB = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDBID(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.dbURL = function () {\n\treturn this.server + this.dbid;\n};\n\n\n/**\n * sets the connection to point at the schema api URL\n */\nConnectionConfig.prototype.setSchemaURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseSchemaURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.schemaURL = function () {\n\treturn `${this.dbURL()}/schema`;\n};\n\n/**\n * @param {String} inputStr - the URL of a Terminus DB base install or schema endpoint\n * @param {Object} [context] optional json-ld context\n * sets the connection to point at the query api URL\n */\nConnectionConfig.prototype.setQueryURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseQueryURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.queryURL = function () {\n\treturn `${this.dbURL()}/woql`;\n};\n\n\n\n/**\n * @param {String} inputStr - the URL of a Terminus DB base install or frame endpoint\n * @param {Object} [context] optional json-ld context\n * sets the connection to point at the class frame api URL\n */\nConnectionConfig.prototype.setClassFrameURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseClassFrameURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.frameURL = function () {\n\treturn `${this.dbURL()}/frame`;\n};\n\n/**\n * @param {String} inputStr - the URL of a Terminus DB base install or document endpoint\n * @param {Object} [context] optional json-ld context\n * sets the connection to point at the document api URL\n */\nConnectionConfig.prototype.setDocument = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDocumentURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tif (parser.dbid()) this.dbid = parser.dbid();\n\t\tif (parser.docid()) this.docid = parser.docid();\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.docURL = function () {\n\treturn `${this.dbURL()}/document/${this.docid ? this.docid : ''}`;\n};\n\n/**\n * will a key be used in this connnection?\n */\nConnectionConfig.prototype.includeKey = function () {\n\treturn this.include_key === true;\n};\n\nmodule.exports = ConnectionConfig;\n","/**\n * @file Terminus ID Parser\n * @license Apache Version 2\n * Object representing a terminus ID / URL \n * Helper methods for parsing and decomposing Terminus URLs \n * and dealing with namespace prefixed URLs\n * @param {Object} context JSON-LD context to be used for prefixes\n */\n function IDParser(context) {\n\tthis.context = context;\n\tthis.server_url = false;\n\tthis.db = false;\n\tthis.doc = false;\n}\n\nIDParser.prototype.server = function () {\n\treturn this.server_url;\n};\n\nIDParser.prototype.dbid = function () {\n\treturn this.db;\n};\n\nIDParser.prototype.docid = function () {\n\treturn this.doc;\n};\n\nIDParser.prototype.setContext = function (context) {\n\tthis.context = context;\n};\n\n/**\n * parses a Terminus Server URL and appends a trailing slash if not present\n */\nIDParser.prototype.parseServerURL = function (str) {\n\tthis.server_url = false;\n\n\tif (this.validURL(str)) {\n\t\tthis.server_url = str;\n\t} else if (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tthis.server_url = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.server_url && this.server_url.lastIndexOf('/') !== this.server_url.length - 1\n\t) {\n\t\tthis.server_url += '/';\n\t}\n\treturn this.server_url;\n};\n\nIDParser.prototype.parseDBID = function (str) {\n\tthis.db = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tif (str.lastIndexOf('/') === str.length - 1) {\n\t\t\t// trim trailing slash\n\t\t\tstr = str.substring(0, str.length - 1);\n\t\t}\n\t\tconst index = str.lastIndexOf('/');\n\n\t\tconst serverURL = str.substring(0, index);\n\t\t// only dbNamer\n\t\tstr = str.substring(index + 1);\n\n\t\tif (this.parseServerURL(serverURL) === false) return false;\n\t}\n\n\tif (this.validIDString(str)) {\n\t\tthis.db = str;\n\t}\n\treturn this.db;\n};\n\nIDParser.prototype.parseDocumentURL = function (str) {\n\tthis.doc = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.validURL(str)) {\n\t\tlet dbURL = str;\n\t\tif (str.lastIndexOf('/document/') !== -1) {\n\t\t\t// get dbURL\n\t\t\tdbURL = str.substring(0, str.lastIndexOf('/document/'));\n\t\t\tstr = str.substring(str.lastIndexOf('/document/') + 10);\n\t\t}\n\t\tif (this.parseDBID(dbURL) === false) return false;\n\t}\n\tif (str.substring(0, 4) === 'doc:') str = str.substring(4);\n\t// check if the document's name hasn't space or '/'\n\tif (this.validIDString(str)) {\n\t\tthis.doc = str;\n\t}\n\treturn this.doc;\n};\n\nIDParser.prototype.parseSchemaURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'schema');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.parseQueryURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'woql');\n\t\tstr = this.stripOptionalPath(str, 'query');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.stripOptionalPath = function (str, bit) {\n\tif (str.indexOf(`/${bit}`) !== -1) str = str.substring(0, str.indexOf(`/${bit}`));\n\treturn str;\n};\n\nIDParser.prototype.parseClassFrameURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'frame');\n\t}\n\treturn this.parseDBID(str);\n};\n\n// Valid URLs are those that start with http:// or https://\nIDParser.prototype.validURL = function (str) {\n\tif (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://') return true;\n\treturn false;\n};\n\nIDParser.prototype.validPrefixedURL = function (str, context) {\n\tif (typeof str !== 'string' || typeof context !== 'object') return false;\n\tconst parts = str.split(':');\n\tif (parts.length !== 2) return false;\n\tif (parts[0].length < 1 || parts[1].length < 1) return false;\n\tif (context && context[parts[0]] && this.validIDString(parts[1])) return true;\n\treturn false;\n};\n\nIDParser.prototype.validIDString = function (str) {\n\tif (typeof str !== 'string') return false;\n\tif (str.indexOf(':') !== -1 || str.indexOf(' ') !== -1 || str.indexOf('/') !== -1) return false;\n\treturn true;\n};\n\nIDParser.prototype.expandPrefixed = function (str, context) {\n\tconst parts = str.split(':');\n\treturn context[parts[0]] + parts[1];\n};\n\nmodule.exports = IDParser;\n","\nconst UTILS = require('./utils.js');\nconst WOQL = require('./woql.js');\n\n\n/**\n * @file WOQL Result Object\n * @license Apache Version 2\n * Object representing the result of a WOQL Query\n * @param {Object} results result JSON object as returned by WOQL query\n * @param {WOQLQuery} query the query object that generated the result\n * @param {Object} [config] optional result configuration options object\n *                 [config.no_compress] by default all URLs are compressed where possible (v:X rather than http://.../variable/x) set to true to return non-compressed values \n *                 [config.context] specify the JSON-LD context to use for compressing results - by default the query context will be used\n */\nfunction WOQLResult(results, query, config) {\n\tthis.bindings = (results ? results.bindings : []);\n\tthis.query = (query ? query : WOQL.query());\n\tthis.cursor = 0;\n\tif (!(config && config.no_compress)) {\n\t\tconst context = (config && config.context ? config.context : false);\n\t\tthis.compress(context);\n\t}\n}\n\n/**\n * @param {Object} [context] optional context to use for compression - if ommitted query context is used\n */\nWOQLResult.prototype.compress = function (context) {\n\tcontext = (context || this.query.getContext());\n\tfor (let i = 0; i < this.bindings.length; i++) {\n\t\tfor (const prop of Object.keys(this.bindings[i])) {\n\t\t\tconst nprop = UTILS.shorten(prop, context);\n\t\t\tconst nval = ((typeof this.bindings[i][prop] === 'string')\n\t\t\t\t? UTILS.shorten(this.bindings[i][prop], context)\n\t\t\t\t: this.bindings[i][prop]\n\t\t\t);\n\t\t\tdelete (this.bindings[i][prop]);\n\t\t\tthis.bindings[i][nprop] = nval;\n\t\t}\n\t}\n\treturn this;\n}\n\n/**\n * Returns true if there are any results \n */\nWOQLResult.prototype.hasBindings = function () {\n\tif(this.bindings && this.count()) return true;\n\treturn false;\n};\n\n/**\n * Returns original array of bindings returned by API\n */\nWOQLResult.prototype.getBindings = function () {\n\treturn this.bindings;\n};\n\n/**\n * Returns list of variables returned in bindings from API\n */\nWOQLResult.prototype.getVariableList = function () {\n\tif (this.bindings && this.bindings[0]) {\n\t\treturn Object.keys(this.bindings[0]);\n\t}\n\treturn [];\n};\n\n/**\n * Number of rows in bound results\n */\nWOQLResult.prototype.count = function () {\n\treturn this.bindings.length;\n};\n\n/**\n * Result set navigation\n */\nWOQLResult.prototype.first = function () {\n\tthis.cursor = 0;\n\treturn this.bindings[0];\n};\n\nWOQLResult.prototype.last = function(){\n\tthis.cursor = this.bindings.length-1;\n\treturn this.bindings[this.bindings.length-1];\n}\n\nWOQLResult.prototype.next = function () {\n\tif(this.cursor >= this.bindings.length) return false;\n\tconst res = this.bindings[this.cursor];\t\n\tthis.cursor++;\n\treturn res;\n};\n\nWOQLResult.prototype.prev = function () {\n\tif (this.cursor > 0) {\n\t\tthis.cursor--;\n\t\treturn this.bindings[this.cursor];\n\t}\n};\n\n/**\n * Normally sorting of results is the job of the query - this is just in case you want to resort results according to some key (variable)\n */\nWOQLResult.prototype.sort = function(key, asc_or_desc){\n\tthis.bindings.sort((a, b) => {\n\t\treturn this.compareValues(a[key], b[key], asc_or_desc);\n\t});\n\tthis;\n}\n\n/**\n * Compares results a, b according to \"asc\" or \"desc\" order\n */\nWOQLResult.prototype.compareValues = function(a, b, asc_or_desc=\"asc\"){\n\tif(!a || !b) return 0;\n\tif(typeof a['@value'] != \"undefined\" && typeof b['@value'] != \"undefined\"){\n\t\ta = a['@value'];\n\t\tb = b['@value'];\n\t}\n\tif (a > b) {\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? 1 : -1);\n\t}\n\tif (b > a) {\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? -1 : 1);\n\t}\n};\n\nmodule.exports = WOQLResult;\n","const UTILS = require('./utils');\n\n/**\n * The WOQL object is a wrapper around the WOQLQuery object\n * Syntactic sugar to allow writing WOQL.triple()... instead of new WOQLQuery().triple()\n * Every function matches one of the public api functions of the woql query object\n */\nlet WOQL = {};\n\n/*\n * We expose all the real woql predicates via the WOQL object,\n * for ease of typing all return a WOQL query object\n */\n\n /**\n * When the sub-query in Condition is met, the Update query is executed\n * @param {object or boolean} Query - WOQL Query object or bool\n * @param {object} Update - WOQL Query object, optional\n * @return {object} WOQLQuery\n *\n * Functions which take a query as an argument advance the cursor to make the chaining of queries fall into the corrent place in the encompassing json.\n */\nWOQL.when = function(Query, Update){ return new WOQLQuery().when(Query, Update);}\n\n/**\n * The Query in the Optional argument is specified as optional\n * @param {object} query - WOQL Query object\n * @return {object} WOQLQuery\n */\nWOQL.opt = function(query){ return new WOQLQuery().opt(query); }\n\n/**\n * Specifies the database URL that will be the default database for the enclosed query\n * @param {string} dburl - url of the database\n * @param {object} query - WOQL Query object, optional\n * @return {object} WOQLQuery\n */\nWOQL.from = function(dburl, query){ return new WOQLQuery().from(dburl, query); }\n\n/**\n * Sets the current output graph for writing output to.\n * @param {string} dburl - url of the database\n * @param {object} query - WOQL Query object, optional\n * @return {object} WOQLQuery\n */\nWOQL.into = function(dburl, query){ return new WOQLQuery().into(dburl, query); }\n\n/**\n * Specifies that only the first Number of rows will be returned\n * @param {integer} limit - number of maximum results returned\n * @param {object} query - WOQL Query object, optional\n * @return {object} WOQLQuery\n */\nWOQL.limit = function(limit, query){ return new WOQLQuery().limit(limit, query); }\n\n/**\n * Specifies that the start of the query returned\n * @param {integer} start - index of the frist result got returned\n * @param {object} query - WOQL Query object, optional\n * @return {object} WOQLQuery\n */\nWOQL.start = function(start, query){ return new WOQLQuery().start(start, query); }\n\n/**\n * Filters the query so that only the variables included in [V1...Vn] are returned in the bindings\n * @param list - only these variables are returned\n * @return {object} WOQLQuery\n */\nWOQL.select = function(...list){ return new WOQLQuery().select(...list); }\n\n/**\n * Creates a logical OR of the arguments\n * @param queries - WOQL Query objects\n * @return {object} WOQLQuery\n */\nWOQL.or = function(...queries){\treturn new WOQLQuery().or(...queries); }\n\n/**\n * Creates a logical AND of the arguments\n * @param queries - WOQL Query objects\n * @return {object} WOQLQuery\n */\nWOQL.and = function(...queries){ return new WOQLQuery().and(...queries); }\n\n/**\n * Creates a logical NOT of the arguments\n * @param queries - WOQL Query objects\n * @return {object} WOQLQuery\n */\nWOQL.not = function(query){ return new WOQLQuery().not(query); }\n\n/**\n * Creates a triple pattern matching rule for the triple [S, P, O] (Subject, Predicate, Object)\n * @param {string} a - Subject\n * @param {string} b - Predicate\n * @param {string} c - Object\n * @return {object} WOQLQuery\n */\nWOQL.triple = function(a, b, c){ return new WOQLQuery().triple(a, b, c); }\n\n/**\n * Creates a pattern matching rule for the quad [S, P, O, G] (Subject, Predicate, Object, Graph)\n * @param {string} a - Subject\n * @param {string} b - Predicate\n * @param {string} c - Object\n * @param {string} d - Graph\n * @return {object} WOQLQuery\n */\nWOQL.quad = function(a, b, c, d){ return new WOQLQuery().quad(a, b, c, d); }\n\n/**\n * Returns true if ClassA is a sub-class of ClassB, according to the current DB schema\n * @param {string} a - classA\n * @param {string} b - classB, optional\n * @return {boolean} WOQLQuery\n */\nWOQL.sub = function(a, b){ return new WOQLQuery().sub(a, b); }\n\n/**\n * Matches if Instance is a member of Class, according to the current state of the DB\n * @param {string} a - classA\n * @param {string} b - classB, optional\n * @return {boolean} WOQLQuery\n */\nWOQL.isa = function(a, b){\treturn new WOQLQuery().isa(a, b);\t}\n\n/**\n * Matches if a is equal to b\n * @param {string} a - object in the graph\n * @param {string} b - object in the graph\n * @return {object} WOQLQuery\n */\nWOQL.eq = function(a, b){ return new WOQLQuery().eq(a, b);}\n\n/**\n * A trimmed version of StringA (with leading and trailing whitespace removed) is copied into VariableA\n * @param {string} a - StringA\n * @param {string} b - VariableA\n * @return {object} WOQLQuery\n */\nWOQL.trim = function(a, b){\treturn new WOQLQuery().trim(a, b);\t}\n\n/**\n * Deletes a node identified by an IRI or a JSON-LD document\n * @param {string} JSON_or_IRI - IRI or a JSON-LD document\n * @return {object} WOQLQuery\n */\nWOQL.delete = function(JSON_or_IRI){ return new WOQLQuery().delete(JSON_or_IRI);\t}\n\n/**\n * Deletes any triples that match the rule [S,P,O]\n * @param {string} S - Subject\n * @param {string} P - Predicate\n * @param {string} O - Object\n * @return {object} WOQLQuery\n */\nWOQL.delete_triple = function( S, P, O ){ return new WOQLQuery().delete_triple (S, P, O);\t}\n\n/**\n * Deletes any quads that match the rule [S, P, O, G] (Subject, Predicate, Object, Graph)\n * @param {string} S - Subject\n * @param {string} P - Predicate\n * @param {string} O - Object\n * @param {string} G - Graph\n * @return {object} WOQLQuery\n */\nWOQL.delete_quad = function( S, P, O, G ){ return new WOQLQuery().delete_quad (S, P, O, G); }\n\n/**\n * Adds triples according to the the pattern [S,P,O]\n * @param {string} S - Subject\n * @param {string} P - Predicate\n * @param {string} O - Object\n * @return {object} WOQLQuery\n */\nWOQL.add_triple = function( S, P, O ){ return new WOQLQuery().add_triple (S, P, O); }\n\n/**\n * Adds quads according to the pattern [S,P,O,G]\n * @param {string} S - Subject\n * @param {string} P - Predicate\n * @param {string} O - Object\n * @param {string} G - Graph\n * @return {object} WOQLQuery\n */\nWOQL.add_quad = function( S, P, O, G ){ \treturn new WOQLQuery().add_quad (S, P, O, G);}\n\n/**\n * Imports the Target Resource to the variables defined in vars\n * @param {object or array} vars - If WQOLQuery object, cols will replace the target. If list, its column names of the source csv\n * @param {array or string} cols - List, if arr1 is list and it will take the variable names for the input. Str, if arr1 is WQOLQuery, it will be the target\n * @param {string} target - optional, target of the source data, used only if vars and cols is list\n * @return {object} WOQLQuery\n */\nWOQL.get = function(vars, cols, target){\treturn new WOQLQuery().get(vars, cols, target); }\n\n/**\n * Exports the Target Resource to the file file, with the variables defined in as\n * @param {object or array} as - WQOLQuery as object\n * @param {array or string} cols - List, if arr1 is list and it will take the variable names for the input. Str, if arr1 is WQOLQuery, it will be the target\n * @param {string} target - optional, target of the source data, used only if vars and cols is list\n * @return {object} WOQLQuery\n */\nWOQL.put = function(as, query, file){\treturn new WOQLQuery().put(as, query, file); }\n\n\n/**\n * Reads source into a temporary in-memory graph and runs the query on it.\n * @param {string} graph - graph id\n * @param {object} source - WOQLQuery object\n * @param {object} query - WOQLQuery object, optional\n * @return {object} WOQLQuery\n */\nWOQL.with = function(graph, source, query){\treturn new WOQLQuery().with(graph, source, query); }\n\n/**\n * Imports the value identified by Source to a Target variable\n * @param {string} map - Source\n * @param {string} vari - Target\n * @return {object} WOQLQuery\n */\nWOQL.as = function(map, vari, ty){\treturn new WOQLQuery().as(map, vari, ty); }\n\n/**\n * Provides details of a remote data source in a JSON format that includes a URL property\n * @param {object} url - remote data source in a JSON format\n * @param {object} opts - imput options, optional\n * @return {object} WOQLQuery\n */\nWOQL.remote = function(url, opts){\treturn new WOQLQuery().remote(url, opts); }\n\n/**\n * Provides details of a file source in a JSON format that includes a URL property\n * @param {object} url - file data source in a JSON format\n * @param {object} opts - imput options, optional\n * @return {object} WOQLQuery\n */\nWOQL.file = function(url, opts){\treturn new WOQLQuery().file(url, opts); }\n\n\n/**\n * Provides details of a file source in a JSON format that includes a URL property\n * @param {object} url - file data source in a JSON format\n * @param {object} opts - imput options, optional\n * @return {object} WOQLQuery\n */\nWOQL.post = function(url, opts){\treturn new WOQLQuery().post(url, opts); }\n\n\n/**\n * Create a list of variables for WOQL\n * @param vars - variables to be put in the list\n * @return {object} WOQLQuery\n */\nWOQL.list = function(...vars){\treturn new WOQLQuery().list(...vars); }\n\n/**\n * Orders the results by the list of variables including in gvarlist, asc_or_desc is a WOQL.asc or WOQ.desc list of variables\n * @param {array or object} gvarlist - list of variables to order\n * @param {object} asc_or_desc - WOQL.asc or WOQ.desc, optional, default is asc\n * @param {object} query - WOQLQuery object, optional\n * @return {object} WOQLQuery\n */\nWOQL.order_by = function(asc_or_desc, query){\treturn new WOQLQuery().order_by(asc_or_desc, query); }\n\n/**\n * Orders the list by ascending order\n * @param {array or string} varlist_or_var - list of variables to order\n * @return {object} WOQLQuery\n */\nWOQL.asc = function(varlist_or_var){\treturn new WOQLQuery().asc(varlist_or_var); }\n\n/**\n * Orders the list by descending value\n * @param {array or string} varlist_or_var - list of variables to order\n * @return {object} WOQLQuery\n */\nWOQL.desc = function(varlist_or_var){\treturn new WOQLQuery().desc(varlist_or_var); }\n\n/**\n * Groups the results of groupquery together by the list of variables gvarlist, using the variable groupedvar as a grouping and saves the result into variable output.\n * @param {array or object} gvarlist - list of variables to group\n * @param {array or string} groupedvar - grouping variable(s)\n * @param {object} groupquery - WOQLQuery object\n * @param {string} output - output variable, optional\n * @return {object} WOQLQuery\n */\nWOQL.group_by = function(gvarlist, groupedvar, groupquery, output){\treturn new WOQLQuery().group_by(gvarlist, groupedvar, groupquery, output); }\n\n/* String and other processing functions */\n\n/**\n * Concatenates the list of variables into a string and saves the result in v\n * @param {array} list - list of variables to concatenate\n * @param {string} v - saves the results\n * @return {object} WOQLQuery\n */\nWOQL.concat = function(list, v){\treturn new WOQLQuery().concat(list, v); }\n\n/**\n * Changes a string to lower-case - input is in u, output in l\n * @param {string} u - input string\n * @param {string} l - stores output\n * @return {object} WOQLQuery\n */\nWOQL.lower = function(u, l){\treturn new WOQLQuery().lower(u, l); }\n\n/**\n * Pads out the string input to be exactly len long by appending the pad character pad to form output\n * @param {string} input - input string\n * @param {string} pad - padding character(s)\n * @param {integer} len - length to pad\n * @param {string} output - stores output\n * @return {object} WOQLQuery\n */\nWOQL.pad = function(input, pad, len, output){\treturn new WOQLQuery().pad(input, pad, len, output); }\n\n/**\n * Joins a list variable together (input) into a string variable (output) by glueing the strings together with glue\n * @param {array} input - a list of variables\n * @param {string} glue - joining character(s)\n * @param {string} output - variable that stores output\n * @return {object} WOQLQuery\n */\nWOQL.join = function(input, glue, output){\treturn new WOQLQuery().join(input, glue, output); }\n\n/**\n * Splits a variable apart (input) into a list of variables (output) by separating the strings together with separator\n * @param {string} input - a string or variable\n * @param {string} separator - character string to separate string into list\n * @param {string} output - variable that stores output list\n * @return {object} WOQLQuery\n */\nWOQL.split = function(input, separator, output){\treturn new WOQLQuery().split(input, separator, output); }\n\n/**\n * Iterates through a list and returns a value for each member\n * @param {string} El - a variable representing an element of the list\n * @param {string} List - A list variable\n * @return {object} WOQLQuery\n */\nWOQL.member = function(El, List){\treturn new WOQLQuery().member(El, List); }\n\n/**\n * Generates an ID for a node as a function of the passed VariableList with a specific prefix (URL base). If the values of the passed variables are the same, the output will be the same\n * @param {string} prefix - prefix for the id\n * @param {string} vari - variable to generate id for\n * @param {string} type - the variable to hold the id\n * @return {object} WOQLQuery\n */\nWOQL.unique = function(prefix, vari, type){\treturn new WOQLQuery().unique(prefix, vari, type); }\n\n/**\n * Generates an ID for a node as a function of the passed VariableList with a specific prefix (URL base). If the values of the passed variables are the same, the output will be the same\n * @param {string} prefix - prefix for the id\n * @param {string or array} vari - variable to generate id for\n * @param {string} type - the variable to hold the id\n * @param {string} output - idgen mode\n * @return {object} WOQLQuery\n */\nWOQL.idgen = function(prefix, vari, type, output){\treturn new WOQLQuery().idgen(prefix, vari, type, output); }\n\n/**\n * Changes the type of va to type and saves the return in vb\n * @param {string} vara - original variable\n * @param {string} type - type to be changed\n * @param {string} varb - save the return variable\n * @return {object} WOQLQuery\n */\nWOQL.typecast = function(vara, type, varb){\treturn new WOQLQuery().typecast(vara, type, varb); }\nWOQL.cast = WOQL.typecast;\n\n/**\n * Regular Expression Call\n * @param {string} pattern - regex pattern\n * @param {string} test - string to be matched\n * @param {string or array or object} matches - store list of matches\n * @return {object} WOQLQuery\n *\n * p is a regex pattern (.*) using normal regular expression syntax, the only unusual thing is that special characters have to be escaped twice, s is the string to be matched and m is a list of matches:\n * e.g. WOQL.re(\"(.).*\", \"hello\", [\"v:All\", \"v:Sub\"])\n */\nWOQL.re = function(pattern, test, matches){\treturn new WOQLQuery().re(pattern, test, matches); }\n\n\n/**\n * Compares the value of v1 against v2 and returns true if v1 is less than v2\n * @param {string} v1 - first variable to compare\n * @param {string} v2 - second variable to compare\n * @return {object} WOQLQuery\n */\nWOQL.less = function(v1, v2){\treturn new WOQLQuery().less(v1, v2); }\n\n/**\n * Compares the value of v1 against v2 and returns true if v1 is greater than v2\n * @param {string} v1 - first variable to compare\n * @param {string} v2 - second variable to compare\n * @return {object} WOQLQuery\n */\nWOQL.greater = function(v1, v2){\treturn new WOQLQuery().greater(v1, v2); }\n\n\n/* Mathematical Processing */\n\n/**\n * Evaluates the Arithmetic Expression Arith and copies the output to variable V\n * @param {object} arith - query or JSON-LD representing the query\n * @param {string} v - output variable\n * @return {object} WOQLQuery\n */\nWOQL.eval = function(arith, v){\treturn new WOQLQuery().eval(arith, v);}\n\n/**\n * Adds numbers N1...Nn together\n * @param args - numbers to add together\n * @return {object} WOQLQuery\n */\nWOQL.plus = function(...args){\treturn new WOQLQuery().plus(...args);}\n\n/**\n * Adds a list of numbers together\n * @param input - input list variable\n * @param output - output numeric\n * @return {object} WOQLQuery\n */\nWOQL.sum = function(input, output){\treturn new WOQLQuery().sum(input, output);}\n\n\n/**\n * Subtracts Numbers N1..Nn\n * @param args - numbers to be subtracted\n * @return {object} WOQLQuery\n */\nWOQL.minus = function(...args){\treturn new WOQLQuery().minus(...args); }\n\n/**\n * Multiplies numbers N1...Nn together\n * @param args - numbers to be multiplied\n * @return {object} WOQLQuery\n */\nWOQL.times = function(...args){\treturn new WOQLQuery().times(...args); }\n\n/**\n * Divides numbers N1...Nn by each other left, to right precedence\n * @param args - numbers to tbe divided\n * @return {object} WOQLQuery\n */\nWOQL.divide = function(...args){ return new WOQLQuery().divide(...args); }\n\n/**\n * Raises A to the power of B\n * @param {integer or double} a - base number\n * @param {integer or double} b - power of\n * @return {object} WOQLQuery\n */\nWOQL.exp = function(a, b){\treturn new WOQLQuery().exp(a, b); }\n\n/**\n * Division - integer division - args are divided left to right\n * @param args - numbers for division\n * @return {object} WOQLQuery\n */\nWOQL.div = function(...args){\treturn new WOQLQuery().div(...args); }\n\n/**\n * Adds a text comment to a query - can also be used to wrap any part of a query to turn it off\n * @param {string} arg - text comment\n * @return {object} WOQLQuery\n */\nWOQL.comment = function(arg){\treturn new WOQLQuery().comment(arg); }\n\n/**\n * Calculates the length of the value in va and stores it in vb\n * @param {string} var1 - value to calculate length\n * @param {string} res - stores result\n * @return {object} WOQLQuery\n */\nWOQL.length = function(var1, res){\treturn new WOQLQuery().length(var1, res);}\n\n\n//language extensions that can be chained after 'grounded' stuff (clauses with a specific subject) sub, isa, delete_triple, add_triple, delete_quad, add_quad, node\n//WOQL.value = function(vars){\treturn new WOQLQuery().list(vars); }\n\n/**\n * Selects everything as triples in the graph identified by GraphIRI into variables Subj, Pred, Obj - by default they are \"v:Subject\", \"v:Predicate\", \"v:Object\"\n * @param {string} G - graphIRI\n * @param {string} S - target subject\n * @param {string} P - target predicate\n * @param {string} O - target object\n * @return {object} WOQLQuery\n */\nWOQL.star = function(G, S, P, O){\treturn new WOQLQuery().star(G, S, P, O); }\n\n/**\n * Selects nodes with the ID NodeID as the subject of subsequent sub-queries. The second argument PatternType specifies what type of sub-queries are being constructed, options are: triple, quad, update_triple, update_quad, delete_triple, delete_quad\n * @param {string} nodeid - node to be selected\n * @param {string} type - pattern type, optional (default is triple)\n * @return {object} WOQLQuery\n */\nWOQL.node = function(nodeid, type){\treturn new WOQLQuery().node(nodeid, type); }\n//These ones are special ones for dealing with the schema only...\n\n/**\n * Generates a new Class with the given ClassID and writes it to the DB schema\n * @param {string} classid - class to be added\n * @param {string} graph - target graph\n * @return {object} WOQLQuery\n */\nWOQL.add_class = function(classid, graph){\treturn new WOQLQuery().add_class(classid, graph); }\n\n/**\n * Generates a new Property with the given PropertyID and a range of type type and writes it to the DB schema\n * @param {string} propid - property id to be added\n * @param {string} type - type of the proerty\n * @param {string} graph - target graph, optional\n * @return {object} WOQLQuery\n */\nWOQL.add_property = function(propid, type, graph){\treturn new WOQLQuery().add_property(propid, type, graph); }\n\n/**\n * Generates a box class around a class (a property that has a name derived from the class which points at the class and a new class with name Scoped[ClassID]\n * This allows providing termporal scoping, etc to \n * @param {string} prefix - url prefix that will be applied to new classes (default scm:)\n * @param {[classes]} classes - array of classnames, all non-abstract sub-classes will be boxed\n * @param {string} graph - target graph, optional - default is db:schema\n * @return {object} WOQLQuery\n */\nWOQL.boxClasses = function(prefix, classes, except, graph){\treturn new WOQLQuery().boxClasses(prefix, classes, except, graph); }\n\nWOQL.libs = function(...libs){ return new WOQLQuery().libs(...libs)}\n\nWOQL.generateChoiceList = function(cls, clslabel, clsdesc, choices, graph, parent){ return new WOQLQuery().generateChoiceList(cls, clslabel, clsdesc, choices, graph, parent)}\n\n/**\n * Deletes the Class with the passed ID form the schema (and all references to it)\n * @param {string} classid - class to be added\n * @param {string} graph - target graph\n * @return {object} WOQLQuery\n */\nWOQL.delete_class = function(classid, graph){\treturn new WOQLQuery().delete_class(classid, graph); }\n\n/**\n * Deletes the property with the passed ID from the schema (and all references to it)\n * @param {string} propid - property id to be added\n * @param {string} graph - target graph, optional\n * @return {object} WOQLQuery\n */\nWOQL.delete_property = function(propid, graph){\treturn new WOQLQuery().delete_property(propid, graph); }\n\n\n/**\n * Insert a node with a specific type in a graph\n * @param {string} Node - node to be insert\n * @param {string} Type - type of the node\n * @param {string} Graph - target graph, optional\n * @return {object} WOQLQuery\n */\nWOQL.insert = function(Node, Type, Graph){\n\tvar q = new WOQLQuery();\n\tif(Graph){\n\t\treturn q.add_quad(Node, \"rdf:type\", q.cleanType(Type), Graph);\n\t}\n\telse {\n\t\treturn q.add_triple(Node, \"rdf:type\", q.cleanType(Type));\n\t}\n}\n\n/**\n * Creates a new document class in the schema - equivalent to: add_quad(type, \"rdf:type\", \"owl:Class\", graph), add_quad(type, subclassof, tcs:Document, graph)\n * @param {string} Type - type of the docuemnt\n * @param {string} Graph - target graph, optional\n * @return {object} WOQLQuery\n */\nWOQL.doctype = function(Type, Graph){\n\treturn new WOQLQuery().add_class(Type, Graph).parent(\"Document\");\n}\n\n\n/*\n * Beneath here are pseudo predicates - they belong to the javascript object\n * but not to the WOQL language\n */\n//returns empty query object\n\n/**\n * Creates a new Empty Query object\n * @return {object} WOQLQuery\n */\nWOQL.query = function(){\treturn new WOQLQuery(); }\n\n//loads query from json\n\n/**\n * Generates a WOQLQuery object from the passed WOQL JSON\n * @param {object} json - JSON-LD object, optional\n * @return {object} WOQLQuery\n *\n * json version of query for passing to api\n */\nWOQL.json = function(json){\treturn new WOQLQuery().json(json); }\n\n\n\n\n/**\n * The WOQL Query object implements the WOQL language via the fluent style\n * @param query - json version of query\n * @returns WOQLQuery object\n */\nfunction WOQLQuery(query){\n\tthis.query = (query ? query : {});\n\tthis.cursor = this.query;\n\tthis.chain_ended = false;\n\tthis.contains_update = false;\n\t// operators which preserve global paging\n\tthis.paging_transitive_properties = ['select', 'from', 'start', 'when', 'opt', 'limit'];\n\tthis.vocab = this.loadDefaultVocabulary();\n\t//object used to accumulate triples from fragments to support usage like node(\"x\").label(\"y\");\n\tthis.tripleBuilder = false;\n\treturn this;\n}\n\n/**\n * Takes an array of variables, an optional array of column names\n */\nWOQLQuery.prototype.get = function(arr1, arr2, target){\n\tif(arr1.json){\n\t\tvar map = arr1.json();\n\t\ttarget = arr2;\n\t}\n\telse {\n\t\tvar map = this.buildAsClauses(arr1, arr2);\n\t}\n\tif(target){\n\t\tif(target.json) target = target.json();\n\t\tthis.cursor['get'] = [map, target];\n\t}\n\telse {\n\t\tthis.cursor['get'] = [map, {}];\n\t\tthis.cursor = this.cursor[\"get\"][1];\n\t}\n\treturn this;\n}\n\n/**\n * Takes an array of variables, an optional array of column names\n */\nWOQLQuery.prototype.put = function(arr1, query, target){\n\tif(arr1.json){\n\t\tarr1 = arr1.json();\n\t}\n\tif(query.json){\n\t\tquery = query.json();\n\t}\n\tthis.cursor['put'] = [arr1, query];\n\tif(target){\n\t\tif(target.json) target = target.json();\n\t\tthis.cursor['put'].push(target);\n\t}\n\telse {\t\n\t\tthis.cursor['put'].push({});\n\t\tthis.cursor = this.cursor[\"put\"][2];\n\t}\n\treturn this;\n}\n\n\n/**\n * Takes an array of variables, an optional array of column names\n */\nWOQLQuery.prototype.with = function(gid, remq, subq){\n\tthis.cursor['with'] = [gid];\n\tif(remq){\n\t\tremq = (remq.json ? remq.json() : remq);\n\t\tif(subq){\n\t\t\tif(subq.json) subq = subq.json();\n\t\t\tthis.cursor['with'] = [gid, remq, subq];\n\t\t}\n\t\telse {\n\t\t\tthis.cursor['with'] = [gid, remq];\n\t\t\t//this.cursor = this.cursor[\"with\"][2];\n\t\t}\n\t}\n\telse {\n\t\tthis.cursor['with'][1] = remq;\n\t\tthis.cursor = this.cursor[\"with\"][2]; \n\t}\n\treturn this;\n}\n\n\nWOQLQuery.prototype.buildAsClauses = function(vars, cols){\n\tvar clauses = [];\n\tif(vars && typeof vars == \"object\" && vars.length){\n\t\tfor(var i = 0; i<vars.length; i++){\n\t\t\tvar v = vars[i];\n\t\t\tif(cols && typeof cols == \"object\" && cols.length){\n\t\t\t\tvar c = cols[i];\n\t\t\t\tif(typeof c == \"string\"){\n\t\t\t\t\tc = {\"@value\": c};\n\t\t\t\t}\n\t\t\t\tclauses.push({as: [c, v]});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tv.as ? clauses.push(v) : clauses.push({as: [v]});\n\t\t\t}\n\t\t}\n\t}\n\treturn clauses;\n}\n\nWOQLQuery.prototype.typecast = function(va, type, vb){\n\tthis.cursor['typecast'] = [va, type, vb];\n\treturn this;\n}\n\n/**\n * Shorthand of above\n */\nWOQLQuery.prototype.cast = WOQLQuery.prototype.typecast;\n\n\nWOQLQuery.prototype.length = function(va, vb){\n\tthis.cursor['length'] = [va, vb];\n\treturn this;\n}\n\nWOQLQuery.prototype.remote = function(json, opts){\n\tthis.cursor['remote'] = (opts ? [json, opts] : [json]);\n\treturn this;\n}\n\nWOQLQuery.prototype.post = function(json, opts){\n\tthis.cursor['post'] = (opts ? [json, opts] : [json]);\n\treturn this;\n}\n\nWOQLQuery.prototype.file = function(json, opts){\n\tthis.cursor['file'] = (opts ? [json, opts] : [json]);\n\treturn this;\n}\n\nWOQLQuery.prototype.order_by = function(asc_or_desc, query){\n\tlet ovars = [];\n\tif(Array.isArray(asc_or_desc)){\n\t\tfor(var i = 0; i<asc_or_desc.length; i++){\n\t\t\tovars.push(asc_or_desc[i].json ? asc_or_desc[i].json() : asc_or_desc[i])\n\t\t}\n\t}\n\telse if(typeof asc_or_desc == \"string\"){\n\t\tovars.push({\"asc\": [asc_or_desc]});\n\t}\n\telse {\n\t\tovars.push(asc_or_desc.json ? asc_or_desc.json() : asc_or_desc)\n\t}\n\tthis.cursor[\"order_by\"] = [ovars]\n\tif(query){\n\t\tthis.cursor[\"order_by\"] .push(query.json ? query.json() : query);\n\t}\n\telse {\n\t\tthis.cursor[\"order_by\"].push({});\n\t\tthis.cursor = this.cursor[\"order_by\"][1]\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.asc = function(varlist_or_var){\n\tif(!Array.isArray(varlist_or_var)){\n\t\tvarlist_or_var = [varlist_or_var];\n\t}\n\tthis.cursor[\"asc\"] = varlist_or_var;\n\treturn this;\n}\n\nWOQLQuery.prototype.desc = function(varlist_or_var){\n\tif(!Array.isArray(varlist_or_var)){\n\t\tvarlist_or_var = [varlist_or_var];\n\t}\n\tthis.cursor[\"desc\"] = varlist_or_var;\n\treturn this;\n}\n\nWOQLQuery.prototype.group_by = function(gvarlist, groupedvar, groupquery, output){\n\tvar args = [];\n\tthis.cursor['group_by'] = args;\n\tif(gvarlist.json){\n\t\targs.push(gvarlist.json());\n\t}\n\tif(gvarlist['list']){\n\t\targs.push(gvarlist);\n\t}\n\telse {\n\t\targs.push({'list': gvarlist});\n\t}\n\tif(typeof groupedvar == \"object\" && Array.isArray(groupedvar)){\n\t\tconst ng = UTILS.addNamespacesToVariables(groupedvar);\n\t\tgroupedvar = {\"list\": ng};\n\t}\n\telse if(typeof groupedvar == \"string\"){\n\t\tgroupedvar = UTILS.addNamespaceToVariable(groupedvar);\n\t}\n\targs.push(groupedvar);\n\tif(output){\n\t\tgroupquery = groupquery.json ? groupquery.json() : groupquery;\n\t\targs.push(groupquery);\n\t}\n\telse {\n\t\toutput = groupquery;\n\t\tvar sq = {};\n\t\tthis.cursor = sq;\n\t\targs.push(sq);\n\t}\n\targs.push(UTILS.addNamespaceToVariable(output));\n\treturn this;\n}\n\nWOQLQuery.prototype.idgen = function(prefix, vari, type, mode){\n\tthis.cursor['idgen'] = [prefix];\n\tif(vari.json){\n\t\tthis.cursor['idgen'].push(vari.json());\n\t}\n\telse if(vari.list){\n\t\tthis.cursor['idgen'].push(vari);\n\t}\n\telse {\n\t\tif(!Array.isArray(vari)) vari = [vari];\n\t\tlet nvaris = [];\n\t\tfor(var i = 0 ; i<vari.length; i++){\n\t\t\tlet vr = vari[i];\n\t\t\tif(typeof vr == \"string\"){\n\t\t\t\tif(vr.substring(0,2) != \"v:\"){\n\t\t\t\t\tvr = {\"@value\" : vr, \"@type\": \"xsd:string\"}\n\t\t\t\t}\n\t\t\t}\n\t\t\tnvaris.push(vr);\n\t\t}\n\t\tthis.cursor['idgen'].push({\"list\": nvaris})\n\t}\n\tif(mode){\n\t\tthis.cursor['idgen'].push(mode);\n\t}\n\tthis.cursor['idgen'].push(type);\n\treturn this;\n}\n\n\nWOQLQuery.prototype.unique = function(prefix, vari, type){\n\tthis.cursor['unique'] = [prefix];\n\tif(vari.json){\n\t\tthis.cursor['unique'].push(vari.json());\n\t}\n\telse if(vari.list){\n\t\tthis.cursor['unique'].push(vari);\n\t}\n\telse {\n\t\tlet nvaris = [];\n\t\tif(!Array.isArray(vari)) vari = [vari];\n\t\tfor(var i = 0 ; i<vari.length; i++){\n\t\t\tlet vr = vari[i];\n\t\t\tif(typeof vr == \"string\"){\n\t\t\t\tif(vr.substring(0,2) != \"v:\"){\n\t\t\t\t\tvr = {\"@value\" : vr, \"@type\": \"xsd:string\"}\n\t\t\t\t}\n\t\t\t}\n\t\t\tnvaris.push(vr);\n\t\t}\n\t\tthis.cursor['unique'].push({\"list\": nvaris})\n\t}\n\tthis.cursor['unique'].push(type);\n\treturn this;\n}\n\nWOQLQuery.prototype.re = function(p, s, m){\n\tp = this.packString(p)\n\ts = this.packString(s)\n\tif(typeof m == \"string\") m = [m];\n\tif(!m.list){\n\t\tm = {list: m};\n\t}\n\tthis.cursor['re'] = [p, s, m];\n\treturn this;\n}\n\n\nWOQLQuery.prototype.concat = function(list, v){\n\tif(typeof list == \"string\"){\n\t\tvar nlist = list.split(/(v:[\\w_]+)\\b/);\n\t\tfor(var i = 1; i<nlist.length; i++){\n\t\t\tif(nlist[i-1].substring(nlist[i-1].length-1) == \"v\" && nlist[i].substring(0, 1) == \":\"){\n\t\t\t\tnlist[i-1] = nlist[i-1].substring(0, nlist[i-1].length-1);\n\t\t\t\tnlist[i] = nlist[i].substring(1);\n\t\t\t}\n\t\t}\n\t}\n\telse if(list.list){\n\t\tvar nlist = list.list;\n\t}\n\telse if(typeof list == \"object\"){\n\t\tvar nlist = list;\n\t}\n\tvar args = this.packStrings(nlist);\n\tif(v.indexOf(\":\") == -1) v = \"v:\" + v;\n\tthis.cursor['concat'] = [{\"list\": args}, v];\n\treturn this;\n};\n\nWOQLQuery.prototype.lower = function(u, l){\n\tthis.cursor['lower'] = [u, l];\n\treturn this;\n};\n\nWOQLQuery.prototype.pad = function(input, pad, len, output){\n\tpad = this.packString(pad)\n\tthis.cursor['pad'] = [input, pad, len, output];\n\treturn this;\n}\n\nWOQLQuery.prototype.member = function(El, List){\n\tthis.cursor['member'] = [El, List];\n\treturn this;\n}\n\nWOQLQuery.prototype.join = function(input, glue, output){\n\tglue = this.packString(glue);\n\tthis.cursor['join'] = [input, glue, output];\n\treturn this;\n}\n\nWOQLQuery.prototype.split = function(input, glue, output){\n\tglue = this.packString(glue);\n\tinput = this.packString(input);\n\tthis.cursor['split'] = [input, glue, output];\n\treturn this;\n}\n\n\nWOQLQuery.prototype.less = function(v1, v2){\n\tv1 = (v1.json ? v1.json() : v1);\n\tv2 = (v2.json ? v2.json() : v2);\n\tthis.cursor['less'] = [v1, v2];\n\treturn this;\n}\n\nWOQLQuery.prototype.greater = function(v1, v2){\n\tv1 = (v1.json ? v1.json() : v1);\n\tv2 = (v2.json ? v2.json() : v2);\n\tthis.cursor['greater'] = [v1, v2];\n\treturn this;\n}\n\nWOQLQuery.prototype.list  = function(...vars){\n\tthis.cursor['list'] = vars;\n\treturn this;\n}\n\n\n/*\n * json version of query for passing to api\n */\nWOQLQuery.prototype.json = function(json){\n\tif(json){\n\t\tthis.query = json;\n\t\treturn this;\n\t}\n\treturn this.query;\n}\n\n/*\n * Functions which take a query as an argument advance the cursor to make the chaining of queries fall\n * into the corrent place in the encompassing json\n */\nWOQLQuery.prototype.when = function(Query, Update){\n\tif(typeof Query == 'boolean'){\n\t\tif(Query){\n\t\t\tthis.cursor[\"when\"] = [{\"true\": []}, {}];\n\t\t}\n\t\telse {\n\t\t\tthis.cursor[\"when\"] = [{\"false\": []}, {}];\n\t\t}\n\t}\n\telse {\n\t\tvar q = (Query.json ? Query.json() : Query);\n\t\tthis.cursor['when'] = [q, {}];\n\t}\n\tif(Update){\n\t\tvar upd = (Update.json ? Update.json() : Update);\n\t\tthis.cursor[\"when\"][1] = upd;\n\t}\n\tthis.cursor = this.cursor[\"when\"][1];\n\treturn this;\n}\n\nWOQLQuery.prototype.opt = function(query){\n\tif(query){\n\t\tvar q = ((typeof query.json == \"function\") ? query.json() : query);\n\t\tthis.cursor[\"opt\"] = [q];\n\t}\n\telse {\n\t\tthis.cursor['opt'] = [{}];\n\t\tthis.cursor = this.cursor[\"opt\"][0];\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.from = function(dburl, query){\n\tthis.advanceCursor(\"from\", dburl);\n\tif(query){\n\t\tthis.cursor = (query.json ? query.json() : query);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.into = function(dburl, query){\n\tthis.advanceCursor(\"into\", dburl);\n\tif(query){\n\t\tthis.cursor = (query.json ? query.json() : query);\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.limit = function(limit, query){\n\tthis.advanceCursor(\"limit\", limit);\n\tif(query){\n\t\tthis.cursor = (query.json ? query.json() : query);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.start = function(start, query){\n\tthis.advanceCursor(\"start\", start);\n\tif(query){\n\t\tthis.cursor = (query.json ? query.json() : query);\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.select = function (...list) {\n\tthis.cursor.select = list;\n\tconst index = list.length;\n\tif (typeof this.cursor.select[index - 1] === 'object') {\n\t\tlet embedquery = this.cursor.select[index - 1];\n\t\tthis.cursor.select[index - 1] = (embedquery.json ? embedquery.json() : embedquery);\n\t} else {\n\t\tthis.cursor.select[index] = {};\n\t\tthis.cursor = this.cursor.select[index];\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.and = function (...queries) {\n\tthis.cursor.and = this.cursor.and || [];\n\tfor (let i = 0; i < queries.length; i++) {\n\t\tif (queries[i].contains_update) this.contains_update = true;\n\t\tvar nquery = (queries[i].json ? queries[i].json() : queries[i]);\n\t\tif(nquery['and']){\n\t\t\tthis.cursor.and = this.cursor.and.concat(nquery['and']);\n\t\t}\n\t\telse {\n\t\t\tthis.cursor.and.push(nquery);\n\t\t}\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.or = function (...queries) {\n\tthis.cursor.or = this.cursor.or || [];\n\tfor (let i = 0; i < queries.length; i++) {\n\t\tif (queries[i].contains_update) this.contains_update = true;\n\t\tvar nquery = (queries[i].json ? queries[i].json() : queries[i]);\n\t\tif(nquery['or']){\n\t\t\tthis.cursor.and = this.cursor.or.concat(nquery['or']);\n\t\t}\n\t\telse {\n\t\t\tthis.cursor.or.push(nquery);\n\t\t}\n\t}\n\treturn this;\n};\n\n/**\n * Negation of passed or chained query\n */\nWOQLQuery.prototype.not = function (query) {\n\tif (query) {\n\t\tif (query.contains_update) this.contains_update = true;\n\t\tif(query.json) query = query.json();\n\t\tthis.cursor.not = [query];\n\t} else {\n\t\tthis.cursor.not = [{}];\n\t\tthis.cursor = this.cursor.not[0];\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.triple = function(a, b, c){\n\tthis.cursor[\"triple\"] = [this.cleanSubject(a),this.cleanPredicate(b),this.cleanObject(c)];\n\treturn this.chainable(\"triple\", this.cleanSubject(a));\n}\n\nWOQLQuery.prototype.quad = function(a, b, c, g){\n\tthis.cursor[\"quad\"] = [this.cleanSubject(a),this.cleanPredicate(b),this.cleanObject(c),this.cleanGraph(g)];\n\treturn this.chainable(\"quad\", this.cleanSubject(a));\n}\n\nWOQLQuery.prototype.eq = function(a, b){\n\tthis.cursor[\"eq\"] = [this.cleanObject(a),this.cleanObject(b)];\n\treturn this.last();\n};\n\nWOQLQuery.prototype.sub = function(a, b){\n\tif(!b && this.tripleBuilder){\n\t\tthis.tripleBuilder.sub(this.cleanClass(a));\n\t\treturn this;\n\t}\n\tthis.cursor[\"sub\"] = [this.cleanClass(a),this.cleanClass(b)];\n\treturn this.last(\"sub\", a);\n}\n\nWOQLQuery.prototype.comment = function(val){\n\tif(val && val.json){\n\t\tthis.cursor['comment'] = [val.json()];\n\t}\n\telse if(typeof val == \"string\"){\n\t\tthis.cursor['comment'] = [{\"@value\": val, \"@language\": \"en\"}];\n\t}\n\telse if(typeof val == \"object\"){\n\t\tif(val.length) this.cursor['comment'] = val;\n\t\telse this.cursor['comment'] = [val];\n\t}\n\telse {\n\t\tthis.cursor['comment'] = [];\n\t}\n\tvar last_index = this.cursor['comment'].length;\n\tthis.cursor['comment'][last_index] = {};\n\tthis.cursor = this.cursor['comment'][last_index];\n\treturn this;\n}\n\n\nWOQLQuery.prototype.abstract = function(varname, gname){\n\tif(varname){\n\t\tgname = gname || \"db:schema\";\n\t\treturn this.quad(varname, \"tcs:tag\", \"tcs:abstract\", gname);\n\t}\n\telse if(this.tripleBuilder){\n\t\tthis.tripleBuilder.abstract();\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.isa = function(a, b){\n\tif(!b && this.tripleBuilder){\n\t\tthis.tripleBuilder.isa(this.cleanClass(a));\n\t\treturn this;\n\t}\n\tif(b){\n\t\tthis.cursor[\"isa\"] = [this.cleanClass(a),this.cleanClass(b)];\n\t\treturn this.chainable(\"isa\", a);\n\t}\n}\n\nWOQLQuery.prototype.trim = function(a, b){\n\tthis.cursor['trim'] = [a, b];\n\treturn this.chainable('trim', b);\n}\n\nWOQLQuery.prototype.eval = function(arith, v){\n\tarith = arith.json ? arith.json() : arith;\n\tthis.cursor['eval'] = [arith, v];\n\treturn this.chainable('eval', v);\n}\n\nWOQLQuery.prototype.plus = function (...args) {\n\tthis.cursor.plus = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.plus.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.sum = function (input, output) {\n\tthis.cursor.sum = [input, output];\n\treturn this.last();\n}\n\nWOQLQuery.prototype.minus = function (...args) {\n\tthis.cursor.minus = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.minus.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.times = function (...args) {\n\tthis.cursor.times = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.times.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.divide = function (...args) {\n\tthis.cursor.divide = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.divide.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.div = function (...args) {\n\tthis.cursor.div = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.div.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.exp = function (a, b) {\n\ta = (a.json ? a.json() : a);\n\tb = (b.json ? b.json() : b);\n\tthis.cursor.exp = [a, b];\n\treturn this.last();\n};\n\nWOQLQuery.prototype.delete = function (JSON_or_IRI) {\n\tthis.cursor.delete = [JSON_or_IRI];\n\treturn this.lastUpdate();\n};\n\nWOQLQuery.prototype.delete_triple = function( Subject, Predicate, Object_or_Literal ){\n\tthis.cursor['delete_triple'] = [this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal)];\n\treturn this.chainableUpdate('delete_triple', Subject);\n}\n\nWOQLQuery.prototype.add_triple = function( Subject, Predicate, Object_or_Literal ){\n\tthis.cursor['add_triple'] =[this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal)];\n\treturn this.chainableUpdate('add_triple', Subject);\n}\n\nWOQLQuery.prototype.delete_quad = function( Subject, Predicate, Object_or_Literal, Graph ){\n\tthis.cursor['delete_quad'] =[this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal),this.cleanGraph(Graph)];\n\treturn this.chainableUpdate('delete_quad', Subject);\n}\n\nWOQLQuery.prototype.add_quad = function( Subject, Predicate, Object_or_Literal, Graph){\n\tthis.cursor['add_quad'] = [this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal),this.cleanGraph(Graph)];\n\treturn this.chainableUpdate(\"add_quad\", Subject);\n}\n\nWOQLQuery.prototype.update = function(woql){\n\tthis.cursor['update'] = [ woql.json() ];\n\treturn this.lastUpdate();\n}\n\n/**\n * Schema manipulation shorthand\n */\nWOQLQuery.prototype.add_class = function(c, graph){\n\tif(c){\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\n\t\tc = (c.indexOf(\":\") == -1) ? \"scm:\" + c : c;\n\t\tthis.adding_class = c;\n\t\tthis.add_quad(c,\"rdf:type\",\"owl:Class\",graph);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.add_property = function(p, t, g){\n\tt = (t ? t : \"xsd:string\");\n\tif(p){\n\t\tvar graph = (g ? this.cleanGraph(g) : \"db:schema\");\n\t\tp = (p.indexOf(\":\") == -1) ?  \"scm:\" + p : p;\n\t\tt = (t.indexOf(\":\") == -1) ? this.cleanType(t) : t ;\n\t\tvar tc = this.cursor;\n\t\tvar pref = t.split(\":\");\n\t\tif(pref[0] && (pref[0] == \"xdd\" || pref[0] == \"xsd\")) {\n\t\t    this.and(\n\t\t\t\tWOQL.add_quad(p, \"rdf:type\", \"owl:DatatypeProperty\", graph),\n\t\t\t\tWOQL.add_quad(p, \"rdfs:range\", t, graph)\n\t\t\t);\n\t\t}\n\t\telse {\n\t\t\tthis.and(\n\t\t\t\tWOQL.add_quad(p, \"rdf:type\", \"owl:ObjectProperty\", graph),\n\t\t\t\tWOQL.add_quad(p, \"rdfs:range\", t, graph)\n\t\t\t);\n\t\t}\n\t}\n\treturn this.chainableUpdate(\"add_quad\", p);\n}\n\nWOQLQuery.prototype.delete_class = function(c, graph){\n\tif(c){\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\n\t\tc = (c.indexOf(\":\") == -1) ?  \"scm:\" + c : c;\n\t\treturn this.and(\n\t\t\tWOQL.delete_quad(c, \"v:All\", \"v:Al2\", graph),\n\t\t\tWOQL.opt().delete_quad(\"v:Al3\", \"v:Al4\", c, graph)\n\t\t);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.delete_property = function(p, graph){\n\tif(p){\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\n\t\tp = (p.indexOf(\":\") == -1) ? \"scm:\" + p : p;\n\t\treturn this.and(\n\t\t\tWOQL.delete_quad(p, \"v:All\", \"v:Al2\", graph),\n\t\t\tWOQL.delete_quad(\"v:Al3\", \"v:Al4\", p, graph)\n\t\t);\n\t}\n\treturn this;\n}\n\n//requires classes to have first character capitalised\nWOQLQuery.prototype.boxClasses = function(prefix, classes, except, graph){\t\n\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\n\tprefix = prefix || \"scm:\";\n\tvar subs = [];\n\tfor(var i = 0; i<classes.length; i++){\n\t\tsubs.push(WOQL.sub(\"v:Cid\", this.cleanClass(classes[i])));\n\t}\n\tvar nsubs = [];\n\tfor(var i = 0; i<except.length; i++){\n\t\tnsubs.push(WOQL.not().sub(\"v:Cid\", this.cleanClass(except[i])));\n\t}\n\t//property punning\n\t//generate a property id that is the same as the classname but starting with a lowercase letter\n\tlet idgens = [\n\t\tWOQL.re(\"#(.)(.*)\", \"v:Cid\", [\"v:AllB\", \"v:FirstB\", \"v:RestB\"]),\n        WOQL.lower(\"v:FirstB\", \"v:Lower\"),\n        WOQL.concat([\"v:Lower\", \"v:RestB\"], \"v:Propname\"),\n        WOQL.concat([\"Scoped\", \"v:FirstB\", \"v:RestB\"], \"v:Cname\"),\n        WOQL.idgen(prefix, [\"v:Cname\"], \"v:ClassID\"),\n        WOQL.idgen(prefix, [\"v:Propname\"], \"v:PropID\")\n\t];\n\n    const filter = WOQL.and(\n\t\tWOQL.quad(\"v:Cid\", \"rdf:type\", \"owl:Class\", graph),\n\t\tWOQL.not().abstract(\"v:Cid\", graph),\n\t\tWOQL.or(...subs),\n\t\tWOQL.and(...nsubs),\n\t\tWOQL.and(...idgens),\n        WOQL.quad(\"v:Cid\", \"rdfs:label\", \"v:Label\", graph),\n\t\tWOQL.quad(\"v:Cid\", \"rdfs:comment\", \"v:Desc\", graph)\n    )\n    return WOQL.when(filter, WOQL.and(\n        WOQL.add_class(\"v:ClassID\")\n            .label(\"v:Label\")\n            .description(\"v:Desc\"),\n        WOQL.add_property(\"v:PropID\", \"v:Cid\")\n            .label(\"v:Label\")\n            .description(\"v:Desc\")\n\t\t    .domain(\"v:ClassID\")\n    ));\n}\n\nWOQLQuery.prototype.generateChoiceList = function(cls, clslabel, clsdesc, choices, graph, parent){\n    parent = parent || \"scm:Enumerated\";\n    graph = graph || \"db:schema\";\n    var confs = [\n        WOQL.add_class(cls, graph)\n            .label(clslabel)\n            .description(clsdesc)\n            .parent(parent)\n    ]; \n    for(var i = 0; i<choices.length; i++){\n        if(!choices[i]) continue;\n        confs.push(WOQL.insert(choices[i][0], cls, graph)\n            .label(choices[i][1])\n            .description(choices[i][2])\n        )\n    }\n    //generate one of list\n    var clist = [];\n    var listid = \"_:\" + cls.split(\":\")[1];\n    var lastid = listid;\n    for(var i = 0; i <= choices.length; i++){\n        if(!choices[i]) continue;\n        var nextid = (i < (choices.length -1) ? listid + \"_\" + i : \"rdf:nil\");\n        clist.push( WOQL.add_quad(lastid, \"rdf:first\", choices[i][0], graph))\n        clist.push( WOQL.add_quad(lastid, \"rdf:rest\", nextid, graph));\n        lastid = nextid;\n    }\n    //do the owl oneof\n    let oneof = WOQL.and(\n        WOQL.add_quad(cls, \"owl:oneOf\", listid, graph),\n        ...clist\n    )\n    return WOQL.and(...confs, oneof);\n}\n\n\nWOQLQuery.prototype.libs = function(...libs){\n\tvar bits = [];\n\tif(libs.indexOf(\"xdd\") != -1){\n\t\tbits.push(this.loadXDD());\n\t\tif(libs.indexOf(\"box\") != -1) {\n\t\t\tbits.push(this.loadXDDBoxes());\n\t\t\tbits.push(this.loadXSDBoxes());\n\t\t}\n\t}\n\telse if(libs.indexOf(\"box\") != -1){\n\t\tbits.push(this.loadXSDBoxes());\n\t}\n\tif(bits.length > 1) return WOQL.and(...bits);\n\treturn bits[0];\n}\n\nWOQLQuery.prototype.loadXDD = function(graph){\n\treturn WOQL.and(\n\t\t//geograhpic datatypes\n\t\tthis.addDatatype(\"xdd:coordinate\", \"Coordinate\", \n\t\t\t\"A latitude / longitude pair making up a coordinate, encoded as: [lat,long]\", graph),\n\t\tthis.addDatatype(\"xdd:coordinatePolygon\", \"Coordinate Polygon\", \n\t\t\t\"A JSON list of [[lat,long]] coordinates forming a closed polygon.\", graph),\n\t\tthis.addDatatype(\"xdd:coordinatePolyline\", \"Coordinate Polyline\", \n\t\t\t\"A JSON list of [[lat,long]] coordinates.\", graph),\n\t\t\n\t\t//uncertainty range datatypes\n\t\tthis.addDatatype(\"xdd:dateRange\", \"Date Range\", \n\t\t\t`A date (YYYY-MM-DD) or an uncertain date range [YYYY-MM-DD1,YYYY-MM-DD2]. \n\t\t\tEnables uncertainty to be encoded directly in the data`, graph),\n\t\tthis.addDatatype(\"xdd:decimalRange\", \"Decimal Range\", \n\t\t\t`Either a decimal value (e.g. 23.34) or an uncertain range of decimal values \n\t\t\t(e.g.[23.4, 4.143]. Enables uncertainty to be encoded directly in the data`),\n\t\tthis.addDatatype(\"xdd:integerRange\", \"Integer Range\", \n\t\t\t`Either an integer (e.g. 30) or an uncertain range of integers [28,30]. \n\t\t\tEnables uncertainty to be encoded directly in the data`, graph),\n\t\tthis.addDatatype(\"xdd:gYearRange\", \"Year Range\", \n\t\t\t`A year (e.g. 1999) or an uncertain range of years: (e.g. [1999,2001]). \n\t\t\tEnables uncertainty to be encoded directly in the data`, graph),\n\t\n\t\t//string refinement datatypes\n\t\tthis.addDatatype(\"xdd:email\", \"Email\", \"A valid email address\", graph),\n\t\tthis.addDatatype(\"xdd:html\", \"HTML\", \"A string with embedded HTML\", graph),\n\t\tthis.addDatatype(\"xdd:json\", \"JSON\", \"A JSON encoded string\", graph),\n\t\tthis.addDatatype(\"xdd:url\", \"URL\", \"A valid http(s) URL\", graph)\n\t)\n}\n\nWOQLQuery.prototype.loadXSDBoxes = function(){\n\treturn WOQL.and(\n\t\tthis.boxDatatype(\"xsd:anySimpleType\", \"Any Simple Type\", \"Any basic data type such as string or integer. An xsd:anySimpleType value.\"),\n\t\tthis.boxDatatype(\"xsd:string\", \"String\", \"Any text or sequence of characters\"),\n\t\tthis.boxDatatype(\"xsd:boolean\", \"Boolean\", \"A true or false value. An xsd:boolean value.\"),\n\t   \tthis.boxDatatype(\"xsd:decimal\", \"Decimal\", \"A decimal number. An xsd:decimal value.\"),\n\t   \tthis.boxDatatype(\"xsd:double\",  \"Double\", \"A double-precision decimal number. An xsd:double value.\"),\n\t   \tthis.boxDatatype(\"xsd:float\", \"Float\", \"A floating-point number. An xsd:float value.\"),\n\t   \tthis.boxDatatype(\"xsd:time\", \"Time\", \"A time. An xsd:time value. hh:mm:ss.ssss\"),\n\t   \tthis.boxDatatype(\"xsd:date\", \"Date\", \"A date. An xsd:date value. YYYY-MM-DD\"),\n\t\tthis.boxDatatype(\"xsd:dateTime\", \"Date Time\", \"A date and time. An xsd:dateTime value.\"),\n\t\tthis.boxDatatype(\"xsd:dateTimeStamp\", \"Date-Time Stamp\", \"An xsd:dateTimeStamp value.\"),\n\t\tthis.boxDatatype(\"xsd:gYear\", \"Year\", \" A particular 4 digit year YYYY - negative years are BCE.\"),\n\t\tthis.boxDatatype(\"xsd:gMonth\", \"Month\", \"A particular month. An xsd:gMonth value. --MM\"),\n\t\tthis.boxDatatype(\"xsd:gDay\", \"Day\", \"A particular day. An xsd:gDay value. ---DD\"),\n\t\tthis.boxDatatype(\"xsd:gYearMonth\", \"Year / Month\", \"A year and a month. An xsd:gYearMonth value.\"),\n\t\tthis.boxDatatype(\"xsd:gMonthDay\", \"Month / Day\", \"A month and a day. An xsd:gMonthDay value.\"),\n\t\tthis.boxDatatype(\"xsd:duration\", \"Duration\", \"A period of time. An xsd:duration value.\"),\n\t\tthis.boxDatatype(\"xsd:yearMonthDuration\", \"Year / Month Duration\", \"A duration measured in years and months. An xsd:yearMonthDuration value.\"),\n\t\tthis.boxDatatype(\"xsd:dayTimeDuration\", \"Day / Time Duration\", \"A duration measured in days and time. An xsd:dayTimeDuration value.\"),\n\t\tthis.boxDatatype(\"xsd:byte\", \"Byte\", \"An xsd:byte value.\"),\n\t\tthis.boxDatatype(\"xsd:short\", \"Short\", \"An xsd:short value.\"),\n\t\tthis.boxDatatype(\"xsd:integer\", \"Integer\", \"A simple number. An xsd:integer value.\"),\n\t\tthis.boxDatatype(\"xsd:long\", \"Long\", \"An xsd:long value.\"),\n\t\tthis.boxDatatype(\"xsd:unsignedByte\", \"Unsigned Byte\", \"An xsd:unsignedByte value.\"),\n\t\tthis.boxDatatype(\"xsd:unsignedInt\", \"Unsigned Integer\", \"An xsd:unsignedInt value.\"),\n\t\tthis.boxDatatype(\"xsd:unsignedLong\", \"Unsigned Long Integer\", \"An xsd:unsignedLong value.\"),\n\t\tthis.boxDatatype(\"xsd:positiveInteger\", \"Positive Integer\", \"A simple number greater than 0. An xsd:positiveInteger value.\"),\n\t\tthis.boxDatatype(\"xsd:nonNegativeInteger\", \"Non-Negative Integer\", \"A simple number that can't be less than 0. An xsd:nonNegativeInteger value.\"),\n\t\tthis.boxDatatype(\"xsd:negativeInteger\", \"Negative Integer\", \"A negative integer. An xsd:negativeInteger value.\"),\n\t\tthis.boxDatatype(\"xsd:nonPositiveInteger\", \"Non-Positive Integer\", \"A number less than or equal to zero. An xsd:nonPositiveInteger value.\"),\n\t\tthis.boxDatatype(\"xsd:base64Binary\", \"Base 64 Binary\",\"An xsd:base64Binary value.\"),\n\t\tthis.boxDatatype(\"xsd:anyURI\", \"Any URI\", \"Any URl. An xsd:anyURI value.\"),\n\t\tthis.boxDatatype(\"xsd:language\", \"Language\", \"A natural language identifier as defined by by [RFC 3066] . An xsd:language value.\"),\n\t\tthis.boxDatatype(\"xsd:normalizedString\", \"Normalized String\", \"An xsd:normalizedString value.\"),\n\t\tthis.boxDatatype(\"xsd:token\", \"Token\", \"An xsd:token value.\"),\n\t\tthis.boxDatatype(\"xsd:NMTOKEN\", \"NMTOKEN\", \"An xsd:NMTOKEN value.\"),\n\t\tthis.boxDatatype(\"xsd:Name\", \"Name\", \"An xsd:Name value.\"),\n\t\tthis.boxDatatype(\"xsd:NCName\", \"NCName\", \"An xsd:NCName value.\"),\n\t\tthis.boxDatatype(\"xsd:NOTATION\", \"NOTATION\", \"An xsd:NOTATION value.\"),\n\t\tthis.boxDatatype(\"xsd:QName\", \"QName\", \"An xsd:QName value.\"),\n\t\tthis.boxDatatype(\"xsd:ID\", \"ID\", \"An xsd:ID value.\"),\n\t\tthis.boxDatatype(\"xsd:IDREF\", \"IDREF\", \"An xsd:IDREF value.\"),\n\t\tthis.boxDatatype(\"xsd:ENTITY\", \"ENTITY\", \"An xsd:ENTITY value.\"),\n\t\t//this.boxDatatype(\"rdf:XMLLiteral\", \"XML Literal\", \"An rdf:XMLLiteral value.\"),\n\t\t//this.boxDatatype(\"rdf:PlainLiteral\", \"Plain Literal\", \"An rdf:PlainLiteral value.\"),\n\t\t//this.boxDatatype(\"rdfs:Literal\", \"Literal\", \"An rdfs:Literal value.\")\t\n\t)\n}\n\nWOQLQuery.prototype.loadXDDBoxes = function(){\n\treturn WOQL.and(\n\t\tthis.boxDatatype(\"xdd:coordinate\", \"Coordinate\", \"A particular location on the surface of the earth, defined by latitude and longitude . An xdd:coordinate value.\"),\n\t\tthis.boxDatatype(\"xdd:coordinatePolygon\", \"Geographic Area\", \"A shape on a map which defines an area. within the defined set of coordinates   An xdd:coordinatePolygon value.\"),\n\t\tthis.boxDatatype(\"xdd:coordinatePolyline\", \"Coordinate Path\", \"A set of coordinates forming a line on a map, representing a route. An xdd:coordinatePolyline value.\"),\n\t\tthis.boxDatatype(\"xdd:url\", \"URL\", \"A valid url.\"),\n\t\tthis.boxDatatype(\"xdd:email\", \"Email\", \"A valid email address.\"), \n\t\tthis.boxDatatype(\"xdd:html\", \"HTML\", \"A safe HTML string\"), \n\t\tthis.boxDatatype(\"xdd:json\", \"JSON\", \"A JSON Encoded String\"), \n\t\tthis.boxDatatype(\"xdd:gYearRange\", \"Year\", \"A 4-digit year, YYYY, or if uncertain, a range of years. An xdd:gYearRange value.\"), \n\t\tthis.boxDatatype(\"xdd:integerRange\", \"Integer\", \"A simple number or range of numbers. An xdd:integerRange value.\"), \n\t\tthis.boxDatatype(\"xdd:decimalRange\", \"Decimal Number\", \"A decimal value or, if uncertain, a range of decimal values. An xdd:decimalRange value.\"), \n\t\tthis.boxDatatype(\"xdd:dateRange\", \"Date Range\",\"A date or a range of dates YYYY-MM-DD\")\n\t)\n}\n\n/* utility function for creating a datatype in woql */\nWOQLQuery.prototype.addDatatype = function(id, label, descr, graph){\n\tgraph = graph || \"db:schema\";\n\tvar dt = WOQL.insert(id, \"rdfs:Datatype\", graph).label(label);\n\tif(descr) dt.description(descr);\n\treturn dt;\n}\n\n/* utility function for creating a datatype in woql */\nWOQLQuery.prototype.boxDatatype = function(datatype, label, descr, graph, prefix){\n\tgraph = graph || \"db:schema\";\n\tprefix = prefix || \"scm:\";\n\tlet ext = datatype.split(\":\")[1];\n\tlet box_class_id = prefix + ext.charAt(0).toUpperCase() + ext.slice(1);\n\tlet box_prop_id = prefix + ext.charAt(0).toLowerCase() + ext.slice(1);\n\tvar box_class = WOQL.add_class(box_class_id).label(label).parent(\"scm:Box\");\n\tif(descr) box_class.description(descr);\n\tvar box_prop = WOQL.add_property(box_prop_id, datatype).label(label).domain(box_class_id)\n\tif(descr) box_prop.description(descr);\n\treturn WOQL.and(box_class, box_prop);\n}\n\n\nWOQLQuery.prototype.as = function(a, b, c){\n\tif(!a) return;\n\tif(!this.asArray){\n\t\tthis.asArray = true;\n\t\tthis.query = [];\n\t}\n\tif(b){\n\t\tb = (b.indexOf(\":\") == -1 ? \"v:\" + b : b);\n\t\tvar val = (typeof a == \"object\" ? a : { \"@value\" : a});\n\n        if(c){\n\t\t    this.query.push({as: [val, b, c]});\n        }else{\n            this.query.push({as: [val, b]});\n        }\n\t}\n\telse {\n\t\ta = (a.indexOf(\":\") == -1 ? \"v:\" + a : a);\n\t\tthis.query.push({as: [a]});\n\t}\n\treturn this;\n}\n\n\n\n/**\n * Internal Triple-builder functions which allow chaining of sub-queries\n */\n\nWOQLQuery.prototype.node = function(node, type){\n\ttype = (type ? type : \"triple\");\n\tthis.tripleBuilder = new TripleBuilder(type, this.cursor, node);\n\treturn this;\n}\n\nWOQLQuery.prototype.max = function(m){\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"max\");\n\treturn this;\n}\n\nWOQLQuery.prototype.cardinality = function(m){\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"cardinality\");\n\treturn this;\n}\n\nWOQLQuery.prototype.min = function(m){\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"min\");\n\treturn this;\n}\n\nWOQLQuery.prototype.graph = function(g){\n\tg = this.cleanGraph(g);\n\tvar t = (this.type == \"triple\") ? \"quad\" : false;\n\tif(this.type == \"add_triple\") t = \"add_quad\";\n\tif(this.type == \"delete_triple\") t = \"delete_quad\";\n\tif(!this.tripleBuilder){\n\t\tthis.tripleBuilder = new TripleBuilder(t, this.cursor);\n\t}\n\tthis.tripleBuilder.graph(g);\n\treturn this;\n}\n\nWOQLQuery.prototype.domain = function(d){\n\td = this.cleanClass(d);\n\tif(this.tripleBuilder) this.tripleBuilder.addPO('rdfs:domain',d);\n\treturn this;\n}\n\nWOQLQuery.prototype.label = function(l, lang){\n\tif(this.tripleBuilder) this.tripleBuilder.label(l, lang);\n\treturn this;\n}\n\nWOQLQuery.prototype.description = function(c, lang){\n\tif(this.tripleBuilder) this.tripleBuilder.description(c, lang);\n\treturn this;\n}\n\nWOQLQuery.prototype.parent = function(...p){\n\tif(this.tripleBuilder){\n\t\tfor(var i = 0 ; i<p.length; i++){\n\t\t\tvar pn = this.cleanClass(p[i]);\n\t\t\tthis.tripleBuilder.addPO('rdfs:subClassOf', pn);\n\t\t}\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.entity = function(...p){\n\treturn this.parent(\"tcs:Entity\");\n}\n\nWOQLQuery.prototype.relationship = function(...p){\n\treturn this.parent(\"tcs:Entity\");\n}\n\nWOQLQuery.prototype.property = function(p,val){\n\tif(this.tripleBuilder) {\n\t\tif(this.adding_class){\n\t\t\tvar nwoql = WOQL.add_property(p, val).domain(this.adding_class);\n\t\t\tnwoql.query.and.push(this.json());\n\t\t\tnwoql.adding_class = this.adding_class;\n\t\t\treturn nwoql;\n\t\t}\n\t\telse {\n\t\t\tp = this.cleanPredicate(p);\n\t\t\tthis.tripleBuilder.addPO(p, val);\n\t\t}\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.star = function(GraphIRI, Subj, Pred, Obj){\n\tSubj = (Subj ? this.cleanSubject(Subj) : \"v:Subject\");\n\tPred = (Pred ? this.cleanPredicate(Pred) : \"v:Predicate\");\n\tObj = (Obj  ? this.cleanObject(Obj) : \"v:Object\");\n\tGraphIRI = (GraphIRI ? this.cleanGraph(GraphIRI) : false);\n\tif(GraphIRI){\n\t\treturn this.quad(Subj, Pred, Obj, GraphIRI);\n\t}\n\telse {\n\t\t//console.log(Subj, Pred, Obj);\n\t\treturn this.triple(Subj, Pred, Obj);\n\t}\n}\n\n/**\n * These are composite functions, the above are primitives\n */\nWOQLQuery.prototype.getEverything = function(GraphIRI){\n\tif(GraphIRI){\n\t\tGraphIRI = this.cleanGraph(GraphIRI);\n\t\treturn this.quad(\"v:Subject\", \"v:Predicate\", \"v:Object\", GraphIRI);\n\t}\n\telse {\n\t\treturn this.triple(\"v:Subject\", \"v:Predicate\", \"v:Object\");\n\t}\n}\n\nWOQLQuery.prototype.getAllDocuments = function(){\n\treturn this.and(\n\t\tWOQL.triple(\"v:Subject\", \"rdf:type\", \"v:Type\"),\n\t\tWOQL.sub(\"v:Type\", \"tcs:Document\")\n\t);\n}\n\nWOQLQuery.prototype.documentMetadata = function(){\n\treturn this.and(\n\t\tWOQL.triple(\"v:ID\", \"rdf:type\", \"v:Class\"),\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:label\", \"v:Label\"),\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:comment\", \"v:Comment\"),\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Type_Comment\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.concreteDocumentClasses = function(){\n\treturn this.and(\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\n\t\tWOQL.not().abstract(\"v:Class\"),\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Comment\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.propertyMetadata = function(){\n\treturn this.and(\n\t\tWOQL.or(\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:DatatypeProperty\", \"db:schema\"),\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:ObjectProperty\", \"db:schema\")\n\t\t),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.elementMetadata = function(){\n\treturn this.and(\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:subClassOf\", \"v:Parent\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.classMetadata = function(){\n\treturn this.and(\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.getDataOfClass = function(chosen){\n\treturn this.and(\n\t\tWOQL.triple(\"v:Subject\", \"rdf:type\", chosen),\n\t\tWOQL.opt().triple(\"v:Subject\", \"v:Property\", \"v:Value\")\n\t);\n}\n\nWOQLQuery.prototype.getDataOfProperty = function(chosen){\n\treturn this.and(\n\t\tWOQL.triple(\"v:Subject\", chosen, \"v:Value\"),\n\t\tWOQL.opt().triple(\"v:Subject\", \"rdfs:label\", \"v:Label\")\n\t);\n}\n\nWOQLQuery.prototype.documentProperties = function(id){\n\treturn this.and(\n\t\tWOQL.triple(id, \"v:Property\", \"v:Property_Value\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.getDocumentConnections = function(id){\n\treturn this.and(\n\t\tWOQL.eq(\"v:Docid\", id),\n\t\tWOQL.or(\n\t\t\tWOQL.triple(id, \"v:Outgoing\", \"v:Entid\"),\n\t\t\tWOQL.triple(\"v:Entid\", \"v:Incoming\", id)\n\t\t),\n\t\tWOQL.triple(\"v:Entid\", \"type\", \"v:Enttype\"),\n\t\tWOQL.sub(\"v:Enttype\", \"tcs:Document\"),\n\t\tWOQL.opt().triple(\"v:Entid\", \"rdfs:label\", \"v:Label\"),\n\t\tWOQL.opt().quad(\"v:Enttype\", \"rdfs:label\", \"v:Class_Label\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.getAllDocumentConnections = function(){\n\treturn this.and(\n\t\tWOQL.sub(\"v:Enttype\", \"tcs:Document\"),\n\t\tWOQL.triple(\"v:doc1\", \"type\", \"v:Enttype\"),\n\t\tWOQL.triple(\"v:doc1\", \"v:Predicate\", \"v:doc2\"),\n\t\tWOQL.triple(\"v:doc2\", \"type\", \"v:Enttype2\"),\n\t\tWOQL.sub(\"v:Enttype2\", \"tcs:Document\"),\n\t\tWOQL.opt().triple(\"v:doc1\", \"rdfs:label\", \"v:Label1\"),\n\t\tWOQL.opt().triple(\"v:doc2\", \"rdfs:label\", \"v:Label2\"),\n\t\tWOQL.not().eq(\"v:doc1\", \"v:doc2\")\n\t);\n}\n\nWOQLQuery.prototype.getInstanceMeta = function(url){\n\treturn this.and(\n\t\tWOQL.triple(url, \"rdf:type\", \"v:InstanceType\"),\n\t\tWOQL.opt().triple(url, \"rdfs:label\", \"v:InstanceLabel\"),\n\t\tWOQL.opt().triple(url, \"rdfs:comment\", \"v:InstanceComment\"),\n\t\tWOQL.opt().quad(\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.simpleGraphQuery = function(){\n\treturn this.and(\n\t    WOQL.triple(\"v:Source\", \"v:Edge\", \"v:Target\"),\n\t    WOQL.isa(\"v:Source\", \"v:Source_Class\"),\n\t    WOQL.sub(\"v:Source_Class\", \"tcs:Document\"),\n\t    WOQL.isa(\"v:Target\", \"v:Target_Class\"),\n\t    WOQL.sub(\"v:Target_Class\", \"tcs:Document\"),\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:label\", \"v:Source_Label\"),\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:comment\", \"v:Source_Comment\"),\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:label\", \"v:Source_Type\", \"db:schema\"),\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:comment\", \"v:Source_Type_Comment\", \"db:schema\"),\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:label\", \"v:Target_Label\"),\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:comment\", \"v:Target_Comment\"),\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:label\", \"v:Target_Type\", \"db:schema\"),\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:comment\", \"v:Target_Type_Comment\", \"db:schema\"),\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:label\", \"v:Edge_Type\", \"db:schema\"),\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:comment\", \"v:Edge_Type_Comment\", \"db:schema\")\n\t);\n}\n\n\n/**\n * Queries the schema graph and loads all the ids found there as vocabulary that can be used without prefixes\n * ignoring blank node ids\n */\nWOQLQuery.prototype.loadVocabulary = function(client){\n\tvar nw = new WOQLQuery().quad(\"v:S\", \"v:P\", \"v:O\", \"db:schema\");\n\tnw.execute(client).then( (result) => {\n\t\tif(result.bindings && result.bindings.length > 0){\n\t\t\tfor(var i = 0; i<result.bindings.length; i++){\n\t\t\t\tfor(var k in result.bindings[i]){\n\t\t\t\t\tvar v = result.bindings[i][k]\n\t\t\t\t\tif(typeof v == \"string\"){\n\t\t\t\t\t\tvar spl = v.split(\":\");\n\t\t\t\t\t\tif(spl.length == 2 && spl[1] && spl[0] != \"_\"){\n\t\t\t\t\t\t\tthis.vocab[spl[0]] = spl[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\n\n/**\n * Provides the query with a 'vocabulary' a list of well known predicates that can be used without prefixes mapping: id: prefix:id ...\n */\nWOQLQuery.prototype.setVocabulary = function(vocab){\n\tthis.vocab = vocab;\n}\n\nWOQLQuery.prototype.getVocabulary = function(vocab){\n\treturn this.vocab;\n}\n\nWOQLQuery.prototype.getLimit = function(){\n\treturn this.getPagingProperty(\"limit\");\n}\n\nWOQLQuery.prototype.setLimit = function(l){\n\treturn this.setPagingProperty(\"limit\", l);\n}\n\nWOQLQuery.prototype.isPaged = function(q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == \"limit\") return true;\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\treturn this.isPaged(q[prop][q[prop].length-1]);\n\t\t}\n\t}\n\treturn false;\n}\n\nWOQLQuery.prototype.getPage = function(){\n\tif(this.isPaged()){\n\t\tvar psize = this.getLimit();\n\t\tif(this.hasStart()){\n\t\t\tvar s = this.getStart();\n\t\t\treturn (parseInt(s / psize) + 1);\n\t\t}\n\t\telse return 1;\n\t}\n\telse return false;\n}\n\nWOQLQuery.prototype.setPage = function(pagenum){\n\tvar pstart = (this.getLimit() * (pagenum - 1));\n\tif(this.hasStart()){\n\t\tthis.setStart(pstart);\n\t}\n\telse {\n\t\tthis.addStart(pstart);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.nextPage = function(){\n\treturn this.setPage(this.getPage() + 1);\n}\n\nWOQLQuery.prototype.firstPage = function(){\n\treturn this.setPage(1);\n}\n\nWOQLQuery.prototype.previousPage = function(){\n\tconst npage = this.getPage() - 1;\n\tif(npage > 0) this.setPage(npage);\n\treturn this;\n}\n\nWOQLQuery.prototype.setPageSize = function(size){\n\tthis.setPagingProperty(\"limit\", size);\n\tif(this.hasStart()){\n\t\tthis.setStart(0);\n\t}\n\telse {\n\t\tthis.addStart(0);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.hasSelect = function(){\n\treturn (this.getPagingProperty(\"select\") ? true : false);\n}\n\nWOQLQuery.prototype.getSelectVariables = function(q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == \"select\") {\n\t\t\tvar vars = q[prop].slice(0, q[prop].length - 1);\n\t\t\treturn vars;\n\t\t}\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\tvar val = this.getSelectVariables(q[prop][q[prop].length-1]);\n\t\t\tif(typeof val != \"undefined\"){\n\t\t\t\treturn val;\n\t\t\t}\n\t\t}\n\t}\n}\n\nWOQLQuery.prototype.hasStart = function(){\n\treturn (typeof this.getPagingProperty(\"start\") != \"undefined\");\n}\n\nWOQLQuery.prototype.getStart = function(){\n\treturn this.getPagingProperty(\"start\");\n}\n\nWOQLQuery.prototype.setStart = function(start){\n\treturn this.setPagingProperty(\"start\", start);\n}\n\nWOQLQuery.prototype.addStart = function(s){\n\tif(this.hasStart()) this.setStart(s);\n\telse {\n\t\tvar nq = {'start': [s, this.query]};\n\t\tthis.query = nq;\n\t}\n\treturn this;\n}\n\n\n/**\n * Executes the query using the passed client to connect to a server\n */\nWOQLQuery.prototype.execute = function(client,fileList){\n\tif(!this.query[\"@context\"]){\n\t\tthis.query['@context'] = client.connection.getJSONContext();\n\t\tfor(var pref in UTILS.standard_urls){\n\t\t\tif(typeof this.query['@context'][pref] == \"undefined\")\n\t\t\tthis.query['@context'][pref] = UTILS.standard_urls[pref];\n\t\t}\n\t\tthis.query[\"@context\"][\"_\"] = \"_:\";\t\t\n\t\tvar json = this.json();\n\t}\n\telse {\n\t\tvar json = this.json();\n\t}\n\tconst opts=fileList ? {fileList:fileList} : null;\n\tif(this.contains_update){\n\t\t//return client.select(false, json,opts);\n\t\treturn client.update(false, json,opts);\n\t}\n\telse {\n\t\t//return client.select(false, json,opts);\n\t\treturn client.update(false, json,opts);\n\t}\n}\n\n/*\n * Internal State Control Functions\n * Not part of public API -\n */\n\n /**\n  * Wraps literal input in a json carriage \n  */\n WOQLQuery.prototype.packString = function(v){\n\tif(typeof v == \"string\" && v.substring(0,2) != \"v:\"){\n\t\treturn {\"@value\" : v, \"@type\": \"xsd:string\"}\n\t}\n\treturn v;\n }\n\n /**\n  * Wraps an array of literal inputs in a json carriage where appropriate\n  */\n WOQLQuery.prototype.packStrings = function(vs){\n\t let nv = [];\n\t for(var i = 0; i<vs.length; i++){\n\t\tif(vs[i]) nv.push(this.packString(vs[i]))\n\t }\n\t return nv;\n }\n\n /**\n * Advances internal cursor to support chaining of calls: limit(50).start(50). rather than (limit, [50, (start, [50, (lisp-style (encapsulation)))))\n */\nWOQLQuery.prototype.advanceCursor = function(action, value){\n\tthis.cursor[action] = [value];\n\tthis.cursor[action][1] = {};\n\tthis.cursor = this.cursor[action][1];\n}\n\nWOQLQuery.prototype.loadDefaultVocabulary = function(){\n\tvar vocab = {};\n\tvocab.type = \"rdf:type\";\n\tvocab.label = \"rdfs:label\";\n\tvocab.Class = \"owl:Class\";\n\tvocab.DatatypeProperty = \"owl:DatatypeProperty\";\n\tvocab.ObjectProperty = \"owl:ObjectProperty\";\n\tvocab.Entity = \"tcs:Entity\";\n\tvocab.Document = \"tcs:Document\";\n\tvocab.Relationship = \"tcs:Relationship\";\n\tvocab.temporality = \"tcs:temporality\";\n\tvocab.geotemporality = \"tcs:geotemporality\";\n\tvocab.geography = \"tcs:geography\";\n\tvocab.abstract = \"tcs:abstract\";\n\tvocab.comment = \"rdfs:comment\";\n\tvocab.range = \"rdfs:range\";\n\tvocab.domain = \"rdfs:domain\";\n\tvocab.subClassOf = \"rdfs:subClassOf\";\n\tvocab.string = \"xsd:string\";\n\tvocab.integer = \"xsd:integer\";\n\tvocab.decimal = \"xsd:decimal\";\n\tvocab.email = \"xdd:email\";\n\tvocab.json = \"xdd:json\";\n\tvocab.dateTime = \"xsd:dateTime\";\n\tvocab.date = \"xsd:date\";\n\tvocab.coordinate = \"xdd:coordinate\";\n\tvocab.line = \"xdd:coordinatePolyline\";\n\tvocab.polygon = \"xdd:coordinatePolygon\";\n\treturn vocab;\n}\n\nWOQLQuery.prototype.defaultContext = function(DB_IRI){\n\tlet def = {}\n\tfor(var pref in UTILS.standard_urls){\n\t\tdef[pref] = UTILS.standard_urls[pref];\n\t}\n\tdef.scm = DB_IRI + \"/schema#\"\n\tdef.doc = DB_IRI + \"/document/\"\n\tdef.db = DB_IRI + \"/\";\n\treturn def;\n}\n\n\n\n/**\n * Called to indicate that this is the last call in constructing a complete woql query object\n *\n */\nWOQLQuery.prototype.last = function(){\n\tthis.chain_ended = true;\n\treturn this;\n}\n\n/**\n * Called to inidicate that this is the last call in constructing a complete WOQL update query\n */\nWOQLQuery.prototype.lastUpdate = function(){\n\tthis.contains_update = true;\n\tthis.last();\n\treturn this;\n}\n\n/**\n * Called to indicate internally that this is a chainable update - by setting the subject and call of the Triple Builder object which is used to build further triples\n */\nWOQLQuery.prototype.chainable = function(call, subj){\n\tthis.tripleBuilder = new TripleBuilder(call, this.cursor, this.cleanSubject(subj));\n\tthis.last();\n\treturn this;\n}\n\n/**\n * Called to indicate internally that this is a chainable update - by setting the subject and call of the Triple Builder object which is used to build further triples\n */\nWOQLQuery.prototype.chainableUpdate = function(call, subj){\n\tthis.tripleBuilder = new TripleBuilder(call, this.cursor, this.cleanSubject(subj));\n\treturn this.lastUpdate();\n}\n\n\n/**\n * Returns the value of one of the 'paging' related properties (limit, start,...)\n */\nWOQLQuery.prototype.getPagingProperty = function(pageprop, q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == pageprop) return q[prop][0];\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\tvar val = this.getPagingProperty(pageprop, q[prop][q[prop].length-1]);\n\t\t\tif(typeof val != \"undefined\"){\n\t\t\t\treturn val;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Sets the value of one of the paging_transitive_properties properties\n */\nWOQLQuery.prototype.setPagingProperty = function(pageprop, val, q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == pageprop) {\n\t\t\tq[prop][0] = val;\n\t\t}\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\tthis.setPagingProperty(pageprop, val, q[prop][q[prop].length-1]);\n\t\t}\n\t}\n\treturn this;\n}\n\n/**\n * Retrieves the value of the current json-ld context\n */\nWOQLQuery.prototype.getContext = function(q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == \"@context\") return q[prop];\n\t\tif(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\tvar nq = q[prop][1];\n\t\t\tvar nc = this.getContext(nq);\n\t\t\tif(nc) return nc;\n\t\t}\n\t}\n}\n\n\n/**\n * Retrieves the value of the current json-ld context\n */\nWOQLQuery.prototype.context = function(c){\n\tthis.cursor['@context'] = c;\n}\n\n\n/*\n* Transforms from internal json representation to human writable WOQL.js format\n*/\nWOQLQuery.prototype.prettyPrint = function(indent, show_context, q, fluent){\n\tif(!this.indent) this.indent = indent;\n\tq = (q ? q : this.query);\n\tvar str = \"\";\n\tconst newlining_operators = [\"get\", \"from\", \"into\"];\n\tfor(var operator in q){\n\t\t//ignore context in pretty print\n\t\tif(operator == \"@context\") {\n\t\t\tif( show_context){\n\t\t\t\tvar c = this.getContext();\n\t\t\t\tif(c) str += \"@context: \" + JSON.stringify(c) + \"\\n\";\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\t//statement starts differently depending on indent and whether it is fluent style or regular function style\n\t\tstr += this.getWOQLPrelude(operator, fluent, indent - this.indent);\n\t\tvar val = q[operator];\n\t\tif(this.isChainable(operator, val[val.length-1])){\n\t\t\t//all arguments up until the last are regular function arguments\n\t\t\tstr += this.uncleanArguments(operator,  val.slice(0, val.length-1), indent, show_context);\n\t\t\tif(newlining_operators.indexOf(operator) !== -1){\n\t\t\t\t//some fluent function calls demand a linebreak..\n\t\t\t\tstr += \"\\n\" + nspaces(indent-this.indent);\n\t\t\t}\n\t\t\t//recursive call to query included in tail\n\t\t\tstr += this.prettyPrint(indent, show_context, val[val.length-1], true);\n\t\t}\n\t\telse {\n\t\t\t//non chainable operators all live inside the function call parameters\n\t\t\tif(!this.hasShortcut(operator, val, indent)){\n\t\t\t\tstr += this.uncleanArguments(operator,  val, indent, show_context);\n\t\t\t}\n\t\t}\n\t}\n\t//remove any trailing dots in the chain (only exist in incompletely specified queries)\n\tif(str.substring(str.length-1) == \".\"){\n\t\tstr = str.substring(0, str.length-1);\n\t}\n\treturn str;\n}\n\n/**\n * Gets the starting characters for a WOQL query - varies depending on how the query is invoked and how indented it is\n */\nWOQLQuery.prototype.getWOQLPrelude = function(operator, fluent, inline){\n\tif(operator === \"true\" || operator === \"false\"){\n\t\treturn operator;\n\t}\n\tif(fluent){\n\t\treturn \".\" + operator;\n\t}\n\treturn (inline ? \"\\n\" + nspaces(inline) : \"\") + \"WOQL.\" + operator;\n}\n\n/**\n * Determines whether a given operator can have a chained query as its last argument\n */\nWOQLQuery.prototype.isChainable = function(operator, lastArg){\n\tconst non_chaining_operators = [\"and\", \"or\", \"remote\", \"file\", \"re\"];\n\tif(lastArg && typeof lastArg == \"object\" && typeof lastArg['@value'] == \"undefined\"  && typeof lastArg['@type'] == \"undefined\"  && typeof lastArg['value'] == \"undefined\" && non_chaining_operators.indexOf(operator) == -1){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n/**\n * Transforms arguments to WOQL functions from the internal (clean) version, to the WOQL.js human-friendly version\n */\nWOQLQuery.prototype.uncleanArguments = function(operator, args, indent, show_context){\n\tif(this.hasShortcut(operator, args)){\n\t\treturn this.getShortcut(operator, args, indent);\n\t}\n\tlet str = '(';\n\tfor(var i = 0; i<args.length; i++){\n\t\tif(this.argIsSubQuery(operator, args[i], i)){\n\t\t\tstr += this.prettyPrint(indent + this.indent, show_context, args[i], false);\n\t\t}\n\t\telse if(operator == \"get\" && i == 0){ // weird one, needs special casing\n\t\t\tstr += \"\\n\" + nspaces(indent-this.indent) + \"WOQL\";\n\t\t\tfor(var j = 0; j < args[0].length; j++){\n\t\t\t\tvar myas = (args[0][j].as ? args[0][j].as : args[0][j]);\n\t\t\t\tvar lhs = myas[0];\n\t\t\t\tvar rhs = myas[1];\n\t\t\t\tif(typeof lhs == \"object\" && lhs['@value']){\n\t\t\t\t\tlhs = lhs['@value'];\n\t\t\t\t}\n\t\t\t\tif(typeof lhs == \"object\") {\n\t\t\t\t\tlhs = JSON.stringify(lhs);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlhs = '\"' + lhs + '\"'\n\t\t\t\t}\n\t\t\t\tstr += '.as(' + lhs;\n\t\t\t\tif(rhs) str += ', \"' + rhs + '\"';\n\t\t\t\tstr += \")\";\n\t\t\t\tstr += \"\\n\" + nspaces(indent);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tstr += this.uncleanArgument(operator, args[i], i, args);\n\t\t}\n\t\tif(i < args.length -1) str +=  ',';\n\t}\n\tconst args_take_newlines = [\"and\", \"or\"];\n\tif(args_take_newlines.indexOf(operator) != -1){\n\t\tstr += \"\\n\" + nspaces(indent-this.indent);\n\t}\n\tstr += \")\";\n\treturn str;\n}\n\n\n/**\n * Passed as arguments: 1) the operator (and, triple, not, opt, etc)\n * 2) the value of the argument\n * 3) the index (position) of the argument.\n */\nWOQLQuery.prototype.uncleanArgument = function(operator, val, index, allArgs){\n\t//numeric values go out untouched...\n\tconst numeric_operators = [\"limit\", \"start\", \"eval\", \"plus\", \"minus\", \"times\", \"divide\", \"exp\", \"div\"];\n\tif(operator == \"isa\"){\n\t\tval = (index == 0 ? this.unclean(val, 'subject') : this.unclean(val, 'class'));\n\t}\n\telse if(operator == \"sub\"){\n\t\tval = this.unclean(val, 'class');\n\t}\n\telse if([\"select\"].indexOf(operator) != -1){\n\t\t//if(val.substring(0, 2) == \"v:\") val = val.substring(2);\n\t}\n\telse if([\"quad\", \"add_quad\", \"delete_quad\", \"add_triple\", \"delete_triple\", \"triple\"].indexOf(operator) != -1){\n\t\tswitch(index){\n\t\t\tcase 0: val = this.unclean(val, \"subject\"); break;\n\t\t\tcase 1: val = this.unclean(val, \"predicate\"); break;\n\t\t\tcase 2: val = this.unclean(val, \"object\"); break;\n\t\t\tcase 3: val = this.unclean(val, \"graph\"); break;\n\t\t}\n\t}\n\tif(typeof val == \"object\"){\n\t\tif(operator == \"concat\" && index == 0){\n\t\t\tvar cstr = \"\";\n\t\t\tif(val.list){\n\t\t\t\tfor(var i = 0 ; i<val.list.length; i++){\n\t\t\t\t\tif(val.list[i]['@value']) cstr += val.list[i]['@value'];\n\t\t\t\t\telse cstr += val.list[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar oval = '\"' + cstr + '\"';\n\t\t}\n\t\telse {\n\t\t\tvar oval = this.uncleanObjectArgument(operator, val, index);\n\t\t}\n\t\treturn oval;\n\t}\n\t//else if(numeric_operators.indexOf(operator) !== -1){\n\t//\treturn val;\n\t//}\n\tif(typeof val == \"string\"){\n\t\treturn '\"' + val + '\"';\n\t}\n\treturn val;\n}\n\nWOQLQuery.prototype.uncleanObjectArgument = function(operator, val, index){\n\tif(val['@value'] && (val['@language'] || (val['@type'] && val['@type'] == \"xsd:string\"))) return '\"' + val['@value'] + '\"';\n\tif(val['@value'] && (val['@type'] && val['@type'] == \"xsd:integer\")) return val['@value'];\n\tif(val['list']) {\n\t\tvar nstr = \"[\";\n\t\tfor(var i = 0 ; i<val['list'].length; i++){\n\t\t\tif(typeof val['list'][i] == \"object\"){\n\t\t\t\tnstr += this.uncleanObjectArgument(\"list\", val['list'][i], i);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnstr += '\"' + val['list'][i] + '\"';\n\t\t\t}\n\t\t\tif(i < val['list'].length-1){\n\t\t\t\tnstr += \",\";\n\t\t\t}\n\t\t}\n\t\tnstr += \"]\";\n\t\treturn nstr;\n\t}\n\treturn JSON.stringify(val);\n}\n\nWOQLQuery.prototype.argIsSubQuery = function(operator, arg, index){\n\tconst squery_operators = [\"and\", \"or\", \"when\", \"not\", \"opt\", \"exp\", \"minus\", \"div\", \"divide\", \"plus\", \"multiply\"];\n\tif(squery_operators.indexOf(operator) !== -1){\n\t\tif(arg && typeof arg != \"object\") return false;\n\t\treturn true;\n\t}\n\tif(operator == \"group_by\" && index == 2) return true;\n\telse return false;\n}\n\n/**\n * Goes from the properly prefixed clean internal version of a variable to the WOQL.js unprefixed form\n */\nWOQLQuery.prototype.unclean = function(s, part){\n\tif(typeof s != \"string\") return s;\n\tif(s.indexOf(\":\") == -1) return s;\n\tif(s.substring(0,4) == \"http\") return s;\n\tvar suff = s.split(\":\")[1];\n\tif(this.vocab && this.vocab[suff] && this.vocab[suff] == s){\n\t\treturn suff;\n\t}\n\tif(!part) return s;\n\tif(part == \"subject\" && (s.split(\":\")[0] == \"doc\")) return suff;\n\tif(part == \"class\" && (s.split(\":\")[0] == \"scm\")) return suff;\n\tif(part == \"predicate\" && (s.split(\":\")[0] == \"scm\")) return suff;\n\tif(part == \"type\" && (s.split(\":\")[0] == \"scm\")) return suff;\n\tif(part == \"graph\" && (s.split(\":\")[0] == \"db\")) return suff;\n\treturn s;\n}\n\nWOQLQuery.prototype.hasShortcut = function(operator, args, indent){\n\tif(operator == \"true\") return true;\n\treturn false;\n}\n\nWOQLQuery.prototype.getShortcut = function(operator, args, indent){\n\tif(operator == \"true\") return true;\n}\n\nfunction nspaces(n){\n\tlet spaces = \"\";\n\tfor(var i = 0; i<n; i++){\n\t\tspaces += \" \";\n\t}\n\treturn spaces;\n}\n\nWOQLQuery.prototype.printLine = function(indent, clauses){\n\treturn \"(\\n\" + nspaces(indent) + \"WOQL.\" + clauses.join(\",\\n\"+ nspaces(indent) + \"WOQL.\") + \"\\n\" + nspaces(indent - this.indent) + \")\";\n}\n\nWOQLQuery.prototype.cleanSubject = function(s){\n\tif(typeof s != \"string\") return s;\n\tif(s.indexOf(\":\") != -1) return s;\n\tif(this.vocab && this.vocab[s]) return this.vocab[s];\n\treturn \"doc:\" + s;\n}\n\nWOQLQuery.prototype.cleanPredicate = function(p){\n\tif(p.indexOf(\":\") != -1) return p;\n\tif(this.vocab && this.vocab[p]) return this.vocab[p];\n\treturn \"scm:\" + p;\n}\nWOQLQuery.prototype.cleanType = function(t){\n\tif(t.indexOf(\":\") != -1) return t;\n\tif(this.vocab && this.vocab[t]) return this.vocab[t];\n\treturn \"scm:\" + t;\n}\n\nWOQLQuery.prototype.cleanObject = function(o){\n\tif(typeof o != \"string\" || o.indexOf(\":\") != -1) return o;\n\tif(this.vocab && this.vocab[o]) return this.vocab[o];\n\treturn { \"@value\": o, \"@language\": \"en\"};\n}\n\nWOQLQuery.prototype.cleanGraph = function(g){\n\tif(g.indexOf(\":\") != -1) return g;\n\tif(this.vocab && this.vocab[g]) return this.vocab[g];\n\treturn \"db:\" + g;\n}\n\nWOQLQuery.prototype.cleanClass = function(c){\n\tif(c.indexOf(\":\") != -1) return c;\n\tif(this.vocab && this.vocab[c]) return this.vocab[c];\n\treturn \"scm:\" + c;\n}\n\n/**\n * @file Triple Builder\n * higher level composite queries - not language or api elements\n * Class for enabling building of triples from pieces\n * type is add_quad / remove_quad / add_triple / remove_triple\n */\nfunction TripleBuilder(type, cursor, s){\n\t//what accumulation type are we\n\tthis.type = type;\n\tthis.cursor = cursor;\n\tthis.subject = (s ? s : false);\n\tthis.g = false;\n}\n\nTripleBuilder.prototype.label = function(l, lang){\n\tlang = (lang ? lang : \"en\");\n\tif(l.substring(0, 2) == \"v:\"){\n\t\tvar d = l;//{\"value\": l, \"@language\": lang }\n\t}\n\telse {\n\t\tvar d = {\"@value\": l, \"@language\": lang }\n\t}\n\tvar x = this.addPO('rdfs:label', d);\n\treturn x;\n}\n\nTripleBuilder.prototype.description = function(c, lang){\n\tlang = (lang ? lang : \"en\");\n\tif(c.substring(0, 2) == \"v:\"){\n\t\t//var d = {\"value\": c, \"@language\": lang }\n\t\tvar d = c;\n\t}\n\telse {\n\t\tvar d = {\"@value\": c, \"@language\": lang }\n\t}\n\treturn this.addPO('rdfs:comment', d);\n}\n\nTripleBuilder.prototype.addPO = function(p, o, g){\n\tif(this.type){\n\t\tvar ttype = (this.type == \"isa\" || this.type == \"sub\" ? \"triple\" : this.type);\n\t}\n\telse var ttype = \"triple\";\n\tvar evstr = ttype + '(\"' + this.subject + '\", \"' + p + '\", ';\n\tif(typeof o == \"string\"){\n\t\tevstr += \"'\" + o + \"'\";\n\t}\n\telse if(typeof o == \"object\"){\n\t\tevstr += JSON.stringify(o);\n\t}\n\telse {\n\t\tevstr += o;\n\t}\n\tif(ttype.substring(ttype.length-4) == \"quad\" || this.g){\n\t\tvar g = (g ? g : (this.g ? this.g : \"db:schema\"));\n\t\tevstr += ', \"' + g + '\"';\n\t}\n\tevstr += \")\";\n\ttry {\n\t\tvar unit = eval(\"new WOQLQuery().\" + evstr );\n\t\treturn this.addEntry(unit);\n\t}\n\tcatch(e){\n\t\tconsole.error(e);\n\t\treturn this;\n\t}\n}\n\nTripleBuilder.prototype.getO = function(s, p){\n\tif(this.cursor['and']){\n\t\tfor(var i = 0; i<this.cursor['and'].length; i++){\n\t\t\tvar clause = this.cursor['and'][i];\n\t\t\tvar key = Object.keys(clause)[0];\n\t\t\tif(clause[key][0] == s && clause[key][1] == p && clause[key][2]) return clause[key][2];\n\t\t}\n\t}\n\telse if(Object.keys(this.cursor)) {\n\t\tvar key =  Object.keys(this.cursor)[0];\n\t\tif(this.cursor[key][0] == s && this.cursor[key][1] == p && this.cursor[key][2])  return this.cursor[key][2];\n\t}\n\treturn false;\n}\n\nTripleBuilder.prototype.addEntry = function(unit){\n\tif(this.cursor[this.type]){\n\t\tvar next = {};\n\t\tnext[this.type] = this.cursor[this.type];\n\t\tthis.cursor['and'] = [next];\n\t\tdelete(this.cursor[this.type]);\n\t}\n\tif(this.cursor['and']){\n\t\tthis.cursor['and'].push(unit.json());\n\t}\n\telse {\n\t\tvar j = unit.json();\n\t\tif(j[this.type]) this.cursor[this.type] = j[this.type];\n\t\telse {\n\t\t\talert(JSON.stringify(j));\n\t\t}\n\t}\n\treturn this;\n}\n\nTripleBuilder.prototype.card = function(n, which){\n\tlet os = this.subject;\n\tthis.subject += \"_\" + which;\n\tthis.addPO('rdf:type', \"owl:Restriction\");\n\tthis.addPO(\"owl:onProperty\", os);\n\tswitch(which){\n\t\tcase \"max\": this.addPO(\"owl:maxCardinality\", {\"@value\": n, \"@type\": \"xsd:nonNegativeInteger\"});\n\t\t\tbreak;\n\t\tcase \"min\": this.addPO(\"owl:minCardinality\", {\"@value\": n, \"@type\": \"xsd:nonNegativeInteger\"});\n\t\t\tbreak;\n\t\tdefault: this.addPO(\"owl:cardinality\", {\"@value\": n, \"@type\": \"xsd:nonNegativeInteger\"});\n\t}\n\tlet od = this.getO(os, \"rdfs:domain\");\n\tif(od){\n\t\tvar cardcls = this.subject;\n\t\tthis.subject = od;\n\t\tthis.addPO(\"rdfs:subClassOf\", cardcls);\n\t}\n\tthis.subject = os;\n\treturn this;\n};\n\nTripleBuilder.prototype.isa = function(a){\n\tvar unit = new WOQLQuery.isa(this.subject, a);\n\tthis.tb.addEntry(unit);\n}\n\nTripleBuilder.prototype.graph = function(g){\n\tthis.g = g;\n}\n\nTripleBuilder.prototype.sub = function(s){\n\tvar unit = new WOQLQuery.sub(this.subject, s);\n\treturn this.addEntry(unit);\n}\n\nTripleBuilder.prototype.abstract = function(){\n\treturn this.addPO('tcs:tag', \"tcs:abstract\");\n}\n\nmodule.exports = WOQL;\n","const UTILS = require('./utils.js');\n\n/**\n * @file Terminus Rules\n * @license Apache Version 2\n * Abstract object to support applying matching rules to result sets and documents\n * sub-classes are FrameRule and WOQLRule - this just has common functions\n */\nfunction TerminusRule(){}\n\n/**\n * @param {Boolean} tf - the rule will match all literals or all non-literals\n */\nTerminusRule.prototype.literal = function(tf){\n\tif(typeof tf == \"undefined\"){\n\t\treturn this.pattern.literal;\n\t}\n\tthis.pattern.literal = tf;\n\treturn this;\n}\n\n/**\n * @param {[TYPE_URLS]} list - parameters are types identified by prefixed URLS (xsd:string...)\n */\nTerminusRule.prototype.type = function(...list){\n\tif(typeof list == \"undefined\" || list.length == 0){\n\t\treturn this.pattern.type;\n\t}\n\tthis.pattern.type = list;\n\treturn this;\n}\n\n/**\n * Specifies the scope of a rule - row / cell / object / property / * .. what part of the result does the rule apply to\n */\nTerminusRule.prototype.scope = function(scope){\n\tif(typeof scope == \"undefined\"){\n\t\treturn this.pattern.scope;\n\t}\n\tthis.pattern.scope = scope;\n\treturn this;\n}\n\n/**\n * Specifies that the rule matches a specific value\n */\nTerminusRule.prototype.value = function(...val){\n\tif(typeof val == \"undefined\"){\n\t\treturn this.pattern.value;\n\t}\n\tthis.pattern.value = val;\n\treturn this;\n}\n\n/**\n * Produces a canonical json format to represent the rule\n */\nTerminusRule.prototype.json = function(mjson){\n\tif(!mjson) {\n\t\tvar njson = {};\n\t\tif(this.pattern) njson.pattern = this.pattern.json();\n\t\tif(this.rule) njson.rule = this.rule;\n\t\treturn njson;\n\t}\n\telse {\n\t    if(mjson.pattern) this.pattern.setPattern(mjson.pattern);\n\t\tif(mjson.rule) this.rule = mjson.rule;\n\t}\n\treturn this;\n}\n\n/**\n * Contained Pattern Object to encapsulate pattern matching\n * @param {Object} pattern\n */\nfunction TerminusPattern(pattern){};\n\nTerminusPattern.prototype.setPattern = function(pattern){\n\tif(typeof pattern.literal != \"undefined\") this.literal = pattern.literal;\n\tif(pattern.type) this.type = pattern.type;\n\tif(pattern.scope) this.scope = pattern.scope;\n\tif(pattern.value) this.value = pattern.value;\n}\n\nTerminusPattern.prototype.json = function(){\n    var json = {};\n\tif(typeof this.literal != \"undefined\") json.literal = this.literal;\n\tif(this.type) json.type = this.type;\n    if(this.scope) json.scope = this.scope;\n    if(this.value) json.value = this.value;\n    return json;\n}\n\n/**\n * Tests whether the passed values matches the basic pattern\n */\nTerminusPattern.prototype.testBasics = function(scope, value){\n\tif(this.scope && scope && this.scope != scope) return false;\n\tif(this.type){\n\t\tvar dt = value[\"@type\"];\n\t\tif(!dt || !this.testValue(dt, this.type)) return false;\n\t}\n\tif(typeof this.literal != \"undefined\"){\n\t\tif(!(this.literal == !(typeof value[\"@type\"] == \"undefined\"))) return false;\n\t}\n\tif(typeof this.value != \"undefined\"){\n\t   if(!this.testValue(value, this.value)) return false;\n\t}\n\treturn true;//passed all tests\n}\n\nTerminusPattern.prototype.testValue = function(value, constraint){\n\tvar vundertest = (value['@value'] ? value['@value'] : value);\n\tif(typeof constraint == \"function\") return constraint(vundertest);\n\tif(constraint && !Array.isArray(constraint)) constraint = [constraint];\n\tfor(var i = 0; i<constraint.length; i++){\n\t\tvar nc = constraint[i];\n\t\tif(typeof vundertest == \"string\"){\n\t\t\tif(this.stringMatch(nc, vundertest)) return true;\n\t\t}\n\t\telse if(typeof vundertest == \"number\"){\n\t\t\tif(this.numberMatch(nc, vundertest)) return true;\n\t\t}\n\t}\n\treturn false;\n}\n\n/**\n * Unpacks an array into a list of arguments\n * @param {Boolean} nonstring - if set, the values will be double-quoted only when they are strings, otherwise, all will be quoted as strings\n */\nTerminusPattern.prototype.unpack = function(arr, nonstring){\n\tvar str = \"\";\n\tif(nonstring){\n\t\tfor(var i = 0 ; i<arr.length; i++){\n\t\t\tif(typeof arr[i] == \"string\"){\n\t\t\t\tstr += '\"' + arr[i] + '\"';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstr += arr[i];\n\t\t\t}\n\t\t\tif(i < (arr.length - 1)) str += \", \";\n\t\t}\n\t}\n\telse {\n\t\tstr = '\"' + arr.join('\",\"') + '\"';\n\t}\n\treturn str;\n}\n\n\nTerminusPattern.prototype.IDsMatch = function (ida, idb) {\n\treturn UTILS.compareIDs(ida, idb);\n};\n\nTerminusPattern.prototype.classIDsMatch = function (ida, idb) {\n\treturn this.IDsMatch(ida, idb);\n};\n\nTerminusPattern.prototype.propertyIDsMatch = function (ida, idb) {\n\tconst match = this.IDsMatch(ida, idb);\n\treturn match;\n};\n\nTerminusPattern.prototype.rangeIDsMatch = function (ida, idb) {\n\treturn this.IDsMatch(ida, idb);\n};\n\nTerminusPattern.prototype.valuesMatch = function (vala, valb) {\n\treturn vala == valb;\n};\nTerminusPattern.prototype.numberMatch = function (vala, valb) {\n\tif (typeof vala === 'string') {\n\t\ttry {\n\t\t\treturn eval(valb + vala);\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn vala === valb;\n};\n\nTerminusPattern.prototype.stringMatch = function (vala, valb) {\n\tif(vala.substring(0,1) == \"/\"){\n\t\tconst pat = new RegExp(vala.substring(1));\n\t\treturn pat.test(valb);\n\t}\n\telse {\n\t\treturn vala === valb;\n\t}\n};\n\n\n module.exports = {TerminusRule, TerminusPattern};\n","const Config  = require('./viewConfig.js');\nconst WOQLTable  = require('./woqlTable.js');\nconst UTILS  = require('../utils.js');\n\n\nfunction WOQLTableConfig(){\n    Config.ViewConfig.call(this); \n    this.type = \"table\";\n}\n\nWOQLTableConfig.prototype = Object.create(Config.ViewConfig.prototype);\nWOQLTableConfig.prototype.constructor = Config.ViewConfig;\n\nWOQLTableConfig.prototype.create = function(client){\n\tvar wqt = new WOQLTable(client, this);\n\treturn wqt;\n}\n\nWOQLTableConfig.prototype.json = function(){\n\tlet jr = [];\n\tfor(var i = 0; i<this.rules.length; i++){\n\t\tjr.push(this.rules[i].json());\n\t}\n\tvar conf = {};\n\tif(typeof this.column_order() != \"undefined\"){\n\t\tconf['column_order'] = this.column_order();\n\t}\n\tif(typeof this.pagesize() != \"undefined\"){\n\t\tconf['pagesize'] = this.pagesize();\n\t}\n\tif(typeof this.renderer() != \"undefined\"){\n\t\tconf['renderer'] = this.renderer();\n\t}\n\tif(typeof this.pager() != \"undefined\"){\n\t\tconf['pager'] = this.pager();\n\t}\n\tif(typeof this.page() != \"undefined\"){\n\t\tconf['page'] = this.page();\n\t}\n\tif(typeof this.changesize() != \"undefined\"){\n\t\tconf['changesize'] = this.changesize();\n\t}\n\tlet mj = {\"table\" :conf, \"rules\": jr};\n\treturn mj;\n}\n\nWOQLTableConfig.prototype.loadJSON = function(config, rules){\n\tvar jr = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tvar nr = new WOQLTableRule();\n\t\tnr.json(rules[i]);\n\t\tjr.push(nr);\n\t}\n\tthis.rules = jr;\n\tif(typeof config.column_order != \"undefined\"){\n\t\tthis.column_order(...config.column_order);\n\t}\n\tif(typeof config.pagesize != \"undefined\"){\n\t\tthis.pagesize(config.pagesize);\n\t}\n\tif(typeof config.renderer != \"undefined\"){\n\t\tthis.renderer(config.renderer);\n\t}\n\tif(typeof config.pager != \"undefined\"){\n\t\tthis.pager(config.pager);\n\t}\n\tif(typeof config.page != \"undefined\"){\n\t\tthis.page(config.page);\n\t}\n\tif(typeof config.changesize != \"undefined\"){\n\t\tthis.changesize(config.changesize);\n    }\n    return this;\n}\n\nWOQLTableConfig.prototype.prettyPrint = function(){\n\tvar str = \"view = View.table();\\n\";\n\tif(typeof this.column_order() != \"undefined\"){\n\t\tstr += \"view.column_order('\" + this.column_order() + \"')\\n\";\n\t}\n\tif(typeof this.pagesize() != \"undefined\"){\n\t\tstr += \"view.pagesize(\" + this.pagesize() + \")\\n\";\n\t}\n\tif(typeof this.renderer() != \"undefined\"){\n\t\tstr += \"view.renderer('\" + this.renderer() + \"')\\n\";\n\t}\n\tif(typeof this.pager() != \"undefined\"){\n\t\tstr += \"view.pager(\" + this.pager() + \")\\n\";\n\t}\n\tif(typeof this.page() != \"undefined\"){\n\t\tstr += \"view.page(\" + this.page() + \")\\n\";\n\t}\n    if(typeof this.changesize() != \"undefined\"){\n        str += \"view.changesize(\" + this.changesize() + \")\\n\";\n    }\n    \n    for(var i = 0; i<this.rules.length ; i++){\n\t\tlet x = this.rules[i].prettyPrint();\n\t\tif(x) str += \"view.\" + x + \"\\n\";\t\t\n\t}\n\treturn str;\n}\n\nWOQLTableConfig.prototype.renderer = function(rend){\n\tif(!rend) return this.trenderer;\n\tthis.trenderer = rend;\n\treturn this;\n}\n\nWOQLTableConfig.prototype.column_order = function(...val){\n\tif(typeof val == \"undefined\" || val.length == 0){\n\t\treturn this.order;\n\t}\n\tthis.order = UTILS.addNamespacesToVariables(val);\n\treturn this;\n}\n\nWOQLTableConfig.prototype.pager = function(val){\n\tif(typeof val == \"undefined\"){\n\t\treturn this.show_pager;\n\t}\n\tthis.show_pager = val;\n\treturn this;\n}\n\nWOQLTableConfig.prototype.changesize = function(val){\n    if(typeof val == \"undefined\") return this.change_pagesize;\n    this.change_pagesize = val;\n    return this;\n}\n\n\nWOQLTableConfig.prototype.pagesize = function(val){\n\tif(typeof val == \"undefined\"){\n\t\treturn this.show_pagesize;\n\t}\n\tthis.show_pagesize = val;\n\treturn this;\n}\n\nWOQLTableConfig.prototype.page = function(val){\n\tif(typeof val == \"undefined\"){\n\t\treturn this.show_pagenumber;\n\t}\n\tthis.show_pagenumber = val;\n\treturn this;\n}\n\nWOQLTableConfig.prototype.column = function(...cols){\n\tlet nr = new WOQLTableRule().scope(\"column\");\n\tnr.setVariables(cols);\n\tthis.rules.push(nr);\n\treturn nr;\n}\n\nWOQLTableConfig.prototype.row = function(){\n\tlet nr = new WOQLTableRule().scope(\"row\");\n\tthis.rules.push(nr);\n\treturn nr;\n}\n\n/*\n * Table\n */\n\n \nfunction WOQLTableRule(){\n\tConfig.WOQLViewRule.call(this); \n};\n\nWOQLTableRule.prototype = Object.create(Config.WOQLViewRule.prototype);\nWOQLTableRule.prototype.constructor = Config.WOQLViewRule;\n\nWOQLTableRule.prototype.header = function(hdr){\n\tif(typeof hdr == \"undefined\"){\n\t\treturn this.rule.header;\n\t}\n\tthis.rule.header = hdr;\n\treturn this;\n}\n\nWOQLTableRule.prototype.prettyPrint = function(type){\n\tvar str = Config.WOQLViewRule.prototype.prettyPrint.apply(this);\n    if(typeof this.header() != \"undefined\"){\n\t    str += \".header(\" + this.header() + \")\";\n\t}\n\treturn str;\n}\n\nmodule.exports = WOQLTableConfig;","const WOQLTableConfig = require(\"./tableConfig\");\nconst UTILS = require('../utils');\nconst WOQLRule = require('../woqlRule');\nconst WOQLResult = require('../woqlResult');\n\n/**\n * @file WOQL Table \n * @license Apache Version 2 \n */\n\nfunction WOQLTable(client, config){\n\tthis.client = client;\n\tthis.config = (config ? config : new WOQLTableConfig());\n\treturn this;\n}\n\nWOQLTable.prototype.options = function(config){\n\tthis.config = config;\n\treturn this;\n}\n\nWOQLTable.prototype.setResult = function(res){\n\tthis.result = res;\n\treturn this;\n}\n\nWOQLTable.prototype.count = function(){\n\treturn this.result.count();\n}\n\nWOQLTable.prototype.first = function(){\n\treturn this.result.first();\n}\n\nWOQLTable.prototype.prev = function(){\n\treturn this.result.prev();\n}\n\nWOQLTable.prototype.next = function(){\n\treturn this.result.next();\n}\n\nWOQLTable.prototype.canAdvancePage = function(){\n\treturn (this.result.count() == this.result.query.getLimit()); \n}\n\nWOQLTable.prototype.canChangePage = function(){\n\treturn this.canAdvancePage() || this.canRetreatPage();\n}\n\nWOQLTable.prototype.canRetreatPage = function(){\n\treturn (this.result.query.getPage() > 1);\n}\n\nWOQLTable.prototype.getPageSize = function(){\n\treturn this.result.query.getLimit() ;\t\n}\n\nWOQLTable.prototype.setPage = function(l){\n\treturn this.result.query.setPage(l);\t\n}\n\nWOQLTable.prototype.getPage = function(){\n\treturn this.result.query.getPage();\t\n}\n\nWOQLTable.prototype.setPageSize = function(l){\n\treturn this.update(this.result.query.setPageSize(l));\n}\n\nWOQLTable.prototype.nextPage = function(){\n\treturn this.update(this.result.query.nextPage());\n}\n\nWOQLTable.prototype.firstPage = function(){\n\treturn this.update(this.result.query.firstPage());\n}\n\nWOQLTable.prototype.previousPage = function(){\n\treturn this.update(this.result.query.previousPage());\n}\n\nWOQLTable.prototype.getColumnsToRender = function(){\n\tif(this.hasColumnOrder()){\n\t\tvar cols = this.getColumnOrder();\n\t}\n\telse if(this.result.query.hasSelect()){\n\t\tvar cols = this.result.query.getSelectVariables();\n\t}\n\telse {\n\t\tvar cols = this.result.getVariableList();\n\t}\n\tvar self = this;\n\treturn (cols ? cols.filter(col => !self.hidden(col)) : []);\n}\n\nWOQLTable.prototype.getColumnHeaderContents = function(colid){\n\tcolid = UTILS.addNamespaceToVariable(colid);\n\tlet hr = new WOQLRule().matchColumn(this.config.rules, colid, \"header\");\n\tif(hr && hr.length){\n\t\tlet h = hr[hr.length-1].rule.header;\n\t\tif(typeof h == \"string\"){\n\t\t\treturn document.createTextNode(h);\t\t\t\n\t\t}\n\t\telse if(typeof h == \"function\"){\n\t\t\treturn h(colid);\n\t\t}\n\t\telse return h;\n\t}\n\tvar clab = UTILS.labelFromURL(colid);\n\treturn document.createTextNode(clab);\n}\n\n\nWOQLTable.prototype.hidden = function(col){\n\tcolid = UTILS.addNamespaceToVariable(col);\n\tlet matched_rules = new WOQLRule().matchColumn(this.config.rules, colid, \"hidden\");\n\tif(matched_rules.length){\n\t\treturn matched_rules[matched_rules.length-1].rule.hidden;\n\t}\n\treturn false;\n}\n\n/**\n * Called when you want to change the query associated with the table. \n */\nWOQLTable.prototype.update = function(nquery){\n\treturn nquery.execute(this.client).then((results) => {\n\t\tvar nresult = new WOQLResult(results, nquery);\n\t\tthis.setResult(nresult);\n\t\tif(this.notify) this.notify(nresult);\n\t\treturn nresult;\n\t});\t\n}\n\nWOQLTable.prototype.hasDefinedEvent = function(row, key, scope, action, rownum){\n\tif(scope == \"row\"){\n\t\tvar matched_rules = new WOQLRule().matchRow(this.config.rules, row, this.result.cursor, action);\t\n\t}\n\telse {\n\t\tvar matched_rules = new WOQLRule().matchCell(this.config.rules, row, key, this.result.cursor, action);\t\n\t}\n\tif(matched_rules && matched_rules.length) return true;\n\treturn false;\n}\n\nWOQLTable.prototype.getDefinedEvent = function(row, key, scope, action, rownum){\n\tif(scope == \"row\"){\n\t\tvar matched_rules = new WOQLRule().matchRow(this.config.rules, row, this.result.cursor, action);\t\n\t}\n\telse {\n\t\tvar matched_rules = new WOQLRule().matchCell(this.config.rules, row, key, this.result.cursor, action);\t\n\t}\n\tif(matched_rules && matched_rules.length) {\n\t\tvar l = (matched_rules.length - 1);\n\t\treturn matched_rules[l].rule[action];\n\t}\n}\n\nWOQLTable.prototype.getRowClick = function(row){\n\tlet re = this.getDefinedEvent(row, false, \"row\", \"click\");\n\treturn re;\n}\n\nWOQLTable.prototype.getCellClick = function(row, col){\n\tlet cc = this.getDefinedEvent(row, col, \"column\", \"click\");\n\treturn cc;\n}\n\nWOQLTable.prototype.getRowHover = function(row){\n\treturn this.getDefinedEvent(row, false, \"row\", \"hover\");\n}\n\nWOQLTable.prototype.getCellHover = function(row, key){\n\treturn this.getDefinedEvent(row, key, \"column\", \"hover\");\n}\n\nWOQLTable.prototype.getColumnOrder = function(){\n\treturn this.config.column_order();\n}\n\nWOQLTable.prototype.hasColumnOrder = WOQLTable.prototype.getColumnOrder;\nWOQLTable.prototype.hasCellClick = WOQLTable.prototype.getCellClick;\nWOQLTable.prototype.hasRowClick = WOQLTable.prototype.getRowClick;\nWOQLTable.prototype.hasCellHover = WOQLTable.prototype.getCellHover;\nWOQLTable.prototype.hasRowHover = WOQLTable.prototype.getRowHover;\n\nWOQLTable.prototype.getRenderer = function(key, row, rownum){\n\tvar rend = this.getSpecificRender(key, row);\n\tif(rend) return rend;\n\tlet renderer = this.getDefinedEvent(row, key, \"column\", \"renderer\", rownum);\n\tlet args =  this.getDefinedEvent(row, key, \"column\", \"args\", rownum);\n\tif(!renderer){\n\t\tlet r = this.getRendererForDatatype(row[key]);\n\t\trenderer = r.name;\n\t\tif(!args) args = r.args;\n\t}\n\tif(renderer){\n\t\treturn this.datatypes.createRenderer(renderer, args);\t\t\n\t}\n}\n\nWOQLTable.prototype.renderValue = function(renderer, val, key, row){\n\tif(val && val['@type']){\n\t\trenderer.type = val['@type'];\n\t\tvar dv = new DataValue(val['@value'], val['@type'], key, row);\n\t}\t\n\telse if(val && val['@language']){\n\t\trenderer.type = \"xsd:string\";\n\t\tvar dv = new DataValue(val['@value'], renderer.type, key, row);\n\t}\n\telse if(val && typeof val == \"string\"){\n\t\trenderer.type = \"id\";\n\t\tvar dv = new DataValue(val, \"id\", key, row);\n\t}\n\tif(dv) return renderer.renderValue(dv);\n\treturn \"\";\n}\n\nfunction DataValue(val, type){\n\tthis.datavalue = (val == \"unknown\" ? \"\" : val);\n\tthis.datatype = type;\n}\n\nDataValue.prototype.value = function(nvalue){\n\tif(nvalue) {\n\t\tthis.datavalue = nvalue; \n\t\treturn this;\n\t}\n\treturn this.datavalue;\n}\n\n\nWOQLTable.prototype.getRendererForDatatype = function(val){\n\tif(val && val['@type']){\n\t\treturn this.datatypes.getRenderer(val['@type'], val['@value']);\n\t}\n\telse if(val && val['@language']){\n\t\treturn this.datatypes.getRenderer(\"xsd:string\", val['@value']);\n\t}\n\telse if(val && typeof val == \"string\"){\n\t\treturn this.datatypes.getRenderer(\"id\", val);\t\t\n\t}\n\treturn false;\n}\n\nWOQLTable.prototype.getSpecificRender = function(key, row){\n\tlet rend = this.getDefinedEvent(row, key, \"column\", \"render\");\n\treturn rend;\n}\n\nmodule.exports = WOQLTable;","const Config  = require('./viewConfig.js');\nconst WOQLChooser  = require('./woqlChooser.js');\nconst UTILS = require('../utils');\n\nfunction WOQLChooserConfig(){\n    Config.ViewConfig.call(this); \n    this.type = \"chooser\";\n}\n\nWOQLChooserConfig.prototype = Object.create(Config.ViewConfig.prototype);\nWOQLChooserConfig.prototype.constructor = Config.ViewConfig;\n\nWOQLChooserConfig.prototype.create = function(client){\n\tvar wqt = new WOQLChooser(client, this);\n\treturn wqt;\n}\n\nWOQLChooserConfig.prototype.prettyPrint = function(){\n    var str = \"view = View.chooser();\\n\";\n    str += this.getBasicPrettyPrint();\n\tif(typeof this.change() != \"undefined\"){\n\t\tstr += \"view.change(\" + this.change() + \")\\n\";\n\t}\n\tif(typeof this.show_empty() != \"undefined\"){\n\t\tstr += \"view.show_empty('\" + this.show_empty() + \"')\\n\";\n\t}\n\tif(typeof this.values() != \"undefined\"){\n\t\tstr += \"view.values('\" + UTILS.removeNamespaceFromVariable(this.values()) + \"')\\n\";\n\t}\n\tif(typeof this.labels() != \"undefined\"){\n\t\tstr += \"view.labels('\" + UTILS.removeNamespaceFromVariable(this.labels()) + \"')\\n\";\n\t}\n\tif(typeof this.titles() != \"undefined\"){\n\t\tstr += \"view.titles('\" + UTILS.removeNamespaceFromVariable(this.titles()) + \"')\\n\";\n\t}\n\tif(typeof this.sort() != \"undefined\"){\n\t\tstr += \"view.sort(\" + this.sort() + \")\\n\";\n\t}\n\tif(typeof this.direction() != \"undefined\"){\n\t\tstr += \"view.direction('\" + this.direction() + \"')\\n\";\n\t}\n\tfor(var i = 0; i<this.rules.length ; i++){\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"chooser\") + \"\\n\";\n\t}\n\treturn str;\n}\n\nWOQLChooserConfig.prototype.json = function(){\n\tvar conf = this.getBasicJSON();\n\tif(typeof this.change() != \"undefined\"){\n\t\tconf['change'] = this.change();\n\t}\n\tif(typeof this.show_empty() != \"undefined\"){\n\t\tconf['show_empty'] = this.show_empty();\n\t}\n\tif(typeof this.values() != \"undefined\"){\n\t\tconf['values'] = this.values();\n\t}\n\tif(typeof this.labels() != \"undefined\"){\n\t\tconf['labels'] = this.labels();\n\t}\n\tif(typeof this.titles() != \"undefined\"){\n\t\tconf['titles'] = this.titles();\n\t}\n\tif(typeof this.sort() != \"undefined\"){\n\t\tconf['sort'] = this.sort();\n\t}\n\tif(typeof this.direction() != \"undefined\"){\n\t\tconf['direction'] = this.direction();\n\t}\n\tlet mj = {\"chooser\" :conf, \"rules\": this.getRulesJSON()};\n\treturn mj;\n}\n\nWOQLChooserConfig.prototype.loadJSON = function(config, rules){\n\tvar jr = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tvar nr = new WOQLChooserRule();\n\t\tnr.json(rules[i]);\n\t\tjr.push(nr);\n\t}\n    this.rules = jr;\n    this.loadBasicJSON(config);\n\tif(typeof config.change != \"undefined\"){\n\t\tthis.change(config.change);\n\t}\n\tif(typeof config.show_empty != \"undefined\"){\n\t\tthis.show_empty(config.show_empty);\n\t}\n\tif(typeof config.values != \"undefined\"){\n\t\tthis.values(config.values);\n\t}\n\tif(typeof config.labels != \"undefined\"){\n\t\tthis.labels(config.labels);\n\t}\n\tif(typeof config.titles != \"undefined\"){\n\t\tthis.titles(config.titles);\n\t}\n\tif(typeof config.sort != \"undefined\"){\n\t\tthis.sort(config.sort);\n\t}\n\tif(typeof config.direction != \"undefined\"){\n\t\tthis.direction(config.direction);\n\t}\n}\n\nWOQLChooserConfig.prototype.change = function(v){\n\tif(typeof v != \"undefined\"){\n\t\tthis.onChange = v;\n\t\treturn this;\n\t}\n\treturn this.onChange;\n}\n\nWOQLChooserConfig.prototype.show_empty = function(p){\n\tif(typeof p != \"undefined\"){\n\t\tthis.placeholder = p;\n\t\treturn this;\n\t}\n\treturn this.placeholder;\n}\n\nWOQLChooserConfig.prototype.rule = function(v){\n\tlet nr = new WOQLChooserRule().scope(\"row\");\n    this.rules.push(nr);\n    if(v) nr.vars(v);\n    //if(v) nr.v(v);\n    return nr;\n}\n\nWOQLChooserConfig.prototype.values = function(v){\n\tif(typeof v != \"undefined\"){\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\n\t\tthis.value_variable = v;\n\t\treturn this;\n\t}\n\treturn this.value_variable;\n}\n\nWOQLChooserConfig.prototype.labels = function(v){\n\tif(v){\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\n\t\tthis.label_variable = v;\n\t\treturn this;\n\t}\n\treturn this.label_variable;\n}\n\nWOQLChooserConfig.prototype.titles = function(v){\n\tif(v){\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\n\t\tthis.title_variable = v;\n\t\treturn this;\n\t}\n\treturn this.title_variable;\n}\n\nWOQLChooserConfig.prototype.sort = function(v){\n\tif(v){\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\n\t\tthis.sort_variable = v;\n\t\treturn this;\n\t}\n\treturn this.sort_variable;\n}\n\nWOQLChooserConfig.prototype.direction = function(v){\n\tif(v){\n\t\tthis.sort_direction = v;\n\t\treturn this;\n\t}\n\treturn this.sort_direction;\n}\n\n\nfunction WOQLChooserRule(scope){\n\tConfig.WOQLViewRule.call(this,scope); \n};\n\nWOQLChooserRule.prototype = Object.create(Config.WOQLViewRule.prototype);\nWOQLChooserRule.prototype.constructor = Config.WOQLViewRule;\n\nWOQLChooserRule.prototype.label = function(l){\n\tif(l){\n\t\tthis.rule.label = l;\n\t\treturn this;\n\t}\n\treturn this.rule.label;\n}\n\nWOQLChooserRule.prototype.title = function(l){\n\tif(l){\n\t\tthis.rule.title = l;\n\t\treturn this;\n\t}\n\treturn this.rule.title;\n}\n\nWOQLChooserRule.prototype.values = function(l){\n\tif(l){\n\t\tthis.rule.values = l;\n\t\treturn this;\n\t}\n\treturn this.rule.values;\n}\n\nWOQLChooserRule.prototype.selected = function(s){\n\tif(typeof s != \"undefined\"){\n\t\tthis.rule.selected = s;\n\t\treturn this;\n\t}\n\treturn this.rule.selected;\n}\n\nWOQLChooserRule.prototype.prettyPrint = function(type){\n\tvar str = WOQLViewRule.prototype.prettyPrint.apply(this);\n    if(typeof this.selected() != \"undefined\"){\n\t    str += \".selected(\" + this.selected() + \")\";\n    }\n    if(typeof this.label() != \"undefined\"){\n\t    str += \".label(\\\"\" + this.label() + \"\\\")\";\n    }\n    if(typeof this.title() != \"undefined\"){\n\t    str += \".title(\\\"\" + this.title() + \"\\\")\";\n    }\n    if(typeof this.values() != \"undefined\"){\n\t    str += \".values(\\\"\" + this.values() + \"\\\")\";\n\t}\n\treturn str;\n}\n\nmodule.exports = WOQLChooserConfig;","const WOQLChooserConfig = require(\"./chooserConfig\");\nconst UTILS = require('../utils');\nconst WOQLRule = require('../woqlRule');\n\n/*\n * Very simple implementation of a WOQL backed chooser\n * Makes a drop down from a WOQL query - configuration tells it which columns to use...\n */\nfunction WOQLChooser(client, config){\n\tthis.client = client;\n\tthis.config = (config ? config : new WOQLChooserConfig());\n\tthis.selected = false;\n\tthis.cursor = 0;\n\treturn this;\n}\n\nWOQLChooser.prototype.options = function(config){\n\tthis.config = config;\n\treturn this;\n}\n\nWOQLChooser.prototype.set = function(id){\n\tif(this.selected != id){\n\t\tthis.selected = id;\n\t\tlet ch = this.config.change;\n\t\tif(ch) ch(id);\n\t}\n}\n\n/*\n * Sets up the required variables from the result / config\n */\nWOQLChooser.prototype.setResult = function(result){\n\tthis.result = result;\n\tthis.choices = [];\n\tlet rows = 0;\n\tconst variables = result.getVariableList();\n\tif(!this.config.values() && variables.length){\n\t\tthis.config.values(variables[0]);\n\t}\n\t//sort it \n\tif(this.config.sort()){\n\t\tthis.result.sort(this.config.sort(), this.config.direction());\n\t}\n\twhile(row = this.result.next()){\n\t\tif(row && this.includeRow(row, this.result.cursor)){\n\t\t\tthis.choices.push(this.rowToChoice(row, rows++));\n\t\t}\t\t\n\t}\n\treturn this;\n}\n\nWOQLChooser.prototype.includeRow = function(row, index){\n\tconst matched_rules = new WOQLRule().matchRow(this.config.rules, row, index, \"hidden\");\n\tfor(var i = 0; i<matched_rules.length; i++){\n\t\tif(matched_rules[i].rule.hidden) return false;\n\t}\n\treturn true;\n}\n\nWOQLChooser.prototype.rowToChoice = function(row, rownum){\n\tvar choice = { \n\t\tid: this.getRowID(row) \n\t};\n\tchoice.label = this.getLabelFromBinding(row, rownum);\n\tchoice.title = this.getTitleFromBinding(row, rownum);\n\tchoice.selected = this.getSelectedFromBinding(row, rownum);\n\treturn choice;\n}\n\nWOQLChooser.prototype.getRowID = function(row){\n\tvar rval = row[this.config.values()];\n\tif(rval['@value']) return rval['@value'];\n\treturn rval;\n}\n\nWOQLChooser.prototype.getLabelFromBinding = function(row, rownum){\n\tlet sp = this.getSpecialRenderer(row, rownum, \"label\");\n\tif(sp) return this.renderSpecial(sp, row, rownum);\n\tif(this.config.labels()){\n\t\tif(row[this.config.labels()]){\n\t\t\tvar lab = row[this.config.labels()];\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\n\t\t\tif(lab != \"unknown\") return lab;\n\t\t}\n\t}\n\treturn UTILS.labelFromURL(this.getRowID(row));\n}\n\nWOQLChooser.prototype.getTitleFromBinding = function(row, rownum){\n\tlet sp = this.getSpecialRenderer(row, rownum, \"title\");\n\tif(sp) return this.renderSpecial(sp, row, rownum);\n\tif(this.config.titles()){\n\t\tif(row[this.config.titles()]){\n\t\t\tvar lab = row[this.config.titles()];\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\n\t\t\tif(lab != \"unknown\") return lab;\n\t\t}\n\t}\n\treturn false;\n}\n\nWOQLChooser.prototype.getSelectedFromBinding = function(row, rownum){\n\tconst matched_rules =  new WOQLRule().matchRow(this.config.rules, row, rownum, \"selected\");\n\tif(matched_rules && matched_rules.length){\n\t\treturn matched_rules[matched_rules.length - 1].rule.selected;\n\t}\n\treturn false;\n}\n\nWOQLChooser.prototype.render = function(){\n\tif(this.renderer) return this.renderer.render(this);\n}\n\nWOQLChooser.prototype.setRenderer = function(rend){\n\tthis.renderer = rend;\n\treturn this;\n}\n\nWOQLChooser.prototype.getSpecialRenderer = function(row, index, type){\n\tconst matched_rules =  new WOQLRule().matchRow(this.config.rules, row, index, type);\n\tfor(var i = 0; i<matched_rules.length; i++){\n\t\tif(matched_rules[i].rule[type]) return matched_rules[i].rule[type];\n\t}\n\treturn false;\n}\n\nWOQLChooser.prototype.renderSpecial = function(rule, row, rownum){\n\tif(rule && typeof rule == \"function\"){\n\t\treturn rule(row);\n\t}\n\tif(rule && typeof rule == \"string\"){\n\t\treturn rule;\n\t}\n}\n\nWOQLChooser.prototype.count = function(){\n\treturn this.result.count();\n}\n\nWOQLChooser.prototype.first = function(){\n\tthis.cursor = 0;\n\treturn this.choices[this.cursor];\n}\n\nWOQLChooser.prototype.next = function () {\n\tconst res = this.choices[this.cursor];\n\tthis.cursor++;\n\treturn res;\n};\n\nWOQLChooser.prototype.prev = function () {\n\tif (this.cursor > 0) {\n\t\tthis.cursor--;\n\t\treturn this.choices[this.cursor];\n\t}\n};\n\nmodule.exports = WOQLChooser;","const Config  = require('./viewConfig.js');\nconst WOQLGraph  = require('./woqlGraph.js');\nconst UTILS  = require('../utils.js');\n\nfunction WOQLGraphConfig(){\n    Config.ViewConfig.call(this); \n    this.type = \"graph\";\n}\n\nWOQLGraphConfig.prototype = Object.create(Config.ViewConfig.prototype);\nWOQLGraphConfig.prototype.constructor = Config.ViewConfig;\n\nWOQLGraphConfig.prototype.create = function(client){\n\tvar wqt = new WOQLGraph(client, this);\n\treturn wqt;\n}\n\nWOQLGraphConfig.prototype.literals = function(v){\n\tif(typeof v != \"undefined\"){\n\t\tthis.show_literals = v;\n\t\treturn this;\n\t}\n\treturn this.show_literals;\n}\n\nWOQLGraphConfig.prototype.source = function(v){\n\tif(v){\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\n\t\tthis.source_variable = v;\n\t\treturn this;\n\t}\n\treturn this.source_variable;\n}\n\nWOQLGraphConfig.prototype.fontfamily = function(v){\n\tif(typeof v != \"undefined\"){\n\t\tthis.fontfam = v;\n\t\treturn this;\n\t}\n\t//return 'Font Awesome 5 Free';\n\treturn this.fontfam;\n}\n\nWOQLGraphConfig.prototype.show_force = function(v){\n\tif(typeof v != \"undefined\"){\n\t\tthis.force = v;\n\t\treturn this;\n\t}\n\treturn this.force;\n}\n\nWOQLGraphConfig.prototype.fix_nodes = function(v){\n\tif(typeof v != \"undefined\"){\n\t\tthis.fixed = v;\n\t\treturn this;\n\t}\n\treturn this.fixed;\n}\n\nWOQLGraphConfig.prototype.explode_out = function(v){\n\tif(typeof v != \"undefined\"){\n\t\tthis.explode = v;\n\t\treturn this;\n\t}\n\treturn this.explode;\n}\n\nWOQLGraphConfig.prototype.selected_grows = function(v){\n\tif(typeof v != \"undefined\"){\n\t\tthis.bigsel = v;\n\t\treturn this;\n\t}\n\treturn this.bigsel;\n}\n\n/**\n * no parameter get the graph width or\n * set the graph width and return the WOQLGraphConfig\n * @param {size} Number\n */\n\nWOQLGraphConfig.prototype.width = function(size){\n\tif(typeof size != \"undefined\"){\n\t\tthis.gwidth = size;\n\t\treturn this;\n\t}\n\treturn this.gwidth;\n}\n\n/**\n * no parameter get the graph height or\n * set the graph height and return the WOQLGraphConfig\n * @param {size} Number\n */\n\nWOQLGraphConfig.prototype.height = function(size){\n\tif(typeof size != \"undefined\"){\n\t\tthis.gheight = size;\n\t\treturn this;\n\t}\n\treturn this.gheight;\n}\n\nWOQLGraphConfig.prototype.edges = function(...edges){\n\tif(edges && edges.length){\n\t\tvar nedges = [];\n\t\tfor(var i = 0; i<edges.length; i++){\n\t\t\tnedges.push(UTILS.addNamespacesToVariables(edges[i]));\n\t\t}\n\t\tthis.show_edges = nedges;\n\t\treturn this;\n\t}\n\treturn this.show_edges;\n}\n\nWOQLGraphConfig.prototype.edge = function(source, target){\n\tlet nr = new WOQLGraphRule().edge(source, target);\n\tthis.rules.push(nr);\n\treturn nr;\n}\n\nWOQLGraphConfig.prototype.node = function(...cols){\n\tlet nr = new WOQLGraphRule();\n\tif(cols && cols.length){\n\t\tnr.scope(\"node\").setVariables(cols);\n\t}\n\telse {\n\t\tnr.scope(\"row\");\n\t}\n\tthis.rules.push(nr);\n\treturn nr;\n}\n\nWOQLGraphConfig.prototype.loadJSON = function(config, rules){\n\tvar jr = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tvar nr = new WOQLGraphRule();\n\t\tnr.json(rules[i]);\n\t\tjr.push(nr);\n\t}\n\tthis.rules = jr;\n\tif(typeof config.literals != \"undefined\"){\n\t\tthis.literals(config.literals);\n\t}\n\tif(typeof config.source != \"undefined\"){\n\t\tthis.source(config.source);\n\t}\n\tif(typeof config.fontfamily != \"undefined\"){\n\t\tthis.fontfamily(config.fontfamily);\n\t}\n\tif(typeof config.show_force != \"undefined\"){\n\t\tthis.show_force(config.show_force);\n\t}\n\tif(typeof config.fix_nodes != \"undefined\"){\n\t\tthis.fix_nodes(config.fix_nodes);\n\t}\n\tif(typeof config.explode_out != \"undefined\"){\n\t\tthis.explode_out(config.explode_out);\n\t}\n\tif(typeof config.selected_grows != \"undefined\"){\n\t\tthis.selected_grows(config.selected_grows);\n\t}\n\tif(typeof config.width != \"undefined\"){\n\t\tthis.width(config.width);\n\t}\n\tif(typeof config.height != \"undefined\"){\n\t\tthis.height(config.height);\n\t}\n\tif(typeof config.edges != \"undefined\"){\n\t\tthis.edges(...config.edges);\n\t}\n}\n\nWOQLGraphConfig.prototype.prettyPrint = function(){\n\tvar str = \"view = View.graph();\\n\";\n\tif(typeof this.literals() != \"undefined\"){\n\t\tstr += \"view.literals('\" + this.literals() + \"')\\n\";\n\t}\n\tif(typeof this.source() != \"undefined\"){\n\t\tstr += \"view.source('\" + UTILS.removeNamespaceFromVariable(this.source()) + \"')\\n\";\n\t}\n\tif(typeof this.fontfamily() != \"undefined\"){\n\t\tstr += \"view.fontfamily('\" + this.fontfamily() + \"')\\n\";\n\t}\n\tif(typeof this.show_force() != \"undefined\"){\n\t\tstr += \"view.show_force('\" + this.show_force() + \"')\\n\";\n\t}\n\tif(typeof this.fix_nodes() != \"undefined\"){\n\t\tstr += \"view.fix_nodes('\" + this.fix_nodes() + \"')\\n\";\n\t}\n\tif(typeof this.explode_out() != \"undefined\"){\n\t\tstr += \"view.explode_out('\" + this.explode_out() + \"')\\n\";\n\t}\n\tif(typeof this.selected_grows() != \"undefined\"){\n\t\tstr += \"view.selected_grows('\" + this.selected_grows() + \"')\\n\";\n\t}\n\tif(typeof this.width() != \"undefined\"){\n\t\tstr += \"view.width('\" + this.width() + \"')\\n\";\n\t}\n\tif(typeof this.height() != \"undefined\"){\n\t\tstr += \"view.height('\" + this.height() + \"')\\n\";\n\t}\n\tif(typeof this.edges() != \"undefined\"){\n\t\tvar nedges = this.edges();\n\t\tvar estrs = [];\n\t\tfor(var i = 0; i<nedges.length; i++){\n\t\t\testrs.push(\"['\" + nedges[i][0] + \", \" + nedges[i][1] + \"']\");\n\t\t}\n\t\tstr += \"view.edges('\" + estrs.join(\", \") + \"')\\n\";\n\t}\n\tfor(var i = 0; i<this.rules.length ; i++){\n\t\tlet x = this.rules[i].prettyPrint();\n\t\tif(x) str += \"view.\" + x + \"\\n\";\t\t\n\t}\n\treturn str;\n}\n\nWOQLGraphConfig.prototype.json = function(){\n\tlet jr = [];\n\tfor(var i = 0; i<this.rules.length; i++){\n\t\tjr.push(this.rules[i].json());\n\t}\n\tvar json = {};\n\tif(typeof this.literals() != \"undefined\"){\n\t\tjson['literals'] = this.literals();\n\t}\n\tif(typeof this.source() != \"undefined\"){\n\t\tjson['source'] = this.source();\n\t}\n\tif(typeof this.fontfamily() != \"undefined\"){\n\t\tjson['fontfamily'] = this.fontfamily();\n\t}\n\tif(typeof this.show_force() != \"undefined\"){\n\t\tjson['show_force'] = this.show_force();\n\t}\n\tif(typeof this.fix_nodes() != \"undefined\"){\n\t\tjson['fix_nodes'] = this.fix_nodes();\n\t}\n\tif(typeof this.explode_out() != \"undefined\"){\n\t\tjson['explode_out'] = this.explode_out();\n\t}\n\tif(typeof this.selected_grows() != \"undefined\"){\n\t\tjson['selected_grows'] = this.selected_grows();\n\t}\n\tif(typeof this.width() != \"undefined\"){\n\t\tjson['width'] = this.width();\n\t}\n\tif(typeof this.height() != \"undefined\"){\n\t\tjson['height'] = this.height();\n\t}\n\tif(typeof this.edges() != \"undefined\"){\n\t\tjson['edges'] = this.edges();\n\t}\n\tlet mj = {\"graph\" :json, \"rules\": jr};\n\treturn mj;\n}\n\nfunction WOQLGraphRule(scope){\n\tConfig.WOQLViewRule.call(this,scope); \n};\n\nWOQLGraphRule.prototype = Object.create(Config.WOQLViewRule.prototype);\nWOQLGraphRule.prototype.constructor = Config.WOQLViewRule;\n\nWOQLGraphRule.prototype.charge = function(v){\n\tif(typeof v == \"undefined\"){\n\t\treturn this.rule.charge;\n\t}\n\tthis.rule.charge = v;\n\treturn this;\n}\n\nWOQLGraphRule.prototype.collisionRadius = function(v){\n\tif(typeof v == \"undefined\"){\n\t\treturn this.rule.collisionRadius;\n\t}\n\tthis.rule.collisionRadius = v;\n\treturn this;\n}\n\nWOQLGraphRule.prototype.arrow = function(json){\n\tif(json){\n\t\tthis.rule.arrow = json;\n\t\treturn this;\n\t}\n\treturn this.rule.arrow;\n}\n\nWOQLGraphRule.prototype.distance = function(d){\n\tif(typeof d != \"undefined\"){\n\t\tthis.rule.distance = d;\n\t\treturn this;\n\t}\n\treturn this.rule.distance;\n}\n\nWOQLGraphRule.prototype.symmetric = function(d){\n\tif(typeof d != \"undefined\"){\n\t\tthis.rule.symmetric = d;\n\t\treturn this;\n\t}\n\treturn this.rule.symmetric ;\n}\n\n\nWOQLGraphRule.prototype.weight = function(w){\n\tif(typeof w != \"undefined\"){\n\t\tthis.rule.weight = w;\n\t\treturn this;\n\t}\n\treturn this.rule.weight;\n}\n\nWOQLGraphRule.prototype.prettyPrint = function(type){\n\tvar str = Config.WOQLViewRule.prototype.prettyPrint.apply(this);\n\tif(typeof this.charge() != \"undefined\"){\n\t\tstr += \".charge('\" + this.charge() + \"')\";\n\t}\n\tif(typeof this.distance() != \"undefined\"){\n\t\tstr += \".distance('\" + this.distance() + \"')\";\n\t}\n\tif(typeof this.weight() != \"undefined\"){\n\t\tstr += \".weight('\" + this.weight() + \"')\";\n\t}\n\tif(typeof this.symmetric() != \"undefined\"){\n\t\tstr += \".symmetric(\" + this.symmetric() + \")\";\n\t}\n\tif(typeof this.collisionRadius() != \"undefined\"){\n\t\tstr += \".collisionRadius(\" + this.collisionRadius() + \")\";\n\t}\t\n\tif(typeof this.arrow() != \"undefined\"){\n\t\tstr += \".arrow(\" + JSON.stringify(this.arrow()) + \")\";\n\t}\n\treturn str;\n}\n\nmodule.exports = WOQLGraphConfig;","const WOQLGraphConfig = require(\"./graphConfig\");\nconst UTILS = require('../utils');\nconst WOQLRule = require('../woqlRule');\n\nfunction WOQLGraph(client, config){\n\tthis.client = client;\n\tthis.config = (config ? config : new WOQLGraphConfig());\n\tthis.nodes = [];\n\tthis.edges = [];\n}\n\nWOQLGraph.prototype.options = function(config){\n\tthis.config = config;\n\treturn this;\n}\n\nWOQLGraph.prototype.setResult = function(result){\n\tthis.result = result;\n\tthis.calculateVariableTypes(result);\n}\n\nWOQLGraph.prototype.calculateVariableTypes = function(){\n\tvar bindings = this.result.getBindings();\n\tif(bindings && bindings.length){\n\t\tfor(var i = 0; i<bindings.length; i++){\n\t\t\tthis.extractFromBinding(bindings[i], i);\n\t\t}\n\t}\n\tthis.edges = this.combineEdges(this.edges);\n\tthis.nodes = this.combineNodes(this.nodes);\n}\n\nWOQLGraph.prototype.extractFromBinding = function(row, rownum){\n\t//\n\tif(this.includeRow(row, rownum)){\n\t\t//get all the nodes (ids - non literals) //\n\t\t//see which nodes are excluded ...\n\t\tvar nodes = [];\n\t\tvar lits = [];\n\t\tfor(var k in row){\n\t\t\tif(typeof row[k] == \"string\"){\n\t\t\t\tif(row[k] && row[k] != \"unknown\" && this.includeNode(k, row)) nodes.push(k);\n\t\t\t}\n\t\t\telse if(row[k][\"@value\"] && this.includeLiteralNode(k, row)){\n\t\t\t\tlits.push(k);\n\t\t\t}\n\t\t}\n\t\tif(nodes.length == 0) return;\n\t\t//first of all we need to make the literal nodes targets of \n\t\tfor(var i = 0; i<lits.length; i++){\n\t\t\t//make an edge and put the lit in as a node...\n\t\t\tvar nid = UTILS.genBNID().substring(2);\n\t\t\tlet source = this.getLiteralOwner(nodes, lits[i], row);\n\t\t\tif(source) {\n\t\t\t\tthis.addAdornedNode(nid, lits[i], row);\n\t\t\t\tthis.addAdornedEdge(row[source], nid, source, lits[i], row);\n\t\t\t}\n\t\t}\n\t\tthis.createEdgesFromIDs(nodes, row);\n\t\tfor(var i = 0; i<nodes.length; i++){\n\t\t\tvar ndid = row[nodes[i]];\n\t\t\tthis.addAdornedNode(ndid, nodes[i], row);\n\t\t}\n\t}\n}\n\nWOQLGraph.prototype.addAdornedEdge = function(source, target, ks, kt, row){\n\tvar edge = { type: \"link\", target: target, source: source, text: kt};\n\tconst matched_rules = new WOQLRule().matchEdge(this.config.rules, row, ks, kt);\n\tvar hid = false;\n\tfor(var i = 0; i<matched_rules.length; i++){\n\t\tvar rule = matched_rules[i].rule;\n\t\tif(typeof rule.hidden != \"undefined\"){\n\t\t\thid = rule.hidden;\n\t\t}\n\t\tif(rule.size){\n\t\t\tedge.radius = UTILS.getConfigValue(rule.size, row);\n\t\t}\n\t\tif(rule.text){\n\t\t\tedge.text = UTILS.getConfigValue(rule.text, row);\n\t\t}\n\t\tif(rule.color){\n\t\t\tedge.color = UTILS.getConfigValue(rule.color, row);\n\t\t}\n\t\tif(rule.distance){\n\t\t\tedge.distance = UTILS.getConfigValue(rule.distance, row);\n\t\t}\n\t\tif(rule.arrow){\n\t\t\tedge.arrow = UTILS.getConfigValue(rule.arrow, row);\n\t\t}\n\t\tif(rule.symmetric){\n\t\t\tedge.symmetric = UTILS.getConfigValue(rule.symmetric, row);\n\t\t}\n\t\tif(rule.weight){\n\t\t\tedge.weight = UTILS.getConfigValue(rule.weight, row);\n\t\t}\n\t}\n\tif(!hid) this.edges.push(edge);\t\n}\n\nWOQLGraph.prototype.addAdornedNode = function(nid, k, row){\n\tvar node = { type: \"node\", id: nid, nodetype: k };\n\tconst matched_rules = new WOQLRule().matchNode(this.config.rules, row, k, nid);\n\tfor(var i = 0; i<matched_rules.length; i++){\n\t\tvar rule = matched_rules[i].rule;\n\t\tif(rule.size){\n\t\t\tnode.radius = UTILS.getConfigValue(rule.size, row);\n\t\t}\n\t\tif(rule.color){\n\t\t\tnode.color = UTILS.getConfigValue(rule.color, row);\n\t\t}\n\t\tif(rule.charge){\n\t\t\tnode.charge = UTILS.getConfigValue(rule.charge, row);\n\t\t}\n\t\tif(rule.collisionRadius ){\n\t\t\tnode.collisionRadius = UTILS.getConfigValue(rule.collisionRadius, row);\n\t\t}\n\t\tif(rule.icon ){\n\t\t\tnode.icon = UTILS.getConfigValue(rule.icon, row);\n\t\t}\n\t\tif(rule.text){\n\t\t\tnode.text = UTILS.getConfigValue(rule.text, row);\n\t\t}\n\t\tif(rule.border){\n\t\t\tnode.border = UTILS.getConfigValue(rule.border, row);\n\t\t}\n\t}\n\tif(!node.text){\n\t\tif(typeof row[k] == \"string\") node.text = row[k];\n\t\telse if(row[k]['@value']) node.text = row[k]['@value'];\n\t}\n\tthis.nodes.push(node);\n}\n\nWOQLGraph.prototype.getLiteralOwner = function(nodes, v, row){\n\tvar cs = this.config.source();\n\tif(cs && row[cs]){\n\t\treturn cs;\n\t}\n\tvar edges = this.config.edges();\n\tif(edges){\n\t\tfor(var i = 0; i < edges.length; i++){\n\t\t\tif(edges[i][1] == v){\n\t\t\t\treturn edges[i][0];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\treturn nodes[0];\n}\n\nWOQLGraph.prototype.createEdgesFromIDs = function(nodes, row){\n\tif(nodes.length < 2) return;\n\tvar cs = this.config.source();\n\tlet es = this.config.edges();\n\tif(!cs && es && es.length){\n\t\tfor(var i = 0; i< es.length; i++){\n\t\t\tif(nodes.indexOf(es[i][0]) != -1 && nodes.indexOf(es[i][1]) != -1 ){\n\t\t\t\tthis.addAdornedEdge(row[es[i][0]], row[es[i][1]], es[i][0], es[i][1], row);\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\tvar s = (cs && nodes.indexOf(cs) != -1) ? cs : nodes[0];\n\tfor(var i = 0; i<nodes.length; i++){\n\t\tif(nodes[i] == s) continue;\n\t\tthis.addAdornedEdge(row[s], row[nodes[i]], s, nodes[i], row);\n\t}\n}\n\n\nWOQLGraph.prototype.getEdges = function(){\n\treturn this.edges;\n}\n\nWOQLGraph.prototype.combineNodes = function(nodes){\n\tvar nnodes = {};\n\tfor(var i = 0; i<nodes.length; i++){\n\t\tvar n = nodes[i];\n\t\tif(this.nodes_referenced_by_edges.indexOf(n.id) == -1) continue;\n\t\tif(typeof nnodes[n.id] == \"undefined\"){\n\t\t\tnnodes[n.id] = n;\n\t\t}\n\t\telse {\n\t\t\tfor(var k in n){\n\t\t\t\tif(typeof nnodes[n.id][k] == \"undefined\"){\n\t\t\t\t\tnnodes[n.id][k] = n[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn Object.values(nnodes);\n}\n\n\nWOQLGraph.prototype.combineEdges = function(edges){\n\tthis.nodes_referenced_by_edges = [];\n\tvar nedges = {};\n\tfor(var i = 0; i<edges.length; i++){\n\t\tvar e = edges[i];\n\t\tif(typeof nedges[e.source] == \"undefined\"){\n\t\t\tnedges[e.source] = {};\n\t\t}\n\t\tif(typeof nedges[e.source][e.target] == \"undefined\"){\n\t\t\tnedges[e.source][e.target] = e;\n\t\t}\n\t\telse {\n\t\t\tfor(var k in e){\n\t\t\t\tif(typeof nedges[e.source][e.target][k] == \"undefined\") nedges[e.source][e.target][k] = e[k];\n\t\t\t}\n\t\t}\n\t\tif(this.nodes_referenced_by_edges.indexOf(e.source) == -1) this.nodes_referenced_by_edges.push(e.source);\n\t\tif(this.nodes_referenced_by_edges.indexOf(e.target) == -1) this.nodes_referenced_by_edges.push(e.target);\n\t}\n\tvar fedges = [];\n\tfor(var k in nedges){\n\t\tfor(var k2 in nedges[k]){\n\t\t\tfedges.push(nedges[k][k2]);\n\t\t}\n\t}\n\treturn fedges;\n}\n\n\n\nWOQLGraph.prototype.getNodes = function(){\n\treturn  this.nodes;\n}\n\n\n\nWOQLGraph.prototype.includeNode = function(v, row){\n\tconst matched_rules = new WOQLRule().matchNode(this.config.rules, row, v, false, \"hidden\");\n\tfor(var i = 0; i<matched_rules.length; i++){\n\t\tif(matched_rules[i].rule.hidden) return false;\n\t}\n\treturn true;\n}\n\nWOQLGraph.prototype.includeLiteralNode = function(v, row){\n\tlet l = this.config.literals();\n\tif(typeof l != \"undefined\" && !l) return false;\n\tconst matched_rules = new WOQLRule().matchNode(this.config.rules, row, v, false, \"hidden\");\n\tfor(var i = 0; i<matched_rules.length; i++){\n\t\tif(matched_rules[i].rule.hidden) return false;\n\t}\n\treturn true;\n}\n\n\nWOQLGraph.prototype.includeRow = function(row, num){\n\tconst matched_rules = new WOQLRule().matchRow(this.config.rules, row, num, \"hidden\");\n\tfor(var i = 0; i<matched_rules.length; i++){\n\t\tif(matched_rules[i].rule.hidden) return false;\n\t}\n\treturn true;\n}\n\n\n\nmodule.exports = WOQLGraph;","\nconst Config  = require('./viewConfig.js');\nconst WOQLChart  = require('./woqlChart.js');\n\nfunction WOQLChartConfig(){\n    Config.ViewConfig.call(this); \n    this.type = \"chart\";\n}\n\nWOQLChartConfig.prototype = Object.create(Config.ViewConfig.prototype);\nWOQLChartConfig.prototype.constructor = Config.ViewConfig;\n\n\nWOQLChartConfig.prototype.prettyPrint = function(){\n    var str = \"view = View.chart();\\n\";\n    for(var i = 0; i<this.rules.length ; i++){\n\t\tstr += \"view.\" + this.rules[i].prettyPrint() + \"\\n\";\n\t}\n\tif(typeof this.margin() != \"undefined\"){\n\t\tstr += \"view.margin(\" + this.margin() + \")\\n\";\n\t}\n\tif(typeof this.title() != \"undefined\"){\n\t\tstr += \"view.title('\" + this.title() + \"')\\n\";\n\t}\n\tif(typeof this.description() != \"undefined\"){\n\t\tstr += \"view.description('\" + this.description() + \"')\\n\";\n\t}\n\tif(typeof this.layout() != \"undefined\"){\n\t\tstr += \"view.layout('\" + this.layout() + \"')\\n\";\n\t}\n\t\n    str += this.getBasicPrettyPrint();\n\treturn str;\n}\n\nWOQLChartConfig.prototype.json = function(){\n\t/*\n\t*general properties \n\t*/\n\tvar conf = {};\n\tif(typeof this.margin() != \"undefined\"){\n\t\tconf['margin'] = this.margin();\n\t}\n\tif(typeof this.title() != \"undefined\"){\n\t\tconf['title'] = this.title();\n\t}\n\tif(typeof this.description() != \"undefined\"){\n\t\tconf['description'] = this.description();\n\t}\n\tif(typeof this.layout() != \"undefined\"){\n\t\tconf['layout'] = this.layout();\n\t}\n\n\tlet mj = {\"chart\" :conf, \"rules\": this.getRulesJSON()};\n\treturn mj;\n}\n\nWOQLChartConfig.prototype.loadJSON = function(config, rules){\n    this.loadBasicJSON(config);\n    var jr = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tvar nr = new WOQLChartRule();\n\t\tnr.json(rules[i]);\n\t\tjr.push(nr);\n\t}\n\tthis.rules = jr;\n\tif(typeof config.margin != \"undefined\"){\n\t\tthis.margin(config.margin);\n\t}\n\tif(typeof config.title != \"undefined\"){\n\t\tthis.title(config.title);\n\t}\n\tif(typeof config.description != \"undefined\"){\n\t\tthis.description(config.description);\n\t}\n\tif(typeof config.layout != \"undefined\"){\n\t\tthis.layout(config.layout);\n\t}\n}\n\nWOQLChartConfig.prototype.title = function(title){\n\tif(typeof title == \"undefined\"){\n\t\treturn this._title;\n\t}\n\tthis._title = title;\n\treturn this;\n}\n\nWOQLChartConfig.prototype.description=function(description){\n\tif(description){\n\t\tthis._description=description;\n\t\treturn this\n\t}\n\treturn this._description;\n}\n\n//layout \"vertical\" | \"horizontal\"\nWOQLChartConfig.prototype.layout=function(layout){\n\tif(layout){\n\t\tthis._layout=layout;\n\t\treturn this\n\t}\n\treturn this._layout;\n}\n\n\n//default is { top: 10, right: 30, left: 0, bottom: 80 }\nWOQLChartConfig.prototype.margin=function(marginObj){\n\tif(marginObj){\n\t\tthis._margin=marginObj;\n\t\treturn this\n\t}\n\n\treturn this._margin;\n}\n\n\nWOQLChartConfig.prototype.create = function(client){\n\tvar wqt = new WOQLChartConfig(client, this);\n\treturn wqt;\n}\n\n/*\n{\"XAxis\":{dataKey:\"date_i\",type:'number'}\n\t\t\t\t\t\t\t,\"chartObj\":\n\t\t\t\t\t\t\t[{'label':'Confident','dataKey':'conf',\"chartType\":\"Area\",\n\t\t\t\t\t\t\t\"style\":{\"stroke\":\"#82ca9d\", \"fillOpacity\":1, \"fill\":\"#82ca9d\"}},\n\t\t\t\t\t\t\t {'label':'Predictions','dataKey':'predictions',\"chartType\":\"Line\",\n\t\t\t\t\t\t\t \"style\":{\"strokeWidth\":2, \"stroke\":\"#ff8000\"}},\n\t\t\t\t\t\t\t {'label':'Picks','dataKey':'picks',\"chartType\":\"Point\",\"style\": \n\t\t\t\t\t\t\t {\"stroke\": '#8884d8', \"fill\": '#8884d8'}},\n\t\t\t\t\t\t\t {'label':'Stock','dataKey':'stock',\"chartType\":\"Line\",\"style\":\n\t\t\t\t\t\t\t  {\"stroke\": '#0000ff', \"fill\": '#0000ff'}}]}\n\n{\"XAxis\":{dataKey:\"v:Date\",\"label\":{rotate:\"-50\"}},\"chartObj\":\n\t\t\t\t\t\t\t  \t[{'dot':true, 'label':'Quantity','dataKey':'v:Quantity',\"chartType\":\"Line\",  \n\t\t\t\t\t\t\t  \t  \"style\": {\"stroke\": '#FF9800', \"fill\": '#FF9800'}}]\n\t\t\t\t\t\t\t  }\n*/\n\n\nWOQLChartConfig.prototype.xAxis = function(...vars){\n\tlet woqlRule = new WOQLChartRule().scope(\"XAxis\");\n\twoqlRule.setVariables(vars);\n\tthis.rules.push(woqlRule);\n\treturn woqlRule;\n}\n\nWOQLChartConfig.prototype.bar = function(...vars){\n\tlet woqlRule=new WOQLChartRule().scope(\"Bar\");\n\twoqlRule.setVariables(vars);\n\tthis.rules.push(woqlRule);\n\treturn woqlRule;\n}\n\nWOQLChartConfig.prototype.line=function(...vars){\n\tlet woqlRule=new WOQLChartRule().scope(\"Line\");\n\twoqlRule.setVariables(vars);\n\tthis.rules.push(woqlRule);\n\treturn woqlRule;\n}\n\nWOQLChartConfig.prototype.point=function(...vars){\n\tlet woqlRule=new WOQLChartRule().scope(\"Point\");\n\twoqlRule.setVariables(vars);\n\tthis.rules.push(woqlRule);\n\treturn woqlRule;\n}\n\nWOQLChartConfig.prototype.area=function(...vars){\n\tlet woqlRule=new WOQLChartRule().scope(\"Area\");\n\twoqlRule.setVariables(vars);\n\tthis.rules.push(woqlRule);\n\treturn woqlRule;\n}\n\n/**\n * \n * @param {Chart} scope  \n */\nfunction WOQLChartRule(){\n\tConfig.WOQLViewRule.call(this); \n};\n\nWOQLChartRule.prototype = Object.create(Config.WOQLViewRule.prototype);\nWOQLChartRule.prototype.constructor = Config.WOQLViewRule;\n\nWOQLChartRule.prototype.style=function(key,value){\n\tif(value){\n\t\tthis.rule[key]=value;\n\t\treturn this;\n\t}\n\treturn this.rule[key];\n}\n\nWOQLChartRule.prototype.label = function(label){\n\tif(label){\n\t\tthis.rule.label = label;\n\t\treturn this;\n\t}\n\treturn this.rule.label;\n}\n\n/*\n*line is the default value\n* 'line' | 'square' | 'rect'| 'circle' | 'cross' | 'diamond' | 'square' | 'star' | 'triangle' | 'wye' | 'none'\n*/\n\nWOQLChartRule.prototype.legendType = function(legendType){\n\tif(legendType){\n\t\tthis.rule.legendType = legendType;\n\t\treturn this;\n\t}\n\treturn this.rule.legendType;\n}\n\n\nWOQLChartRule.prototype.fill=function(color){\n\tif(color){\n\t\tthis.rule.fill = color;\n\t\treturn this;\n\t}\n\treturn this.rule.fill;\n}\n\nWOQLChartRule.prototype.stroke=function(color){\n\tif(color){\n\t\tthis.rule['stroke'] = color;\n\t\treturn this;\n\t}\n\treturn this.rule['stroke'];\n}\n\n\nWOQLChartRule.prototype.strokeWidth=function(size){\n\tif(typeof size != \"undefined\"){\n\t\tthis.rule.strokeWidth = size;\n\t\treturn this;\n\t}\n\treturn this.rule.strokeWidth;\n}\n\n\nWOQLChartRule.prototype.dot=function(isVisible){\n\tif(typeof isVisible != \"undefined\"){\n\t\tthis.rule.dot = isVisible;\n\t\treturn this;\n\t}\n\treturn this.rule.dot;\n}\n\nWOQLChartRule.prototype.labelRotate=function(angle){\n\tif(angle!==undefined){\n\t\tthis.rule.labelRotate = angle;\n\t\treturn this\n\t}\n\treturn this.rule.labelRotate;\n}\n\n//Specify the padding of x-axis. DEFAULT: { left: 0, right: 0 }\nWOQLChartRule.prototype.padding=function(paddingObj){\n\tif(paddingObj){\n\t\tthis.rule.padding=paddingObj;\n\t\treturn this\n\t}\n\n\treturn this.rule.padding;\n}\n\n/*\n* The type of xAxis or yAxis 'number' | 'category' default is 'category'.\n* The type of line chart 'basis'|'basisClosed'|'basisOpen'|'linear'|'linearClosed'|'natural'|'monotoneX'|'monotoneY'|'monotone' | 'step' | 'stepBefore' | 'stepAfter' | \n*/\n\nWOQLChartRule.prototype.type=function(type){\n\tif(type){\n\t\tthis.rule.type=type\n\t\treturn this;\n\t}\n\treturn this.rule.type\n}\n/*\n* works only if type is number\n* domainArr =[min,max];\n*/\nWOQLChartRule.prototype.axisDomain=function(domainArr){\n\tif(domainArr){\n\t\tthis.rule.domain=domainArr\n\t\treturn this;\n\t}\n\treturn this.rule.domain\n}\n\n\nWOQLChartRule.prototype.barSize=function(barSize){\n\tif(barSize){\n\t\tthis.rule.barSize=barSize\n\t\treturn this;\n\t}\n\treturn this.rule.barSize\n}\n\nmodule.exports = WOQLChartConfig;","const WOQLChartConfig = require(\"./chartConfig\");\n\nfunction WOQLChart(client, config){\n\tthis.client = client;\n\tthis.config = (config ? config : new WOQLChartConfig());\n\treturn this;\n}\n\nWOQLChart.prototype.options = function(config){\n\tthis.config = config;\n\treturn this;\n}\n\nWOQLChart.prototype.setResult = function(res){\n\tthis.result = res;\n\treturn this;\n}","const Config  = require('./viewConfig.js');\nconst WOQLStream  = require('./woqlStream.js');\n\nfunction WOQLStreamConfig(){\n    Config.ViewConfig.call(this); \n    this.type = \"stream\";\n}\n\nWOQLStreamConfig.prototype = Object.create(Config.ViewConfig.prototype);\nWOQLStreamConfig.prototype.constructor = Config.ViewConfig;\n\nWOQLStreamConfig.prototype.create = function(client){\n\tvar wqt = new WOQLStream(client, this);\n\treturn wqt;\n}\n\nWOQLStreamConfig.prototype.row = function(){\n    var wqt = new WOQLStreamRule().scope(\"row\");\n    this.rules.push(wqt);    \n\treturn wqt;\n}\n\nWOQLStreamConfig.prototype.template = function(template){\n\tif(!template) return this.mtemplate; \n\tthis.mtemplate = template;\n\treturn this;\n}\n\n\nWOQLStreamConfig.prototype.prettyPrint = function(){\n\tvar str = \"view = View.stream();\\n\";\n\tif(typeof this.template() != \"undefined\"){\n\t\tstr += \"view.template(\" + JSON.stringify(this.template()) + \")\\n\";\n\t}\n\tfor(var i = 0; i<this.rules.length ; i++){\n\t\tstr += \"view.\" + this.rules[i].prettyPrint() + \"\\n\";\n\t}\n\treturn str;\n}\n\nWOQLStreamConfig.prototype.loadJSON = function(config, rules){\n\tvar jr = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tvar nr = new WOQLStreamRule();\n\t\tnr.json(rules[i]);\n\t\tjr.push(nr);\n\t}\n\tthis.rules = jr;\n\tif(config.template){\n\t\tthis.mtemplate = config.template;\n\t}\n}\n\nWOQLStreamConfig.prototype.json = function(){\n\tlet jr = [];\n\tfor(var i = 0; i<this.rules.length; i++){\n\t\tjr.push(this.rules[i].json());\n\t}\n\tvar conf = {};\n\tif(this.mtemplate){\n\t\tconf.template = this.mtemplate;\n\t}\n\tlet mj = {\"stream\" :conf, \"rules\": jr};\n\treturn mj;\n}\n\nfunction WOQLStreamRule(){\n\tConfig.WOQLViewRule.call(this); \n};\n\nWOQLStreamRule.prototype = Object.create(Config.WOQLViewRule.prototype);\nWOQLStreamRule.prototype.constructor = Config.WOQLViewRule;\n\nWOQLStreamRule.prototype.template = function(template){\n\tif(!template) return this.rule.template; \n\tthis.rule.template = template;\n\treturn this;\n}\n\nmodule.exports = WOQLStreamConfig;","const WOQLStreamConfig = require(\"./streamConfig\");\n\nfunction WOQLStream(client, config){\n\tthis.client = client;\n\tthis.config = (config ? config : new WOQLStreamConfig());\n\treturn this;\n}\n\nWOQLStream.prototype.options = function(config){\n\tthis.config = config;\n\treturn this;\n}\n\nWOQLStream.prototype.setResult = function(wqrs){\n\tthis.result = wqrs;\n}\n\nmodule.exports = WOQLStream;","\nconst Config  = require('./viewConfig.js');\nconst FrameRule  = require('../frameRule.js');\nconst DocumentFrame  = require('./documentFrame.js');\n\n\n/**\n * @file Frame Config \n * @license Apache Version 2\n */\nfunction FrameConfig(){\n    Config.ViewConfig.call(this); \n    this.type = \"document\";\n}\n\nFrameConfig.prototype = Object.create(Config.ViewConfig.prototype);\nFrameConfig.prototype.constructor = Config.ViewConfig;\n\nFrameConfig.prototype.create = function(client){\n\tvar tf = new DocumentFrame(client, this);\n\treturn tf;\n}\n\nFrameConfig.prototype.prettyPrint = function(){\n    var str = \"view = View.document();\\n\";\n    str += this.getBasicPrettyPrint();\n\tif(typeof this.load_schema() != \"undefined\"){\n\t\tstr += \"view.load_schema(\" + this.load_schema() + \")\\n\";\n\t}\n\tfor(var i = 0; i<this.rules.length ; i++){\n\t\tstr += \"view.\" + this.rules[i].prettyPrint() + \"\\n\";\n\t}\n\treturn str;\n}\n\nFrameConfig.prototype.json = function(){\n\tvar conf = this.getBasicJSON();\n\tif(typeof this.load_schema() != \"undefined\"){\n\t\tconf['load_schema'] = this.load_schema();\n\t}\n\tlet mj = {\"frame\" :conf, \"rules\": this.getRulesJSON()};\n\treturn mj;\n}\n\nFrameConfig.prototype.loadJSON = function(config, rules){\n\tvar jr = [];\n\tfor(var i = 0; i<rules.length; i++){\n\t\tvar nr = new DocumentRule();\n\t\tnr.json(rules[i]);\n\t\tjr.push(nr);\n\t}\n    this.rules = jr;\n    this.loadBasicJSON(config);\n\tif(typeof config.load_schema != \"undefined\"){\n\t\tthis.load_schema(config.load_schema);\n\t}\n\treturn this;\n}\n\nFrameConfig.prototype.json_rules = function(){\n\tlet jr = [];\n\tfor(var i = 0; i<this.rules.length; i++){\n\t\tjr.push(this.rules[i].json());\n\t}\n\treturn jr;\n}\n\nFrameConfig.prototype.load_schema = function(tf){\n\tif(typeof tf == \"undefined\") return this.get_schema;\n\tthis.get_schema = tf;\n\treturn this;\n}\n\nFrameConfig.prototype.show_all = function(r){\n\tthis.all().renderer(r);\n\treturn this;\n}\n\nFrameConfig.prototype.show_parts = function(o, p, d){\n\tthis.object().renderer(o);\n\tthis.property().renderer(p);\n\tthis.data().renderer(d);\n\treturn this;\n}\n\nFrameConfig.prototype.object = function(){\n\tlet fp = new DocumentRule().scope(\"object\");\n\tthis.rules.push(fp);\n\treturn fp;\n}\n\nFrameConfig.prototype.property = function(){\n\tlet fp = new DocumentRule().scope(\"property\");\n\tthis.rules.push(fp);\n\treturn fp;\n}\n\nFrameConfig.prototype.scope = function(scope){\n\tlet fp = new DocumentRule().scope(scope);\n\tthis.rules.push(fp);\n\treturn fp;\n}\n\nFrameConfig.prototype.data = function(){\n\tlet fp = new DocumentRule().scope(\"data\");\n\tthis.rules.push(fp);\n\treturn fp;\n}\n\nFrameConfig.prototype.all = function(){\n\tlet fp = new DocumentRule().scope(\"*\");\n\tthis.rules.push(fp);\n\treturn fp;\n}\n\n/**\n * Attaches display options to frames from matching rules\n */\nFrameConfig.prototype.setFrameDisplayOptions = function(frame, rule){\n\tif(typeof frame.display_options == \"undefined\") frame.display_options = {};\n\tif(typeof rule.mode() != \"undefined\") {\tframe.display_options.mode = rule.mode();}\n\tif(typeof rule.view() != \"undefined\") frame.display_options.view = rule.view();\n\tif(typeof rule.showDisabledButtons() != \"undefined\") frame.display_options.show_disabled_buttons = rule.showDisabledButtons();\n\tif(typeof rule.hidden() != \"undefined\") frame.display_options.hidden = rule.hidden();\n\tif(typeof rule.collapse() != \"undefined\") frame.display_options.collapse = rule.collapse();\n\tif(typeof rule.style() != \"undefined\") frame.display_options.style = rule.style();\n\tif(typeof rule.headerStyle() != \"undefined\") frame.display_options.header_style = rule.headerStyle();\n\tif(typeof rule.features() != \"undefined\") {\t\tframe.display_options.features = this.setFrameFeatures(frame.display_options.features, rule.features());\t}\n\tif(typeof rule.headerFeatures() != \"undefined\") frame.display_options.header_features = this.setFrameFeatures(frame.display_options.header_features, rule.headerFeatures());\n\tif(typeof rule.header() != \"undefined\") frame.display_options.header = rule.header();\n\tif(typeof rule.showEmpty() != \"undefined\") frame.display_options.show_empty = rule.showEmpty();\n\tif(typeof rule.dataviewer() != \"undefined\") frame.display_options.dataviewer = rule.dataviewer();\n\tif(typeof rule.args() != \"undefined\") frame.display_options.args = this.setFrameArgs(frame.display_options.args, rule.args());\n}\n\n/*\nConsolidates properties of features sent in in different rules\n*/\nFrameConfig.prototype.setFrameFeatures = function(existing, fresh){\n\t//preserve order of existing\n\tif(!existing || !existing.length) return fresh;\n\tif(!fresh || !fresh.length)  return existing;\n\tlet got = [];\n\tfor(var i = 0; i< existing.length; i++){\n\t\tvar key = (typeof existing[i] == \"string\" ? existing[i] : Object.keys(existing[i])[0]);\n\t\tgot.push(key);\n\t}\n\tfor(var j = 0; j< fresh.length; j++){\n\t\tvar fkey = (typeof fresh[j] == \"string\" ? fresh[j] : Object.keys(fresh[j])[0]);\n\t\tvar rep = got.indexOf(fkey);\n\t\tif(rep == -1) existing.push(fresh[j]);\n\t\telse if(typeof fresh[j] == \"object\"){\n\t\t\tvar val = existing[rep];\n\t\t\tif(typeof val == 'string') existing[rep] = fresh[j];\n\t\t\telse if(typeof val == 'object'){\n\t\t\t\tvar props = fresh[j][fkey];\n\t\t\t\tfor(var p in props){\n\t\t\t\t\texisting[rep][fkey][p] = props[p];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn existing;\t\n}\n\nFrameConfig.prototype.setFrameArgs = function(existing, fresh){\n\tif(!existing) return fresh;\n\tif(!fresh) return existing;\n\tfor(var k in fresh){\n\t\texisting[k] = fresh[k];\n\t}\n\treturn existing;\n}\n\n/**\n * @file Document Rule\n * @license Apache Version 2\n */\n\nfunction DocumentRule(){\n\tFrameRule.call(this); \n\tthis.rule = {};\n};\n\nDocumentRule.prototype = Object.create(FrameRule.prototype);\nDocumentRule.prototype.constructor = FrameRule;\n\nDocumentRule.prototype.renderer = function(rend){\n\tif(typeof rend == \"undefined\"){\n\t\treturn this.rule.renderer;\n\t}\n\tthis.rule.renderer = rend;\n\treturn this;\n}\n\nDocumentRule.prototype.compare = function(func){\n\tif(typeof func == \"undefined\"){\n\t\treturn this.rule.compare;\n\t}\n\tthis.rule.compare = func;\n\treturn this;\n}\n\nDocumentRule.prototype.mode = function(mode){\n\tif(typeof mode == \"undefined\"){\n\t\treturn this.rule.mode;\n\t}\n\tthis.rule.mode = mode;\n\treturn this;\n}\n\nDocumentRule.prototype.collapse = function(func){\n\tif(typeof func == \"undefined\"){\n\t\treturn this.rule.collapse;\n\t}\n\tthis.rule.collapse = func;\n\treturn this;\n}\n\nDocumentRule.prototype.view = function(m){\n\tif(!m) return this.rule.view;\n\tthis.rule.view = m;\n\treturn this;\n}\n\n/**\n * Should actions which are disabled in the given context be displayed?\n */\nDocumentRule.prototype.showDisabledButtons = function(m){\n\tif(typeof m == \"undefined\") return this.rule.show_disabled_buttons;\n\tthis.rule.show_disabled_buttons = m;\n\treturn this;\n}\n\nDocumentRule.prototype.header = function(m){\n\tif(!m) return this.rule.header;\n\tthis.rule.header = m;\n\treturn this;\n}\n\nDocumentRule.prototype.headerStyle = function(m){\n\tif(!m) return this.rule.headerStyle;\n\tthis.rule.headerStyle = m;\n\treturn this;\n}\n\nDocumentRule.prototype.showEmpty = function(m){\n\tif(!m) return this.rule.show_empty;\n\tthis.rule.show_empty = m;\n\treturn this;\n}\n\nDocumentRule.prototype.dataviewer = function(m){\n\tif(!m) return this.rule.dataviewer;\n\tthis.rule.dataviewer = m;\n\treturn this;\n}\n\nDocumentRule.prototype.features = function(...m){\n\tif(typeof m == \"undefined\" || m.length == 0) return this.rule.features;\n\tthis.rule.features = m;\n\treturn this;\n}\n\nDocumentRule.prototype.headerFeatures = function(...m){\n\tif(typeof m == \"undefined\" || m.length == 0) return this.rule.header_features;\n\tthis.rule.header_features = m;\n\treturn this;\n}\n\nDocumentRule.prototype.render = function(func){\n\tif(!func) return this.rule.render;\n\tvar hf = this.headerFeatures(); \n\tvar f = this.features(); \n\tif(hf && hf.length){\n\t\tvar feats = this.applyFeatureProperty(hf, \"render\", func);\n\t\tthis.headerFeatures(...feats);\n\t}\n\telse if(f && f.length){\n\t\tvar feats = this.applyFeatureProperty(f, \"render\", func);\n\t\tthis.features(...feats);\n\t}\n\telse {\n\t\tthis.rule.render = func;\n\t}\n\treturn this;\n}\n\nDocumentRule.prototype.style = function(style){\n\tif(typeof style == \"undefined\") return this.rule.style;\n\tvar hf = this.headerFeatures(); \n\tvar f = this.features(); \n\tif(hf && hf.length){\n\t\tvar feats = this.applyFeatureProperty(hf, \"style\", style);\n\t\tthis.headerFeatures(...feats);\n\t}\n\telse if(f && f.length){\n\t\tvar feats = this.applyFeatureProperty(f, \"style\", style);\n\t\tthis.features(...feats);\n\t}\n\telse {\n\t\tthis.rule.style = style;\n\t}\n\treturn this;\n};\n\n/**\n * The frame or feature will be hidden or unhidden (boolean)\n */\nDocumentRule.prototype.hidden = function(m){\n\tif(typeof m == \"undefined\") return this.rule.hidden;\n\tvar hf = this.headerFeatures(); \n\tvar f = this.features(); \n\tif(hf && hf.length){\n\t\tvar feats = this.applyFeatureProperty(hf, \"hidden\", m);\n\t\tthis.headerFeatures(...feats);\n\t}\n\telse if(f && f.length){\n\t\tvar feats = this.applyFeatureProperty(f, \"hidden\", m);\n\t\tthis.features(...feats);\n\t}\n\telse {\n\t\tthis.rule.hidden = m;\n\t}\n\treturn this;\n}\n\n/**\n * Specifies arguments to a renderer \n */\nDocumentRule.prototype.args = function(json){\n\tif(!json) return this.rule.args;\n\tvar hf = this.headerFeatures(); \n\tvar f = this.features(); \n\tif(hf && hf.length){\n\t\tvar feats = this.applyFeatureProperty(hf, \"args\", json);\n\t\tthis.headerFeatures(...feats);\n\t}\n\telse if(f && f.length){\n\t\tvar feats = this.applyFeatureProperty(f, \"args\", json);\n\t\tthis.features(...feats);\n\t}\n\telse {\n\t\tthis.rule.args = json;\n\t}\n\treturn this;\n}\n\n/**\n * Adds a property to a feature array\n */\nDocumentRule.prototype.applyFeatureProperty = function(feats, prop, val){\n\tvar nfeats = [];\n\tfor(var i = 0; i<feats.length; i++){\n\t\tif(typeof feats[i] == \"string\"){\n\t\t\tvar nfeat = {};\n\t\t\tnfeat[feats[i]] = {};\n\t\t\tnfeat[feats[i]][prop] = val;\n\t\t\tnfeats.push(nfeat);\n\t\t}\n\t\telse if(typeof feats[i] == \"object\"){\n\t\t\tlet fkey = Object.keys(feats[i])[0];\n\t\t\tif(fkey){\n\t\t\t\tvar nfeat = feats[i];\n\t\t\t\tnfeat[fkey][prop] = val;\n\t\t\t\tnfeats.push(nfeat);\n\t\t\t}\n\t\t}\n\t}\n\treturn nfeats;\n}\n\nDocumentRule.prototype.unpackFeatures = function(feats){\n\tlet extensions = {};\n\tvar fstr = \"\";\n\tfor(var i = 0; i<feats.length; i++){\n\t\tif(typeof feats[i] == \"string\"){\n\t\t\tfstr += '\"' + feats[i] + '\"';\n\t\t}\n\t\telse if(typeof feats[i] == \"object\"){\n\t\t\tvar fid = Object.keys(feats[i])[0];\n\t\t\tfstr += '\"' +  fid + '\"';\n\t\t\tfor(var prop in feats[i][fid]){\n\t\t\t\textensions[prop] = feats[i][fid][prop];\n\t\t\t}\n\t\t}\n\t\tif(i < feats.length - 1){\n\t\t\tfstr += \", \"\n\t\t}\n\t}\n\tfor(var k = 0; k < Object.keys(extensions).length; k++){\n\t\tvar ext = Object.keys(extensions)[k];\n\t\tvar val = extensions[ext];\n\t\tfstr += \").\" + ext + \"(\";\n\t\tif(typeof val == \"function\"){\n\t\t\tfstr += val;\n\t\t}\n\t\telse if(typeof val == \"string\"){\n\t\t\tfstr += '\"' + val + '\"';\n\t\t}\n\t\telse if(typeof val == \"object\"){\n\t\t\tfstr += JSON.stringify(val);\n\t\t}\n\t}\n\treturn fstr;\n}\n\nDocumentRule.prototype.prettyPrint = function(){\n\tif(this.pattern){\n\t\tstr = this.pattern.prettyPrint();\n\t}\n\tif(typeof this.renderer() != \"undefined\"){\n\t\tstr += \".renderer('\" + this.renderer() + \"')\";\n\t}\n\tif(typeof this.render() != \"undefined\"){\n\t\tstr += \".render(\" + this.render + \")\";\n\t}\n\tif(typeof this.compare() != \"undefined\"){\n\t\tstr += \".compare(\" + this.compare() + \")\";\n\t}\n\tif(typeof this.mode() != \"undefined\"){\n\t\tstr += \".mode('\" + this.mode() + \"')\";\n\t}\n\tif(typeof this.collapse() != \"undefined\"){\n\t\tstr += \".collapse(\" + this.collapse() + \")\";\n\t}\n\tif(typeof this.hidden() != \"undefined\"){\n\t\tstr += \".hidden(\" + this.hidden() + \")\";\n\t}\n\tif(typeof this.view() != \"undefined\"){\n\t\tstr += \".view('\" + this.view() + \"')\";\n\t}\n\tif(typeof this.showDisabledButtons() != \"undefined\"){\n\t\tstr += \".showDisabledButtons(\" + this.showDisabledButtons() + \")\";\n\t}\n\tif(typeof this.header() != \"undefined\"){\n\t\tstr += \".header(\" + this.header() + \")\";\n\t}\n\tif(typeof this.style() != \"undefined\"){\n\t\tstr += \".style(\\\"\" + this.style() + \"\\\")\";\n\t}\n\tif(typeof this.headerStyle() != \"undefined\"){\n\t\tstr += \".headerStyle(\\\"\" + this.headerStyle() + \"\\\")\";\n\t}\n\tif(typeof this.args() != \"undefined\"){\n\t\tstr += \".args(\" + JSON.stringify(this.args()) + \")\";\n\t}\n\tif(typeof this.showEmpty() != \"undefined\"){\n\t\tstr += \".showEmpty(\" + this.show_empty() + \")\";\n\t}\n\tif(typeof this.dataviewer() != \"undefined\"){\n\t\tstr += \".dataviewer(\\\"\" + this.dataviewer() + \"\\\")\";\n\t}\n\tif(typeof this.features() != \"undefined\"){\n\t\tstr += \".features(\" + this.unpackFeatures(this.features()) + \")\";\n\t}\n\tif(typeof this.headerFeatures() != \"undefined\"){\n\t\tstr += \".headerFeatures(\" + this.unpackFeatures(this.headerFeatures()) + \")\";\n\t}\n\treturn str;\n}\n\nmodule.exports = FrameConfig;","const ObjectFrame = require(\"../objectFrame\");\nconst FrameConfig = require(\"./frameConfig\");\nconst FrameHelper = require(\"../utils\");\n\n/**\n * @file Document Frame \n * @license Apache Version 2\n */\n\n\nfunction DocumentFrame(client, config){\n\tthis.client = client;\n\tthis.config = (config ? config : new FrameConfig());\n\tthis.load_schema = false;\n}\n\nDocumentFrame.prototype.options = function(opts){\n\tthis.config = opts;\n\treturn this;\n}\n\nDocumentFrame.prototype.db = function(dburl){\n    this.client.connectionConfig.setDB(dburl);\n    return this;\n}\n\nDocumentFrame.prototype.load = function(url, cls){\n\tif(url) {\n\t\tif(url.substring(0,4) == \"doc:\"){\n\t\t\turl = url.substring(4);\n\t\t}\n\t\tif(this.config.load_schema()){\n\t\t\treturn this.loadComplete(url, cls)\n\t\t}\n\t\telse {\n\t\t\treturn this.loadDocument(url);\n\t\t}\n\t}\n\tif(cls){\n\t\treturn this.loadSchema(cls);\n\t}\n\t//return Promise.reject\n}\n\n/**\n *  @param {String} url - loads the document frame from the document API in frame form\n *  - loads the frame encapsulates more meta-data in the json and reduces the number of api calls we need to make\n *  @returns {Promise}\n */\nDocumentFrame.prototype.loadDocument = function(url, encoding){\n     encoding = encoding || \"terminus:frame\";\n\t return this.client.getDocument(url, {\"terminus:encoding\": encoding})\n\t.then((response) => {\n\t\t(encoding == \"terminus:frame\" ? this.loadDataFrames(response) : this.loadJSON(response));\n\t});\n}\n\nDocumentFrame.prototype.loadSchema = function(cls, dbURL){\n\tvar ncls = FrameHelper.unshorten(cls);\n\treturn this.client.getClassFrame(dbURL, ncls)\n\t.then((response) => this.loadSchemaFrames(response, ncls));\n}\n\n/**\n *  @param {String} url - loads the document frame along with its class frame\n *  @param {String} [cls] - optional class id of the document - if absent class frames will be loaded from the document class once it is loaded\n *  @returns {Promise}\n *  - loads a document frame and it's class frame in unison\n */\n\nDocumentFrame.prototype.loadComplete = function(url, cls){\n    if(cls){\n        return Promise.all([this.loadDocument(url), this.loadDocumentSchema(cls)]);        \n    }\n    else {\n\t    return this.loadDocument(url)\n        .then((response) =>  {\n\t\t\tthis.loadSchema(this.document.cls);\n\t\t});\n    }\n}\n\nDocumentFrame.prototype.loadJSON = function(json, type){\n    if(this.docid){\n        return this.loadDocument(this.docid);\n    }\n    else if(this.clsid){\n        return this.loadDocumentSchema(this.clsid);\n    }\n    console.error(\"Either docid or clid must be set before load is called\")\n}\n\nDocumentFrame.prototype.loadDataFrames = function(dataframes, cls, classframes){\n\tif(!cls){\n\t\tif(this.document) cls = this.document.cls;\n\t\telse {\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\n\t\t\t\tcls = dataframes[0].domain;\n\t\t\t}\n\t\t}\n\t}\n\tif(cls){\n\t\tif(!this.document){\n\t\t\tthis.document = new ObjectFrame(cls, dataframes, classframes);\n\t\t}\n\t\telse {\n\t\t\tthis.document.loadDataFrames(dataframes);\n\t\t}\n\t}\n\telse {\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\n\t}\n}\n\nDocumentFrame.prototype.loadSchemaFrames = function(classframes, cls){\n\tif(!cls){\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\n\t\t\tcls = classframes[0].domain;\n\t\t}\n\t}\n\tif(cls){\n\t\tif(!this.document){\n\t\t\tthis.document = new ObjectFrame(cls);\n\t\t}\n\t\tif(classframes){\n\t\t\tthis.document.loadClassFrames(classframes);\n\t\t\tif(!this.document.subjid){\n\t\t\t\tthis.document.newDoc = true;\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing both class and classframes\");\n\t}\n}\n\n/*\n * adds render and compare functions to object frames\n */\nDocumentFrame.prototype.applyRules = function(doc, config, mymatch){\n\tdoc = (doc ? doc : this.document);\n\tconfig = (config ? config : this.config);\n\tvar self = this;\n\tvar onmatch = function(frame, rule){\n\t\tconfig.setFrameDisplayOptions(frame, rule);\n\t\tif(mymatch) mymatch(frame, rule);\n\t};\n\tdoc.filter(config.rules, onmatch);\n}\n\nmodule.exports = DocumentFrame ;\n","const HTMLStringViewer = require('./datatypes/String');\nconst HTMLStringEditor = require('./datatypes/StringEditor');\nconst HTMLBooleanViewer = require('./datatypes/Boolean');\nconst HTMLBooleanEditor = require('./datatypes/BooleanEditor');\nconst HTMLChoiceViewer = require('./datatypes/Choice');\nconst HTMLChoiceEditor = require('./datatypes/ChoiceEditor');\nconst HTMLCoordinateViewer = require('./datatypes/Coordinate');\nconst HTMLCoordinateEditor = require('./datatypes/CoordinateEditor');\nconst HTMLDateViewer = require('./datatypes/Date');\nconst HTMLDateEditor = require('./datatypes/DateEditor');\nconst HTMLEntityViewer = require('./datatypes/Entity');\nconst HTMLEntityEditor = require('./datatypes/EntityEditor');\nconst HTMLImageViewer = require('./datatypes/Image');\nconst HTMLImageEditor = require('./datatypes/ImageEditor');\nconst HTMLLinkViewer = require('./datatypes/Link');\nconst HTMLNumberViewer = require('./datatypes/Number');\nconst HTMLRangeViewer = require('./datatypes/Range');\nconst HTMLRangeEditor = require('./datatypes/RangeEditor');\nconst GoogleMapEditor = require('./datatypes/GoogleMapEditor');\nconst GoogleMapViewer = require('./datatypes/GoogleMapViewer');\nconst HTMLMarkupEditor = require('./datatypes/HTMLMarkupEditor');\nconst S2EntityEditor = require('./datatypes/S2EntityEditor');\n\n\nfunction initialiseDataRenderers(RenderingMap, plugins, options){\n\tRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", {label: \"Checkbox Viewer\"}, [\"xsd:boolean\"]);\n\tRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", {label: \"Checkbox Editor\"}, [\"xsd:boolean\"]);\n\tRenderingMap.registerViewerForTypes(\"HTMLChoiceViewer\", {label: \"Choice Viewer\"}, [\"oneOf\"]);\n\tRenderingMap.registerEditorForTypes(\"HTMLChoiceEditor\", {label: \"Choice Selector\"}, [\"oneOf\"]);\n\tRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", {label: \"Coordinate Viewer\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\n\tRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", {label: \"Coordinate Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\n\tRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", {label: \"Date Viewer\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\n\tRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", {label: \"Date Editor\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\t\n\tvar hevopts = {label: \"Document Viewer\"};\n\tif (options && options[\"HTMLEntityViewer\"]) hevopts.args = options[\"HTMLEntityViewer\"];\n\tRenderingMap.registerViewerForTypes(\"HTMLEntityViewer\", hevopts, [\"document\"]);\n\t//RenderingMap.registerEditorForTypes(\"HTMLEntityEditor\", {label: \"Document Selector\"}, [\"document\"]);\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\n\tRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", {label: \"Link Viewer\"}, [\"xdd:url\", \"xsd:anyURI\"]);\n\tRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", {label: \"Number with commas\"}, \n\t\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \n\t\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\n\tRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", {label: \"Range Viewer\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\n\tRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", {label: \"Range Editor\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\n\tRenderingMap.universalEditor = \"HTMLStringEditor\";\n\tRenderingMap.universalViewer = \"HTMLStringViewer\";\n\taddPlugins(RenderingMap, plugins);\n\tRenderingMap.createRenderer = function(type, args){\n\t\tlet r = createDataRenderer(type, args);\n\t\treturn r;\n\t}\n}\n\nfunction createDataRenderer(type, options){\n\ttry {\n\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"()\");\n\t\tif(viewer.options) viewer.options(options);\n\t}\n\tcatch(e){\n\t\treturn false;\n\t}\n\treturn viewer;\n}\n\nfunction addPlugins(RenderingMap, plugins){\n\tif(plugins && plugins.indexOf(\"gmaps\") != -1){\n\t\tRenderingMap.registerEditorForTypes(\"GoogleMapEditor\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\n\t\tRenderingMap.registerViewerForTypes(\"GoogleMapViewer\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\n\t}\n\tif(plugins && plugins.indexOf(\"quill\") != -1){\n\t\tRenderingMap.registerEditorForTypes(\"HTMLMarkupEditor\", {label: \"Quill WYSIWIG HTML Editor\"}, [\"xdd:html\"]);\n\t}\n\tif(plugins && plugins.indexOf(\"select2\") != -1){\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", {label: \"S2 Autocomplete Selector\"}, \"document\");\n\t}\n}\n\nmodule.exports = {createDataRenderer, initialiseDataRenderers};","function HTMLDateHelper(){\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n}\n\nHTMLDateHelper.prototype.getMonthName = function(num){\n\treturn this.months[num-1];\n}\n\nmodule.exports={HTMLDateHelper}","function GoogleMapHelper(options){\n\tthis.polygon = false;\n\tthis.polyline = false;\n\tthis.markers = [];\n\tthis.init(options);\n}\n\nGoogleMapHelper.prototype.init = function(config){\n\tthis.type = ((config && config.type) ? config.type: 'Shape'); \n\tthis.width = ((config && config.width) ? config.width : '400px'); \n\tthis.height = ((config && config.height ) ? config.height : '400px'); \n\tthis.mapLat = ((config && config.mapLat) ? config.mapLat : '41.9010004'); \n\tthis.mapLong = ((config && config.mapLong ) ? config.mapLong : '12.500061500000015');\n\tthis.zoom = ((config && config.zoom) ? config.zoom : 3);\n\tthis.stroke = ((config && config.stroke) ? config.stroke : { color: '#FF0000', opacity: 0.3, weight: 3});\n\tthis.fill = ((config && config.fill) ? config.fill : { color: '#FF0000', opacity: 0.1});\n\tthis.line = ((config && config.line) ? config.line : { color: '#000000', opacity: 0.9, weight: 3});\n}\n\nGoogleMapHelper.prototype.destroy = function(){\n    this.clear();\n} \n\nGoogleMapHelper.prototype.translatePolygonToArray = function(polygon){\n   var data = \"[\";\n   var vertices = polygon.getPath();\n   var seenValue = false;\n   for (var j=0; j<vertices.getLength(); j++){\n       if(seenValue){\n           data = data + \",\";\n       }\n       var xy = vertices.getAt(j);\n       data = data + \"[\" + xy.lat() + \",\" + xy.lng() + \"]\"\n       seenValue = true;\n   }\n   data = data + \"]\";\n   return data;\n};\n\nGoogleMapHelper.prototype.translateArrayToPolygon = function(array){\n   var jsonified = JSON.parse(array);\n   var output = [];\n   for(var i=0;i<jsonified.length;i++){\n       var latlong = {}\n       latlong.lat = jsonified[i][0];\n       latlong.lng = jsonified[i][1];\n       output.push(latlong);\n   }\n   return output;\n}\n\nGoogleMapHelper.prototype.createPolygon = function(coords, map) {\n\tvar polygon = new google.maps.Polygon({\n        paths: coords,\n        strokeColor: this.stroke.color,\n        strokeOpacity: this.stroke.opacity,\n        strokeWeight: this.stroke.weight,\n        fillColor: this.fill.color,\n        fillOpacity: this.fill.opacity\n\t});\n    polygon.setMap(map);\n\treturn polygon;\n}\n\nGoogleMapHelper.prototype.createPolyline = function(coords){\n\tvar init = {\n\t      strokeColor: this.line.color,\n\t      strokeOpacity: this.line.opacity,\n\t      strokeWeight: this.line.weight\n\t};\n\tif(coords){\n\t\tinit.paths = coords;\n\t}\n\tvar poly = new google.maps.Polyline(init);\n\treturn poly;\n}\n\nGoogleMapHelper.prototype.clearMarkers = function() {\n\tfor (var i = 0; i < this.markers.length; i++ ) {\n\t\tthis.markers[i].setMap(null);\n\t}\n\tthis.markers.length = 0;\n}\n\n\nGoogleMapHelper.prototype.addMarker = function(position, map, frame, title, ty) {\n\tvar init = {\n\t\tposition: position, \n\t\tmap: map\n\t}\n\tif(title){\n\t\tinit.title = title;\n\t}\n\tvar marker = new google.maps.Marker(init);\n\tvar self = this;\n\tif(this.markers.length == 0 && ty == \"xdd:coordinatePolygon\"){\n     \tmarker.addListener('click', function() {\n\t\t\tvar coords = self.getCoordsFromMarkers();\n    \t\tself.polygon = self.createPolygon(coords, map);\n            self.clearMarkers();\n            self.polyline.setMap(null);\n            frame.set(self.translatePolygonToArray(self.polygon));\n        });                \t\n    }\n\tthis.markers.push(marker);\n\tif(ty == \"xdd:coordinatePolyline\"){\n\t\tvar x = this.translatePolygonToArray(this.polyline);\n\t\tframe.set(x);\n\t}\n\treturn marker;\n}\n\nGoogleMapHelper.prototype.getCoordsFromMarkers = function(){\n\treturn this.polyline.getPath();\n}\n\nGoogleMapHelper.prototype.clear = function(){\n\tif(this.polygon) {\n\t\tthis.polygon.setMap(null);\n\t\tthis.polygon = false;\n\t}\n\tif(this.polyline) {\n\t\tthis.clearMarkers();\n\t\tthis.polyline.setMap(null);\n\t}\n}\n\nGoogleMapHelper.prototype.initMap = function(mapContainer, value, type){\n\tmapContainer.style.width = this.width;\n\tmapContainer.style.height = this.height;\n\tif(typeof google == \"undefined\"){\n\t\talert(\"google is not effing loaded\");\n\t\treturn false;\n\t}\n\tvar map = new google.maps.Map(mapContainer, {\n\t    zoom: this.zoom,\n\t\tcenter: {lat: parseFloat(this.mapLat), lng: parseFloat(this.mapLong)}  \n\t});\n\tif(type == \"xdd:coordinatePolygon\"){\n\t    this.polyline = this.createPolyline();\n\t\tthis.polyline.setMap(map);\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\n\t\tif(value){\n\t    \tthis.polygon = this.createPolygon(coords, map);\n\t    }\n\t}\n\telse if(type == \"xdd:coordinatePolyline\"){\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\n\t    this.polyline = this.createPolyline();\n\t\tthis.polyline.setMap(map);\t\t\n\t\tif(value){\n\t    \tthis.polyline.setPath(coords);\n\t    }\n\t}\t\n\telse if(type == \"xdd:coordinate\"){\n\t\tif(value){\n\t\t\tthis.clearMarkers();\n            var lat = parseFloat(value.substring(1, value.indexOf(\",\")));\n\t\t\tvar long = parseFloat(value.substring(value.indexOf(\",\")+1, value.length-1));\n            var init = {\n            \tposition: {lat: lat, lng: long},\n        \t\tmap: map\n\t        }\n\t        var marker = new google.maps.Marker(init);\n\t        this.markers.push(marker);\n\t\t}\n\t}\n    google.maps.event.trigger(map, 'resize');\n    return map;\n}\n\nmodule.exports=GoogleMapHelper;","/*\n * Maintains a list of renderers that are available for rendering \n * datatype values - also covers choice values and id values\n */\n\nfunction DatatypeRenderers(options){\n\tthis.registeredDataViewers = {},\n\tthis.registeredDataEditors = {},\n\tthis.defaultViewers = {};\n\tthis.defaultEditors = {};\n\tthis.universalViewer = false;\n\tthis.universalEditor = false;\n\tif(options) this.options(options);\n\t//links to other documents, choices, id field, id fields of contained objects, ids of structural elements: properties, etc\n\tthis.specials = ['document', 'oneOf', 'id', 'contained', 'structural'];\n}\n\nDatatypeRenderers.prototype.options = function (options){\n\tthis.universalViewer = (options && options.universalViewer ? options.universalViewer : false);\n\tthis.universalEditor = (options && options.universalEditor ? options.universalEditor : false);\n\tthis.editor = (options && options.editor ? options.editor : false);\n}\n\nDatatypeRenderers.prototype.getValidDataViewerList = function(datatype){\n\tlet valids = [];\n\tif(datatype && typeof this.registeredDataViewers[datatype] != \"undefined\"){\n\t\tvalids = valids.concat(this.registeredDataViewers[datatype]);\n\t}\n\tif(this.universalViewer && valids.indexOf(this.universalViewer) == -1){\n\t\tvalids.push(this.universalViewer);\n\t}\n\treturn valids;\n};\n\nDatatypeRenderers.prototype.getValidDataEditorList = function(datatype){\n\tlet valids = [];\n\tif(datatype && typeof this.registeredDataEditors[datatype] != \"undefined\"){\n\t\tvar nftypes = this.registeredDataEditors[datatype];\n\t\tif(nftypes){\n\t\t\tfor(var i = 0; i<nftypes.length; i++){\n\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\n\t\t\t}\n\t\t}\n\t}\n\tif(typeof this.registeredDataEditors[datatype] != \"undefined\"){\n\t\tvalids = valids.concat(this.registeredDataEditors[datatype]);\n\t}\n\tif(this.universalEditor && valids.indexOf(this.universalEditor) == -1){\n\t\tvalids.push(this.universalEditor);\n\t}\n\treturn valids;\n}\n\nDatatypeRenderers.prototype.getEditorForDataFrame = function(datatype){\n\tvar vals = this.getValidDataEditorList(datatype);\n\tif(this.defaultEditors[datatype] && vals[this.defaultEditors[datatype]]){\n\t\treturn vals[this.defaultEditors[datatype]];\n\t}\n\t//last added is default if no explicit default is set\n\tif(vals){\n\t\treturn vals[Object.keys(vals)[0]];\n\t}\n\telse {\n\t\tif(this.universalEditor) return this.universalEditor;\n\t}\n}\n\nDatatypeRenderers.prototype.getViewerForDataFrame = function(datatype){\n\tvar vals = this.getValidDataViewerList(datatype);\n\tif(this.defaultViewers[datatype] && vals[this.defaultViewers[datatype]]){\n\t\treturn vals[this.defaultViewers[datatype]];\n\t}\n\tif(vals){\n\t\treturn vals[Object.keys(vals)[0]];\n\t}\n\telse {\n\t\tif(this.universalViewer) return this.universalViewer;\n\t}\n\n}\n\nDatatypeRenderers.prototype.registerViewerForTypes = function(viewer, record, types){\n\tfor(var i = 0; i < types.length; i++){\n\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\n\t\t\tthis.registeredDataViewers[types[i]] = {};\n\t\t}\n\t\tif(!this.registeredDataViewers[types[i]][viewer]){\n\t\t\tthis.registeredDataViewers[types[i]][viewer] = record;\n\t\t}\n\t}\n}\n\nDatatypeRenderers.prototype.registerEditorForTypes = function(viewer, record, types){\n\tfor(var i = 0; i < types.length; i++){\n\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\n\t\t\tthis.registeredDataEditors[types[i]] = {};\n\t\t}\n\t\tif(!this.registeredDataEditors[types[i]][viewer]){\n\t\t\tthis.registeredDataEditors[types[i]][viewer] = record;\n\t\t}\t\t\t\n\t}\n}\n\nDatatypeRenderers.prototype.getRenderer = function(type, value){\n\tvar r = {};\n\tlet v = this.getViewerForDataFrame(type);\n\tif(v){\n\t\tif(typeof v == \"object\"){\n\t\t\tr.name = Object.keys(v)[0];\n\t\t\tif(v[r.name].label){\n\t\t\t\tr.label = v[r.name].label;\n\t\t\t}\n\t\t\tif(v[r.name].args){\n\t\t\t\tr.args = v[r.name].args;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tr.name = v;\n\t\t}\n\t\treturn r;\n\t}\n\treturn false;\n}\n\nDatatypeRenderers.prototype.getEditor = function(type, value){\n\tvar r = {};\n\tlet v = this.getEditorForDataFrame(type);\n\tif(v){\n\t\tif(typeof v == \"object\"){\n\t\t\tr.name = Object.keys(v)[0];\n\t\t\tif(v[r.name].label){\n\t\t\t\tr.label = v[r.name].label;\n\t\t\t}\n\t\t\tif(v[r.name].args){\n\t\t\t\tr.args = v[r.name].args;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tr.name = v;\n\t\t}\n\t\treturn r;\n\t}\n\treturn false;\n}\n\n\nmodule.exports=DatatypeRenderers;\n\n\n","function TerminusViolations(vios, ui){\n\tthis.ui = ui;\n\tthis.vios = [];\n\tvar nvios = [];\n\tfor(var i = 0; i<vios.length; i++){\n\t\tnvios.push(vios[i]);\n\t}\n\tfor(var i = 0; i<nvios.length; i++){\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\n\t}\n}\n\nTerminusViolations.prototype.getAsDOM = function(context_msg){\n\tvar vdom = document.createElement(\"div\");\n\tvdom.setAttribute(\"class\", \"terminus-violations terminus-show-msg-vio\");\n\tvar vioHeading = document.createElement(\"div\");\n\tvioHeading.setAttribute('class', 'terminus-violations-heading');\n\tvdom.appendChild(vioHeading);\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\n\tif(context_msg) msg += \" \" + context_msg;\n\tvioHeading.appendChild(document.createTextNode(msg));\n\tfor(var i = 0; i<this.vios.length; i++){\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\n\t}\n\treturn vdom;\n}\n\n/*\n * Class for displaying violation reports as HTML\n */\nfunction TerminusViolation(vio, ui){\n\tthis.ui = ui;\n\tthis.vio = vio;\n}\n\nTerminusViolation.prototype.getAsDOM = function(){\n\tvar vdom = document.createElement(\"div\");\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\n\tif(this.vio['@type']){\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\n\t}\n\tfor(var prop in this.vio){\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\n\t\t}\n\t}\n\treturn vdom;\n}\n\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\n\tvar pdom = document.createElement(\"div\");\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\n\tvar ldom = document.createElement(\"span\");\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\n\tldom.appendChild(document.createTextNode(prop));\n\tvar vdom = document.createElement(\"span\");\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\n\tvar mval = val[\"@value\"] || val;\n\tif(mval && typeof mval != \"object\") vdom.appendChild(document.createTextNode(mval));\n\tpdom.appendChild(ldom);\n\tpdom.appendChild(vdom);\n\treturn pdom;\n}\n\nmodule.exports=TerminusViolations\n","\nconst TerminusUI = require('./TerminusUI');\nconst TerminusViewer =require('./html/TerminusViewer')\nmodule.exports={TerminusUI:TerminusUI,\n\tTerminusViewer:TerminusViewer}\n","/**\n * Terminus UI object\n *\n * Traffic control of messages going between different Terminus UI pages and features\n *\n * @param opts - options array\n */\nconst ApiExplorer = require('./ApiExplorer');\nconst TerminusDBsdk = require('./TerminusDB');\nconst TerminusViolations = require('./html/TerminusViolation');\nconst TerminusQueryViewer = require('./TerminusQuery');\nconst TerminusSchemaViewer = require('./TerminusSchema');\nconst TerminusServersdk = require('./TerminusServer');\nconst TerminusURLLoader = require('./TerminusURL');\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\nconst UTILS = require('./Utils');\nconst HTMLHelper = require('./html/HTMLHelper');\nconst TerminusClient = require('@terminusdb/terminus-client');\n\n//const {endpoint,apiKey} = window.env;\n\nfunction TerminusUI(opts){\n\tthis.client = new TerminusClient.WOQLClient();\n\tthis.controls = [];\n\tthis.setOptions(opts);\n}\n\n/*\n * Client connects to specified server and specified part\n * opts is a json with the following fields:\n * server: mandatory URL of the server to connect to\n * key: optional client API key\n * dbid: id of the database to connect to\n * schema: if set, the UI will load the schema page after connecting\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\n * document: if set, the document page corresponding to this document will be loaded after connecting\n *\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\n */\nTerminusUI.prototype.connect = function(opts){\n\tvar self = this;\n\tthis.client.connectionConfig.server = false;\n\tvar key = ((opts && opts.key) ? opts.key : false);\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\n\treturn this.client.connect(opts.server, key)\n\t.then( function(response) {\n\t\tself.clearBusy();\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\n\t\t\tself.connectToDB(opts.db);\n\t\t\tif(opts.document && self.showView(\"get_document\")){\n\t\t\t\tresponse = self.showDocumentPage(opts.document);\n\t\t\t}\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\n\t\t\t\tresponse = self.showSchemaPage(opts.schema);\n\t\t\t}\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\n\t\t\t\tself.showQueryPage(opts.query);\n\t\t\t}\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\n\t\t\t\tself.showExplorer(opts.explorer);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tself.showDBMainPage();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tself.showServerMainPage();\n\t\t}\n\t\tself.redraw();\n\t\treturn response;\n\t})\n\t.catch(function(err) {\n\t\tself.clearBusy();\n\t\tself.showError(err);\n\t\tthrow(err);\n\t});\n}\n\n/**\n * Sends a request to create a new database to the server and interprets the response\n *\n * dbdets is a json object with the following fields:\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\n * title: the text name of the new database for tables, etc. mandatory\n * description: text description of the database (optional)\n * key: a API client key for server auth\n * schema: the url of another Terminus DB from which to import schema\n * instance: the url of another Terminus DB from which to import data\n *\n */\nTerminusUI.prototype.createDatabase = function(dbdets){\n\tvar self = this;\n\tif(!dbdets.id || !dbdets.title){\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\n\t}\n\tvar dbid = dbdets.id;\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\n\treturn this.client.createDatabase(dbid, dbdoc)\n\t.then(function(response){ //reload list of databases in background..\n\t\tself.clearBusy();\n\t\treturn self.refreshDBList()\n\t\t.then(function(response){\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\n\t\t\t\tself.showDBMainPage();\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\n\t\t\t}\n\t\t\telse {\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\n\t\t\t}\n\t\t})\n\t})\n\t.catch(function(error){\n\t\tself.clearBusy();\n\t\tself.showError(error);\n\t});\n}\n\n/**\n * Deletes the database with the passed id from the currently connected server\n */\nTerminusUI.prototype.deleteDatabase = function(dbid){\n\tvar self = this;\n\tvar delrec = this.client.connection.getDBRecord();\n\tvar lid = (dbid ? dbid : this.db());\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\n\tthis.showBusy(\"Deleting database \" + dbn);\n\treturn this.client.deleteDatabase(lid)\n\t.then(function(response){\n\t\tself.clearBusy();\n\t\tself.showServerMainPage();\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"warning\");\n\t\tself.refreshDBList();\n\t\treturn response;\n\t})\n\t.catch(function(error){\n\t\tself.clearBusy();\n\t\tself.showError(error);\n\t});\n}\n\n/*\n * Transforms a details (id, title, description) array into  json-ld document\n */\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\n\tvar doc = {\n\t\t\"@context\" : {\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\n\t\t},\n\t\t\"@type\": \"terminus:Database\"\n\t}\n\tif(dets.title){\n\t\tdoc['rdfs:label'] = {\n\t\t\t\"@language\":  \"en\",\n\t\t\t\"@value\": dets.title\n\t\t};\n\t}\n\tif(dets.description){\n\t\tdoc['rdfs:comment'] = {\n\t\t\t\"@language\":  \"en\",\n\t\t\t\"@value\": dets.description\n\t\t};\n\t}\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\n\treturn doc;\n}\n\nTerminusUI.prototype.getBadArguments = function(fname, str){\n\treturn \"Bad arguments to \" + fname + \": \" + str;\n}\n\nTerminusUI.prototype.getCrashString = function(fname, str){\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\n}\n\n/*\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\n */\nTerminusUI.prototype.load = function(url, key){\n\tvar args = {};\n\tif(url && url.indexOf(\"/document/\") != -1){\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\n\t}\n\telse if(url && url.indexOf(\"/schema\") != -1){\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\n\t\targs.schema = {};\n\t}\n\telse if(url && url.indexOf(\"/woql\") != -1){\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\n\t}\n\targs.server = url;\n\tif(key) args.key = key;\n\treturn this.connect(args);\n}\n\n/**\n * Fetches the DB URL from the url by chopping off the extra bits\n */\nTerminusUI.prototype.getConnectionEndpoint = function(url){\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\n\t}\n\tif(url && url.lastIndexOf(\"/document\") != -1){\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\n\t}\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\n\t}\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\n\t}\n\treturn url;\n}\n\nTerminusUI.prototype.server = function(){\n\treturn this.client.connectionConfig.server;\n}\n\nTerminusUI.prototype.db = function(){\n\treturn this.client.connectionConfig.dbid;\n}\n\nTerminusUI.prototype.clearServer = function(){\n\tthis.client.connectionConfig.server = false;\n}\n\nTerminusUI.prototype.connectToDB = function(dbid){\n\tthis.client.connectionConfig.dbid = dbid;\n\t//set standard prefixes for the current db\n\tTerminusClient.UTILS.addURLPrefix('doc', this.client.connectionConfig.dbURL() + \"/document/\");\n\tTerminusClient.UTILS.addURLPrefix('scm', this.client.connectionConfig.dbURL() + \"/schema#\");\n}\n\nTerminusUI.prototype.clearDB = function(){\n\tthis.client.connectionConfig.dbid = false;\n}\n\nTerminusUI.prototype.removeDB = function(db, url){\n\tthis.client.connection.removeDB(db, url);\n}\n\nTerminusUI.prototype.getDBRecord = function(db, url){\n\treturn this.client.connection.getDBRecord(db, url);\n}\n\nTerminusUI.prototype.refreshDBList = function(){\n\tvar self = this;\n\treturn this.client.connect();\n}\n\nTerminusUI.prototype.showServerMainPage = function(){\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showCollaboratePage = function(){\n\tthis.viewer = new TerminusURLLoader(this);\n\tthis.redrawMainPage();\n}\n\n\nTerminusUI.prototype.showLoadURLPage = function(val){\n\tthis.viewer = new TerminusURLLoader(this, val);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showDBMainPage = function(){\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\n\tthis.page = \"db\";\n\tthis.redraw();\n}\n\nTerminusUI.prototype.showCreateDBPage = function(){\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showSchemaPage = function(durl){\n\tthis.viewer = new TerminusSchemaViewer(this);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showQueryPage = function(query){\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showDocumentPage = function(durl){\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\n\tthis.page = \"docs\";\n\tif(durl){\n\t\tthis.viewer.docid = durl;\n\t}\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showCreateDocument = function(durl){\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\n\tconst promise = this.viewer.loadCreateDocument(durl);\n\tthis.redrawMainPage();\n\treturn promise;\n}\n\nTerminusUI.prototype.redrawMainPage = function(){\n\tHTMLHelper.removeChildren(this.mainDOM);\n\tif(this.viewer && this.mainDOM){\n\t\tvar x = this.viewer.getAsDOM();\n\t\tthis.mainDOM.appendChild(x);\n\t}\n}\n\nTerminusUI.prototype.deleteDBPermitted = function(dbid){\n\tif(dbid == \"terminus\") return false;\n\tif(this.client.connection.capabilitiesPermit(\"delete_database\", dbid)){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.getDeleteDBButton = function(dbid){\n\tif(!this.deleteDBPermitted(dbid)) return false;\n\t//var delbut = document.createElement('button');\n\tvar icon = document.createElement('i');\n\ticon.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-trash\");\n\t//delbut.appendChild(icon);\n\t//delbut.appendChild(document.createTextNode(\"Delete Database\"));\n\t//delbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\n\t\t// function to fix db in a closure\n\tvar self = this;\n\tvar delDB = function(db){\n\t\treturn function(){\n\t\t\tlet deleteConfirm = confirm(`This action is irreversible, it will remove the database from the system permanently. Are you sure you want to delete ${db} Database?`);\n\t\t\tif (deleteConfirm == true) {\n\t\t\t\tself.deleteDatabase(db);\n\t\t\t}\n\t\t}\n\t};\n\ticon.addEventListener(\"click\", delDB(dbid));\n\treturn icon;\n}\n\nTerminusUI.prototype.showResult = function(response){\n\tthis.showMessage(response, \"success\");\n};\n\nTerminusUI.prototype.showError = function(response){\n\tthis.showMessage(response, \"error\");\n};\n\nTerminusUI.prototype.showWarning = function(response){\n\tthis.showMessage(response, \"warning\");\n};\n\nTerminusUI.prototype.setAttachedServer = function(url){\n\tthis.attached_server = url;\n}\n\nTerminusUI.prototype.attachedServer = function(){\n\treturn this.attached_server;\n}\n\nTerminusUI.prototype.clearMessages = function(response){\n\tif(this.messages) HTMLHelper.removeChildren(this.messages);\n};\n\nTerminusUI.prototype.clearMainPage = function(){\n\tif(this.main) HTMLHelper.removeChildren(this.main);\n}\n\nTerminusUI.prototype.setMessageDOM = function(dom){\n\tthis.messages = dom;\n}\n\nTerminusUI.prototype.setbuttonControls = function(dom){\n\tthis.buttons = dom;\n}\n\nTerminusUI.prototype.setControllerDOM = function(dom){\n\tthis.controller = dom;\n}\n\nTerminusUI.prototype.setExplorerDOM = function(dom){\n\tthis.explorer = dom;\n}\n\nTerminusUI.prototype.setPluginsDOM = function(dom){\n\tthis.plugins = dom;\n}\n\nTerminusUI.prototype.setViewerDOM = function(dom){\n\tthis.mainDOM = dom;\n}\n\nTerminusUI.prototype.draw = function(comps, slocation){\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\n\t//if(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\n\tif(this.plugins){\n\t\tthis.drawPlugins();\n\t}\n\tif(this.buttons){\n\t\t//this.toggleControl();\n\t}\n\tvar self = this;\n\tvar cdrawn = false;\n\t/*\n\tuse envairoment variable\n\t*/\n\tconst endpoint=process.env.API_URL\n\tconst apiKey=process.env.API_KEY\n\n\tconsole.log(\"__TEST__\",endpoint,apiKey)\n\n\tif(endpoint){\n\t\tif(typeof this.client.connection.connection[endpoint] == \"undefined\") {\n\t\t\treturn this.connect({server:endpoint,key:apiKey})\n\t\t\t.catch(function(error){\n\t\t\t\tself.showLoadURLPage();\n\t\t\t});\n\t\t}\n\t}else if(slocation && slocation.server){\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\t\t\t\n\t\t\treturn this.connect(slocation)\n\t\t\t.catch(function(error){\n\t\t\t\tself.showLoadURLPage();\n\t\t\t});\n\t\t}\n\t}\n\telse {\n\t\tthis.showLoadURLPage();\n\t};\n}\n\nTerminusUI.prototype.redraw = function(msg){\n\tthis.clearMessages();\n\tthis.redrawControls();\n\tif(this.explorer){\n\t\tHTMLHelper.removeChildren(this.explorer);\n\t\t//this.drawExplorer();\n\t}\n\tif(this.viewer){\n\t\tthis.redrawMainPage();\n\t}\n\tif(msg) this.showMessage(msg);\n};\n\n\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\n    HTMLHelper.removeChildren(this.controller);\n    HTMLHelper.removeChildren(this.explorer);\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\n    widget.classList.add('terminus-dashboard-selected');\n}\n\nTerminusUI.prototype.toggleControl = function(){\n /* var self = this;\n  this.buttons.client.addEventListener('click', function(){\n    self.toggleDashboardWidget(this);\n    self.drawControls();\n    self.showServerMainPage();\n  })\n  this.buttons.explorer.addEventListener('click', function(){\n    self.toggleDashboardWidget(this);\n    self.drawExplorer();\n  })*/\n}\n\nTerminusUI.prototype.redrawControls = function(){\n\tif(this.controller){\n\t\tHTMLHelper.removeChildren(this.controller);\n\t\tthis.drawControls();\n\t}\n}\n\nTerminusUI.prototype.drawControls = function(){\n\tthis.controls = [];\n\tthis.loadControls();\n\tfor(var i = 0; i<this.controls.length; i++){\n\t\tvar ncontrol = this.controls[i];\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\n\t\t\tthis.controller.appendChild(nd);\n\t\t}\n\t}\n}\n\nTerminusUI.prototype.drawExplorer = function(){\n\tif(this.explorer){\n\t\tif(this.showControl(\"api_explorer\")){\n\t\t\tvar exp = new ApiExplorer(this);\n\t\t\tae = exp.getAsDOM();\n\t\t\tthis.explorer.appendChild(ae);\n\t\t\tthis.explorer.style.display = 'block';\n\t\t}\n\t}\n}\n\nTerminusUI.prototype.loadControls = function(){\n\tif(this.showControl('server')){\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\n\t\tif(sc) {\n\t\t\tthis.controls.push(sc);\n\t\t}\n\t\tif(this.db() && this.showControl(\"db\")){\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\n\t\t\tif(sc) this.controls.push(sc);\n\t\t}\n\t}\n}\n\nTerminusUI.prototype.showControl = function(el){\n\tif(this.show_controls.indexOf(el) == -1) return false;\n\tif(this.pseudoCapability(el)) return true;\n\tif(this.client.connection.capabilitiesPermit(el)) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.showView = function(el){\n\tif(this.show_views.indexOf(el) == -1) return false;\n\tif(this.pseudoCapability(el)) return true;\n\tif(this.client.connection.capabilitiesPermit(el)) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.clearBusy = function(response){\n\tthis.clearMessages();\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\n}\n\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\n     var pd = document.createElement('div');\n     var pbc = document.createElement('div');\n     pbc.setAttribute('class', 'term-progress-bar-container');\n     pd.appendChild(pbc);\n\n     var pbsa = document.createElement('div');\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\n     pbc.appendChild(pbsa);\n     var pbia = document.createElement('span');\n     pbia.setAttribute('class', 'term-progress-bar-inner');\n     pbsa.appendChild(pbia);\n\n     bsyDom.appendChild(pd);\n}\n\nTerminusUI.prototype.showMessage = function(msg, type){\n\tif(this.messages){\n\t\tHTMLHelper.removeChildren(this.messages);\n\t\tvar md = document.createElement('div');\n        switch(type){\n            case 'busy':\n                var msgHolder = document.createElement('div');\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\n                msgHolder.appendChild(document.createTextNode(msg));\n                md.appendChild(msgHolder);\n                this.getBusyLoader(md);\n            break;\n            case 'success':\n                md.setAttribute('class', 'terminus-show-msg-success');\n                md.appendChild(document.createTextNode(msg));\n            break;\n            case 'error':\n                md.setAttribute('class', 'terminus-show-msg-error');\n                md.appendChild(document.createTextNode(msg));\n            break;\n            case 'info':\n                md.setAttribute('class', 'terminus-show-msg-info');\n                md.appendChild(document.createTextNode(msg));\n            break;\n            case 'warning':\n                md.setAttribute('class', 'terminus-show-msg-warning');\n                md.appendChild(document.createTextNode(msg));\n            break;\n        }\n\t\tthis.messages.appendChild(md);\n\t}\n};\n\nTerminusUI.prototype.showViolations = function(vios, type){\n\tvar nvios = new TerminusViolations(vios, this);\n\tif(this.messages){\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\n\t\tHTMLHelper.removeChildren(this.messages);\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\n\t}\n}\n\nTerminusUI.prototype.showBusy = function(msg){\n\tthis.showMessage(msg, \"busy\");\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\n};\n\nTerminusUI.prototype.pseudoCapability = function(el){\n\tvar pseuds = [\"server\", \"db\", \"collaborate\", \"change-server\", \"api_explorer\", \"import_schema\", \"add_new_library\"];\n\tif(pseuds.indexOf(el) == -1) return false;\n\treturn true;\n}\n\nTerminusUI.prototype.setOptions = function(opts){\n\tthis.show_controls = opts && opts.controls ? opts.controls :\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\n\t\t\t\"collaborate\", \"get_document\", \"update_schema\",\n\t\t\t\"get_schema\", \"woql_select\"\n\t\t];\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\n\tif(opts.document){\n\t\tthis.document_options = opts.document;\n\t}\n\tif(opts.schema){\n\t\tthis.schema_options = opts.schema;\n\t}\n\tif(opts.attach_server){\n\t\tthis.setAttachedServer(opts.attach_server)\n\t}\n\tthis.piman = new TerminusPluginManager();\n\tvar self = this;\n\tthis.piman.init(opts.plugins, function(){\n\t\t/*var pins = [\"gmaps\", \"quill\", \"select2\"];\n\t\tfor(var i = 0; i<pins.length; i++){\n\t\t\tif(self.piman.pluginAvailable(pins[i])){\n\t\t\t\t//RenderingMap.addPlugin(pins[i]);\n\t\t\t}\n\t\t}*/\n\t\t//self.redraw();\n\t});\n\tif(opts.css && this.piman){\n\t\tthis.piman.loadPageCSS(opts.css);\n\t}\n\tthis.loadControls();\n}\n\nTerminusUI.prototype.pluginAvailable = function(p){\n\treturn this.piman.pluginAvailable(p);\n}\n\nTerminusUI.prototype.drawPlugins = function(){\n\tif(!this.piman) {\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\n\t\treturn false;\n\t}\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\n}\n\nTerminusUI.prototype.getDocViewerOptions = function(){\n\tif(this.document_options && this.document_options['view']){\n\t\treturn this.document_options['view'];\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.getDocCreatorOptions = function(){\n\tif(this.document_options && this.document_options['view']){\n\t\treturn this.document_options['view'];\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.getClassFrameOptions = function(){\n\treturn this.viewdoc_options;\n}\n\nmodule.exports=TerminusUI\n","/**\n * @file Javascript Api explorer tool\n * @author Kitty Jose\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\n *\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\n */\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\nconst UTILS = require('./Utils');\nconst TerminusClient = require('@terminusdb/terminus-client');\nconst HTMLHelper = require('./html/HTMLHelper');\n\nlet apiNavConfig = {\n    mainNav: {\n        connect: {\n    \t\tnavText: 'Connect API',\n            action : 'connect',\n            icon   : 'link',\n            defaultSelected: true\n    \t},\n        database: {\n            navText: 'Database API',\n            action : 'create',\n            icon   : 'database'\n        },\n        schema: {\n            navText: 'Schema API',\n            action : 'schema',\n            icon   : 'cog'\n        },\n        document: {\n            navText: 'Document API',\n            action : 'document',\n            icon   : 'file'\n        },\n        query: {\n            navText: 'Query API',\n            action : 'query',\n            icon   : 'search'\n        }\n    },\n    subNav: {\n        database: {\n            createDatabase: {\n                navText: 'Create database',\n                action : 'create',\n                icon   : 'plus',\n                defaultSelected: true\n            },\n            deleteDatabase: {\n                navText: 'Delete database',\n                action : 'delete',\n                icon   : 'trash-alt'\n            }\n        },\n        schema: {\n            getSchema: {\n                navText: 'View Schema',\n                action : 'getSchema',\n                icon   : 'eye',\n                defaultSelected: true\n            },\n            updateSchema: {\n                navText: 'Update Schema',\n                action : 'updateSchema',\n                icon   : 'arrow-up'\n            },\n            getClassFrames: {\n                navText: 'Get Class Frames',\n                action : 'getClassFrames',\n                icon   : 'share-alt'\n            }\n        },\n        document: {\n            viewDocument: {\n        \t\tnavText: 'View Document',\n                action : 'viewDocument',\n                icon   : 'eye',\n                defaultSelected: true\n        \t},\n            createDocument: {\n                navText: 'Create Document',\n                action : 'createDocument',\n                icon   : 'plus'\n            },\n            updateDocument: {\n                navText: 'Update Document',\n                action : 'updateDocument',\n                icon   : 'arrow-up'\n            },\n            deleteDocument:{\n                navText: 'Delete Document',\n                action : 'deleteDocument',\n                icon   : 'trash-alt'\n            }\n        },\n        query: {\n            select: {\n                navText: 'Select',\n                action : 'select',\n                icon   : 'mouse-pointer',\n                defaultSelected: true\n            },\n            update: {\n                navText: 'Update',\n                action : 'update',\n                icon   : 'arrow-up'\n            }\n        }\n    }\n}\n\nfunction ApiExplorer(ui){\n    this.ui = ui;\n    this.viewer = ui.mainDOM;\n    this.client = new TerminusClient.WOQLClient();\n    this.client.use_fetch = true;\n    this.client.return_full_response = true;\n    this.pman = new TerminusPluginManager();\n}\n\n// Controller provides access to Api explorer functions\nApiExplorer.prototype.getAsDOM = function(){\n \tvar aec = document.createElement(\"div\");\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\n    if(this.ui){\n       this.getApiNav(aec, this.viewer); // nav\n       this.getApiExplorerDom('connect', this.viewer); // content dom\n    } // if this.ui\n    return aec;\n }\n\n/***** Api Nav bar *****/\n// Toggle selected nav bars\nApiExplorer.prototype.setSelectedNavMenu = function(a){\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\n    a.classList.add(\"terminus-selected\");\n}\n\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\n    nav.classList.add(\"terminus-selected\");\n    this.getApiExplorerDom(action, viewer);\n}\n\n// create nav bars\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        self.navOnSelect(navConfig.action, this, viewer);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\n    a.appendChild(icon);\n    var txt = document.createTextNode(navConfig.navText);\n    a.appendChild(txt);\n    ul.appendChild(a);\n}\n\n// gets api nav bar\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\n    // list view of apis\n    var nav = document.createElement('div');\n    navDom.appendChild(nav);\n    // connect to server api\n    var ul = document.createElement('ul');\n    ul.setAttribute('class', 'terminus-ul');\n    nav.appendChild(ul);\n    // loop over apiNavConfig\n    for (var key in apiNavConfig.mainNav){\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\n        }\n    } // for apiNavConfig\n    return navDom;\n} // getApiNav()\n\n/***** Api sub navs  *****/\n// get schema api explorer - nav bar, alert msg, headers ...\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\n    // clear of viewer\n    HTMLHelper.removeChildren(viewer);\n    // wrapper\n    var wrap = document.createElement('div');\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\n    viewer.appendChild(wrap);\n    var cont = document.createElement('div');\n    cont.setAttribute('class', 'container-fluid');\n    wrap.appendChild(cont);\n    var row = document.createElement('div');\n    row.setAttribute('class', 'row-fluid');\n    cont.appendChild(row);\n    var body = document.createElement('div');\n    body.setAttribute('class', 'terminus-module-body');\n    row.appendChild(body);\n    var api = document.createElement('div');\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\n    body.appendChild(api);\n    // body\n    var cont = document.createElement('div');\n    var self = this;\n    switch(view){\n        case 'connect':\n            var apiCont = self.getConnectExplorer(cont);\n            api.appendChild(apiCont);\n        break;\n        case 'create':\n            var apiCont = self.getDatabaseExplorer(cont);\n            api.appendChild(apiCont);\n        break;\n        case 'schema':\n            var apiCont = self.getSchemaApi(cont);\n            api.appendChild(apiCont);\n        break;\n        case 'document':\n            var apiCont = self.getDocumentApi(cont);\n            api.appendChild(apiCont);\n        break;\n        case 'query':\n            var apiCont = self.getQueryApi(cont);\n            api.appendChild(apiCont);\n        break;\n    }// switch(api)\n    return wrap;\n} // getApiExplorerDom\n\n// on trigger of click event - change dom\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\n    HTMLHelper.removeChildren(body);\n    switch(curSubMenu){\n        case 'database':\n            var dom = this.getDatabaseDom(action, body);\n        break;\n        case 'schema':  // getShowApiDom() deals with schema and document\n             var dom = this.getShowApiDom(action, body);\n        break;\n        case 'document': // getShowApiDom() deals with schema and document\n             var dom = this.getShowApiDom(action, body);\n        break;\n        case 'query':\n            var dom = this.getQueryApiDom(action, body);\n        break;\n        default:\n            console.log('Invalid Api Config');\n        break;\n    }\n    cont.appendChild(dom);\n}\n\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\n    UTILS.setSelectedSubMenu(subNav);\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\n}\n\n// create sub nav bars\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\n    // comment getclassframes for api explorer time being\n    if(subMenuConfig.action == 'getClassFrames') return;\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\n    var self = this;\n    a.addEventListener(\"click\", function() {\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\n    a.appendChild(icon);\n    var txt = document.createTextNode(subMenuConfig.navText);\n    a.appendChild(txt);\n    ul.appendChild(a);\n}\n\n// get connect to server api calls - on click of connectAPI nav bar\nApiExplorer.prototype.getConnectExplorer = function(body){\n    var self = this;\n    var br = document.createElement('BR');\n    body.appendChild(br);\n    // get signature\n    var b = this.getSignature('connect');\n    body.appendChild(b);\n    // get header Parameter\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\n    var br = document.createElement('BR');\n    body.appendChild(br);\n    //form to get server url\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\n    //body.appendChild(form);\n    return body;\n} // getConnectExplorer\n\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\n    var body = document.createElement('div');\n    // list view of Databse tools\n    var ul = document.createElement('ul');\n    ul.setAttribute('class','terminus-ul-horizontal');\n    // loop over apiNavConfig\n    for (var key in apiNavConfig.subNav.database){\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\n    } // for apiNavConfig\n    cont.appendChild(ul);\n    // landing page\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\n    cont.appendChild(dom);\n    return cont;\n} // getDatabaseExplorer\n\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\nApiExplorer.prototype.getSchemaApi = function(cont){\n    var body = document.createElement('div');\n    // list view of Databse tools\n    var ul = document.createElement('ul');\n    ul.setAttribute('class','terminus-ul-horizontal');\n    // loop over apiNavConfig\n    for (var key in apiNavConfig.subNav.schema){\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\n        }\n    } // for apiNavConfig\n    cont.appendChild(ul);\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\n    cont.appendChild(dom);\n    return cont;\n} // getSchemaApi\n\n// get document api calls - on click of DocumentAPI nav bar\nApiExplorer.prototype.getDocumentApi = function(cont){\n    var body = document.createElement('div');\n    // list view of Databse tools\n    var ul = document.createElement('ul');\n    ul.setAttribute('class','terminus-ul-horizontal');\n    // loop over apiNavConfig\n    for (var key in apiNavConfig.subNav.document){\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\n        }\n    } // for apiNavConfig\n    cont.appendChild(ul);\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\n    cont.appendChild(dom);\n    return cont;\n} // getDocumentApi\n\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\nApiExplorer.prototype.getQueryApi  = function(cont){\n    var body = document.createElement('div');\n    // list view of Databse tools\n    var ul = document.createElement('ul');\n    ul.setAttribute('class','terminus-ul-horizontal');\n    // loop over apiNavConfig\n    for (var key in apiNavConfig.subNav.query){\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\n        }\n    } // for apiNavConfig\n    cont.appendChild(ul);\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\n    cont.appendChild(dom);\n    return cont;\n} //getQueryApi\n\n/***** Api Content view  *****/\n// get database dom\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\n    var self = this;\n    var br = document.createElement('BR');\n    body.appendChild(br);\n    // get signature\n    var b = this.getSignature(mode);\n    body.appendChild(b);\n    // get header Parameter\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\n    var br = document.createElement('BR');\n    body.appendChild(br);\n    //form to get database id\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\n    return body;\n} // getConnectExplorer\n\n//get create & delete db form\nApiExplorer.prototype.getServerForm = function(){\n  // form\n  var form = document.createElement('form');\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n  var fd = document.createElement('div');\n  fd.setAttribute('class', 'terminus-control-group');\n  form.appendChild(fd);\n  var inpLabel = document.createElement('label');\n  inpLabel.setAttribute('class', 'terminus-control-label');\n  inpLabel.setAttribute('for', 'basicinput');\n  inpLabel.innerHTML = 'Url:';\n  fd.appendChild(inpLabel);\n  var cd = document.createElement('div');\n  cd.setAttribute('class', 'terminus-controls');\n  fd.appendChild(cd);\n  var inpId = document.createElement('input');\n  inpId.setAttribute('type', 'text');\n  inpId.setAttribute('id', 'basicinput');\n  inpId.setAttribute('class', 'terminus-input-text');\n  inpId.setAttribute('placeholder', 'URL : server_url');\n  if(this.val) inpId.value = this.val;\n  cd.appendChild(inpId);\n\n  var fd = document.createElement('div');\n  fd.setAttribute('class', 'terminus-control-group');\n  form.appendChild(fd);\n  var keyLabel = document.createElement('label');\n  keyLabel.setAttribute('class', 'terminus-control-label');\n  keyLabel.setAttribute('for', 'basicinput');\n  keyLabel.innerHTML = 'Key:';\n  fd.appendChild(keyLabel);\n  var cd = document.createElement('div');\n  cd.setAttribute('class', 'terminus-controls');\n  fd.appendChild(cd);\n  var key = document.createElement('input');\n  key.setAttribute('type', 'text');\n  key.setAttribute('id', 'basicinput');\n  key.setAttribute('class', 'span8 terminus-input-text');\n  key.setAttribute('placeholder', 'Key : key');\n  if(this.val) key.value = this.val;\n  cd.appendChild(key);\n\n  var button = document.createElement('button');\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n  button.setAttribute('type', 'button');\n  button.innerHTML = 'Send Api';\n  var gatherips = function(){\n    var input = {};\n    input.url = inpId.value;\n    input.key = key.value;\n    return input;\n  }\n  var resd = document.createElement('div');\n  form.appendChild(button);\n  form.appendChild(resd);\n  var self = this;\n  button.addEventListener(\"click\", function(){\n    var buttonSelf = this;\n    //opts = {};\n    var input = gatherips();\n    self.client.connect(input.url, input.key)\n    .then(function(response){\n      HTMLHelper.removeChildren(resd);\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\n    });\n  }) // button click\n  return form;\n} // getServerForm()\n\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\n  var body = document.createElement('div');\n  // list view of Databse tools\n  var ul = document.createElement('ul');\n  ul.setAttribute('class','terminus-ul-horizontal');\n  // loop over apiNavConfig\n  for (var key in apiNavConfig.subNav.database){\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\n      }\n  } // for apiNavConfig\n  cont.appendChild(ul);\n  // landing page\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\n  cont.appendChild(dom);\n  return cont;\n} // getDatabaseExplorer\n\n\n// get schema & document dom\nApiExplorer.prototype.getShowApiDom = function(action, body){\n    var self = this;\n    var br = document.createElement('BR');\n    body.appendChild(br);\n    // signature\n    var b = this.getSignature(action);\n    body.appendChild(b);\n    // get header Parameter\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\n    var br = document.createElement('BR');\n    body.appendChild(br);\n    // get input\n    switch(action){\n        case 'getSchema':\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\n        break;\n        case 'getClassFrames':\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\n        break;\n        case 'updateSchema':\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\n        break;\n        case 'viewDocument':\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\n        break;\n        case 'deleteDocument':\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\n        break;\n        case 'createDocument':\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\n        break;\n        case 'updateDocument':\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\n        break;\n        default:\n            console.log('Invalid Api Call on form');\n        break;\n   }// switch(action)\n\n   return body;\n } // getShowApiDom()\n\n// get query api dom\nApiExplorer.prototype.getQueryApiDom = function(action, body){\n    var br = document.createElement('BR');\n    body.appendChild(br);\n    // signature\n    var b = this.getSignature(action);\n    body.appendChild(b);\n    // get header Parameter\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\n    var br = document.createElement('BR');\n    body.appendChild(br);\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\n    return body;\n} // getQueryApiDom\n\n/*ApiExplorer.prototype.getClassFramesForm = function(){\n    // form\n    var form = document.createElement('form');\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    form.appendChild(fd);\n    var inpLabel = document.createElement('label');\n    inpLabel.setAttribute('class', 'terminus-control-label');\n    inpLabel.setAttribute('for', 'basicinput');\n    inpLabel.innerHTML = 'Url:';\n    fd.appendChild(inpLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var inpUrl = document.createElement('input');\n    inpUrl.setAttribute('type', 'text');\n    inpUrl.setAttribute('id', 'basicinput');\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\n    if(this.val) inpUrl.value = this.val;\n    cd.appendChild(inpUrl);\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    form.appendChild(fd);\n    var inpLabel = document.createElement('label');\n    inpLabel.setAttribute('class', 'terminus-control-label');\n    inpLabel.setAttribute('for', 'basicinput');\n    inpLabel.innerHTML = 'Url/ ID:';\n    fd.appendChild(inpLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var inpDocUrl = document.createElement('input');\n    inpDocUrl.setAttribute('type', 'text');\n    inpDocUrl.setAttribute('id', 'basicinput');\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\n    cd.appendChild(inpDocUrl);\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    form.appendChild(fd);\n    var optLabel = document.createElement('label');\n    optLabel.setAttribute('class', 'terminus-control-label');\n    optLabel.setAttribute('for', 'basicinput');\n    optLabel.innerHTML = 'Options:';\n    fd.appendChild(optLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var optInp = document.createElement('input');\n    optInp.setAttribute('type', 'text');\n    optInp.setAttribute('id', 'basicinput');\n    optInp.setAttribute('class', 'span8 terminus-input-text');\n    optInp.setAttribute('placeholder', 'options');\n    cd.appendChild(optInp);\n    var button = document.createElement('button');\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n    button.setAttribute('type', 'button');\n    button.innerHTML = 'Send Api';\n    var gatherips = function(){\n        var input = {};\n        input.url = inpUrl.value;\n        input.docUrl = inpDocUrl.value;\n        input.options = optInp.value;\n        return input;\n    }\n    var self = this;\n    button.addEventListener(\"click\", function(form){\n      var input = gatherips();\n      var buttonSelf = this;\n      opts = {};\n      opts.explorer = true;\n      self.client.getClassFrame(input.url, input.docUrl, opts)\n      .then(function(response){\n          var currForm = buttonSelf.parentNode;\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\n      });\n    }) // button click\n    form.appendChild(button);\n    return form;\n}   */\n\n// get form for all Apis\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\n    // form\n    var formDoc = document.createElement('form');\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    formDoc.appendChild(fd);\n    var urlLabel = document.createElement('label');\n    urlLabel.setAttribute('class', 'terminus-control-label');\n    urlLabel.setAttribute('for', 'basicinput');\n    urlLabel.innerHTML = 'Url:';\n    fd.appendChild(urlLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var inpUrl = document.createElement('input');\n    inpUrl.setAttribute('type', 'text');\n    inpUrl.setAttribute('id', 'basicinput');\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\n    cd.appendChild(inpUrl);\n    // add extra form fields based on current api chosen\n    switch(curApi){\n        case 'getClassFrames':\n            var fd = document.createElement('div');\n            fd.setAttribute('class', 'terminus-control-group');\n            formDoc.appendChild(fd);\n            var docUrlLabel = document.createElement('label');\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\n            docUrlLabel.setAttribute('for', 'basicinput');\n            docUrlLabel.innerHTML = 'Url/ ID:';\n            fd.appendChild(docUrlLabel);\n            var cd = document.createElement('div');\n            cd.setAttribute('class', 'terminus-controls');\n            fd.appendChild(cd);\n            var inpDocUrl = document.createElement('input');\n            inpDocUrl.setAttribute('type', 'text');\n            inpDocUrl.setAttribute('id', 'basicinput');\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\n            cd.appendChild(inpDocUrl);\n        break;\n        case 'schema':\n            //encoding\n           /* var fd = document.createElement('div');\n            fd.setAttribute('class', 'terminus-control-group');\n            formDoc.appendChild(fd);\n            var encLabel = document.createElement('label');\n            encLabel.setAttribute('class', 'terminus-control-label');\n            encLabel.setAttribute('for', 'basicinput');\n            encLabel.innerHTML = 'Encoding:';\n            fd.appendChild(encLabel);\n            var cd = document.createElement('div');\n            cd.setAttribute('class', 'terminus-controls');\n            fd.appendChild(cd);\n            var inpEnc = document.createElement('select');\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\n            inpEnc.setAttribute('placeholder', 'turtle');\n            var optTurt = document.createElement('option');\n            optTurt.setAttribute('value', 'terminus:turtle');\n            optTurt.appendChild(document.createTextNode('turtle'));\n            inpEnc.appendChild(optTurt);\n            var optJld = document.createElement('option');\n            optJld.setAttribute('value', 'terminus:jsonld');\n            optJld.appendChild(document.createTextNode('jsonLD'));\n            inpEnc.appendChild(optJld);\n            cd.appendChild(inpEnc); */\n        break;\n    }\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    formDoc.appendChild(fd);\n    var keyLabel = document.createElement('label');\n    keyLabel.setAttribute('class', 'terminus-control-label');\n    keyLabel.setAttribute('for', 'basicinput');\n    keyLabel.innerHTML = 'Key:';\n    fd.appendChild(keyLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var inpKey = document.createElement('input');\n    inpKey.setAttribute('type', 'text');\n    inpKey.setAttribute('id', 'basicinput');\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\n    inpKey.setAttribute('placeholder', 'Key');\n    cd.appendChild(inpKey);\n    if(!view){\n        // include text area only if call is type post\n        var fd = document.createElement('div');\n        fd.setAttribute('class', 'terminus-control-group');\n        formDoc.appendChild(fd);\n        var docLabel = document.createElement('label');\n        docLabel.setAttribute('class', 'terminus-control-label');\n        docLabel.setAttribute('for', 'basicinput');\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\n        docLabel.innerHTML = 'Document:';\n        fd.appendChild(docLabel);\n        var cd = document.createElement('div');\n        cd.setAttribute('class', 'terminus-controls');\n        fd.appendChild(cd);\n        var inpDoc = document.createElement('textarea');\n        cd.appendChild(inpDoc);\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\n        UTILS.stylizeEditor(this.ui, inpDoc, 'api-doc', 'javascript');\n    }\n    body.appendChild(formDoc);\n    // gather inputs\n    var inp ={};\n    inp.url = inpUrl;\n    inp.key = inpKey;\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\n    //if(curApi == 'schema') inp.enc = inpEnc;\n    if(!view) inp.doc = inpDoc;\n    var form = this.getApiSendButton(action, inp);\n    body.appendChild(form);\n}\n\n// define event listeners on send api of schema & documents\n\nApiExplorer.prototype.getApiForm = function(action, input){\n  // form\n  var form = document.createElement('form');\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n  var button = document.createElement('button');\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n  button.setAttribute('type', 'button');\n  button.innerHTML = 'Send Api';\n  form.appendChild(button);\n  var resd = document.createElement('div');\n  form.appendChild(resd);\n  var self = this;\n  switch(action){\n    case 'getSchema':\n      button.addEventListener(\"click\", function(){\n        var opts = {};\n        opts['terminus:encoding'] = input.enc.value;\n        opts['terminus:user_key'] = 'terminus:turtle';\n        var schurl = input.url.value;\n        var buttonSelf = this;\n        self.client.getSchema(schurl, opts)\n        .then(function(response){\n          HTMLHelper.removeChildren(resd);\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\n        });\n      }) // button click\n    break;\n    case 'updateSchema':\n      button.addEventListener(\"click\", function(){\n        var buttonSelf = this;\n        opts = {};\n        opts['terminus:encoding'] = input.enc.value;\n        opts['terminus:user_key'] = 'terminus:turtle';\n        var schurl = input.url.value;\n        self.client.connectionConfig.connected_mode = false;\n        self.client.updateSchema(schurl, input.doc.value, opts)\n        .then(function(response){\n          var gtxtar = document.createElement('textarea');\n          gtxtar.setAttribute('readonly', true);\n          gtxtar.innerHTML = response;\n          var currForm = buttonSelf.parentNode;\n          currForm.appendChild(gtxtar);\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\n        });\n      }) // button click\n    break;\n    case 'viewDocument':\n      button.addEventListener(\"click\", function(){\n      var dcurl = input.value;\n      var buttonSelf = this;\n      var opts = {};\n      opts.format = 'turtle';\n      self.client.getDocument(dcurl, opts)\n      .then(function(response){\n        HTMLHelper.removeChildren(resd);\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n      });\n    }) // button click\n    break;\n    case 'deleteDocument':\n      button.addEventListener(\"click\", function(){\n      var dcurl = input.value;\n      var buttonSelf = this;\n      var opts = {};\n      self.client.deleteDocument(dcurl, opts)\n      .then(function(response){\n        HTMLHelper.removeChildren(resd);\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n      });\n    }) // button click\n    break;\n    case 'createDocument':\n      button.addEventListener(\"click\", function(){\n        var dcurl = input.schemaUrlDom.value;\n        var payload = input.htmlEditor.getValue();\n        var buttonSelf = this;\n        opts = {};\n        self.client.createDocument(dcurl, payload, opts)\n        .then(function(response){\n          HTMLHelper.removeChildren(resd);\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n        });\n      }) // button click\n    break;\n    case 'updateDocument':\n      button.addEventListener(\"click\", function(){\n        var dcurl = input.schemaUrlDom.value;\n        var payload = input.htmlEditor.getValue();\n        var buttonSelf = this;\n        opts = {};\n        opts.editmode = 'replace';\n        opts.format = 'json';\n        self.client.updateDocument(dcurl, payload, opts)\n        .then(function(response){\n          HTMLHelper.removeChildren(resd);\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n        });\n      }) // button click\n    break;\n  } // switch(action)\n\n  var br = document.createElement('BR');\n  form.appendChild(br);\n  var br = document.createElement('BR');\n  form.appendChild(br);\n\n  return form;\n} // getApiForm()\n\n\n// define event listeners on send api of schema & documents\nApiExplorer.prototype.getApiSendButton = function(action, input){\n    // form\n    var form = document.createElement('form');\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n    var button = document.createElement('button');\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n    button.setAttribute('type', 'button');\n    button.innerHTML = 'Send Api';\n    form.appendChild(button);\n    var resd = document.createElement('div');\n    form.appendChild(resd);\n    var self = this;\n    switch(action){\n        case 'connect':\n            button.addEventListener(\"click\", function(){\n                self.client.connect(input.url.value, input.key.value)\n                .then(function(response){\n                \tHTMLHelper.removeChildren(resd);\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n               });\n            }) // button click\n        break;\n        case 'create':\n            button.addEventListener(\"click\", function(form){\n              self.client.createDatabase(input.url.value, JSON.parse(input.doc.value), input.key.value)\n              .then(function(response){\n            \t  HTMLHelper.removeChildren(resd);\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n              });\n            }) // button click\n        break;\n        case 'delete':\n            button.addEventListener(\"click\", function(){\n              var opts ={}\n              self.client.deleteDatabase(input.url.value, input.key.value)\n              .then(function(response){\n            \t  HTMLHelper.removeChildren(resd);\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n              });\n            }) // button click\n        break\n        case 'getSchema':\n            button.addEventListener(\"click\", function(){\n                var opts = {};\n                opts['terminus:encoding'] = 'terminus:turtle';\n                opts['terminus:user_key'] = input.key.value;\n                var schurl = input.url.value;\n                self.client.getSchema(schurl, opts)\n                .then(function(response){\n                \tHTMLHelper.removeChildren(resd);\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n                });\n            }) // button click\n        break;\n        case 'updateSchema':\n            button.addEventListener(\"click\", function(){\n                opts = {};\n                opts['terminus:encoding'] = 'terminus:turtle';\n                opts['terminus:user_key'] = input.key.value;\n                var payload = input.doc.value;\n                var schurl = input.url.value;\n                self.client.connectionConfig.connected_mode = false;\n                self.client.updateSchema(schurl, input.doc.value, opts)\n                //self.client.updateSchema(schurl, input.doc.value, opts)\n                .then(function(response){\n                \tHTMLHelper.removeChildren(resd);\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n                });\n            }) // button click\n        break;\n        case 'getClassFrames':\n            button.addEventListener(\"click\", function(form){\n                var schurl = input.url.value;\n                opts = {};\n                opts.explorer = true;\n                self.client.getClassFrame(input.url, JSON.parse(input.docUrl.value), opts)\n                .then(function(response){\n                    var currForm = buttonSelf.parentNode;\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\n                });\n            }) // button click\n        break;\n        case 'viewDocument':\n          button.addEventListener(\"click\", function(){\n              var dcurl = input.url.value;\n              var opts = {};\n              opts['terminus:encoding'] = \"jsonld\";\n              opts['terminus:user_key'] = input.key.value;\n              self.client.getDocument(dcurl, opts)\n              .then(function(response){\n            \t    HTMLHelper.removeChildren(resd);\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n              });\n        }) // button click\n        break;\n        case 'deleteDocument':\n          button.addEventListener(\"click\", function(){\n              var dcurl = input.url.value;\n              var opts = {};\n              opts.key = input.key.value;\n              self.client.deleteDocument(dcurl, opts)\n              .then(function(response){\n            \t  HTMLHelper.removeChildren(resd);\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n              });\n          }) // button click\n        break;\n        case 'createDocument':\n          button.addEventListener(\"click\", function(){\n              var dcurl = input.url.value;\n              var payload = input.doc.value;\n              opts = {};\n              opts['terminus:encoding'] = \"jsonld\";\n              opts['terminus:user_key'] = input.key.value;\n              self.client.createDocument(dcurl, JSON.parse(payload), opts)\n              .then(function(response){\n            \t   HTMLHelper.removeChildren(resd);\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n               });\n          }) // button click\n        break;\n        case 'updateDocument':\n          button.addEventListener(\"click\", function(){\n            var dcurl = input.url.value;\n            var payload = input.doc.value;\n            var buttonSelf = this;\n            opts = {};\n            opts['terminus:encoding'] = \"jsonld\";\n            opts['terminus:user_key'] = input.key.value;\n            self.client.updateDocument(dcurl, JSON.parse(payload), opts)\n            .then(function(response){\n            \tHTMLHelper.removeChildren(resd);\n                var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n            });\n          }) // button click\n        break;\n        case 'select':\n            button.addEventListener(\"click\", function(){\n                var opts = {};\n                opts.key = input.key.value;\n                var doc = JSON.parse(input.doc.value);\n                self.client.select(input.url.value, doc, opts)\n                .then(function(response){\n                \tHTMLHelper.removeChildren(resd);\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n                });\n            }) // button click\n        break;\n        case 'update':\n            button.addEventListener(\"click\", function(){\n              var opts = {};\n              opts.key = input.key.value;\n              var doc = JSON.parse(input.doc.value);\n              self.client.update(input.url.value, doc, opts)\n              .then(function(response){\n            \t  HTMLHelper.removeChildren(resd);\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n              });\n            }) // button click\n        break;\n        default:\n            console.log('Invalid Api call on button');\n        break;\n    } // switch(action)\n    var br = document.createElement('BR');\n    form.appendChild(br);\n    var br = document.createElement('BR');\n    form.appendChild(br);\n    return form;\n} // getApiSendButton()\n\n// get signature of api calls\nApiExplorer.prototype.getSignature = function(action){\n    var api = document.createElement('div');\n    // get header signature\n    var sg = document.createElement('button');\n    sg.appendChild(document.createTextNode('Click to read API Signature'));\n    sg.setAttribute('class', 'terminus-collapsible');\n    ic = document.createElement('i');\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\n    sg.appendChild(ic);\n    api.appendChild(sg);\n    var br = document.createElement('BR');\n    api.appendChild(br);\n    var cl = document.createElement('div');\n    cl.setAttribute('class', 'terminus-collapsible-content content');\n    var sig = UTILS.getFunctionSignature(action);\n    var txt = document.createTextNode(sig.spec);\n    var pre = document.createElement('pre');\n    pre.setAttribute('class', 'terminus-api-signature-pre');\n    pre.appendChild(txt);\n    var txt =  document.createTextNode(sig.descr);\n    pre.appendChild(txt);\n    var br = document.createElement('BR');\n    pre.appendChild(br);\n    var br = document.createElement('BR');\n    pre.appendChild(br);\n    var txt = document.createTextNode(sig.result);\n    pre.appendChild(txt);\n    cl.appendChild(pre);\n    api.appendChild(cl);\n    var br = document.createElement('BR');\n    api.appendChild(br);\n    sg.addEventListener('click', function(){\n        UTILS.tolggleContent(ic, cl);\n    });\n    return api;\n} // getSignature()\n\n// displays signature only on click\nfunction tolggleSignatureContent(content){\n    if (content.style.display === \"block\")\n        content.style.display = \"none\";\n    else content.style.display = \"block\";\n}\n\nmodule.exports=ApiExplorer\n","\nconst CONST = require('./const');\nconst DispatchRequest = require('./dispatchRequest');\nconst ErrorMessage = require('./errorMessage');\nconst ConnectionCapabilities = require('./connectionCapabilities');\nconst ConnectionConfig = require('./connectionConfig');\nconst UTILS = require('./utils.js');\n\n\n/**\n * @file Javascript WOQL client object\n * @license Apache Version 2\n * Simple Javascript Client for accessing the Terminus DB API\n * Constructor - takes an option json list of connection parameters\n * @param {Object} params a json object containing connection parameters\n * which can be:\n * params.server URL of server to connect to\n * params.dbid ID of database to connect to\n * params.docid = ID of document to load;\n */\nfunction WOQLClient(params) {\n\t// current connection context variables\n\tconst key = (params && params.key) ? params.key : undefined;\n\tthis.use_fetch = false;\n\tthis.return_full_response = false;\n\tthis.connectionConfig = new ConnectionConfig(params);\n\tthis.connection = new ConnectionCapabilities(this.connectionConfig, key);\n}\n\nWOQLClient.CONST = CONST;\n\n/**\n * Connect to a Terminus server at the given URI with an API key\n * Stores the terminus:ServerCapability document returned\n * in the connection register which stores, the url, key, capabilities,\n * and database meta-data for the connected server\n *\n * If the curl argument is false or null,\n * this.connectionConfig.server will be used if present,\n * or the promise will be rejected.\n\n * @param  {string} curl Terminus server URI\n * @param  {string} [key] API  key\n * @param  {string} [dbid] Optional DB to connect to by default\n * @return {Promise}\n * @public\n */\nWOQLClient.prototype.connect = function (curl, key, dbid) {\n\tif (curl && !this.connectionConfig.setServer(curl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(curl, CONST.CONNECT))\n\t\t);\n\t}\n\tconst serverURL = this.connectionConfig.serverURL();\n\tif (key) {\n\t\tthis.connection.setClientKey(serverURL, key);\n\t}\n\t// unset the current server setting until successful connect\n\tthis.connectionConfig.server = false;\n\treturn this.dispatch(serverURL, CONST.CONNECT)\n\t.then((response) => {\n\t    this.connectionConfig.server = serverURL;\n\t    if(dbid) this.connectionConfig.dbid = dbid;\n\t    this.connection.addConnection(serverURL, response);\n\t    return response;\n\t});\n};\n\n/**\n * Create a Terminus Database by posting\n * a terminus:Database document to the Terminus API\n *\n * The dburl argument can be\n *    1) a valid URL of a terminus database or\n *    2) a valid Terminus database id or\n *    3) can be omitted\n * \t\tin case 2) the current server will be used,\n * \t\tin case 3) the database id will be set from the @id field of the terminuse:Database document.\n *\n * The second (details) argument contains a terminus:Database document\n * with a mandatory rdfs:label field and an optional rdfs:comment field.\n * The third (key) argument contains an optional API key\n *\n * @param {string} dburl Terminus server URI or a TerminusID\n * @param {object} details\n * @param {string} key\n * @return {Promise}\n * @public\n */\nWOQLClient.prototype.createDatabase = function (dburl, details, key) {\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Create Database'))\n\t\t);\n\t}\n\tif (\n\t\tdetails\n    && details['@id']\n    && !this.connectionConfig.setDB(details['@id'], details['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(details['@id'], 'Create Database'))\n\t\t);\n\t}\n\tdetails = this.makeDocumentConsistentWithURL(details, this.connectionConfig.dbURL());\n\n\tconst opts = {};\n\tif (key) {\n\t\topts.key = key;\n\t}\n\tconst doc = this.addOptionsToDocument(details, opts);\n\treturn this.dispatch(this.connectionConfig.dbURL('create'), CONST.CREATE_DATABASE, doc);\n};\n\n/**\n * Delete a Database\n * @param {String} dburl it is a terminusDB Url or a terminusDB Id\n * @param {String} key an optional API key\n * @return {Promise}\n *\n * if dburl is omitted, the current server and database will be used\n */\nWOQLClient.prototype.deleteDatabase = function (dburl, key) {\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Delete Database'))\n\t\t);\n\t}\n\tconst dbid = this.connectionConfig.dbid\n\tconst opts = {};\n\n\tif (key) {\n\t\topts.key = key;\n\t}\n\n\tconst self = this;\n\treturn this.dispatch(`${this.connectionConfig.dbURL()}`, CONST.DELETE_DATABASE, opts).then(\n\t\t(response) => {\n\t\t\tself.connection.removeDB(dbid);\n\t\t\treturn response;\n\t\t}\n\t);\n};\n\n/**\n * Retrieves the schema of the specified database\n *\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\n * @param {object} opts is an options object\n * @return {Promise}\n *\n * opts.format is optional and defines which format is requested (*json / turtle)\n * opts.key is an optional API key\n */\nWOQLClient.prototype.getSchema = function (schurl, opts) {\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Get Schema'))\n\t\t);\n\t}\n\treturn this.dispatch(this.connectionConfig.schemaURL(), CONST.GET_SCHEMA, opts);\n};\n\n/**\n * Updates the Schema of the specified database\n *\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\n * @param {object} doc is a valid owl ontology in json-ld or turtle format\n * @param {object} opts is an options object\n * @return {Promise}\n *\n * if omitted the current server and database will be used\n * opts.format is used to specify which format is being used (*json / turtle)\n * opts.key is an optional API key\n */\nWOQLClient.prototype.updateSchema = function (schurl, doc, opts) {\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Update Schema'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(doc, opts);\n\treturn this.dispatch(this.connectionConfig.schemaURL(), 'update_schema', doc);\n};\n\n/**\n * Creates a new document in the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus database (an id will be randomly assigned) or\n * 2) a valid URL or of a terminus document (the document will be given the passed URL) or\n * 3) a valid terminus document id (the current server and database will be used)\n * 4) can be omitted (the URL will be taken from the document if present)\n * The second argument (doc) is a valid document in json-ld\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.createDocument = function (docurl, doc, opts) {\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Create Document'))\n\t\t);\n\t} if (\n\t\tdoc\n    && doc['@id']\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Create Document'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\n\t\topts\n\t);\n\treturn this.dispatch(this.connectionConfig.docURL(), 'create_document', doc);\n};\n\n/**\n * Retrieves a document from the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database\n * the second argument (opts) is an options json -\n * \t\topts.key is an optional API key\n * \t\topts.shape is frame | *document\n */\nWOQLClient.prototype.getDocument = function (docurl, opts) {\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Get Document'))\n\t\t);\n\t}\n\treturn this.dispatch(this.connectionConfig.docURL(), 'get_document', opts);\n};\n\n/**\n * Updates a document in the specified database with a new version\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database or\n * 3) omitted in which case the id will be taken from the document @id field\n * the second argument (doc) is a document in json-ld format\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.updateDocument = function (docurl, doc, opts) {\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Update Document'))\n\t\t);\n\t}\n\tif (doc && doc['@id']\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Update Document'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\n\t\topts\n\t);\n\treturn this.dispatch(this.connectionConfig.docURL(), 'update_document', doc);\n};\n\n/**\n * Deletes a document from the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database\n * 3) omitted - the current document will be used\n * the second argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.deleteDocument = function (docurl, opts) {\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Delete Document'))\n\t\t);\n\t}\n\treturn this.dispatch(this.connectionConfig.docURL(), 'delete_document', opts);\n};\n\n/**\n * Executes a read-only WOQL query on the specified database and returns the results\n *\n * @param {string} qurl TerminusDB server URL or omitted (the current DB will be used)\n * @param {string} woql is a \"woql query select statement\"\n * @param {object} opts can contain an API key (opts.key)\n *\n */\nWOQLClient.prototype.select = function (qurl, woql, opts) {\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Select'))\n\t\t);\n\t}\n\tconst fileList = opts ? opts.fileList : {};\n\tlet q = {'terminus:query' : JSON.stringify(woql), ...fileList};\n\n\tq = this.addOptionsToWOQL(q, opts);\n\treturn this.dispatch(this.connectionConfig.queryURL(), CONST.WOQL_SELECT, q);\n};\n\n/**\n * Executes a WOQL query on the specified database which updates the state and returns the results\n *\n * The first (qurl) argument can be\n * 1) a valid URL of a terminus database or\n * 2) omitted - the current database will be used\n * the second argument (woql) is a woql select statement encoded as a string\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.update = function (qurl, woql, opts) {\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Select'))\n\t\t);\n\t}\n\tconst fileList = opts ? opts.fileList : {};\n\n\t//var formData = new FormData();\n    //formData.set('file', file);\n\t\n\tlet q = {'terminus:query' : JSON.stringify(woql), ...fileList};\n\n\tq = this.addOptionsToWOQL(q, opts);\n\treturn this.dispatch(this.connectionConfig.queryURL(),  CONST.WOQL_UPDATE, q);\n};\n\n/**\n * Executes a WOQL query on the server which keeps log of messages\n *\n * the first argument (payload) will include the message \n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.serverLog = function (payload, opts) {\n\tlet endpoint = this.connectionConfig.server + \"message\";\n\tlet q = {'@type' : \"terminus:APIUpdate\", \"terminus:message\" : payload};\n\n\tq = this.addOptionsToWOQL(q, opts);\n\treturn this.dispatch(endpoint,  CONST.TERMINUS_MESSAGE, q);\n};\n\n\n/**\n * Retrieves a WOQL query on the specified database which updates the state and returns the results\n *\n * The first (cfurl) argument can be\n * 1) a valid URL of a terminus database or\n * 2) omitted - the current database will be used\n * the second argument (cls) is the URL / ID of a document class that exists in the database schema\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.getClassFrame = function (cfurl, cls, opts) {\n\tif (cfurl && !this.connectionConfig.setClassFrameURL(cfurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(cfurl, 'Get Class Frame'))\n\t\t);\n\t}\n\tif (!opts) opts = {};\n\topts['terminus:class'] = cls;\n\treturn this.dispatch(this.connectionConfig.frameURL(), 'class_frame', opts);\n};\n\n/*\n * Utility functions for adding standard fields to API arguments\n */\n\n /**\n  * Adds a key to the passed woql query if it is present in the opts json\n  *\n  */\nWOQLClient.prototype.addOptionsToWOQL = function (woql, opts) {\n\tif (opts && opts.key) {\n\t\twoql.key = opts.key;\n\t}\n\treturn woql;\n};\n\n\n/**\n * Wrapws the passed json document in a valid TerminusDB update document API shell\n */\nWOQLClient.prototype.addOptionsToDocument = function (doc, opts) {\n\tconst pdoc = {};\n\tpdoc['@context'] = doc['@context'];\n\t// add blank node prefix as document base url\n\tif (pdoc['@context'] && doc['@id']) {\n\t\tpdoc['@context']._ = `${doc['@id']}/`;\n\t}\n\tif (opts && opts['terminus:encoding'] && opts['terminus:encoding'] === 'terminus:turtle') {\n\t\tpdoc['terminus:turtle'] = doc;\n\t\tpdoc['terminus:schema'] = this.connectionConfig.schemaURL();\n\t\tdelete pdoc['terminus:turtle']['@context'];\n\t} else {\n\t\tpdoc['terminus:document'] = doc;\n\t\tdelete pdoc['terminus:document']['@context'];\n\t}\n\tpdoc['@type'] = 'terminus:APIUpdate';\n\tif (opts && opts['terminus:user_key']) {\n\t\tpdoc['terminus:user_key'] = opts['terminus:user_key'];\n\t}\n\tif (opts && opts.key) {\n\t\tpdoc['terminus:user_key'] = opts.key;\n\t}\n\treturn pdoc;\n};\n\n/**\n * Adds an api key to the payload\n */\nWOQLClient.prototype.addKeyToPayload = function (payload, url) {\n\tif (typeof payload !== 'object')payload = {};\n\tif (payload.key) {\n\t\tpayload['terminus:user_key'] = payload.key;\n\t\tdelete payload.key;\n\t} else if (this.connection.getClientKey()) {\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey();\n\t} else if (this.connection.getClientKey(url)) {\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey(url);\n\t}\n\treturn payload;\n};\n\n/**\n * Document updates include the URL in both the endpoint and the document itself\n * This ensures that they are the same by using the endpoint URL as the authoritative version\n * and copying it into the embedded document ID\n */\nWOQLClient.prototype.makeDocumentConsistentWithURL = function (doc, dburl) {\n\tdoc['@id'] = dburl;\n\treturn doc;\n};\n\n/**\n * Common request dispatch function\n */\nWOQLClient.prototype.dispatch = function (url, action, payload) {\n\tif (this.connectionConfig.includeKey()) {\n\t\tpayload = this.addKeyToPayload(payload, url);\n\t}\n\tif (this.use_fetch) {\n\t\treturn this.dispatchFetch(url, action, payload);\n\t}\n\treturn DispatchRequest(url, action, payload);\n};\n\n/**\n * If the use_fetch switch is set, the browser's built in fetch will be used rather than the npm axios module\n */\nWOQLClient.prototype.dispatchFetch = function (url, action, payload) {\n\tconst api = {\n\t\t//mode: 'cors',  no-cors, cors, *same-origin\n\t\tredirect: 'follow', // manual, *follow, error\n\t\treferrer: 'client', // no-referrer, *client\n\t};\n\tlet hdrs = {};\n\tif (payload && payload['terminus:user_key']) {\n\t\thdrs = { Authorization: `Basic ${btoa(`:${payload['terminus:user_key']}`)}` };\n\t\tdelete (payload['terminus:user_key']);\n\t}\n\t// read only API calls - use GET\n\tswitch (action) {\n\tcase CONST.DELETE_DATABASE:\n\tcase CONST.DELETE_DOCUMENT:\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\n\t\tapi.method = 'DELETE';\n\t\tapi.cache = 'no-cache';\n\t\tbreak;\n\tcase CONST.CREATE_DATABASE:\n\tcase CONST.UPDATE_SCHEMA:\n\tcase CONST.CREATE_DOCUMENT:\n\tcase CONST.UPDATE_DOCUMENT:\n\tcase CONST.WOQL_UPDATE:\n\t\tapi.method = 'POST';\n\t\tapi.cache = 'no-cache';\n\t\thdrs['Content-Type'] = 'application/json';\n\t\tapi.body = JSON.stringify(payload);\n\t\tbreak;\n\tcase CONST.GET_SCHEMA:\n\tcase CONST.CONNECT:\n\tcase CONST.CLASS_FRAME:\n\tcase CONST.WOQL_SELECT:\n\tcase CONST.GET_DOCUMENT:\n\tdefault:\n\t\tapi.method = 'GET';\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\n\t}\n\tconst self = this;\n\tif (Object.keys(hdrs).length > 0) {\n\t\tapi.headers = new Headers(hdrs);\n\t}\n\treturn fetch(url, api).then((response) => {\n\t\tif (self.return_full_response) return response;\n\t\tif (response.ok) {\n\t\t\treturn response.json();\n\t\t}\n\t\tself.error = self.parseAPIError(response);\n\t\treturn Promise.reject(new Error(self.getAPIErrorMessage(url, api, self.error)));\n\t});\n};\n\nmodule.exports = WOQLClient;\n","const axios = require('axios');\nconst UTILS = require('./utils.js');\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n\n\n\n/**\n * base 64 encodes a string using either the btoa implementation if available or the Buffer object.\n * @param {String} str string to be base 64 encoded\n */\nfunction btoaImplementation(str) {\n\ttry {\n\t\treturn btoa(str);\n\t} catch (err) {\n\t\t// console.log('in buffer')\n\t\treturn Buffer.from(str).toString('base64');\n\t}\n}\n\n/**\n * @file Dispatch Request\n * @license Apache Version 2\n * @description Functions for dispatching API requests via the axios library.\n * @param {String} url  API endpoint URL\n * @param {String} action API action\n * @param {Object} payload data to be transmitted to endpoint\n */\nfunction DispatchRequest(url, action, payload) {\n\t/*\n\t*CORS is only required when trying to fetch data from a browser,\n\t*as browsers by default will block requests to different origins\n\t*/\n\tconst options = {\n\t\tmode: 'cors', // no-cors, cors, *same-origin\n\t\tredirect: 'follow', // manual, *follow, error\n\t\treferrer: 'client',\n\t\t// url:url,\n\t\t// no-referrer, *client\n\t};\n\tif (payload && payload['terminus:user_key']) {\n\t\toptions.headers = { Authorization: `Basic ${btoaImplementation(`:${payload['terminus:user_key']}`)}` };\n\t\tdelete (payload['terminus:user_key']);\n\t}\n\n\tswitch (action) {\n\tcase CONST.DELETE_DATABASE:\n\tcase CONST.DELETE_DOCUMENT:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.delete(url, options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\tcase CONST.CREATE_DATABASE:\n\tcase CONST.UPDATE_SCHEMA:\n\tcase CONST.CREATE_DOCUMENT:\n\tcase CONST.UPDATE_DOCUMENT:\n\tcase CONST.TERMINUS_MESSAGE:\n\tcase CONST.WOQL_UPDATE:\n\t\toptions.headers = options.headers ? options.headers : {};\n\t\toptions.headers['Content-Type'] = 'application/json';\n\t\treturn axios.post(url, JSON.stringify(payload), options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tconst e = new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t\tif (err.response && err.response.data) e.data = err.response.data;\n\t\t\t\tthrow e;\n\t\t\t});\n\tcase CONST.GET_SCHEMA:\n\tcase CONST.CONNECT:\n\tcase CONST.CLASS_FRAME:\n\tcase CONST.WOQL_SELECT:\n\tcase CONST.GET_DOCUMENT:\n\tdefault:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.get(url, options)\n\t\t\t.then((response => response.data))\n\t\t\t.catch((err) => {\n\t\t\t\tlet e = new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t\tif(err.response && err.response.data){\n\t\t\t\t\te.data = err.response.data;\n\t\t\t\t}\n\t\t\t\tthrow e;\n\t\t\t});\n\t}\n}\n\nmodule.exports = DispatchRequest;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = require('./lib/axios');","'use strict';\n\nvar utils = require('./utils');\nvar bind = require('./helpers/bind');\nvar Axios = require('./core/Axios');\nvar mergeConfig = require('./core/mergeConfig');\nvar defaults = require('./defaults');\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = require('./cancel/Cancel');\naxios.CancelToken = require('./cancel/CancelToken');\naxios.isCancel = require('./cancel/isCancel');\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = require('./helpers/spread');\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n","'use strict';\n\nvar utils = require('./../utils');\nvar buildURL = require('../helpers/buildURL');\nvar InterceptorManager = require('./InterceptorManager');\nvar dispatchRequest = require('./dispatchRequest');\nvar mergeConfig = require('./mergeConfig');\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = arguments[1] || {};\n    config.url = arguments[0];\n  } else {\n    config = config || {};\n  }\n\n  config = mergeConfig(this.defaults, config);\n\n  // Set config.method\n  if (config.method) {\n    config.method = config.method.toLowerCase();\n  } else if (this.defaults.method) {\n    config.method = this.defaults.method.toLowerCase();\n  } else {\n    config.method = 'get';\n  }\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\nAxios.prototype.getUri = function getUri(config) {\n  config = mergeConfig(this.defaults, config);\n  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\\?/, '');\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n","'use strict';\n\nvar utils = require('./../utils');\nvar transformData = require('./transformData');\nvar isCancel = require('../cancel/isCancel');\nvar defaults = require('../defaults');\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n","'use strict';\n\nvar createError = require('./createError');\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  if (!validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n","'use strict';\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n\n  error.request = request;\n  error.response = response;\n  error.isAxiosError = true;\n\n  error.toJSON = function() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: this.config,\n      code: this.code\n    };\n  };\n  return error;\n};\n","'use strict';\n\nvar isAbsoluteURL = require('../helpers/isAbsoluteURL');\nvar combineURLs = require('../helpers/combineURLs');\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n * @returns {string} The combined full path\n */\nmodule.exports = function buildFullPath(baseURL, requestedURL) {\n  if (baseURL && !isAbsoluteURL(requestedURL)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n};\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n    (function standardBrowserEnv() {\n      var msie = /(msie|trident)/i.test(navigator.userAgent);\n      var urlParsingNode = document.createElement('a');\n      var originURL;\n\n      /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n      function resolveURL(url) {\n        var href = url;\n\n        if (msie) {\n        // IE needs attribute set twice to normalize properties\n          urlParsingNode.setAttribute('href', href);\n          href = urlParsingNode.href;\n        }\n\n        urlParsingNode.setAttribute('href', href);\n\n        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n        return {\n          href: urlParsingNode.href,\n          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n          host: urlParsingNode.host,\n          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n          hostname: urlParsingNode.hostname,\n          port: urlParsingNode.port,\n          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n            urlParsingNode.pathname :\n            '/' + urlParsingNode.pathname\n        };\n      }\n\n      originURL = resolveURL(window.location.href);\n\n      /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n      return function isURLSameOrigin(requestURL) {\n        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n        return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n      };\n    })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return function isURLSameOrigin() {\n        return true;\n      };\n    })()\n);\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n    (function standardBrowserEnv() {\n      return {\n        write: function write(name, value, expires, path, domain, secure) {\n          var cookie = [];\n          cookie.push(name + '=' + encodeURIComponent(value));\n\n          if (utils.isNumber(expires)) {\n            cookie.push('expires=' + new Date(expires).toGMTString());\n          }\n\n          if (utils.isString(path)) {\n            cookie.push('path=' + path);\n          }\n\n          if (utils.isString(domain)) {\n            cookie.push('domain=' + domain);\n          }\n\n          if (secure === true) {\n            cookie.push('secure');\n          }\n\n          document.cookie = cookie.join('; ');\n        },\n\n        read: function read(name) {\n          var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n          return (match ? decodeURIComponent(match[3]) : null);\n        },\n\n        remove: function remove(name) {\n          this.write(name, '', Date.now() - 86400000);\n        }\n      };\n    })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return {\n        write: function write() {},\n        read: function read() { return null; },\n        remove: function remove() {}\n      };\n    })()\n);\n","'use strict';\n\nvar Cancel = require('./Cancel');\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n","const WOQLTableConfig = require('./viewer/tableConfig');\nconst WOQLChooserConfig = require('./viewer/chooserConfig');\nconst WOQLGraphConfig = require('./viewer/graphConfig');\nconst WOQLChartConfig = require('./viewer/chartConfig');\nconst WOQLStreamConfig = require('./viewer/streamConfig');\nconst FrameConfig = require('./viewer/frameConfig');\nconst WOQLRule = require('./woqlRule');\nconst FrameRule = require('./frameRule');\n\n/**\n * @constructor \n * We bundle the useful functions in a View object and just export that for ease of consumption\n */\nconst View = {};\n\nView.table = function(){ return new WOQLTableConfig(); }\nView.chart = function(){ return new WOQLChartConfig(); }\nView.graph = function(){ return new WOQLGraphConfig(); }\nView.chooser = function(){ return new WOQLChooserConfig(); }\nView.stream = function(){ return new WOQLStreamConfig(); }\nView.document = function(){ return new FrameConfig(); }\nView.loadConfig = function(config){\n\tif(config.table){\n\t\tvar view = new WOQLTableConfig();\n\t\tview.loadJSON(config.table, config.rules);\n\t}\n\telse if(config.chooser){\n\t\tvar view = new WOQLChooserConfig();\n\t\tview.loadJSON(config.chooser, config.rules);\n\t}\n\telse if(config.graph){\n\t\tvar view = new WOQLGraphConfig();\n\t\tview.loadJSON(config.graph, config.rules);\n\t}\n\telse if(config.chart){\n\t\tvar view = new WOQLChartConfig();\n\t\tview.loadJSON(config.chart, config.rules);\n\t}\n\telse if(config.stream){\n\t\tvar view = new WOQLStreamConfig();\n\t\tview.loadJSON(config.stream, config.rules);\n\t}\n\telse if(config.frame){\n\t\tvar view = new FrameConfig();\n\t\tview.loadJSON(config.frame, config.rules);\n\t}\n\treturn view;\n}\n\n/**\n * Shorthand functions for accessing the pattern matching capabilities\n */\nView.rule = function(type){ \n\tif(type && type == \"frame\") return new FrameRule(); \n\treturn new WOQLRule(); \n}\n\nView.pattern = function(type){ \n\tif(type && type == \"woql\") return new WOQLRule().pattern;\n\telse return new FrameRule().pattern;\n}\n\n/**\n * Called to match an entire row of results is matched by a set of rules\n * returns array of rules that matched\n */\nView.matchRow = function(rules, row, rownum, action){\n\treturn new WOQLRule().matchRow(rules, row, rownum, action);\n}\n\n/**\n * Called to test whether an entire column of results is matched by a set of rules\n * returns array of rules that matched\n */\nView.matchColumn = function(rules, key, action){\n\treturn new WOQLRule().matchColumn(rules, key, action);\n}\n\n/**\n * Called to test whether a specific cell is matched by a set of rules\n * returns array of rules that matched\n */\nView.matchCell = function(rules, row, key, rownum, action){\n\treturn new WOQLRule().matchCell(rules, row, key, rownum, action);\n}\n\n/**\n * Called to test whether a specific node is matched by a set of rules\n * returns array of rules that matched\n */\nView.matchNode = function(rules, row, key, nid, action){\n\treturn new WOQLRule().matchNode(rules, row, key, nid, action);\n}\n\n/**\n * Called to test whether a specific edge (source -> target) is matched by a set of rules\n * returns array of rules that matched\n */\nView.matchEdge = function(rules, row, keya, keyb, action){\n\treturn new WOQLRule().matchPair(rules, row, keya, keyb, action);\n}\n\n/**\n * Called to test whether a specific frame is matched by a set of rules\n */\nView.matchFrame = function(rules, frame, onmatch){\n\treturn new FrameRule().testRules(rules, frame, onmatch);\n}\n\nmodule.exports = View;\n","const FrameHelper = require('./utils');\nconst FrameRule = require('./frameRule');\n\n/**\n * @file Javascript Terminus Document Classes\n * @license Apache Version 2\n * Helper classes for accessing documents returned by the Terminus DB API programmatically\n * \n * @example\n * let doc = new TerminusDocument(client);\n * \n * //These set the objects document property and return promises:\n *  \n * doc.loadDocument(URL).then(() => console.log(this.document));\n * doc.loadComplete(URL, CLS).then(() => console.log(this.document))\n * doc.loadSchema(cls).then(() => console.log(this.document))\n * \n * //These just set the object's document property \n * doc.loadJSON(json_frames, cls) //console.log(this.document)\n * doc.loadDataFrames(json_frames, cls)\n * doc.loadClassFrames(json_frames, cls)\n * @example \n *\n * @description Represents a frame for programmatic access to object frame, anywhere within a document\n * Recursive data structure where this.children contains an indexed array of object frames\n * and this.dataframes contains a property indexed array of data frames\n * Every object frame carries a reference to its classframe\n * This gives us instructions as to how to create new frames according to the schema\n * After that it's turtles all the way down.\n * @param cls - ID of the class (URL)\n * @param classframe - an array of frames representing a class\n * @param archetypes list of class frames\n * @param parent parent object\n * @returns\n */\n\nfunction ObjectFrame(cls, dataframes, classframes, parent, parentframe) {\n\t// the class of the frame - mandatory\n\tthis.empty();\n\tthis.cls = cls;\n\n\t// array of frames representing the full class frame\n\t// (optional - required to be able to safely add missing properties)\n\tif (classframes && typeof classframes === 'object') {\n\t\tthis.loadClassFrames(classframes);\n\t}\n\tif (dataframes && typeof dataframes === 'object') {\n\t\tthis.originalFrames = dataframes;\n\t\tthis.loadDataFrames(dataframes);\n\t} else {\n\t\tthis.originalFrames = false;\n\t}\n\t// parent object frame\n\tthis.parent = parent;\n\t// original frame used by parent to create me\n\tthis.parentframe = parentframe;\n\t// set to true if this is a newly created document\n\tthis.newDoc = false;\n}\n\n/**\n * Loads class frames for the object's class - the instructions about how to put an object together\n */\nObjectFrame.prototype.loadClassFrames = function (classframes) {\n\tfor (let j = 0; j < classframes.length; j += 1) {\n\t\tif (classframes[j]['@context']) this.jsonld_context = classframes[j]['@context'];\n\n\t\tconst cf = new ClassFrame(classframes[j]);\n\t\tif (cf.isValid()) {\n\t\t\tif(!this.classframes) this.classframes = {};\n\t\t\tif(typeof this.classframes[classframes[j].property] === 'undefined') {\n\t\t\t\tthis.classframes[classframes[j].property] = [];\n\t\t\t}\n\t\t\tthis.classframes[classframes[j].property] = cf;\n\t\t\tif (cf.isObject() && this.properties[classframes[j].property]) {\n\t\t\t\tfor (let i = 0; i < this.properties[classframes[j].property].values.length; i += 1) {\n\t\t\t\t\tthis.properties[classframes[j].property].values[i].loadClassFrames(classframes[j].frame);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn this;\n};\n\n/**\n * Does this object have a schema loaded?\n */\nObjectFrame.prototype.hasSchema = function () {\n\treturn !FrameHelper.empty(this.classframes);\n};\n\n/*\n * Loads an array of data frames into the object's internal index\n * {property: [frames]}\n */\nObjectFrame.prototype.loadDataFrames = function (frames) {\n\tif (typeof frames !== 'object' || !frames.length) return undefined;\n\tif (!this.originalFrames) this.originalFrames = frames;\n\tif (!this.subjid && frames[0].domainValue) this.subjid = frames[0].domainValue;\n\tfor (let i = 0; i < frames.length; i += 1) {\n\t\tif (frames[i]['@context']) this.jsonld_context = frames[i]['@context'];\n\t\tlet cframe = this.getPropertyClassFrame(frames[i].property, frames[i]);\n\t\tif (cframe && cframe.isClassChoice()) {\n\t\t\tcframe = cframe.getChosenClassFrame(frames[i].range);\n\t\t\tif (!cframe) {\n\t\t\t\tconsole.log(`no choice frame ${frames[i].range}`);\n\t\t\t}\n\t\t} else if (cframe && cframe.isLogic()) {\n\t\t\tcframe = cframe.getChosenFrame(frames[i]);\n\t\t}\n\t\tif (cframe) {\n\t\t\tif (typeof this.properties[frames[i].property] === 'undefined') {\n\t\t\t\tthis.properties[frames[i].property] = new PropertyFrame(frames[i].property, cframe, this);\n\t\t\t}\n\t\t\tthis.properties[frames[i].property].addFrame(frames[i]);\n\t\t}\n\t}\n\treturn this;\n};\n\n/*\n * Serialises the javascript object as an array of frames\n */\nObjectFrame.prototype.getAsFrame = function (prop, parent) {\n\tif (this.parentframe) return this.parentframe;\n\tconst ff = { type: 'objectProperty', property: prop };\n\tff.range = this.cls;\n\tff.domain = parent.cls;\n\tff.domainValue = parent.subjid;\n\tff.frame = [];\n\tfor (const prop of Object.keys(this.properties)) {\n\t\tff.frame = ff.frame.concat(ff.frame, this.properties[prop].getAsFrames());\n\t}\n\treturn ff;\n};\n\nObjectFrame.prototype.getAsFrames = function (prop, parent) {\n\tvar frames = [];\n\tfor (const prop of Object.keys(this.properties)) {\n\t\tframes = frames.concat(frames, this.properties[prop].getAsFrames());\n\t}\n\treturn frames;\n}\n\n/**\n * Cleans out object and sets everything empty\n */\nObjectFrame.prototype.empty = function () {\n\t// all indexed by property\n\tthis.properties = {};\n\tthis.restrictions = {};\n\tthis.subjid = false;\n\tthis.cls = false;\n};\n\n/*\n * Resets object state to original state\n */\nObjectFrame.prototype.reset = function (prop) {\n\tif (prop) {\n\t\tconst props = [];\n\t\tfor (let i = 0; i < this.originalFrames.length; i += 1) {\n\t\t\tif (this.originalFrames[i].property === prop) {\n\t\t\t\tprops.push(this.originalFrames[i]);\n\t\t\t}\n\t\t}\n\t\tif (this.properties[prop]) this.properties[prop] = [];\n\t\tthis.loadDataFrames(props);\n\t} else {\n\t\tthis.restrictions = {};\n\t\tthis.properties = {};\n\t\tthis.loadDataFrames(this.originalFrames);\n\t}\n};\n\n/*\n * Clears out any specific information from a tree\n */\nObjectFrame.prototype.clear = function () {\n\tfor (const prop of Object.keys(this.properties)) {\n\t\tthis.properties[prop].clear();\n\t}\n\treturn this;\n};\n\n/*\n * Filters the frame and its children\n */\nObjectFrame.prototype.filter = function (rules, onmatch) {\n\tvar hits = new FrameRule().testRules(rules, this, onmatch);\n\tfor (const prop of Object.keys(this.properties)) {\n\t\tthis.properties[prop].filter(rules, onmatch);\n\t}\n\treturn this;\n};\n\n\n/**\n * If a class frame is present, it is returned for the given property\n * If no class frame is present and an instance frame is passed in the\n * this enables make it up as you go along editing\n * second argument a class frame will be created from the instance frame.\n */\nObjectFrame.prototype.getPropertyClassFrame = function (prop, instance) {\n\tif (this.classframes && typeof this.classframes === 'object' && typeof this.classframes[prop] === 'object') {\n\t\treturn this.classframes[prop];\n\t}\n\tif (instance) {\n\t\tconst cf = new ClassFrame(instance);\n\t\treturn cf;\n\t}\n\tif (this.properties[prop]) {\n\t\treturn new ClassFrame(this.properties[prop].values[0]);\n\t}\n\treturn false;\n};\n\n/*\n * Returns a list of properties - type can be filled|missing|all\n */\nObjectFrame.prototype.getProperties = function (type) {\n\tif(type == \"filled\" || !this.classframes){\n\t\treturn Object.keys(this.properties);\n\t}\n\tif (type == 'missing') {\n\t\tconst filled = Object.keys(this.properties);\n\t\tconst all = Object.keys(this.classframes);\n\t\tconst missing = [];\n\t\tfor (let i = 0; i < all.length; i++) {\n\t\t\tif (filled.indexOf(all[i]) == -1 && missing.indexOf(all[i]) == -1) {\n\t\t\t\tmissing.push(all[i]);\n\t\t\t}\n\t\t}\n\t\treturn missing;\n\t}\n\treturn Object.keys(this.classframes);\n};\n\n/**\n * Missing properties are those that are present in the classframe,\n * but not instantiated in the current object frame\n * for this to work we need to load the frame with the associated classframe\n */\nObjectFrame.prototype.getMissingPropertyList = function () {\n\tvar missing = this.getProperties(\"missing\");\n\tconst nmissing = [];\n\tfor (let i = 0; i < missing.length; i++) {\n\t\tconst cframe = this.getPropertyClassFrame(missing[i]);\n\t\tif(cframe){\n\t\t\tvar newb = { label: cframe.getLabel(), value: missing[i] };\n\t\t}\n\t\telse {\n\t\t\tvar newb = { label: missing[i], value: missing[i]};\n\t\t}\n\t\tnmissing.push(newb);\n\t}\n\treturn nmissing;\n};\n\n/**\n * List of properties that are filled in the object\n */\nObjectFrame.prototype.getFilledPropertyList = function () {\n\tvar props = this.getProperties(\"filled\");\n\tconst filled = [];\n\tfor (let i = 0; i < props.length; i++) {\n\t\tconst cframe = this.getPropertyClassFrame(props[i]);\n\t\tif(cframe){\n\t\t\tvar newb = { label: cframe.getLabel(), value: props[i] };\n\t\t}\n\t\telse {\n\t\t\tvar newb = { label: props[i], value: props[i]};\n\t\t}\n\t\tfilled.push(newb);\n\t}\n\treturn filled;\n};\n\n/*\n * Fills the object frame from the schema - adding all the necessary property frames, etc to make it complete\n */\nObjectFrame.prototype.fillFromSchema = function (newid) {\n\tif (newid) this.subjid = newid;\n\tnewid = (newid || FrameHelper.genBNID());\n\tconst properties = {};\n\tif(this.classframes){\n\t\tfor (const prop of Object.keys(this.classframes)) {\n\t\t\tconst pf = this.getPropertyClassFrame(prop);\n\t\t\tproperties[prop] = new PropertyFrame(prop, pf, this);\n\t\t\tproperties[prop].fillFromSchema(newid);\n\t\t}\n\t}\n\tthis.properties = properties;\n\tthis.originalFrames = [];\n\tfor (const prop of Object.keys(this.properties)) {\n\t\tthis.originalFrames.push(this.properties[prop].getAsFrames());\n\t}\n\treturn this;\n};\n\n/*\n * Clones an object frame to be a copy of the current frame\n */\nObjectFrame.prototype.clone = function (newid) {\n\tconst properties = {};\n\tconst cloned = new ObjectFrame(this.cls, false, false, this.parent);\n\tcloned.classframes = this.classframes;\n\tcloned.subjid = newid;\n\tfor (const prop of Object.keys(this.properties)) {\n\t\tproperties[prop] = this.properties[prop].clone();\n\t}\n\tcloned.properties = properties;\n\treturn cloned;\n};\n\n\n/**\n * Returns a child frame with a particular id\n * If the second parameter is included, it will only look in that specific property\n * Otherwise searches all properties for the child\n */\nObjectFrame.prototype.getChild = function (childid, prop) {\n\tlet pframe = this.getProperty(prop);\n\tfor (let i = 0; i < pframe.values.length; pframe++) {\n\t\tif (pframe.values[i].isObject() && pframe.values[i].subject === childid) return pframe.values[i];\n\t}\n\tif (!prop) {\n\t\tfor (const key of Object.keys(this.properties)) {\n\t\t\tfor (let i = 0; i < this.properties[key].values.length; i += 1) {\n\t\t\t\tif (this.properties[key].values[i].subject() === childid) return this.properties[key].values[i];\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n\nObjectFrame.prototype.addProperty = function (prop, cls) {\n\tconst cframe = this.getPropertyClassFrame(prop);\n\tvar ndata = false;\n\tif(cframe){\n\t\tconst nprop = new PropertyFrame(prop, cframe, this);\n\t\tif(cframe.isObject()){\n\t\t\tif (!cframe.isClassChoice()) {\n\t\t\t\tndata = cframe.createEmpty(FrameHelper.genBNID());\n\t\t\t}\n\t\t\tif (cls) {\n\t\t\t\tndata = cframe.createEmptyChoice(cls, FrameHelper.genBNID());\n\t\t\t}\n\t\t\tconst clss = cframe.getClassChoices();\n\t\t\tif (clss && clss.length) {\n\t\t\t\tndata = cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tndata = cframe.createEmpty();\n\t\t}\n\t\tif(ndata){\n\t\t\tnprop.addValueFrame(ndata);\n\t\t}\n\t\tif (typeof this.properties[prop] === 'undefined') {\n\t\t\tthis.properties[prop] = [];\n\t\t}\n\t\tthis.properties[prop].push(nprop);\n\t\treturn nprop;\n\t}\n\treturn false;\n};\n\nObjectFrame.prototype.addPropertyValue = function (prop, value) {\n\tconst pframe = this.properties[prop];\n\treturn pframe.addValue(value);\n};\n\nObjectFrame.prototype.removeProperty = function (prop) {\n\tif (typeof this.properties[prop] !== 'undefined') {\n\t\tdelete (this.properties[prop]);\n\t}\n};\n\nObjectFrame.prototype.removePropertyValue = function (prop, value, index) {\n\tconst pframe = this.properties[prop];\n\tpframe.removeValue(value, index);\n\tif (pframe.values.length == 0) {\n\t\tthis.removeProperty(prop);\n\t}\n};\n\nObjectFrame.prototype.error = function (msg) {\n\tconsole.error(msg);\n};\n\nObjectFrame.prototype.extract = function(){\n\tvar extracts = {};\n\tfor(var prop in this.properties){\n\t\tfor(var i = 0; i<this.properties[prop].length; i++){\n\t\t\tvar extracted = this.properties[prop][i].extract();\n\t\t\tif(!FrameHelper.empty(extracted)){\n\t\t\t\tif(typeof extracts[prop] == \"undefined\") extracts[prop] = [];\n\t\t\t\textracts[prop] = extracts[prop].concat(extracted);\n\t\t\t}\n\t\t}\n\t}\n\tif(FrameHelper.empty(extracts) && this.parent){\n\t\treturn false;\n\t}\n\telse {\n\t\tvar ext = this.extractJSONLD(extracts);\n\t\treturn ext;\n\t}\n}\n\nObjectFrame.prototype.extractJSONLD = function(extracts){\n\textracts[\"@type\"] = this.cls;\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\n\tif(this.jsonld_context) extracts['@context'] = this.jsonld_context;\n\treturn extracts;\n}\n\n\nObjectFrame.prototype.subject = function () {\n\treturn this.subjid;\n};\n\nObjectFrame.prototype.get = ObjectFrame.prototype.subject;\nObjectFrame.prototype.set = function(val){\n\tthis.subjid = val;\n}\n\nObjectFrame.prototype.isObject = function () { return true; };\nObjectFrame.prototype.isProperty = function () { return false; };\nObjectFrame.prototype.isData = function () { return false; };\n\n\nObjectFrame.prototype.subjectClass = function () {\n\treturn this.cls;\n};\n\nObjectFrame.prototype.depth = function () {\n\tif (this.parent) return (this.parent.depth() + 1);\n\treturn 0;\n};\n\nObjectFrame.prototype.getProperty = function (prop) {\n\treturn this.properties[prop];\n};\n\nObjectFrame.prototype.first = function (prop) {\n\tif (this.properties && this.properties[prop]) {\n\t\treturn this.properties[prop].first();\n\t}\n};\n\nObjectFrame.prototype.property = function (prop) {\n\tif (this.parent) return this.parent.property();\n\treturn false;\n};\n\nObjectFrame.prototype.parentObject = function () {\n\tif (this.parent && this.parent.parent) {\n\t\treturn this.parent.parent;\n\t}\n\treturn false;\n};\n\nObjectFrame.prototype.root = function () {\n\tif (this.parent) return false;\n\treturn true;\n};\n\nObjectFrame.prototype.renderProperties = function () {\n\tconst props = this.sortProperties();\n\tconst nprops = [];\n\tfor (let i = 0; i < props.length; i++) {\n\t\tif (this.properties[props[i]].render) {\n\t\t\tconst rend = this.properties[props[i]].render(this.properties[props[i]]);\n\t\t\tif (rend) nprops.push(rend);\n\t\t}\n\t}\n\treturn nprops;\n};\n\nObjectFrame.prototype.sortProperties = function () {\n\tconst unsorted = Object.keys(this.properties);\n\tif (this.compare) {\n\t\treturn unsorted.sort((a, b) => this.compare(a, b, this));\n\t}\n\treturn unsorted.sort((a, b) => this.standardCompare(a, b, this));\n};\n\n/*\n * Label first, then datatype properties, then object properties\n */\nObjectFrame.prototype.standardCompare = function (a, b, doc) {\n\tif (a == 'rdfs:label') return -1;\n\tif (b == 'rdfs:label') return 1;\n\tif (a == 'rdfs:comment') return -1;\n\tif (b == 'rdfs:comment') return 1;\n\tif (doc.properties[a].isData() && doc.properties[b].isObject()) return -1;\n\tif (doc.properties[b].isData() && doc.properties[a].isObject()) return 1;\n\treturn 0;\n};\n\nObjectFrame.prototype.cardControlAllows = function(action){\n\tif(!this.parent) return true;\n\tif(this.parent.cframe.hasRestriction()){\n\t\tvar rest = this.parent.cframe.restriction;\n\t\tvar currentnum = this.parent.values.length;\n\t\tif(action == \"add\" || action == \"clone\"){\n\t\t\tif(rest.max && currentnum >= rest.max){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nObjectFrame.prototype.isUpdated = function(){\n\tvar i = 0;\n\tfor(var prop in this.properties){\n\t\tif(this.originalFrames[i] != prop) return true;\n\t\tif(this.properties[prop].isUpdated()) return true;\n\t\ti++;\n\t}\n\tif(i != this.originalFrames.length) return true;\n\treturn false;\n}\n\nObjectFrame.prototype.isNew = function(){\n\treturn (this.subject().substring(0, 2) == \"_:\");\n}\n\nObjectFrame.prototype.getSummary = function(){\n\tvar ret = { status: \"ok\" };\n\tif(this.isUpdated()) ret.status = \"updated\";\n\tif(this.isNew()) ret.status = \"new\";\n\tret.propcount = 0;\n\tfor(var prop in this.properties){\n\t\tret.propcount++;\n\t}\n\tret.long = ret.propcount + \" properties\";\n\treturn ret;\n}\n\nfunction PropertyFrame(property, cframe, parent) {\n\tthis.predicate = property;\n\tthis.cframe = cframe;\n\tthis.parent = parent;\n\tthis.values = [];\n}\n\nPropertyFrame.prototype.addFrame = function (frame) {\n\tif(this.cframe.isData()){\n\t\tvar df = new DataFrame(frame, this, this.values.length);\n\t\tthis.values.push(df);\n\t} else {\n\t\tconst kid = new ObjectFrame(this.range(), this.cframe.frame, frame.frame, this, frame);\n\t\tthis.values.push(kid);\n\t}\n};\n\nPropertyFrame.prototype.addValueFrame = function (oframe) {\n\toframe.parent = this;\n\toframe.index = this.values.length;\n\tthis.values.push(oframe);\n};\n\n\nPropertyFrame.prototype.fillFromSchema = function (newid) {\n\tif (this.isData() || (this.isObject() && !this.isClassChoice())) {\n\t\tvar values = [];\n\t\tif (this.cframe.hasRestriction() && this.cframe.restriction.min) {\n\t\t\tfor (let i = 0; i < this.cframe.restriction.min; i += 1) {\n\t\t\t\tvar nframe = this.createEmpty(newid);\n\t\t\t\tnframe.parent = this;\n\t\t\t\tvalues.push(nframe);\n\t\t\t}\n\t\t} \n\t\telse {\n\t\t\tvar nframe = this.createEmpty(newid);\n\t\t\tnframe.parent = this;\n\t\t\tvalues.push(nframe);\n\t\t}\n\t\tthis.values = values;\n\t}\n\telse if (this.isClassChoice()) {\n\t\tconst clss = this.cframe.getClassChoices();\n\t\tif (clss && clss.length) {\n\t\t\tconst empty = this.cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\n\t\t\tempty.parent = this;\n\t\t\tthis.values = [empty];\n\t\t}\n\t}\n};\n\nPropertyFrame.prototype.isData = function () {\n\treturn this.cframe.isData();\n};\n\nPropertyFrame.prototype.isObject = function () {\n\treturn this.cframe.isObject();\n};\n\nPropertyFrame.prototype.isProperty = function () {\n\treturn true;\n};\n\nPropertyFrame.prototype.property = function () {\n\treturn this.predicate;\n};\n\nPropertyFrame.prototype.extract = function () {\n \tconst extracts = [];\n \tfor (let i = 0; i < this.values.length; i++) {\n \t\tconst val = this.values[i].extract();\n \t\tif (val !== '' && val !== false && typeof val !== 'undefined') extracts.push(val);\n \t}\n\treturn extracts;\n};\n\nPropertyFrame.prototype.subject = function () {\n\treturn (this.parent ? this.parent.subject() : false);\n};\nPropertyFrame.prototype.subjectClass = function () {\n\treturn (this.parent ? this.parent.subjectClass() : false);\n};\nPropertyFrame.prototype.depth = function () {\n\treturn (this.parent ? this.parent.depth() : false);\n};\nPropertyFrame.prototype.updated = function () {\n\treturn (this.parent ? this.parent.childUpdated() : false);\n};\nPropertyFrame.prototype.range = function () {\n\treturn (this.cframe ? this.cframe.range : '');\n};\nPropertyFrame.prototype.getLabel = function () {\n\treturn (\n\t\tthis.cframe ? this.cframe.getLabel() : '');\n};\nPropertyFrame.prototype.getComment = function () {\n\treturn (this.cframe ? this.cframe.getComment() : false);\n};\nPropertyFrame.prototype.hasCardinalityRestriction = function () {\n\treturn (this.cframe ? this.cframe.hasRestriction() : false);\n};\nPropertyFrame.prototype.getRestriction = function () {\n\treturn (this.cframe ? this.cframe.restriction : false);\n};\nPropertyFrame.prototype.isClassChoice = function () {\n\treturn (this.cframe ? this.cframe.isClassChoice() : false);\n};\n\nPropertyFrame.prototype.deletePropertyValue = function (value, index) {\n\tthis.parent.removePropertyValue(this.property(), value, index);\n};\n\nPropertyFrame.prototype.get = function(){\n\tvar gets = [];\n\tfor(var i = 0; i<this.values.length; i++){\n\t\tif(this.values[i]) {\n\t\t\tvar x = this.values[i].get();\n\t\t\tif(x) gets.push(x);\n\t\t}\n\t}\n\treturn gets;\n}\n\nPropertyFrame.prototype.set = function(val){\n\tfor(var i = 0; i<this.values.length; i++){\n\t\tif(this.values[i]) {\n\t\t\tthis.values[i].set(val);\n\t\t}\n\t}\n}\n\n\nPropertyFrame.prototype.clear = function(){\n\tfor(var i = 0 ; i<this.values.length; i++){\n\t\tthis.values[i].clear();\n\t}\n}\n\nPropertyFrame.prototype.clone = function(){\n\tconst cvalues = [];\n\tconst cloned = new PropertyFrame(this.predicate, this.cframe, this.parent);\n\tfor(var i = 0 ; i<this.values.length; i++){\n\t\tcvalues.push(this.values[i].clone());\n\t}\n\tcloned.values = cvalues;\n\treturn cloned;\n\t//\n}\n\nPropertyFrame.prototype.getAsFrames = function(){\n\tvar fs = [];\n\tfor(var i = 0; i<this.values.length; i++){\n\t\tif(this.values[i]){\n\t\t\tif(this.isData()){\n\t\t\t\tfs.push(this.values[i].getAsFrame());\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfs = fs.concat(this.values[i].getAsFrames());\n\t\t\t}\n\t\t}\n\t}\n\treturn fs;\n}\n\nPropertyFrame.prototype.createEmpty = function(){\n\tif (this.cframe.isData()) {\n\t\tconst df = this.cframe.copy();\n\t\tdf.set('');\n\t\treturn df;\n\t}\n\telse if (this.cframe.isObject()) {\n\t\tif (!this.cframe.isClassChoice()) {\n\t\t\tconst df = this.cframe.createEmpty(FrameHelper.genBNID());\n\t\t\treturn df;\n\t\t}\n\t\tconst clss = this.cframe.getClassChoices();\n\t\tif (clss && clss.length) {\n\t\t\tconst df = this.cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\n\t\t\treturn df;\n\t\t}\n\t}\n}\n\nPropertyFrame.prototype.filter = function (rules, onmatch) {\n\tvar hits = new FrameRule().testRules(rules, this, onmatch);\n\tfor (var i = 0; i<this.values.length; i++){\n\t\tthis.values[i].filter(rules, onmatch);\n\t}\n\treturn this;\n}\n\n/*\n * Shorthand functions to make it easier to access the underlying data\n */\n\nPropertyFrame.prototype.first = function () {\n\tif (this.values && this.values[0]) {\n\t\treturn this.values[0].get();\n\t}\n};\n\nPropertyFrame.prototype.renderValues = function(){\n\tvar sortedVals = this.sortValues();\n\tvar vals = [];\n\tfor(var i = 0; i<sortedVals.length; i++){\n\t\tif(sortedVals[i] && sortedVals[i].render){\n\t\t\tvar rend = sortedVals[i].render(sortedVals[i]);\n\t\t\tif(rend) vals.push(rend);\n\t\t}\n\t}\n\treturn vals;\n};\n\nPropertyFrame.prototype.sortValues = function () {\n\tif (this.compare) {\n\t\treturn this.values.sort((a, b) => this.compare(a, b, this));\n\t}\n\treturn this.values;\n};\n\nPropertyFrame.prototype.cardControlAllows = function(action){\n\tif(this.cframe.hasRestriction()){\n\t\tvar rest = this.cframe.restriction;\n\t\tvar currentnum = this.values.length;\n\t\tif(action == \"add\" || action == \"clone\"){\n\t\t\tif(rest.max && currentnum >= rest.max){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif(action == \"delete\" && (rest.min)){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nPropertyFrame.prototype.isUpdated = function(){\n\treturn true;\n\tif(this.values.length != this.originalValues.length) return true;\n\tfor(var i = 0 ; i < this.values.length; i++){\n\t\tif(this.cframe && this.cframe.isData()){\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(this.values[i].isUpdated()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\n\nfunction DataFrame(frame, parent, index) {\n\tthis.err = false;\n\tthis.parent = parent;\n\t// the id of the object that owns this dataframe\n\tthis.subjid = (parent ? parent.subjid : false);\n\tthis.index = index;\n\tif (frame) {\n\t\tthis.load(frame);\n\t}\n}\n\nDataFrame.prototype.load = function (frame) {\n\tif (typeof frame !== 'object') {\n\t\tthis.error('No frame passed to load');\n\t\treturn;\n\t}\n\t// all the meta-data carried in frames:\n\tthis.type = frame.type;\n\tthis.predicate = frame.property;\n\tthis.range = frame.range;\n\tthis.rangeValue = frame.rangeValue;\n\tthis.domain = frame.domain;\n\tthis.domainValue = frame.domainValue;\n\tthis.frame = frame.frame;\n\tthis.label = frame.label;\n\tthis.comment = frame.comment;\n\tconst { restriction } = frame;\n\tthis.restriction = false;\n\tif (restriction && typeof restriction === 'object') {\n\t\tthis.restriction = new Restriction(restriction);\n\t}\n};\n\nDataFrame.prototype.filter = function (rules, onmatch) {\n\tvar hits = new FrameRule().testRules(rules, this, onmatch);\n\treturn this;\n};\n\nDataFrame.prototype.delete = function () {\n\tthis.parent.deletePropertyValue(this.get(), this.index);\n};\n\nDataFrame.prototype.save = function () {\n\tif (this.parent) {\n\t\tthis.parent.save();\n\t}\n};\n\nDataFrame.prototype.reset = function () {\n\tthis.set(this.originalValue);\n\t// this.redraw();\n};\n\nDataFrame.prototype.clone = function () {\n\tconst newb = this.parent.addPropertyValue(this.get());\n\tconst nrend = this.copy(newb);\n\tnrend.setNew();\n\tnrend.mode = 'edit';\n\tnrend.index = this.parent.values.length;\n\tthis.parent.values.push(nrend);\n};\n\n\nDataFrame.prototype.depth = function () { return (this.parent ? this.parent.depth() : false); };\nDataFrame.prototype.property = function () { return (this.parent ? this.parent.property() : false); };\nDataFrame.prototype.subject = function () { return (this.parent ? this.parent.subject() : false); };\nDataFrame.prototype.subjectClass = function () { return (this.parent ? this.parent.subjectClass() : false); };\nDataFrame.prototype.type = function () {\treturn (this.range ? this.range : false); };\n\nDataFrame.prototype.isValidType = function (dt) {\n\tconst vtypes = ['datatypeProperty', 'objectProperty', 'restriction '];\n\tif (vtypes.indexOf(dt) === -1) return false;\n\treturn true;\n};\n\n\nDataFrame.prototype.getAsFrame = function () {\n\t const ff = { type: this.type, property: this.property() };\n\t if (this.range) ff.range = this.range;\n\t if (this.rangeValue) ff.rangeValue = this.rangeValue;\n\t if (this.domain) ff.domain = this.domain;\n\t if (this.domainValue) ff.domainValue = this.domainValue;\n\t if (this.frame) ff.frame = this.frame;\n\t if (this.label) ff.label = this.label;\n\t if (this.comment) ff.comment = this.comment;\n\t return ff;\n};\n\nDataFrame.prototype.hasRestriction = function () {\n\t if (this.restriction) {\n\t\t return this.restriction.hasCardRestriction();\n\t }\n\t return false;\n};\n\nDataFrame.prototype.copy = function (newid) {\n\tconst copy = new DataFrame(this, this.parent);\n\tif (newid) copy.domainValue = newid;\n\treturn copy;\n};\n\nDataFrame.prototype.getLabel = function () {\n\tlet lab = '';\n\tif(this.predicate == \"rdfs:label\") return \"Name\";\n\tif(this.predicate == \"rdfs:comment\") return \"Description\";\n\tif (this.label && typeof this.label === 'object') lab = this.label['@value'];\n\tif (this.label && typeof this.label === 'string') lab = this.label;\n\t// always return something\n\tif (!lab && this.property()) lab = FrameHelper.labelFromURL(this.property());\n\tif (!lab) lab = FrameHelper.labelFromURL(this.cls);\n\treturn lab;\n};\n\nDataFrame.prototype.getType = function () {\n\tif (this.range) return this.range;\n\tif (this.rangeValue && this.rangeValue.type) return this.rangeValue.type;\n\treturn false;\n};\n\nObjectFrame.prototype.getLabel = DataFrame.prototype.getLabel;\n\nDataFrame.prototype.getComment = function () {\n\tlet comment = '';\n\tif (this.comment && typeof this.comment === 'object') comment = this.comment['@value'];\n\tif (this.comment && typeof this.comment === 'string') comment = this.comment;\n\treturn comment;\n};\n\nObjectFrame.prototype.getComment = DataFrame.prototype.getComment;\n\n\nDataFrame.prototype.error = function (msg) {\n\tif (msg)\tthis.err = msg;\n\treturn this.err;\n};\n\nDataFrame.prototype.isValid = function () {\n\tif (!(this.type && this.isValidType(this.type))) {\n\t\tthis.error(`Missing or Illegal Frame Type ${this.type}`);\n\t\treturn false;\n\t}\n\tif (!(this.predicate)) {\n\t\tthis.error('Missing Frame Property');\n\t\treturn false;\n\t}\n\tif (!(this.domain)) {\n\t\tthis.error('Missing Frame Domain');\n\t\treturn false;\n\t}\n\tif (!(this.range)) {\n\t\tthis.error('Missing Frame Range');\n\t\treturn false;\n\t}\n\tif (this.isObjectProperty() && !(this.frame && typeof this.frame === 'object')) {\n\t\tthis.error('Missing Object Frame');\n\t\treturn false;\n\t}\n\treturn true;\n};\n\nDataFrame.prototype.isObjectProperty = function () {\n\treturn this.type === 'objectProperty';\n};\n\nDataFrame.prototype.isDatatypeProperty = function () {\n\treturn this.type === 'datatypeProperty';\n};\n\nDataFrame.prototype.isLogic = function () {\n\tif (this.type === 'and' || this.type === 'or' || this.type === 'xor') {\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nDataFrame.prototype.isRestriction = function () {\n\treturn this.type === 'restriction';\n};\n\nDataFrame.prototype.ftype = function () {\n\tif (this.isDocument()) return 'document';\n\tif (this.isDatatypeProperty()) return 'data';\n\tif (this.isChoice()) return 'oneOf';\n\tif (this.isObject()) return 'object';\n\tif (this.isLogic()) return 'logic';\n\tif (this.isClassChoice()) return 'class_choice';\n\treturn undefined;\n};\n\n\nDataFrame.prototype.isClassChoice = function () {\n\treturn (this.frame && this.frame.type === 'class_choice');\n};\n\nDataFrame.prototype.isString = function () {\n\tif (this.range === FrameHelper.getStdURL('xsd', 'string')) {\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nDataFrame.prototype.getChoiceOptions = function () {\n\tconst opts = [];\n\tfor (let i = 0; i < this.frame.elements.length; i += 1) {\n\t\tconst option = {};\n\t\tif (this.frame.elements[i].label) {\n\t\t\toption.label = this.frame.elements[i].label['@value'];\n\t\t} else {\n\t\t\toption.label = FrameHelper.labelFromURL(this.frame.elements[i].class);\n\t\t}\n\t\toption.value = this.frame.elements[i].class;\n\t\topts.push(option);\n\t}\n\treturn opts;\n};\n\nDataFrame.prototype.lang = function () {\n\treturn 'en';\n};\n\nDataFrame.prototype.isChoice = function () {\n\treturn (this.frame && this.frame.type === 'oneOf');\n};\n\nDataFrame.prototype.isDocument = function () {\n\treturn (this.frame && this.frame.type === 'document');\n};\n\nDataFrame.prototype.isData = function () {\n\treturn (this.isDocument() || this.isChoice() || this.isDatatypeProperty());\n};\n\nDataFrame.prototype.isObject = function () {\n\treturn (this.isObjectProperty() && this.frame && !(this.isChoice() || this.isDocument()));\n};\n\nDataFrame.prototype.isProperty = function () {\n\treturn false;\n};\n\nDataFrame.prototype.getTypeShorthand = function () {\n\tif (this.isDocument()) return 'document';\n\tif (this.isChoice()) return 'choice';\n\tconst sh = FrameHelper.getShorthand(this.getType());\n\treturn (sh || this.getType());\n};\n\nDataFrame.prototype.get = function () {\n\tif (this.contents) {\n\t\treturn this.contents;\n\t}\n\tif (this.isDatatypeProperty() && this.rangeValue && typeof this.rangeValue['@value'] !== 'undefined') {\n\t\treturn this.rangeValue['@value'];\n\t}\n\tif (this.isChoice() || this.isDocument()) {\n\t\treturn this.frame.domainValue;\n\t}\n\treturn '';\n};\n\nDataFrame.prototype.set = function (value, normalizer) {\n\tif (normalizer) value = normalizer(value, this);\n\tthis.contents = value;\n\tif (this.isChoice() || this.isDocument()) {\n\t\tthis.frame.domainValue = value;\n\t}\n\tif (this.isDatatypeProperty() && this.rangeValue) {\n\t\tthis.rangeValue['@value'] = value;\n\t}\n};\n\nDataFrame.prototype.clear = function () {\n\tif (this.isDocument() || this.isChoice() || this.isDatatypeProperty()) {\n\t\tthis.set('');\n\t}\n};\n\nDataFrame.prototype.cardControlAllows = function(action){\n\tif(this.parent.cframe.hasRestriction()){\n\t\tvar rest = this.parent.cframe.restriction;\n\t\tvar currentnum = this.parent.values.length;\n\t\tif(action == \"add\" || action == \"clone\"){\n\t\t\tif(rest.max && currentnum >= rest.max){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nDataFrame.prototype.extract = function(){\n\tvar val = this.get();\n\tif(val !== \"\" && val !== false){\n\t\tif(this.isDatatypeProperty()){\n\t\t\tvar objlit = { \"@value\": this.get()}\n\t\t\tif(this.isString()) objlit[\"@language\"] = this.lang();\n\t\t\telse objlit[\"@type\"] = this.getType();\n\t\t\treturn objlit;\n\t\t}\n\t\telse if(this.isChoice() || this.isDocument()){\n\t\t\treturn {\"@id\": val}\n\t\t}\n\t}\n\treturn val;\n}\n\n\n/*\n * Class frames represent the archetypal version of a property frame as returned by the class frame api\n */\nfunction ClassFrame(frame, parent) {\n\tthis.err = false;\n\tthis.parent = parent;\n\t// the id of the object that owns this dataframe\n\tthis.subjid = (parent ? parent.subjid : false);\n\tif (frame) {\n\t\tthis.load(frame);\n\t}\n}\n\nClassFrame.prototype = DataFrame.prototype;\n\nClassFrame.prototype.loadFromObjectFrame = function (par, child) {\n\t// all the meta-data carried in frames:\n\tthis.type = 'objectProperty';\n\tthis.predicate = par.property;\n\tthis.range = par.range;\n\tthis.rangeValue = child.subjid;\n\tthis.domain = par.cls;\n\tthis.domainValue = par.subjid;\n\tthis.label = par.getLabel();\n\tthis.comment = par.getComment();\n\tthis.restriction = par.restriction;\n};\n\nClassFrame.prototype.createEmptyChoice = function (cls, newid) {\n\tconst cf = this.getChosenClassFrames(cls);\n\tconst objframe = new ObjectFrame(cls);\n\tif (newid) objframe.subjid = newid;\n\tobjframe.loadClassFrames(cf);\n\tconst fframe = objframe.fillFromSchema();\n\treturn fframe;\n};\n\nClassFrame.prototype.getChosenClassFrames = function (chosen) {\n\tlet nc = [];\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\n\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\n\t\t\tif (chosen === this.frame.operands[i][j].domain) {\n\t\t\t\tnc = nc.concat(this.frame.operands[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\treturn nc;\n};\n\nClassFrame.prototype.createEmpty = function (newid) {\n\tif (this.isObject()) {\n\t\tconst objframe = new ObjectFrame(this.range);\n\t\tif (newid) objframe.subjid = newid;\n\t\tobjframe.loadClassFrames(this.frame);\n\t\tconst fframe = objframe.fillFromSchema();\n\t\treturn fframe;\n\t}\n\tif (this.isData()) {\n\t\tconst dataframe = this.copy();\n\t\tdataframe.set('');\n\t\treturn dataframe;\n\t}\n\treturn undefined;\n};\n\nClassFrame.prototype.cloneDataFrame = function (newid, other) {\n\treturn other;\n};\n\nClassFrame.prototype.clone = function (newid, other) {\n\tif (this.isObject()) {\n\t\tconsole.log('cannot clone class frame');\n\t} else if (this.isData()) {\n\t\treturn this.cloneDataFrame(newid, other);\n\t}\n\treturn undefined;\n};\n\nClassFrame.prototype.getClassChoices = function () {\n\tconst choices = [];\n\tif (this.frame.operands) {\n\t\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\n\t\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\n\t\t\t\tconst domcls = this.frame.operands[i][j].domain;\n\t\t\t\tif (domcls && choices.indexOf(domcls) === -1) {\n\t\t\t\t\tchoices.push(domcls);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn choices;\n};\n\nClassFrame.prototype.getChosenClassFrame = function (chosen) {\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\n\t\tconst operand = this.frame.operands[i];\n\t\tif (operand.length) {\n\t\t\tfor (let j = 0; j < operand.length; j += 1) {\n\t\t\t\tif (operand[j] && (chosen === operand[j].domain)) {\n\t\t\t\t\tconst cf = new ClassFrame(operand);\n\t\t\t\t\treturn cf;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (operand.range && chosen === operand.range) {\n\t\t\tconst cf = new ClassFrame(operand);\n\t\t\treturn cf;\n\t\t}\n\t}\n\treturn false;\n};\n\nClassFrame.prototype.getChosenFrame = function (dataframe) {\n\treturn dataframe;\n};\n\n\nfunction Restriction(restriction) {\n\tthis.min = 0;\n\tthis.max = 0;\n\tif (restriction) this.loadRestriction(restriction);\n}\n\nRestriction.prototype.hasCardRestriction = function () {\n\tif (this.min === 0 && this.max === 0) return false;\n\treturn true;\n};\n\nRestriction.prototype.loadRestriction = function (restriction) {\n\tif (typeof restriction.cardinality !== 'undefined') {\n\t\tthis.max = restriction.cardinality;\n\t\tthis.min = restriction.cardinality;\n\t} else if (typeof restriction.maxCardinality !== 'undefined') {\n\t\tthis.max = restriction.maxCardinality;\n\t} else if (typeof restriction.minCardinality !== 'undefined') {\n\t\tthis.min = restriction.minCardinality;\n\t} else if (typeof restriction.type !== 'undefined' && restriction.type === 'and' && typeof restriction.operands === 'object') {\n\t\tfor (let i = 0; i < restriction.operands.length; i += 1) {\n\t\t\tconst nrest = new Restriction(restriction.operands[i]);\n\t\t\tif (this.max === 0 && nrest.max > 0) this.max = nrest.max;\n\t\t\telse if (this.max > 0 && nrest.max > 0 && nrest.max < this.max) this.max = nrest.max;\n\t\t\tif (this.min === 0 && nrest.min > 0) this.min = nrest.min;\n\t\t\telse if (this.min > 0 && nrest.min > 0 && nrest.min > this.min) this.min = nrest.min;\n\t\t}\n\t}\n};\n\nmodule.exports = ObjectFrame;\n","function Codemirror(text, format, config){\n  this.textdom = text;\n  this.mode = format;\n  if(objectIsEmpty(config)) this.darkMode = config.darkMode;\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\n}\n// checks if a json object is empty\nfunction objectIsEmpty(arg) {\n  for (var item in arg) {\n    return false;\n  }\n  return true;\n}\n\nfunction autocomplete(){\n    var orig = CodeMirror.hint.javascript = function (cm) {\n        var list = [];//\"limit()\",\"start()\",\"triple()\"];//Session.get(Template.strSessionDistinctFields) || [];\n        var cursor = cm.getCursor();\n        var currentLine = cm.getLine(cursor.line);\n        var start = cursor.ch;\n        var end = start;\n        while (end < currentLine.length && /[\\w$]+/.test(currentLine.charAt(end))) ++end;\n        while (start && /[\\w$]+/.test(currentLine.charAt(start - 1))) --start;\n        var curWord = start != end && currentLine.slice(start, end);\n        var regex = new RegExp('^' + curWord, 'i');\n        var result = {\n            list: (!curWord ? list : list.filter(function (item) {\n                return item.match(regex);\n            })).sort(),\n            from: CodeMirror.Pos(cursor.line, start),\n            to: CodeMirror.Pos(cursor.line, end)\n        };\n        return result;\n    };\n    // codeMirror.hint.sql is defined when importing codemirror/addon/hint/sql-hint\n    // (this is mentioned in codemirror addon documentation)\n    // Reference the hint function imported here when including other hint addons\n    // or supply your own\n   \t//cm.replaceSelection(\".\");\n    //codeMirror.showHint(cm, CodeMirror.hint.javascript, hintOptions);\n}\n\n/*\ntxtar    : editor is attached to textar\nmode     : format for highlighting, ex: json, html etc.\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\nCodemirror.prototype.colorizeTextArea = function(dimensions){\n    //initize auto complete\n    /*CodeMirror.commands.autocomplete = function(cm) {\n    cm.showHint({hint: CodeMirror.hint.anyword});\n    }*/\n\n    // initialise code editor on text area\n    var editor = CodeMirror.fromTextArea(this.textdom, {\n        mode                : this.mode,\n        firstLineNumber     : 1,\n        lineNumbers         : true,\n        styleActiveLine     : true,\n        lineWrapping        : true,\n        smartIndent         : true,\n        indentWithTabs      : true,\n        newlineAndIndent    : true,\n        autoCloseBrackets   : true,\n        matchBrackets       : {afterCursor: true},\n        extraKeys           : {\"Ctrl-F\": \"find\",\n                               //\"Tab\": \"autocomplete\",\n                               \"Ctrl-Q\": function(cm){ cm.foldCode(cm.getCursor()); }},\n        refresh             : true,\n        foldGutter          : true,\n        gutters             : [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"]\n    });\n    editor.foldCode(CodeMirror.Pos(13, 0));\n    if(false && !(objectIsEmpty(dimensions))){\n      editor.setSize(dimensions.width, dimensions.height);\n    }\n    else this.setCodemirrorSize(editor, dimensions);\n    editor.defaultCharWidth('20px');\n    if(true || this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\n    else editor.setOption(\"theme\", 'neo');\n    return editor;\n} // colorizeTextArea()\n\n/*\n  set editor size according to screens\n  editor : code mirror editor Object\n  mode   : editor being viewed from schema/ doc/ query page*/\nCodemirror.prototype.setCodemirrorSize = function(editor, dimensions){\n  switch(dimensions){\n    case 'query':\n      editor.setSize('auto', '400');\n    break;\n    case 'schema':\n      editor.setSize('auto', '1550');\n    break;\n    case 'document':\n     editor.setSize('765', '500');\n    break;\n    case 'api-doc':\n        editor.setSize('800', '500');\n    break;\n    case 'doc-json':\n        editor.setSize('1410', 'auto');\n    break;\n    case 'doc-json-create':\n        editor.setSize('1410', '500');\n    break;\n  } // switch(dimensions)\n} // setCodemirrorSize()\n\n// updateTextArea(): highlights new changes on editor\nCodemirror.prototype.updateTextArea = function(editor){\n  editor.save();\n  setTimeout(function() {\n      editor.refresh();\n  },1);\n  // save changes of code mirror editor\n  editor.on('change', function(){\n    editor.save();\n  });\n} //updateTextArea()\n\n/*\ncolorizePre() to colorise pre tags (read only mode)\ntext (string)    : The document to run through the highlighter.\nmode (mode spec) : format to highlight color\noutput (DOM node): The tokens will be converted to spans as in an editor,\n                   and inserted into the node (through innerHTML).*/\nCodemirror.prototype.colorizePre = function(){\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\n  if(true || this.darkMode)\n      var theme = 'cm-s-erlang-dark';\n  else var theme = 'cm-s-neo';\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\n  return this.textdom;\n} // colorizePre()\n\nCodemirror.prototype.jsonldCheck = function(format){\n  if(format == 'jsonld') return true;\n}\n\nmodule.exports=Codemirror\n","/*\n * User Interface elements dealing with database level functions - view, delete, create, db\n * view document etc\n */\nconst UTILS=require('./Utils');\nconst TerminusClient = require('@terminusdb/terminus-client');\nconst HTMLHelper = require('./html/HTMLHelper');\nconst TerminusViewer = require(\"./html/TerminusViewer\");\n\n\n/**\n * DB home page main function\n * @param {TerminusUI} ui\n */\nfunction TerminusDBViewer(ui){\n\tthis.ui = ui;\n\tthis.tv = new TerminusViewer(ui.client);\n\tthis.container = document.createElement(\"span\");\n\tthis.container.setAttribute(\"class\", \"terminus-main-page\");\n\tthis.pages = [\"home\"];\n}\n\n//Document configuration for DB meta-data listing on DB home page\nTerminusDBViewer.prototype.getDatabaseDocumentConfig = function(){\n\tvar property_style = \"display: block; padding: 0.3em 1em;\"\n\tvar box_style = \"padding: 8px; border: 1px solid #afafaf; background-color: #efefef;\"\n\tvar label_style = \"display: inline-block; min-width: 100px; font-weight: 600; color: #446ba0;\";\n\tvar value_style = \"font-weight: 400; color: #002856;\";\n\tvar config = TerminusClient.View.document();\n\tconfig.show_all(\"SimpleFrameViewer\");\n\tconfig.object().style(box_style);\n\tconfig.object().headerFeatures(\"id\").style(property_style).args({headerStyle: label_style + \" padding-right: 10px;\", bodyStyle: value_style, label: \"Database ID\", removePrefixes: true});\n\tconfig.object().headerFeatures(\"type\").style(property_style).args({headerStyle: label_style + \" padding-right: 10px;\", bodyStyle: value_style})\n\tconfig.object().features(\"value\").style(property_style);\n\tconfig.property().features(\"label\").style(label_style);\n\tconfig.property().features(\"label\", \"value\");\n\tconfig.property().property(\"terminus:id\").hidden(true);\n\tconfig.data().features(\"value\").style(value_style);\n\treturn config;\n}\n\n\n/**\n * Query Pane Configurations\n */\n\n//documents home page table\nTerminusDBViewer.prototype.getDocumentsQueryPane = function(docs, docClasses){\n\tvar table = TerminusClient.View.table();\n\t//table.pager(true);\n\ttable.column('ID').header('Document ID');\n\ttable.column('Label').header('Name');\n\ttable.column('Comment').header('Description');\n\ttable.column_order(\"ID\", \"Label\", \"Type\", \"Comment\");\n\tvar self = this;\n\tvar x = function(row){\n\t\tself.showDocumentPage(row[\"v:ID\"], docClasses, false, docs);\n\t}\n\ttable.row().click(x);\n\tvar qp = this.tv.getResult(docs.query, table, docs);\n\treturn qp;\n}\n\n\n//Create document page pane configuration\t\t\nTerminusDBViewer.prototype.getCreateDataPaneConfig = function(){\n\tconst pc = {\n\t\tshowQuery: false, \n\t\teditQuery: false\n\t};\n\treturn pc;\n}\n\n//Document configuration for create document page\nTerminusDBViewer.prototype.getCreateDocumentConfig = function(){\n\tvar property_style = \"display: block; padding: 0.3em 1em;\"\n\tvar box_style = \"padding: 8px; border: 1px solid #afafaf; background-color: #efefef;\"\n\tvar label_style = \"display: inline-block; min-width: 100px; font-weight: 600; color: #446ba0;\";\n\tvar value_style = \"font-weight: 400; color: #002856;\";\n\t\n\tvar config = TerminusClient.View.document().load_schema(true);\n\tconfig.all().mode(\"edit\");\n\tconfig.show_all(\"SimpleFrameViewer\");\n\tconfig.object().style(box_style);\n\tconfig.object().depth(0).headerFeatures(\"id\").style(property_style).args({headerStyle: label_style + \" padding-right: 10px;\", bodyStyle: value_style, label: \"Document ID\", removePrefixes: true});\n\tconfig.object().headerFeatures(\"type\").style(property_style).args({headerStyle: label_style + \" padding-right: 10px;\", bodyStyle: value_style})\n\tconfig.object().features(\"value\").style(property_style);\n\tconfig.property().features(\"label\").style(label_style);\n\tconfig.property().features(\"label\", \"value\");\n\tconfig.property().property(\"terminus:id\").hidden(true);\n\tconfig.data().features(\"value\").style(value_style);\n\treturn config;\n}\n\n//Document configuration for view / edit document page\nTerminusDBViewer.prototype.getShowDocumentConfig = function(){\n\tvar property_style = \"display: block; padding: 1.5em 1em 0.8em 1em; position: relative;\"\n\tvar config = TerminusClient.View.document().load_schema(true);\n\tconfig.show_all(\"SimpleFrameViewer\");\n\tconfig.object().depth(0).style(\"border: 1px solid #aaa; background-color: #fafafd\").headerStyle(\"background-color: #002856; color: white; padding: 8px; display: block; \");\n\tconfig.object().headerFeatures(\"id\", \"type\").args({headerStyle: \"text-align: right; display: inline-block; width: 200px; padding-right: 10px; text-weight: 600px; color: white\"});\n\t//config.object().headerFeatures(\"mode\").style(\"float: right\");\n\tconfig.object().features(\"value\").style(property_style);\n\tconfig.property().features(\"label\", \"value\");\n\tconfig.property().features(\"label\").style(\"text-align: right; display: inline-block; width: 200px; padding-right: 10px; font-weight: 600; color: #002856\");\n\tconfig.property().features(\"value\").style(\"display: inline-block; vertical-align: top\");\n\tconfig.data().features(\"value\").style(\"color: #002856; display: block; margin-bottom: 1em;\");\n\treturn config;\n};\n\nTerminusDBViewer.prototype.getDocumentsGraphConfig = function(res){\n\tvar graph = TerminusClient.View.graph();\n\tgraph.literals(false);\n\tgraph.height(800).width(1250);\n\tgraph.edges([\"v:doc1\", \"v:doc2\"], [\"v:doc1\", \"v:Enttype\"], [\"v:doc2\", \"v:Enttype2\"]);\n\tgraph.node(\"v:Label\", \"v:Label2\", \"v:Predicate\").hidden(true);\n\tgraph.edge(\"v:doc1\", \"v:doc2\").distance(100).text(\"v:Predicate\");\n\tgraph.edge(\"v:doc1\", \"v:Enttype\").distance(100).text(\"Class\");\n\tgraph.edge(\"v:doc2\", \"v:Enttype2\").distance(100).text(\"Class\");\n    graph.node(\"v:Enttype\").text(\"v:Enttype\").color([200, 250, 200]).icon({label: true, color: [15, 50, 10]}).collisionRadius(80);\n    graph.node(\"v:Enttype2\").text(\"v:Enttype2\").color([200, 250, 200]).icon({label: true, color: [15, 50, 10]}).collisionRadius(80);\n\tgraph.node(\"v:doc1\").size(24).text(\"v:Label1\").icon({label: true, color: [15, 50, 10]}).collisionRadius(80)\n\tgraph.node(\"v:doc2\").size(24).text(\"v:Label2\").icon({label: true, color: [15, 50, 10]}).collisionRadius(80)\n\treturn graph;\n}\n\nTerminusDBViewer.prototype.showDocumentGraph = function(insertDOM){\n\tvar dburl = this.ui.client.connectionConfig.dbURL();\n\tvar q = TerminusClient.WOQL.limit(200).getAllDocumentConnections();\n\tvar qp = this.tv.getResult(q, this.getDocumentsGraphConfig());\n\tvar dloader = this.getLoaderDOM(\"Terminus Server is generating the document graph\");\n\tinsertDOM.appendChild(dloader)\n\tinsertDOM.appendChild(qp.getAsDOM());\n\tthis.graph_query_pane = qp;\n\tqp.load().finally(() => insertDOM.removeChild(dloader));\n}\n\nTerminusDBViewer.prototype.showDocumentConnections = function(docid, targetDOM, docClasses, docs){\n\tvar q = TerminusClient.WOQL.limit(50).getDocumentConnections(docid);\n\tvar viewer = TerminusClient.View.table().column_order(\"Outgoing\", \"Incoming\", \"Entid\", \"Label\", \"Enttype\", \"Class_Label\" );\n\tviewer.column(\"Entid\").hidden(true);\n\tviewer.column(\"Enttype\").hidden(true);\n\tviewer.column(\"Label\").header(\"Document Name\");\n\tviewer.column(\"Class_Label\").header(\"Type\");\n\tviewer.column(\"Incoming\").header(\"Incoming Link\");\n\tviewer.column(\"Outgoing\").header(\"Outgoing Link\");\n\tvar self = this;\n\tvar x = function(row){\n\t\tself.showDocumentPage(row[\"v:Entid\"], docClasses, false, docs);\n\t}\n\tviewer.row().click(x);\n\tvar graph = TerminusClient.View.graph();\n\tgraph.literals(false);\n\tgraph.height(800).width(1250);\n\tgraph.edges([\"v:Docid\", \"v:Entid\"], [\"v:Entid\", \"v:Docid\"]);\n\tgraph.node(\"Outgoing\", \"Incoming\", \"Label\", \"Enttype\", \"Class_Label\").hidden(true);\n\t\n\t//graph.edge(\"v:Entid\", \"v:Docid\").distance(200).text(\"v:Incoming\");\n\tgraph.edge(\"v:Entid\", \"v:Docid\").v(\"v:Incoming\").in(\"unknown\").hidden(true);\n\tgraph.edge(\"v:Entid\", \"v:Docid\").distance(200).text(\"v:Incoming\").color([255, 0, 0]);\n\n\tgraph.edge(\"v:Docid\", \"v:Entid\").v(\"v:Outgoing\").in(\"unknown\").hidden(true);\n\tgraph.edge(\"v:Docid\", \"v:Entid\").distance(200).text(\"v:Outgoing\").color([0, 0, 255]);\n\t\n\tgraph.node(\"v:Docid\").text(\"v:Docid\").icon({label: true});\n\tgraph.node(\"v:Entid\").text(\"v:Label\");\n\tvar introdom = document.createElement(\"h3\");\n\tintrodom.style = \"margin-top: 1.5em; margin-bottom: -32px; color: #224488;\"\n\tintrodom.appendChild(document.createTextNode(\"Links from other documents\"));\n\tvar rpc = { intro: introdom, viewers: [graph] }\n    var qp = this.tv.getQueryPane(q, [viewer], false, [rpc]);\n    var dloader = this.getLoaderDOM(\"Fetching document relationship table\");\n\ttargetDOM.appendChild(dloader)\n\ttargetDOM.appendChild(qp.getAsDOM());\n\tqp.load().finally(() => targetDOM.removeChild(dloader));\n}\n\n\nTerminusDBViewer.prototype.createFullDocumentPane = function(docid, result_options, target, docClasses, docs){\n\tvar self = this;\n\tvar func = function(v){\n\t\tself.showDocumentPage(v, docClasses, false, docs);\n\t};\n\tvar dpoptions = {\"HTMLEntityViewer\": { \"onclick\": func}};\n\tvar dp = this.tv.getDocumentPane(docid, result_options, dpoptions);\t\n\treturn dp;\n}\n\n/**\n * HTML Page drawing functions\n */\n\n/**\n * Called first - runs set-up queries to seed UI elements\n * before drawing the page body \n */\nTerminusDBViewer.prototype.getAsDOM = function(){\n\tHTMLHelper.removeChildren(this.container);\n\tvar limit = 20;\n\tvar WOQL = TerminusClient.WOQL;\n\tvar q = WOQL.limit(limit).documentMetadata();\n\tq.execute(this.ui.client).then( (result) => {\n\t\tvar docs = new TerminusClient.WOQLResult(result, q);\n\t\tvar q2 = WOQL.query().concreteDocumentClasses();\n\t\tq2.execute(this.ui.client).then( (result2) => {\n\t\t\tvar docClasses = new TerminusClient.WOQLResult(result2, q2);\n\t\t\tvar bdom = this.getBodyAsDOM(docs, docClasses);\n\t\t\tif(bdom) this.container.appendChild(bdom);\n\t\t});\n\t}).catch((e) => {\n\t\tthis.ui.showError(e);\n\t});\n\treturn this.container;\n}\n\n/**\n * Two main pages - DB home page and documents section\n */\nTerminusDBViewer.prototype.getBodyAsDOM = function(docs, docClasses){\n\tif(this.body){\n\t\tHTMLHelper.removeChildren(this.body);\n\t}\n\telse {\n\t\tthis.body = document.createElement(\"div\");\n\t\tthis.body.setAttribute(\"class\", \"terminus-home-body terminus-document-view\");\n\t}\n\tif(this.ui.page == \"docs\"){\n\t\t(this.docid ? \n\t\t\tthis.showDocumentPage(this.docid, docClasses, this.body, docs) :\t\t\n\t\t\tthis.getDocumentsDOM(docs, docClasses, this.body));\n\t}\n\telse {\n\t\t this.getHomeDOM(docs, docClasses, this.body);\n\t}\n\treturn this.body\n}\n\n/**\n * DB home page \n */\nTerminusDBViewer.prototype.getHomeDOM = function(docs, docClasses, body){\n\tvar intro = this.showHappyBox(\"dbhome\", \"demo\");\n\tbody.appendChild(intro);\n\tvar config = this.getDatabaseDocumentConfig();\n\tvar cont = document.createElement(\"span\");\n\tintro.appendChild(cont);\n\tvar mydb = this.ui.db();\n\tthis.ui.connectToDB(\"terminus\");\n\tthis.insertDocument(\"doc:\" + mydb, cont, config);\n\tthis.ui.connectToDB(mydb); \n\tif(docs.count() > 0){\n\t\tbody.appendChild(this.showHappyBox(\"dbhome\", \"intro\"));\n\t\tbody.appendChild(this.showHappyBox(\"happy\", \"query\"));\n\t}\n\telse if(docClasses.count() > 0) {\n\t\tvar dchooser = this.getCreateDataChooser(docClasses, docs);\n\t\tif(docClasses.count() <= 3){\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"schema\"));\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"query\"));\n\t\t}\n\t\telse  {\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"docs\", dchooser));\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"query\"));\n\t\t}\n\t}\n\telse {\n\t\tbody.appendChild(this.showHappyBox(\"empty\", \"schema\"));\n\t\tbody.appendChild(this.showHappyBox(\"empty\", \"query\"));\t\n\t}\n\tvar delw = this.getDeleteDatabaseWidget(\"fa-2x\");\n\tif(delw) body.appendChild(this.showHappyBox(\"happy\", \"delete\", delw));\n\treturn body;\n}\n\n/**\n * Main Document Listing Page\n */\nTerminusDBViewer.prototype.getDocumentsDOM = function(docs, docClasses, body){\n\tvar mactions = this.getDocumentsMenu(docs, docClasses, body);\n\tif(mactions) body.appendChild(mactions);\n\tthis.tableDOM = document.createElement(\"span\");\n\tbody.appendChild(this.tableDOM);\n\tthis.graphDOM = document.createElement(\"span\");\n\tthis.graphDOM.setAttribute(\"class\", \"terminus-documents-graph\");\n\tthis.graphDOM.style.display = \"none\";\n\tbody.appendChild(this.graphDOM);\n\tif(docs.count() > 0){\n\t\tif(!this.document_table) this.document_table = this.getDocumentsQueryPane(docs, docClasses);\n\t\tthis.tableDOM.appendChild(this.document_table.getAsDOM());\n\t\tthis.showDocumentGraph(this.graphDOM);\n\t}\n\telse {\n\t\tvar dchooser = this.getCreateDataChooser(docClasses, docs);\n\t\tif(docClasses.count() <= 3){\n\t\t\tthis.ui.showWarning(\"The database must have a schema before you can add documents to it\")\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"schema\"));\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"query\"));\n\t\t}\n\t\telse {\n\t\t\tthis.ui.showWarning(\"No documents have been added to the database\");\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"docs\", dchooser));\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"query\"));\n\t\t}\n\t}\n\treturn body;\n}\n\n/**\n * Document View / Edit Page\n */\nTerminusDBViewer.prototype.showDocumentPage = function(docid, docClasses, target, docs){\n\tthis.ui.clearMessages();\n\tHTMLHelper.removeChildren(target);\n\tthis.ui.page = \"docs\";\n\tthis.ui.redrawControls();\n\tvar start = docid.substring(0, 4);\n\tif(start != \"doc:\" && start != \"http\") docid = \"doc:\" + docid;\t\n\tvar config = this.getShowDocumentConfig();\n\tvar dp = this.createFullDocumentPane(docid, config, target, docClasses, docs);\n\tthis.docid = docid; \n\tthis.pages.push(docid);\n\tvar dcDOM = document.createElement(\"span\");\n\tvar vc = this.showDocumentConnections(docid, dcDOM, docClasses, docs);\n\treturn dp.load().then(() => {\n\t\tHTMLHelper.removeChildren(this.container);\n\t\tvar nav = this.getNavigationDOM(docClasses, docs);\n\t\tthis.container.appendChild(nav);\n\t\tvar mactions = this.getDocumentsMenu(docs, docClasses, this.container, docid);\n\t\tif(mactions) this.container.appendChild(mactions);\n\t\tvar dx = dp.getAsDOM();\n\t\tthis.container.appendChild(dx);\n\t\tthis.container.appendChild(dcDOM);\n\t})\n\t.catch((e) => {\n\t\tthis.ui.showError(e)\n\t});\t\n}\n\n\n/**\n * Main Create New Document Page\n */\nTerminusDBViewer.prototype.loadCreateDocumentPage = function(cls, docClasses, docs){\n\tthis.ui.page = \"docs\";\n\tthis.ui.redrawControls();\n\tvar WOQL = TerminusClient.WOQL;\n\tvar dburl = this.ui.client.connectionConfig.dbURL();\n\tvar config = this.getCreateDocumentConfig();\n\n\tvar dp = this.tv.getNewDocumentPane(cls, config);\n\tdp.documentLoader = this.getShowDocumentControl(docClasses, docs);\n\t/*var df = new DocumentPane(this.ui.client).options({\n\t\tshowQuery: true,\n\t\teditQuery: true,\n\t\tshowConfig: false,\n\t\teditConfig: false,\n\t\tloadDocument: this.getShowDocumentControl(docClasses, docs)\n\t});*/\n\tif(docClasses && docClasses.count() > 0){\n\t\tvar dchooser = this.getCreateDataChooser(docClasses, docs );\n\t\tdp.setClassLoader(dchooser);\n\t}\n\telse {\n\t\tvar q2 = WOQL.query().concreteDocumentClasses();\n\t\tq2.execute(this.ui.client).then( (result2) => {\n\t\t\tdocClasses = (docClasses ? docClasses : new TerminusClient.WOQLResult(result2, q2));\n\t\t\tvar dchooser = this.getCreateDataChooser(docClasses, docs );\n\t\t\tdp.setClassLoader(dchooser);\n\t\t});\n\t}\n\tthis.container.appendChild(dp.getAsDOM());\n\tdp.load().then(() => {\n\t\tHTMLHelper.removeChildren(this.container);\n\t\tvar nav = this.getNavigationDOM(docClasses, docs);\n\t\tthis.container.appendChild(nav);\n\t\tthis.container.appendChild(dp.getAsDOM());\n\t});\n}\n\n/**\n * Toolbox Menu on top of the page on the documents home page\n */\nTerminusDBViewer.prototype.getDocumentsMenu = function(docs, docClasses, target, docid){\n\tvar self = this;\n\tvar page_actions = document.createElement(\"div\");\n\tpage_actions.setAttribute(\"class\", \"terminus-home-actions\");\n\tvar span = document.createElement('span');\n\tpage_actions.appendChild(span);\n\tif(docs.count() > 0){\n\t\tvar show_doc_action = this.getShowDocumentControl(docClasses, docs, target);\n\t\tspan.appendChild(show_doc_action);\n\t\tif(!docid){\n\t\t\tvar tgtd = this.getToggleGraphTableDOM();\n\t\t\tif(tgtd) page_actions.appendChild(tgtd);\n\t\t}\n\t}\t\n\treturn page_actions;//turned off create document stuff\n\tif(docClasses.count() > 0){\n\t\tvar ch = function(cls){\n\t\t\tif(cls)\tself.loadCreateDocumentPage(cls, docClasses, docs);\n\t\t}\n\t\tvar dchooser = this.getCreateDataChooser(docClasses, docs, ch);\n\t\tif(docs.count() > 1) span.appendChild(dchooser);\n\t}\n\telse {\n\t\tthis.ui.showError(\"No document classes found in schema - you must define a document, entity or relationship class before you can create documents\");\n\t}\n\treturn page_actions;\n}\n\n\nTerminusDBViewer.prototype.getLoaderDOM = function(msg){\n\tvar cont = document.createElement('div');\n\tcont.setAttribute('class', 'terminus-busy-msg')\n\tcont.appendChild(document.createTextNode(msg));           \n\tthis.ui.getBusyLoader(cont, msg);\n\treturn cont;\n}\n\n\n/**\n * Switches between graph and table display modes on documents home page\n */\nTerminusDBViewer.prototype.redrawDocumentPage = function(){\n\tif(this.docview == \"graph\"){\n\t\tthis.tableDOM.style.display = \"none\";\n\t\tthis.graphDOM.style.display = \"inline\";\n\t}\n\telse {\n\t\tthis.tableDOM.style.display = \"inline\";\n\t\tthis.graphDOM.style.display = \"none\";\n\t}\n}\t\n\nTerminusDBViewer.prototype.getToggleGraphTableDOM = function(){\n\t// delete database\n\tvar isp = document.createElement('span');\n\tisp.setAttribute(\"class\", \"terminus-toggle-documents\");\n\tvar tisp = document.createElement('span');\n\tvar gisp = document.createElement('span');\n\tisp.appendChild(tisp);\n\tisp.appendChild(gisp);\n\tvar ticon = document.createElement(\"i\");\n\tticon.setAttribute(\"class\", \"fa fa-table\");\n\tticon.classList.add('terminus-result-view-icon');\n\tvar gicon = document.createElement(\"i\");\n\ttisp.appendChild(ticon);\n\tgisp.appendChild(gicon);\n\tgisp.setAttribute(\"title\", \"Click to view a graph of the links between the documents in the database\");\n\ttisp.setAttribute(\"title\", \"Switch back to a regular table of documents\");\n\tgicon.setAttribute(\"class\", \"fas fa-code-branch\");\n\tgicon.classList.add('terminus-result-view-icon');\n\tif(this.docview && this.docview == \"graph\"){\n\t\tgisp.style.display = \"none\";\n\t}\n\telse {\n\t\ttisp.style.display = \"none\";\n\t}\n\n\tvar hov = function(ticon){\n\t\ttisp.addEventListener('mouseover', function(){\n\t\t\tthis.style.cursor = \"pointer\";\n\t\t});\n\t}\n\thov(gisp);\n\thov(tisp);\n\n\tgisp.addEventListener(\"click\", () => {\n\t\tif(this.docview && this.docview == \"graph\") return;\n\t\tif(!this.graph_query_pane){\n\t\t\tthis.showDocumentGraph(this.graphDOM);\n\t\t}\n\t\tthis.docview = \"graph\";\n\t\tgisp.style.display = \"none\";\n\t\tthis.graphDOM.style.display = \"inline\";\n\t\ttisp.style.display = \"inline\";\n\t\tthis.tableDOM.style.display = \"none\";\n\n\t});\n\tticon.addEventListener(\"click\", () => {\n\t\tif(!this.docview || this.docview == \"table\") return;\n\t\tthis.docview = \"table\";\n\t\ttisp.style.display = \"none\";\n\t\tgisp.style.display = \"inline\";\n\t\tthis.graphDOM.style.display = \"none\";\n\t\tthis.tableDOM.style.display = \"inline\";\n\t});\n\tisp.appendChild(tisp);\n\tisp.appendChild(gisp);\n\treturn isp;\t\n}\n\nTerminusDBViewer.prototype.getDeleteDatabaseWidget = function(css){\n\t// delete database\n\tif(this.ui.db() == \"terminus\") return;\n\tvar d = document.createElement(\"span\");\n\td.setAttribute(\"class\", \"terminus-db-widget\");\n\tHTMLHelper.removeChildren(this.container);\n    var del = document.createElement('button');\n    del.setAttribute('class', 'terminus-btn terminus-btn-float-right terminus-home-del');\n    del.setAttribute('type', 'button');\n\tdel.appendChild(document.createTextNode('Delete Database'));\n\tvar di = document.createElement(\"i\");\n\tvar icss = \"fa fa-trash fa-2x terminus-icon-padding\" + (css ? \" \" + css : \"\");\n\tdi.setAttribute(\"class\", icss);\n\tdel.appendChild(di);\n\tvar dbrec = this.ui.getDBRecord();\n\tif(dbrec)\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\n\telse var nm = this.ui.db();\n    var self = this;\n\tvar dbdel = this.ui.db();\n\tvar delbut = this.ui.getDeleteDBButton(dbdel);\n\tif(delbut){\n\t\td.appendChild(delbut);\n\t}\n\treturn d;\n}\n\nTerminusDBViewer.prototype.styleCreateDocumentChooser = function(){\n\tvar select = document.getElementsByClassName('woql-chooser');\n\tfor(i=0; i<select.length; i++){\n\t\tif(select[i].type == 'select'){\n\t\t\tselect[i].classList.add('terminus-form-doc-value');\n\t\t\tvar self = this;\n\t\t\tselect[i].addEventListener('change', function(){\n\t\t\t\tself.showCreateDocument(this.value);\n\t\t\t})\n\t\t}\n\t}\n}\n\nTerminusDBViewer.prototype.getCreateDataChooser = function(docClasses, docs, change, pholder){\n\tpholder = (pholder ? pholder : \"Create a New Document\");\n\t//qopts  = (qopts ? qopts :  {});\n\t//var dp = new QueryPane(this.ui.client, docClasses.query, docClasses).options(qopts);\n\tvar chooser = TerminusClient.View.chooser().values(\"Class\").labels(\"Label\").titles(\"Comment\").show_empty(pholder);\n\t\n\tvar self = this;\n\tchooser.change = (change ? change : function(cls){\n\t\tif(cls)\tself.loadCreateDocumentPage(cls, docClasses, docs);\n\t});\n\tvar dp = this.tv.getResult(docClasses.query, chooser, docClasses);\n\tvar dchooser = dp.getAsDOM();\n\treturn dchooser;\n}\n\nTerminusDBViewer.prototype.showHappyBox = function(happy, type, chooser){\n\tvar hbox = document.createElement(\"div\");\n\thbox.setAttribute(\"class\", \"terminus-welcome-box terminus-no-res-alert\");\n\tvar self = this;\n\tvar sets = {};\n\tif(type == \"schema\"){\n\t\tsets.title = (happy == \"happy\") ? \"Document Classes Created\" : \"Create Schema from OWL\";\n\t\tsets.text = (happy == \"happy\") ? \"You have successfully created a schema with valid document classes!\" : \"You can create a schema for your database from an OWL document\";\n\t\tsets.css = \"fa fa-cog fa-2x terminus-welcome-icons\";\n\t}\n\telse if(type == \"docs\"){\n\t\tsets.css = \"fa fa-book fa-2x terminus-welcome-icons\";\n\t\tsets.title = \"Create Documents\";\n\t\tsets.text = (happy == \"happy\") ? \"Add data to the system through easy to use automatically generated forms for each document type\" : \"You should create a schema and add at least one document classes before you add data to the system\";\n\t}\n\telse if(type == \"intro\"){\n\t\tsets.css = \"fa fa-book fa-2x terminus-welcome-icons\";\n\t\tsets.title = \"View Documents\";\n\t\tsets.text = \"View the documents in the database and add new ones\";\n\t}\n\telse if(type == \"query\"){\n\t\tsets.css = \"fa fa-search fa-2x terminus-welcome-icons\";\n\t\tsets.title = (happy == \"happy\") ? \"Run Queries\" : \"Create Schema with Queries\";\n\t\tsets.text = (happy == \"happy\") ? \"You can add data to the system with queries and scripts, and import data directly from CSVs and URLs\" : \"You can write WOQL queries to create a schema through our query interface\";\n\t}\n\telse if(type == \"demo\"){\n\t\tsets.css = \"fa fa-database fa-2x terminus-welcome-icons\";\n\t\tvar dbrec = this.ui.getDBRecord();\n\t\tif(dbrec)\n\t\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\n\t\telse var nm = this.ui.db();\n\t\tsets.title = nm ;\n\t\tsets.text = \"\";\n\t}\n\telse if(type == \"delete\"){\n\t\tsets.css = \"fa fa-trash fa-2x terminus-welcome-icons terminus-db-list-del-icon\";\n\t\tsets.title = \"Delete Database\";\n\t\tsets.text = \"This will delete all data and permanently remove all record of this database from the system\";\n\t}\n\tvar ispan =  document.createElement(\"span\");\n\tispan.setAttribute(\"class\", \"terminus-db-widget\");\n\tvar ic = document.createElement(\"i\");\n\tic.setAttribute(\"class\", sets.css);\n\tispan.appendChild(ic);\n\thbox.appendChild(ispan);\n\tvar htit = document.createElement(\"span\");\n\thtit.appendChild(document.createElement(\"strong\").appendChild(document.createTextNode(sets.title)));\n\thtit.classList.add('terminus-welcome-title');\n\thbox.appendChild(htit);\n\tvar body = document.createElement(\"p\");\n\tbody.setAttribute('class', 'terminus-welcome-body');\n\tbody.appendChild(document.createTextNode(sets.text));\n\thbox.appendChild(body);\n\tif(type == \"schema\"){\n\t\thbox.addEventListener(\"click\", function(){\n\t\t\tself.ui.page = \"schema\";\n\t\t\tself.ui.showSchemaPage();\n\t\t\tself.ui.clearMessages();\n\t\t\tself.ui.redrawControls();\n\t\t});\n\t};\n\tif(type == \"delete\"){\n\t\tispan.addEventListener(\"click\", function(){\n\t\t\tself.ui.clearMessages();\n\t\t\tlet db = self.ui.db();\n\t\t\tlet deleteConfirm = confirm(`This action is irreversible, it will remove the database from the system permanently. Are you sure you want to delete ${db} Database?`);\n\t\t\tif (deleteConfirm == true) {\n\t\t\t\tself.ui.deleteDatabase();\n\t\t\t\tself.ui.client.connectionConfig.dbid = false;\n\t\t\t\tself.ui.redrawControls();\n\t\t\t}\n\t\t});\n\t}\n\tif(type == \"intro\" || (type == \"docs\" && false && !chooser)){\n\t\thbox.addEventListener(\"click\", function(){\n\t\t\tself.ui.page = \"docs\";\n\t\t\tself.ui.showDocumentPage();\n\t\t\tself.ui.clearMessages();\n\t\t\tself.ui.redrawControls();\n\t\t});\n\t};\n\tif(type == \"query\"){\n\t\thbox.addEventListener(\"click\", function(){\n\t\t\tself.ui.page = \"query\";\n\t\t\tself.ui.showQueryPage();\n\t\t\tself.ui.clearMessages();\n\t\t\tself.ui.redrawControls();\n\t\t});\n\t};\n\tif(type == \"query\" || type == \"schema\" || type == \"intro\"){\n\t\thbox.addEventListener('mouseover', function(){\n\t\t\tthis.style.cursor = \"pointer\";\n\t\t});\n\t}\n\tif(type == \"docs\" && false && chooser){\n\t\tvar sp = document.createElement('span');\n\t\tsp.setAttribute('class', 'terminus-welcome-chooser');\n\t\tsp.appendChild(chooser);\n\t\thbox.appendChild(sp);\n\t}\n\treturn hbox;\n}\n\nTerminusDBViewer.prototype.getNavigationDOM = function(docClasses, docs){\n\tvar s = document.createElement(\"span\");\n\ts.setAttribute('class', 'terminus-back-to-home terminus-backtohome-span');\n\tvar i = document.createElement(\"span\");\n\ti.setAttribute(\"class\", \"fa fas fa-arrow-left\");\n\ts.appendChild(i);\n\tvar p =  this.pages[this.pages.length-2];\n\tif(p){\n\t\tvar msg = (p == \"home\" ? \"document list\" : p)\n\t\ts.appendChild(document.createTextNode(\" back to \" + msg));\n\t}\n\telse {\n\t\tthis.pages.push(\"home\");\n\t\ts.appendChild(document.createTextNode(\" back to document list \"));\n\t}\n\ts.addEventListener(\"click\", () => {\n\t\tvar pp = this.pages.pop();\n\t\tp =  this.pages[this.pages.length-1];\n\t\tif(p == \"home\"){\n\t\t\tdelete(this[\"docid\"]);\n\t\t\tthis.getAsDOM();\n\t\t}\n\t\telse {\n\t\t\tpp = this.pages.pop();\n\t\t\tthis.docid = pp;\n\t\t\tthis.showDocumentPage(pp, docClasses, false, docs);\n\t\t}\n\t});\n\ts.addEventListener('mouseover', function(){\n\t\tthis.style.cursor = \"pointer\";\n\t});\n\treturn s;\n}\n\nTerminusDBViewer.prototype.insertDocument = function(docid, insertDOM, config, nuke){\n\tvar dp = this.tv.getDocument(docid, config);\n\tdp.load().then(() => {\n\t\tif(nuke) HTMLHelper.removeChildren(insertDOM);\n\t\tinsertDOM.appendChild(dp.getAsDOM());\n\t})\n\t.catch((e) => this.ui.showError(e));\t\n}\n\nTerminusDBViewer.prototype.getShowDocumentControl = function(docClasses, docs, target){\n\tvar scd = document.createElement(\"span\");\n\tscd.setAttribute(\"class\", \"terminus-get-doc terminus-document-chooser terminus-form-horizontal terminus-control-group\");\n\tvar lab = document.createElement(\"span\");\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-doc-control-label terminus-control-label-padding\");\n\tvar dcip = document.createElement(\"input\");\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID to view ...\");\n\tvar nbut = document.createElement(\"button\");\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-btn\");\n\tnbut.setAttribute('title', 'Enter Document ID to view');\n\tvar is = document.createElement('i');\n\tis.setAttribute('class', 'fa fa-caret-left');\n\tnbut.appendChild(is);\n\tnbut.appendChild(document.createTextNode(\" Load \"));\n\tvar i = document.createElement('i');\n\ti.setAttribute('class', 'fa fa-caret-right');\n\tnbut.appendChild(i);\n\tvar self = this;\n\tnbut.addEventListener(\"click\", function(){\n\t\tif(dcip.value) {\n\t\t\tself.showDocumentPage(dcip.value, docClasses, target, docs);\n\t\t}\n\t})\n\tdcip.addEventListener(\"keyup\", function(event) {\n\t\tevent.preventDefault();\n\t\tif (event.keyCode === 13 && dcip.value) {\n\t\t\tself.showDocumentPage(dcip.value, docClasses, target, docs);\n\t\t}\n\t});\n\tscd.appendChild(lab);\n\tscd.appendChild(dcip);\n\tscd.appendChild(nbut);\n\treturn scd;\n}\n\n/**\n * Class Representing the create Database form\n * @param {TerminusUI} ui\n */\nfunction TerminusDBCreator(ui){\n\tthis.ui = ui;\n}\n\nTerminusDBCreator.prototype.getAsDOM = function(selected){\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\n\tvar sct = document.createElement(\"h3\");\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\n\tsct.appendChild(UTILS.getHeaderDom(\"Create Database\"));\n\tscd.appendChild(sct);\n\tvar mfd = document.createElement('div');\n\tmfd.setAttribute('class', 'terminus-form-border ');\n\tscd.appendChild(mfd);\n\tvar dht = document.createElement('div');\n\tdht.setAttribute('class', 'terminus-form-margin-top');\n\tmfd.appendChild(dht);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\n\tvar slab = document.createElement(\"span\");\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\n\tslab.appendChild(document.createTextNode(\"ID\"));\n\tsci.appendChild(slab);\n\tvar idip = document.createElement(\"input\");\n\tidip.setAttribute(\"type\", \"text\");\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\n\tsci.appendChild(idip);\n\tmfd.appendChild(sci);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\n\tvar slab = document.createElement(\"span\");\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\n\tslab.appendChild(document.createTextNode(\"Title\"));\n\tvar titip = document.createElement(\"input\");\n\ttitip.setAttribute(\"type\", \"text\");\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\n\tsci.appendChild(slab);\n\tsci.appendChild(titip);\n\tmfd.appendChild(sci);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\n\tvar slab = document.createElement(\"span\");\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\n\tslab.appendChild(document.createTextNode(\"Description\"));\n\tsci.appendChild(slab);\n\tvar descip = document.createElement(\"textarea\");\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\n\tsci.appendChild(descip);\n\tmfd.appendChild(sci);\n\tvar butfield = document.createElement(\"div\");\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\n\tvar cancbut = document.createElement(\"button\");\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn terminus-btn-float-right\");\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\n\tvar loadbut = document.createElement(\"button\");\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn terminus-btn-float-right\");\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\n\tvar self = this;\n\tvar gatherips = function(){\n\t\tvar input = {};\n\t\tinput.id = idip.value;\n\t\tinput.title = titip.value;\n\t\tinput.description = descip.value;\n\t\t//input.schema = schem.value;\n\t\t//input.key = kip.value;\n\t\t//input.data = datip.value;\n\t\treturn input;\n\t}\n\tvar self = this;\n\tloadbut.addEventListener(\"click\", function(){\n\t\tvar input = gatherips();\n\t\tself.ui.createDatabase(input);\n\t})\n\tcancbut.addEventListener(\"click\", function(){\n\t\tself.ui.showServerMainPage();\n\t})\n\tbutfield.appendChild(cancbut);\n\tbutfield.appendChild(loadbut);\n\tmfd.appendChild(butfield);\n\n\treturn scd;\n}\n\n/*\n * User Interface elements dealing with database level functions - view, delete, create, db\n * view document etc\n */\nfunction TerminusDBController(ui){\n\tthis.ui = ui;\n}\n\n/*\n* Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\n* Populates left hand column on dashboard page\n*/\nTerminusDBController.prototype.getAsDOM = function(){\n   var self = this;\n   var dbc = document.createElement(\"div\");\n   dbc.setAttribute(\"class\", \"terminus-db-controller\");\n   if(this.ui && this.ui.db()){\n\t   var scd = document.createElement(\"div\");\n\t   scd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\n\t   var dbrec = this.ui.client.connection.getDBRecord();\n\t   var nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\n\t   //dbc.appendChild(scd);\n\t   var nav = document.createElement('div');\n\t   nav.setAttribute('class', 'span3');\n\t   dbc.appendChild(nav);\n\t   var ul = document.createElement('ul');\n\t   ul.setAttribute('class','terminus-ul' );\n\t   nav.appendChild(ul);\n\t   // connected to db\n\t   var a = document.createElement('a');\n\t   a.setAttribute('class', 'terminus-dashboard-info terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer\"');\n\t   a.appendChild(document.createTextNode(nm));\n\t   ul.appendChild(a);\n\t   var p = this.ui.page ? this.ui.page : \"db\";\n\t   if(this.ui.showControl(\"db\")){\n\t\t   if(p == \"db\") {\n\t\t\t   a.classList.add(\"terminus-selected\");\n\t\t\t   self.ui.page = \"db\";\n\t\t   }\n\t\t   a.addEventListener(\"click\", function(event){\n\t\t\t   event.stopPropagation();\n\t\t\t   self.ui.showDBMainPage();\n\t\t\t   self.ui.page = \"db\";\n\t\t\t   self.ui.clearMessages();\n\t\t\t   self.ui.redrawControls();\n\t\t   });\n\t   }\n\t   if(this.ui.showControl(\"get_document\")){\n\t\t   var item = this.getControlHTML(\"Documents\", \"fas fa fa-book\");\n\t\t   if(p == \"docs\") item.classList.add(\"terminus-selected\");\n\t\t   item.addEventListener(\"click\", function(event){\n\t\t\t   event.stopPropagation();\n\t\t\t   self.ui.showDocumentPage();\n\t\t\t   self.ui.clearMessages();\n\t\t\t   self.ui.page = \"docs\";\n\t\t\t   self.ui.redrawControls();\n\t\t\t});\n\t\t   ul.appendChild(item);\n\t   }\n\t   if(this.ui.showControl(\"delete_database\")){\n\t\t   var item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\n\t\t   item.addEventListener(\"click\", function(event){\n\t\t\t   UTILS.activateSelectedNav(this, self);\n\t\t\t   self.ui.clearMessages();\n\t\t\t   self.ui.deleteDatabase();\n\t\t   });\n\t\t   ul.appendChild(item);\n\t   }\n\t   if(this.ui.showControl(\"woql_select\")){\n\t\t   var item = this.getControlHTML(\"Query\", \"fa-search\");\n\t\t   if(p == \"query\") item.classList.add(\"terminus-selected\");\n\t\t   item.addEventListener(\"click\", function(event){\n\t\t\t   UTILS.activateSelectedNav(this, self);\n\t\t\t   event.stopPropagation();\n\t\t\t   self.ui.page = \"query\";\n\t\t\t   self.ui.showQueryPage();\n\t\t\t   self.ui.clearMessages();\n\t\t\t   self.ui.redrawControls();\n\t\t   });\n\t\t   ul.appendChild(item);\n\t   }\n\t   if(this.ui.showControl(\"get_schema\")){\n\t\t   var item = this.getControlHTML(\"Schema\", \"fa-cog\");\n\t\t   if(p == \"schema\") item.classList.add(\"terminus-selected\");\n\t\t   item.addEventListener(\"click\", function(){\n\t\t\t   UTILS.activateSelectedNav(this, self);\n\t\t\t   self.ui.page = \"schema\";\n\t\t\t   self.ui.showSchemaPage();\n\t\t\t   self.ui.clearMessages();\n\t\t\t   self.ui.redrawControls();\n\t\t   })\n\t\t   ul.appendChild(item);\n\t   }\n   }\n   return dbc;\n}\n\n\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\n   var self = this;\n   var a = document.createElement('a');\n   a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n   var icon = document.createElement('i');\n   icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\n   a.appendChild(icon);\n   var txt = document.createTextNode(text);\n   a.appendChild(txt);\n   return a;\n}\n\n\n\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\n\t            TerminusDBController:TerminusDBController,\n\t            TerminusDBCreator:TerminusDBCreator}\n","const TerminusClient = require('@terminusdb/terminus-client');\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\nconst ResultPane = require(\"./ResultPane\");\nconst UTILS = require('../Utils');\nconst HTMLHelper = require('./HTMLHelper');\nconst TerminusViolations = require('./TerminusViolation');\n\nfunction QueryPane(client, query, result){\n\tthis.client = client;\n\tthis.query = query;\n\tthis.result = result;\n\tthis.views = [];\n\tthis.container = document.createElement('span');\n\tthis.messages = document.createElement('div');\n\tthis.messages.setAttribute('class', 'terminus-query-messages');\n\tthis.defaultResultView = { showConfig: false, editConfig: false };\n\tthis.defaultQueryView = { showQuery: false, editQuery: false };\n}\n\nQueryPane.prototype.load = function(){\n\treturn this.query.execute(this.client).then( (result) => {\n\t\t\tlet nresult = new TerminusClient.WOQLResult(result, this.query);\n\t\t\tthis.updateResult(nresult);\n\t});\n}\n\n\nQueryPane.prototype.fireDefaultQueries = function(){\n\tlet WOQL = TerminusClient.WOQL;\n\tvar query = WOQL.query().classMetadata();\n\tquery.execute(this.client).then((results) => {\n\t\tlet qcres = new TerminusClient.WOQLResult(results, query);\n\t\tthis.classMetaDataRes = qcres;\n\t})\n\tvar query = WOQL.query().propertyMetadata();\n\tquery.execute(this.client).then((results) => {\n\t\tlet qpres = new TerminusClient.WOQLResult(results, query);\n\t\tthis.propertyMetaDataRes = qpres;\n\t})\n}\n\nQueryPane.prototype.options = function(opts){\n\tthis.showQuery = (opts && typeof opts.showQuery != \"undefined\" ? opts.showQuery : false);\n\tthis.editQuery = (opts && typeof opts.editQuery != \"undefined\" ? opts.editQuery : false);\n\tthis.showHeader = (opts && typeof opts.showHeader != \"undefined\" ? opts.showHeader : false);\n\tthis.addViews = (opts && typeof opts.addViews != \"undefined\" ? opts.addViews : false);\n\tthis.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\n\tthis.saved = (opts && typeof opts.saved != \"undefined\" ? opts.saved: true);\n\tvar css = (opts && typeof opts.css != \"undefined\" ? opts.css : 'terminus-query-pane-cont');\n    this.container.setAttribute('class', css);\n    return this;\n}\n\nQueryPane.prototype.getSection = function(sName){\n\tvar btn = document.createElement('button');\n\tbtn.setAttribute('class', 'terminus-query-section');\n\tbtn.appendChild(document.createTextNode(sName));\n\treturn btn;\n}\n\nQueryPane.prototype.clearSubMenus = function(btn){\n\tvar par = btn.parentElement.parentElement;\n\tvar smenus = par.getElementsByClassName('terminus-queries-submenu');\n\tfor(var i=0; i<smenus.length; i++){\n\t\tHTMLHelper.removeChildren(smenus[i]);\n\t}\n}\n\nQueryPane.prototype.getResults = function(query){\n\tif(query)\n\t\tthis.input.setQuery(query);\n\tHTMLHelper.removeChildren(this.sampleQueryDOM);\n\tthis.sampleQueryDOM.appendChild(document.createTextNode(\" Saved Queries \"))\n\tthis.input.refreshContents();\n}\n\nQueryPane.prototype.AddEvents = function(btn, aval){\n\tvar self = this;\n\tbtn.addEventListener('click', function(){\n\t\tlet WOQL = TerminusClient.WOQL;\n\t\tself.clearSubMenus(this);\n\t\tvar query;\n\t\tswitch(this.value){\n\t\t\tcase 'Show All Schema Elements':\n\t\t\t\tquery = WOQL.query().elementMetadata();\n\t\t\tbreak;\n\t\t\tcase 'Show All Classes':\n\t\t\t\tquery = WOQL.query().classMetadata();\n\t\t\tbreak;\n\t\t\tcase 'Show All Properties':\n\t\t\t\tquery = WOQL.query().propertyMetadata();\n\t\t\tbreak;\n\t\t\tcase 'Show Document Classes':\n\t\t\t\tquery = WOQL.query().concreteDocumentClasses();\n\t\t\tbreak;\n\t\t\tcase 'Show All Data':\n\t\t\t\tquery = WOQL.query().getEverything();\n\t\t\tbreak;\n\t\t\tcase 'Show all documents':\n\t\t\t\tquery = WOQL.query().documentMetadata();\n\t\t\tbreak;\n\t\t\tcase 'Show data of chosen type':\n\t\t\t\tvar choosen = aval || 'scm:' + this.innerText;\n\t\t\t\tquery = WOQL.query().getDataOfClass(choosen);\n\t\t\tbreak;\n\t\t\tcase 'Show data of chosen property':\n\t\t\t\tvar choosen = aval || 'scm:' + this.innerText;\n\t\t\t\tquery = WOQL.query().getDataOfProperty(choosen);\n\t\t\tbreak;\n\t\t\tcase 'Show data of type':\n\t\t\t\treturn;\n\t\t\tbreak;\n\t\t\tcase 'Show data for property':\n\t\t\t\treturn;\n\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.log('Invalid Type of query');\n\t\t\tbreak;\n\t\t}\n\t\tself.getResults(query);\n\t})\n}\n\nQueryPane.prototype.getQueryMenu = function(qName){\n\tvar btn = document.createElement('button');\n\tbtn.setAttribute('class', 'terminus-load-queries');\n\tbtn.setAttribute('value', qName);\n\tbtn.appendChild(document.createTextNode(qName));\n\tthis.AddEvents(btn);\n\treturn btn;\n}\n\nQueryPane.prototype.getSubDataMenu = function(qName, val, aval){\n\tvar btn = document.createElement('button');\n\tbtn.setAttribute('class', 'terminus-load-queries');\n\tbtn.setAttribute('value', qName);\n\tbtn.appendChild(document.createTextNode(val));\n\tthis.AddEvents(btn, aval);\n\treturn btn;\n}\n\n// schema queries\nQueryPane.prototype.getSchemaSection = function(d){\n\tvar section = this.getSection('Schema Queries');\n\td.appendChild(section);\n\tvar btn = this.getQueryMenu('Show All Schema Elements');\n\td.appendChild(btn);\n\tvar btn = this.getQueryMenu('Show All Classes');\n\td.appendChild(btn);\n\tvar btn = this.getQueryMenu('Show Document Classes');\n\td.appendChild(btn);\n\tvar btn = this.getQueryMenu('Show All Properties');\n\td.appendChild(btn);\n}\n\nQueryPane.prototype.checkIfDataMenuOpen = function(btn){\n\tvar isOpen = false;\n\tif(btn.children.length){\n\t\tfor(var i=0; i<btn.children.length; i++){\n\t\t\t//var child = btn.children[i].getElementsByClassName('terminus-queries-submenu');\n\t\t\tvar child = btn.getElementsByClassName('terminus-queries-submenu');\n\t\t\tif(child.length){\n\t\t\t\tfor(var j=0; j<child.length; j++){\n\t\t\t\t\tHTMLHelper.removeElement(child[j]);\n\t\t\t\t\tisOpen = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn isOpen;\n}\n\nQueryPane.prototype.showDataOfTypeEvent = function(btn){\n\tvar self = this;\n\tbtn.addEventListener('click', function(){\n\t\tvar isMenuOpen = self.checkIfDataMenuOpen(this);\n\t\tif(!isMenuOpen){\n\t\t\tvar subPar = document.createElement('div');\n\t\t\tsubPar.setAttribute('class', 'terminus-queries-submenu');\n\t\t\tif(self.classMetaDataRes && self.classMetaDataRes.hasBindings()){\n\t\t\t\tfor(var i = 0; i<self.classMetaDataRes.bindings.length; i++){\n\t\t\t\t\tvar text = self.classMetaDataRes.bindings[i]['v:Label']['@value'];\n\t\t\t\t\tvar val = self.classMetaDataRes.bindings[i]['v:Element'];\n\t\t\t\t\tsubPar.appendChild(self.getSubDataMenu('Show data of chosen type', text, val));\n\t\t\t\t}\n\t\t\t}\n\t\t\tbtn.appendChild(subPar);\n\t\t}\t\t\n\t})\n}\n\nQueryPane.prototype.showPropertyOfTypeEvent = function(btn){\n\tvar self = this;\n\tbtn.addEventListener('click', function(){\n\t\tvar isMenuOpen = self.checkIfDataMenuOpen(this);\n\t\tif(!isMenuOpen){\n\t\t\tvar subPar = document.createElement('div');\n\t\t\tsubPar.setAttribute('class', 'terminus-queries-submenu');\n\t\t\tif(self.propertyMetaDataRes && self.propertyMetaDataRes.hasBindings()){\n\t\t\t\tfor(var i = 0; i<self.propertyMetaDataRes.bindings.length; i++){\n\t\t\t\t\tvar text = self.propertyMetaDataRes.bindings[i]['v:Label']['@value'];\n\t\t\t\t\tvar val = self.propertyMetaDataRes.bindings[i]['v:Property'];\n\t\t\t\t\tsubPar.appendChild(self.getSubDataMenu('Show data of chosen property', text, val));\n\t\t\t\t}\n\t\t\t}\n\t\t\tbtn.appendChild(subPar);\n\t\t}\n\t})\n}\n\nQueryPane.prototype.addCheveronIcon = function(btn){\n\tvar i = document.createElement('i');\n\ti.setAttribute('class', 'fa fa-chevron-right terminus-query-section');\n\tbtn.appendChild(i);\n}\n\n// data queries\nQueryPane.prototype.getDataSection = function(d){\n\tvar section = this.getSection('Data Queries');\n\td.appendChild(section);\n\t// div to populate submenu on data of type\n\tvar bd = document.createElement('div');\n\tbd.setAttribute('class', 'terminus-query-submenu');\n\td.appendChild(bd);\n\tvar btn = this.getQueryMenu('Show data of type');\n\tbd.appendChild(btn);\n\tthis.addCheveronIcon(btn);\n\tthis.showDataOfTypeEvent(btn);\n\t// div to populate submenu on property of type\n\tvar bd = document.createElement('div');\n\tbd.setAttribute('class', 'terminus-query-submenu');\n\td.appendChild(bd);\n\tvar btn = this.getQueryMenu('Show data for property');\n\tbd.appendChild(btn);\n\tthis.showPropertyOfTypeEvent(btn);\n\tthis.addCheveronIcon(btn);\n\tvar btn = this.getQueryMenu('Show All Data');\n\td.appendChild(btn);\n}\n\nQueryPane.prototype.fireDocumentEvent = function(document){\n\tlet WOQL = TerminusClient.WOQL;\n\tvar query = WOQL.query().documentProperties(document);\n\tthis.getResults(query);\n}\n\nQueryPane.prototype.getEnterDocumentIdDOM = function(){\n\tvar sp = document.createElement('span');\n\tsp.setAttribute('class', 'terminus-display-flex');\n\tvar inp = document.createElement('input');\n\tinp.setAttribute('class', 'terminus-doc-id-input');\n\tinp.setAttribute('placeholder', 'doc:myDocId');\n\tvar sub = document.createElement('button');\n\tsub.setAttribute('class', 'terminus-btn terminus-doc-id-input-submit');\n\tsub.appendChild(document.createTextNode('Submit'));\n\tvar self = this;\n\tsub.addEventListener('click', function(){\n\t\tself.fireDocumentEvent(inp.value);\n\t})\n\tsp.appendChild(inp);\n\tsp.appendChild(sub);\n\treturn sp;\n}\n\n// document queries\nQueryPane.prototype.getDocumentSection = function(d){\n\tvar section = this.getSection('Document Queries');\n\td.appendChild(section);\n\tvar btn = this.getQueryMenu('Show all documents');\n\td.appendChild(btn);\n\td.appendChild(this.getEnterDocumentIdDOM());\n}\n\n// bottom color transaprent\nQueryPane.prototype.getQueryMenuBlock = function(){\n\tvar d = document.createElement('div');\n\td.setAttribute('class', 'terminus-load-queries');\n\tthis.getSchemaSection(d);\n\tthis.getDataSection(d);\n\tthis.getDocumentSection(d);\n\treturn d;\n}\n\nQueryPane.prototype.getSampleQueriesDOM = function(){\n\tvar i = document.createElement('icon');\n\ti.setAttribute('class', 'fa fa-ellipsis-v terminus-ellipsis-icon');\n\ti.setAttribute('title', 'Click to load sample Queries');\n\ti.setAttribute('value', false);\n\ti.appendChild(document.createTextNode(\" Saved Queries \"))\n\tthis.sampleQueryDOM = i;\n\tvar self = this;\n\ti.addEventListener('click', function(e){\n\t\tif(e.target !== this) return;\n\t\tif(this.children.length) {\n\t\t\tHTMLHelper.removeChildren(this);\n\t\t\tthis.appendChild(document.createTextNode(\" Saved Queries \"))\n\t\t}\n\t\telse{\n\t\t\tvar d = self.getQueryMenuBlock();\n\t\t\tthis.appendChild(d);\n\t\t}\n\t})\n\treturn i;\n}\n\nQueryPane.prototype.getAsDOM = function(){\n\tif(this.intro){\n\t\tthis.container.appendChild(UTILS.getHeaderDom(this.intro));\n\t}\n\tif(this.showQuery) {\n\t\tif(this.saved) this.fireDefaultQueries();\n\t\tvar configspan = document.createElement(\"span\");\n\t\tconfigspan.setAttribute(\"class\", \"pane-config-icons\");\n\t\tthis.querySnippet = configspan;\n\t\tthis.container.appendChild(configspan);\n\t\tvar mode = (this.editQuery ? \"edit\" : \"view\");\n\t\tthis.input = this.createInput(mode);\n\t\tvar ipdom = this.input.getAsDOM(true);\n\t\tvar ispan = document.createElement(\"span\");\n\t\tispan.setAttribute(\"class\", \"query-pane-config\");\n\t\tvar ic = document.createElement(\"i\");\n\t\t//ic.setAttribute('style', 'margin:10px;')\n\t\tconfigspan.appendChild(ic);\n\t\tvar self = this;\n\t\tfunction showQueryConfig(){\n\t\t\tif(self.showQuery != \"always\"){\n\t\t\t\tconfigspan.title=\"Click to Hide Query\";\n\t\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\n\t\t\t}\n\t\t\tconfigspan.classList.remove('terminus-click-to-view-query');\n\t\t\tif(configspan.nextSibling){\n\t\t\t\tself.container.insertBefore(ipdom, configspan.nextSibling);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tself.container.appendChild(ipdom);\n\t\t\t}\n\t\t\tif(self.saved){\n\t\t\t\tvar qicon = self.getSampleQueriesDOM();\n\t\t\t\tvar sqd = document.createElement(\"span\");\n\t\t\t\tsqd.setAttribute(\"class\", \"sample-queries-pane\");\n\t\t\t\tsqd.appendChild(qicon);\n\t\t\t\tipdom.appendChild(sqd);\n\t\t\t}\n\t\t\tself.input.stylizeSnippet();\n\t\t}\n\t\tfunction hideQueryConfig(){\n\t\t\tconfigspan.title=\"Click to View Query\";\n            ic.setAttribute(\"class\", \"fas fa fa-search terminus-query-view-icon\");\n\t\t\tconfigspan.classList.add('terminus-click-to-view-query');\n\t\t\tself.container.removeChild(ipdom);\n\t\t}\n\t\tconfigspan.addEventListener(\"click\", () => {\n\t\t\tif(this.showingQuery) hideQueryConfig();\n\t\t\telse showQueryConfig();\n\t\t\tthis.showingQuery = !this.showingQuery;\n\t\t});\n\t\tshowQueryConfig();\n\t\tif(this.showQuery == \"icon\") hideQueryConfig();\n\t}\n\tthis.resultDOM = document.createElement(\"span\");\n\tif(this.showQuery){\n\t\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results-full\");\n\t}\n\telse {\n\t\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\n\t}\n\tthis.resultDOM.appendChild(this.messages);\n\tif(this.views.length == 0){\n\t\tthis.addView(TerminusClient.View.table(), this.defaultResultView);\n\t}\n\t//this is where we want to put in the view headers in the case of the query page\n\tfor(var i = 0; i<this.views.length; i++){\n\t\tvar vdom = this.views[i].getAsDOM();\n\t\tif(vdom){\n\t\t\tif(this.showHeader){\n\t\t\t\tvar closable = (this.views.length != 1);\n\t\t\t\t//var qhdr = this.getResultPaneHeader(closable);\n\t\t\t\t//vdom.prepend(qhdr);\n\t\t\t}\n\t\t\tthis.resultDOM.appendChild(vdom);\n\t\t}\n\t}\n\tthis.container.appendChild(this.resultDOM);\n\tif(this.addViews) this.container.appendChild(this.getAddViewControl());\n\treturn this.container;\n}\n\n\nQueryPane.prototype.getResultPaneHeader = function(closable){\n\tvar c = document.createElement('div');\n\tvar savePaneButton = document.createElement('button');\n\tsavePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\tsavePaneButton.appendChild(document.createTextNode('Save'));\n\tc.appendChild(savePaneButton);\n\tif(closable){\n\t\tvar closePaneButton = document.createElement('button');\n\t\tclosePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\t\tclosePaneButton.appendChild(document.createTextNode('Close'));\n\t\tc.appendChild(closePaneButton);\n\t}\n\tvar collapsePaneButton = document.createElement('button');\n\tcollapsePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\tcollapsePaneButton.appendChild(document.createTextNode('Collapse'));\n\tc.appendChild(collapsePaneButton);\n\treturn c;\n}\n\nQueryPane.prototype.createInput = function(mode){\n    let input = new TerminusCodeSnippet(\"woql\", mode, null, 800);\n    if(this.query){\n    \tinput.setQuery(this.query);\n\t}\n\tvar self = this;\n\tinput.submit = function(qObj){\n\t\tself.submitQuery(qObj);\n\t};\n\treturn input;\n}\n\nQueryPane.prototype.updateQuery = function(qObj){\n\tthis.query = qObj;\n\tif(this.input) this.input.setQuery(this.query);\n}\n\nQueryPane.prototype.setInput = function(input){\n\tif(this.input) {\n\t\tlet qr = this.input.setInput(input);\n\t\tif(qr) this.query = qr;\n\t}\n\n}\n\nQueryPane.prototype.updateResult = function(result){\n\tthis.result = result;\n\tthis.updateQuery(result.query);\n\tthis.refreshViews();\n}\n\nQueryPane.prototype.addView = function(config, options){\n\tvar nrp = new ResultPane(this.client, this, config).options(options);\n\tif(this.result){\n\t\tnrp.setResult(this.result);\n\t}\n\tthis.views.push(nrp);\n\treturn nrp;\n}\n\nQueryPane.prototype.empty = function(){\n\treturn (typeof this.query == \"undefined\");\n}\n\nQueryPane.prototype.clearMessages = function(){\n\tif(this.messages.children.length) HTMLHelper.removeChildren(this.messages);\n}\n\nQueryPane.prototype.getBusyLoader = function(){\n     var pbc = document.createElement('div');\n     pbc.setAttribute('class', 'term-progress-bar-container');\n     var pbsa = document.createElement('div');\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\n     pbc.appendChild(pbsa);\n     var pbia = document.createElement('span');\n     pbia.setAttribute('class', 'term-progress-bar-inner');\n     pbsa.appendChild(pbia);\n\t return pbc;\n}\n\nQueryPane.prototype.showBusy = function(msg){\n\tvar msgHolder = document.createElement('div');\n\tmsgHolder.setAttribute('class', 'terminus-busy-msg')\n\tmsgHolder.appendChild(document.createTextNode(msg));\n\tmsgHolder.appendChild(this.getBusyLoader());\n\tthis.messages.appendChild(msgHolder);\n}\n\nQueryPane.prototype.showError = function(e){\n\tthis.showMessage(e, \"error\");\n}\n\nQueryPane.prototype.showMessage = function(m, type){\n\tvar md = document.createElement('div');\n\tmd.setAttribute('class', 'terminus-show-msg-' + type);\n\tmd.appendChild(document.createTextNode(m));\n\tthis.messages.appendChild(md);\n}\n\nQueryPane.prototype.showNoBindings = function(){\n\tnor = document.createElement('div');\n\tnor.setAttribute('class', 'terminus-show-msg-warning');\n\tnor.appendChild(document.createTextNode(\"No results available for this query\"));\n\tthis.clearMessages();\n\tthis.messages.appendChild(nor);\n}\t\n\nQueryPane.prototype.submitQuery = function(qObj){\n\tthis.clearMessages();\n\tif(!qObj){\n\t\tthis.showError(\"Query could not be extracted from input box - remember that the last element in the query must be a WOQL object\")\n\t}\n\tif(typeof qObj == 'string'){\n\t\tthis.showError(qObj);\n\t\treturn;\n\t}\n\tthis.clearResults();\n    this.query = qObj;\n\tthis.showBusy('Fetching results ...');\n\tvar self = this;\n\tvar start = Date.now();\n    return qObj.execute(this.client).then((results) => {\n\t\tvar r = new TerminusClient.WOQLResult(results, qObj);\n\t\tthis.result = r;\n\t\tthis.clearMessages();\n\t\tif(this.result.hasBindings()){\n\t\t\tvar delta = Date.now() - start;\n\t\t\tthis.showMessage(\"Query returned \" + this.result.count() + \" results in \" + (delta/1000) + \" seconds\", \"info\");\n\t\t\tthis.refreshViews();\n\t\t}\n\t\telse this.showNoBindings();\n\t}).catch((error) => {\n\t\tthis.clearMessages();\n\t\tif(error.data && error.data['terminus:witnesses']){\n\t\t\tthis.showViolations(error.data['terminus:witnesses']);\n\t\t}\n\t\telse {\n\t\t\tthis.showError(error);\n\t\t}\n\t});\n}\n\nQueryPane.prototype.clearResults = function(){\n\tfor(var i = 0; i<this.views.length; i++){\n\t\tthis.views[i].clearResult(this.result);\n\t}\n}\n\n\nQueryPane.prototype.refreshViews = function(){\n\tfor(var i = 0; i<this.views.length; i++){\n\t\tthis.views[i].updateResult(this.result);\n\t}\n}\n\nQueryPane.prototype.showViolations = function(vios){\n    var nvios = new TerminusViolations(vios, this); \n\tthis.messages.appendChild(nvios.getAsDOM(\"\"));\n}\n\nQueryPane.prototype.getAddViewControl = function(){\n\tvar vd = document.createElement('div');\n\tvd.setAttribute('class', 'terminus-add-view-selector');\n\tvar self = this;\n\tvar WOQL = TerminusClient.WOQL;\n\tvar newView = function(val){\n\t\tself.selector.value = \"\";\n\t\tvar c= eval('WOQL.' + val + \"()\");\n\t\tvar nv = self.addView(c, self.defaultResultView);\n\t\tif(self.result){\n\t\t\tnv.setResult(self.result);\n\t\t}\n\t\tvar vdom = nv.getAsDOM();\n\t\tif(vdom){\n\t\t\tself.resultDOM.appendChild(vdom);\n\t\t}\n\t}\n\tvar opts = [\n\t\t{ value: \"\", label: \"Add another view of results\"},\n\t\t{ value: \"table\", label: \"Add Table View\"},\n\t\t{ value: \"stream\", label: \"Add Stream View\"},\n\t\t{ value: \"graph\", label: \"Add Graph View\"},\n\t\t{ value: \"chooser\", label: \"Add Drop-down View\"},\n\t\t{ value: \"map\", label: \"Add Map View\"}\n\t];\n\tvar sel = HTMLHelper.getSelectionControl(\"view\", opts, false,newView);\n\tthis.selector = sel;\n\tvd.appendChild(sel);\n\treturn vd;\n}\n\nmodule.exports = QueryPane;","const TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\nconst Datatypes = require(\"./Datatypes\");\nconst DatatypeRenderers = require(\"./DatatypeRenderers\");\n\nconst SimpleTable = require(\"./table/SimpleTable\");\nconst SimpleGraph = require(\"./graph/SimpleGraph\");\nconst SimpleStream = require(\"./stream/SimpleStream\");\nconst SimpleChooser = require(\"./chooser/SimpleChooser\");\nconst HTMLHelper = require('./HTMLHelper');\n\n/**\n * Result Pane is defined by a WOQL configuration object\n * Visually it consists of a single rule editor (showing the current state of the configuration object) which may be collapsed behind a configuration link\n * and a single result view which shows the result of the rule when applied to the current results.\n *\n */\nfunction ResultPane(client, querypane, config){\n    this.client = client;\n    this.qp = querypane;\n    this.config = config;\n\tthis.container = document.createElement('span');\n    this.container.setAttribute('class', 'terminus-result-pane');\n}\n\nResultPane.prototype.options = function(opts){\n\tthis.showConfig = (opts && typeof opts.showConfig != \"undefined\" ? opts.showConfig : false);\n    this.editConfig = (opts && typeof opts.editConfig != \"undefined\" ? opts.editConfig : false);\n    this.changeViewType = (opts && typeof opts.changeViewType != \"undefined\" ? opts.changeViewType : true);\n    this.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\n    this.renderers =  (opts && opts.renderers ? opts.renderers : {\n\t\ttable: new SimpleTable(),\n\t\tgraph: new SimpleGraph(),\n\t\tstream: new SimpleStream(),\n\t\tchooser: new SimpleChooser()\n    });\n    if(this.config){\n        this.viewers = [this.config];\n    }\n    this.viewers =  (opts && typeof opts.viewers != \"undefined\" ? this.viewers.concat(opts.viewers) : this.viewers);\n    this.currentViewer = 0;\n    return this;\n}\n\nResultPane.prototype.getRenderer = function(){\n    if(this.config && this.config.renderer()){\n        return this.config.renderer();\n    }\n    else {\n        if(this.config.type && this.renderers[this.config.type]){\n            return this.renderers[this.config.type];\n        }\n    }\n    return false;\n}\n\nResultPane.prototype.getAsDOM = function(){\n    if(this.intro){\n        var di = (typeof this.intro == \"string\" ? document.createTextNode(this.intro) : this.intro);\n\t\tthis.container.appendChild(di);\n\t}\n    var configspan = document.createElement(\"span\");\n    configspan.setAttribute(\"class\", \"pane-config-icons\");\n    this.container.appendChild(configspan);\n\tthis.resultDOM = document.createElement('span');\n\tthis.resultDOM.setAttribute('class', 'terminus-result-view');\n\tif(this.result){\n\t\tthis.resultDOM.appendChild(this.getResultDOM());\n\t}\n\tthis.container.appendChild(this.resultDOM);\n\tif(this.showConfig){\n        this.showingQuery = (this.showConfig != \"icon\");\n\t\tvar mode = (this.editConfig ? \"edit\" : \"view\");\n\t\tthis.input = this.createInput(mode);\n\t\tvar ipdom = this.input.getAsDOM();\n        var ispan = document.createElement(\"span\");\n        ispan.addEventListener('mouseover', function(){\n            this.style.cursor = \"pointer\";\n\t\t});\n\t\tispan.setAttribute(\"class\", \"result-pane-config\");\n\t\tvar ic = document.createElement(\"i\");\n\t\tispan.appendChild(ic);\n\t\tconfigspan.appendChild(ispan);\n\t\tvar self = this;\n\t\tfunction showQueryConfig(){\n\t\t\tconfigspan.title=\"Click to Hide View Configuration\";\n\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\n            if(configspan.nextSibling){\n                self.container.insertBefore(ipdom, configspan.nextSibling);\n                if(self.input.snippet.value)\n\t\t\t\t\tself.input.stylizeSnippet();\n            }\n            else{\n                self.container.appendChild(ipdom);\n                if(self.input.snippet.value)\n\t\t\t\t\tself.input.stylizeSnippet();\n            }\n\t\t}\n\t\tfunction hideQueryConfig(){\n\t\t\tconfigspan.title=\"Click to View Configuration\";\n            ic.setAttribute(\"class\", \"terminus-result-icons terminus-result-view-icon \" + self.getViewConfigIconClass());\n\t\t\tself.container.removeChild(ipdom);\n\t\t}\n\t\tispan.addEventListener(\"click\", () => {\n\t\t\tif(this.showingQuery) hideQueryConfig();\n\t\t\telse showQueryConfig();\n\t\t\tthis.showingQuery = !this.showingQuery;\n        });\n        showQueryConfig();\n\t\tif(this.showConfig == \"icon\") hideQueryConfig();\n    }\n    if(this.changeViewType){\n        cvicons = this.getViewTypeIconDOM(ipdom);\n        if(cvicons) configspan.prepend(cvicons);\n    }\n\treturn this.container;\n}\n\nResultPane.prototype.getViewConfigIconClass = function(){\n    if(this.changeViewType && this.viewers.length > 1){\n        return \"fas fa fa-vial\";\n    }\n    if(this.viewers[this.currentViewer].icon){\n        return this.viewers[this.currentViewer].icon;\n    }\n    var def = this.getDefaultViewerIcon(this.viewers[this.currentViewer]);\n    return def.icon;\n}\n\n\nResultPane.prototype.getViewTypeIconDOM = function(sp, ipdom){\n    var bsp = document.createElement('span');\n    bsp.setAttribute('class', 'terminus-result-icons');\n    if(this.viewers.length > 1){\n        for(var i = 0; i<this.viewers.length; i++){\n            var isp = this.getIconForViewer(this.viewers[i], i, bsp);\n            bsp.appendChild(isp);\n        }\n    }\n    return bsp;\n}\n\nResultPane.prototype.changeViewerType = function(viewer, index){\n    this.currentViewer = index;\n    this.config = viewer;\n    if(this.input){\n        this.input.setQuery(viewer);\n        this.input.submit(this.input.qObj);\n    }\n    else {\n        this.updateView(viewer);\n    }    \n}\n\n\nResultPane.prototype.getDefaultViewerIcon = function(viewer){\n    var view_types = {\n        table: {label: \"Table\", icon: \"fa fa-table\"},\n\t\tgraph: {label: \"Graph\", icon: \"fas fa-code-branch\"},\n\t\tchooser: {label: \"Drop-down List\", icon: \"fas fa-caret-down\"},\n\t\tstream: {label: \"Result Stream\", icon: \"fa fa-list\"}\n    }\n    return view_types[viewer.type];\n}\n\n\nResultPane.prototype.getIconForViewer = function(viewer, index, container){\n    var isp = document.createElement('span');\n    var icon = document.createElement(\"i\");\n    var def = this.getDefaultViewerIcon(viewer);\n    icon.title = (viewer.label) ? viewer.label : def.label;\n    var ic = (viewer.icon ? viewer.icon : def.icon);\n    icon.setAttribute(\"class\", ic);\n    icon.classList.add('terminus-result-view-icon');\n    //icon.classList.add('circle-icon');\n    isp.appendChild(icon);\n    if(this.currentViewer == index){\n        isp.setAttribute(\"class\", \"result-icon-selected selected terminus-result-selected\");\n        icon.classList.add('terminus-view-selected');\n    }\n    else {\n        isp.setAttribute(\"class\", \"result-icon-selectable selectable\");\n        isp.addEventListener('mouseover', function(){\n            this.style.cursor = \"pointer\";\n\t\t});\n    }\n    isp.addEventListener(\"click\", () => {\n        this.changeViewerType(viewer, index);\n        HTMLHelper.removeChildren(container);\n        for(var i = 0; i<this.viewers.length; i++){\n            var isp = this.getIconForViewer(this.viewers[i], i, container);\n            container.appendChild(isp);\n        }\n    });\n    return isp;\n}\n\nResultPane.prototype.createInput = function(mode){\n    let input = new TerminusCodeSnippet(\"rule\", mode);\n    if(this.config){\n    \tinput.setQuery(this.config);\n\t}\n\tvar self = this;\n\tinput.submit = function(config){\n\t\tself.updateView(config);\n\t};\n\treturn input;\n}\n\nResultPane.prototype.setResult = function(wres){\n\tthis.result = wres;\n}\n\nResultPane.prototype.clearResult = function(){\n    this.result = false;\n    HTMLHelper.removeChildren(this.resultDOM);\n}\n\n\nResultPane.prototype.updateResult = function(wres){\n\tthis.result = wres;\n\tHTMLHelper.removeChildren(this.resultDOM);\n\tthis.resultDOM.appendChild(this.getResultDOM());\n}\n\nResultPane.prototype.updateView = function(config){\n\tthis.config = config;\n\tHTMLHelper.removeChildren(this.resultDOM);\n\tif(this.result){\n\t\tthis.resultDOM.appendChild(this.getResultDOM());\n\t}\n}\n\nResultPane.prototype.getResultDOM = function(){\n\tlet span = document.createElement(\"span\");\n\tspan.setAttribute(\"class\", \"terminus-query-results\");\n    let viewer = this.config.create(this.client);\n    viewer.datatypes = new DatatypeRenderers();\n    Datatypes.initialiseDataRenderers(viewer.datatypes);\n    var self = this;\n    viewer.notify = function(r){\n        self.qp.updateResult(r);\n    }\n\tthis.result.first();\n    viewer.setResult(this.result);\n    \n    var html_renderer = this.getRenderer();\n\n\tspan.appendChild(html_renderer.render(viewer));\n\treturn span;\n}\n\nmodule.exports = ResultPane;\n","const HTMLHelper = require('../HTMLHelper');\n\nfunction HTMLStringViewer(options){\n\tthis.options(options);\t\n}\n\nHTMLStringViewer.prototype.options = function(options){\n\tthis.size = ((options && options.size) ? options.size : false);\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\n\tthis.max_word_size = (options && options.max_word_size ? options.max_word_size : false);\n\tthis.max_cell_size = (options && options.max_cell_size ? options.max_cell_size : false);\n\tthis.show_types = (options && options.show_types ? options.show_types : false);\n}\n\nHTMLStringViewer.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\treturn this.render(value);\n}\n\nHTMLStringViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\nHTMLStringViewer.prototype.render = function(value){\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', this.css);\n\tinput.setAttribute('data-value', value);\n\tif(this.show_types && this.type != \"id\"){\n\t\tvalue += \" (\" + this.type + \")\";\n\t}\n\tif(this.max_word_size || this.max_cell_size){\n\t\tHTMLHelper.wrapShortenedText(input, value, this.max_cell_size, this.max_word_size);\n\t}\n\telse {\n\t\tvalue = document.createTextNode(value);\n\t\tinput.appendChild(value);\n\t}\n\treturn input;\n}\n\nmodule.exports={HTMLStringViewer}\n\n\n","function HTMLStringEditor(options){\n\tthis.options(options);\t\n}\n\nHTMLStringEditor.prototype.options = function(options){\t\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\n\tthis.opts = options;\n}\n\nHTMLStringEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar big = ((this.opts && typeof this.opts.big != \"undefined\") ? this.opts.big : this.isBigType(this.type, value));\n\tif(big){\n\t\tvar input = document.createElement(\"textarea\");\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\n\t}\n\telse {\n\t\tvar size = ((this.opts && typeof this.opts.size != \"undefined\") ? this.opts.size : this.getTypeSize(this.type, value));\n\t\tvar input = document.createElement(\"input\");\n\t\tinput.setAttribute('type', \"text\");\n\t\tinput.setAttribute('size', size);\n\t}\n\tinput.setAttribute('class', this.css);\n\tinput.setAttribute(\"data-value\", value);\n\t\n\tinput.value = value;\n\tvar self = this;\n\tinput.addEventListener(\"input\", function(){\n\t\tframe.set(this.value);\n\t});\n\treturn input;\n}\n\nHTMLStringEditor.prototype.isBigType = function(ty, value){\n\tif(value && value.length && value.length > 100) return true;\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\n\tif(longs.indexOf(ty) == -1) return false;\n\treturn true;\n}\n\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\n\tif(value && value.length && value.length > 40) return 80;\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\n\tif(bigs.indexOf(ty) != -1) return 80;\n\tif(smalls.indexOf(ty) != -1) return 16;\n\tif(tinys.indexOf(ty) != -1) return 8;\n\treturn 32;\n}\n\nmodule.exports={HTMLStringEditor}\n\n\n","function HTMLBooleanViewer(options){\n\tthis.options(options);\n}\n\nHTMLBooleanViewer.prototype.options = function(options){\n\tthis.css = \"terminus-literal-value terminus-literal-value-boolean \" + ((options && options.css) ?  options.css : \"\");\n}\n\nHTMLBooleanViewer.prototype.renderFrame = function(frame, dataviewer){\n\treturn this.render(frame.get());\n}\n\nHTMLBooleanViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\t\n}\n\nHTMLBooleanViewer.prototype.render = function(value){\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', this.css);\n\tif(value){\n\t\tvar vallab = document.createTextNode(value);\n\t\tinput.appendChild(vallab);\n\t}\n\treturn input;\n}\n\n\nmodule.exports={HTMLBooleanViewer}\n\n","function HTMLBooleanEditor(options){\n\tthis.options(options);\n}\n\nHTMLBooleanEditor.prototype.options = function(options){\t\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\n}\n\nHTMLBooleanEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar input = document.createElement(\"input\");\n\tinput.setAttribute('type', \"checkbox\");\n\tif(value){\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\n\t}\n\tinput.addEventListener(\"change\", function(){\n\t\tif(value){\n\t\t\tframe.set(\"\");\n\t\t}\n\t\telse {\n\t\t\tframe.set(\"true\");\n\t\t}\n\t});\n\treturn input;\n}\n\nmodule.exports={HTMLBooleanEditor}\n\n","const TerminusClient = require('@terminusdb/terminus-client');\n\nfunction HTMLChoiceViewer(options){};\nHTMLChoiceViewer.prototype.options = function(options){}\n\nHTMLChoiceViewer.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tif(frame.frame && frame.frame.elements){\n\t\tthis.elements = frame.frame.elements;\n\t}\n\treturn this.render(value);\n}\n\nHTMLChoiceViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\nHTMLChoiceViewer.prototype.render = function(value){\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\n\tinput.setAttribute('data-value', value);\n\tvar lab = false;\n\tif(value && this.elements){\n\t\tfor(var i = 0; i<this.elements.length; i++){\n\t\t\tvar elt = this.elements[i];\n\t\t\tif(elt.class == value){\n\t\t\t\tif(elt.label && elt.label[\"@value\"]){\n\t\t\t\t\tlab = elt.label[\"@value\"];\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\t\t\t\t\n\t\t}\n\t}\n\tif(value && !lab){\n\t\tlab = TerminusClient.UTILS.labelFromURL(value);\t\t\t\t\t\n\t}\n\tif(lab){\n\t\tinput.appendChild(document.createTextNode(lab));\t\t\n\t}\n\treturn input\n}\n\nmodule.exports={HTMLChoiceViewer}\n\n\n","const HTMLHelper = require('../HTMLHelper');\n\nfunction HTMLChoiceEditor(options){};\n\nHTMLChoiceEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar optInput = document.createElement(\"select\");\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\n\tvar foptions = frame.getChoiceOptions();\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\n\tvar callback = function(val){\n\t\tframe.set(val);\n\t}\n\tvar sel = HTMLHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\n\treturn sel;\n}\n\nmodule.exports={HTMLChoiceEditor}\n\n","function HTMLCoordinateViewer(options){\n\tthis.inputs = [];\n}\n\nHTMLCoordinateViewer.prototype.parseValue = function(value){\n\ttry {\n\t\tvar parsed = (value ? JSON.parse(value) : false);\n\t\tif(parsed && this.type == \"xdd:coordinate\"){\n\t\t\tparsed = [parsed];\n\t\t}\n\t\treturn parsed;\n\t}\n\tcatch(e){\n\t\tthis.error = this.type + \" value \" + value + \" failed to parse as json\", e.toString();\n\t\treturn [];\n\t}\n}\n\n\nHTMLCoordinateViewer.prototype.renderFrame = function(frame, dataviewer){\n\treturn this.render(frame.get());\n}\n\nHTMLCoordinateViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\nHTMLCoordinateViewer.prototype.render = function(value){ \n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\n\tif(value){\n\t\tinput.setAttribute('data-value', value);\t\t\n\t\tvar parsed = this.parseValue(value);\n\t\tif(parsed){\n\t\t\tfor(var i = 0; i < parsed.length; i++){\n\t\t\t\tvar lldom = document.createElement(\"span\");\n\t\t\t\tlldom.setAttribute(\"class\", \"latlong\");\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" \" + \" \"));\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" \" ));\n\t\t\t\tinput.appendChild(lldom);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tinput.setAttribute(\"title\", this.error);\n\t\t}\n\t}\n\treturn input;\n}\n\nmodule.exports={HTMLCoordinateViewer}\n\n","function HTMLCoordinateEditor(options){\n\tthis.inputs = [];\n}\n\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\n\tvar latdom = document.createElement(\"input\");\n\tlatdom.setAttribute(\"type\", \"text\");\n\tlatdom.value = lat;\n\tvar longdom = document.createElement(\"input\");\n\tlongdom.setAttribute(\"type\", \"text\");\n\tlongdom.value = long;\n\tlatdom.addEventListener(\"change\", change);\n\tlongdom.addEventListener(\"change\", change);\n\treturn [latdom, longdom];\n}\n\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\n\tvar lldom = document.createElement(\"span\");\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\n\tvar firstcol = document.createElement(\"span\");\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\n\tlldom.appendChild(firstcol);\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\n\t\tvar delbut = document.createElement(\"button\");\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\n\t\tdelbut.addEventListener(\"click\", function(){\n\t\t\tlong.value = \"\";\n\t\t\tlat.value = \"\";\n\t\t\tparent.removeChild(lldom);\n\t\t});\n\t\tfirstcol.appendChild(delbut);\n\t}\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\n\tlldom.appendChild(lat);\n\tlldom.appendChild(document.createTextNode(\" \" + \" \"));\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\n\tlldom.appendChild(long);\n\tlldom.appendChild(document.createTextNode(\"  \" ));\n\treturn lldom;\n}\n\n\nHTMLCoordinateEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\n\tinput.setAttribute('data-value', value);\n\ttry {\n\t\tvar parsed = (value ? JSON.parse(value) : false);\n\t}\n\tcatch(e){\n\t\tthis.error = this.type + \" failed to parse as json\", e.toString();\n\t\tvar parsed = false;\n\t}\n\tvar self = this;\n\tvar updateValueFromForm = function(){\n\t\tvar vals = [];\n\t\tfor(var i = 0; i<self.inputs.length; i++){\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\n\t\t\t\tvals.push(val);\n\t\t\t}\n\t\t}\n\t\tif(vals.length == 0){\n\t\t\tframe.set(\"\");\n\t\t}\n\t\telse if(this.type == \"xdd:coordinate\"){\n\t\t\tframe.set(vals[0]);\n\t\t}\n\t\telse {\n\t\t\tvar op = \"[\";\n\t\t\tfor(var i = 0; i<vals.length; i++){\n\t\t\t\top += vals[i];\n\t\t\t\tif(i+1 < vals.length) op += \",\";\n\t\t\t}\n\t\t\top += \"]\";\n\t\t\tframe.set(op);\n\t\t}\n\t};\n\tif(!parsed){\n\t\tif(this.type == \"xdd:coordinate\") parsed = [\"\",\"\"];\n\t\telse {\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\n\t\t\tif(this.type == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\n\t\t}\n\t}\n\tif(this.type == \"xdd:coordinate\"){\n\t\tparsed = [parsed];\n\t}\n\tfor(var i = 0; i < parsed.length; i++){\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\n\t}\n\tvar lldoms = document.createElement(\"span\");\n\tfor(var i = 0; i < this.inputs.length; i++){\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], this.type, i, lldoms);\n\t\tlldoms.appendChild(lldom);\n\t}\n\tinput.appendChild(lldoms);\n\tvar self = this;\n\tif(this.type != \"xdd:coordinate\"){\n\t\tvar butspan = document.createElement(\"span\");\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\n\t\tvar addbut = document.createElement(\"button\");\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\n\t\taddbut.addEventListener(\"click\", function(){\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], this.type, self.inputs.length, lldoms);\n\t\t\tlldoms.appendChild(lldom);\n\t\t\tself.inputs.push(ipdoms);\n\t\t});\n\t\tbutspan.appendChild(addbut);\n\t\tinput.appendChild(butspan);\t\t\t\n\t}\n\treturn input;\n}\n\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\nconst TerminusClient = require('@terminusdb/terminus-client');\n\nfunction HTMLDateViewer(options){\n\tthis.options(options);\n}\n\nHTMLDateViewer.prototype.options = function(options){\n\tthis.max = (options && options.max ? options.max : false);\n\tthis.min = (options && options.min ? options.min : false);\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\n\tthis.date_spacer = \"/\";\n\tthis.time_spacer = \":\";\n\tthis.datetime_separator = \", \";\n\tthis.helper = new DateHelper.HTMLDateHelper();\n}\n\nHTMLDateViewer.prototype.renderFrame = function(frame, dataviewer){\n\treturn this.render(frame.get());\n}\n\nHTMLDateViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\nHTMLDateViewer.prototype.render = function(value){\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\n\tinput.setAttribute('data-value', value);\n\tif(value){\n\t\tvar parsed = TerminusClient.UTILS.DateHelper.parseDate(this.type, value);\n\t\tvar datepart = this.getDateComponentDOM(parsed);\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\n\t\tif(timepart) input.appendChild(timepart);\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\n\t\tif(datepart) input.appendChild(datepart);\n\t}\n\treturn input;\n}\n\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\n\tif(hdom){\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\n\t}\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\n\tif(mdom){\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\n\t\tvar mlab = (parsed.minute < 10 ? parsed.minute : parsed.minute);\n\t\tmdom.appendChild(document.createTextNode(mlab));\n\t}\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\n\tif(sdom){\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\n\t\tvar slab = (parsed.second < 10 ? parsed.second : parsed.second);\n\t\tsdom.appendChild(document.createTextNode(slab));\n\t}\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\n\tif(tz){\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\n\t}\n\tif(hdom || mdom || sdom || tz){\n\t\tvar dadom = document.createElement(\"span\");\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\n\t\tif(hdom) dadom.appendChild(hdom); \n\t\tif(mdom) {\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\n\t\t\tdadom.appendChild(mdom); \n\t\t}\n\t\tif(sdom) {\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\n\t\t\tdadom.appendChild(sdom); \n\t\t}\n\t\tif(tz){\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \n\t\t\tdadom.appendChild(sdom); \n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\n\t\t}\n\t\treturn dadom;\n\t}\n\treturn false;\n}\n\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\n\tif(ydom){\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\n\t\tydom.appendChild(document.createTextNode(parsed.year));\n\t}\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\n\tif(mdom){\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\n\t}\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\n\tif(ddom){\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\n\t}\n\tif(ydom || mdom || ddom){\n\t\tvar dadom = document.createElement(\"span\");\n\t\tif(ddom) dadom.appendChild(ddom); \n\t\tif(mdom) {\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\n\t\t\tdadom.appendChild(mdom); \n\t\t}\n\t\tif(ydom) {\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\n\t\t\tdadom.appendChild(ydom); \n\t\t}\n\t\treturn dadom;\n\t}\n\treturn false;\n}\n\nmodule.exports={HTMLDateViewer}","const DateHelper = require('./DateHelper');\nconst TerminusClient = require('@terminusdb/terminus-client');\n\nfunction HTMLDateEditor(options){\n\tthis.options(options);\n}\n\nHTMLDateEditor.prototype.options = function(options){\n\tthis.max = (options && options.max ? options.max : false);\n\tthis.min = (options && options.min ? options.min : false);\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\n\tthis.date_spacer = \"/\";\n\tthis.time_spacer = \":\";\n\tthis.datetime_separator = \", \";\n\tthis.helper = new DateHelper.HTMLDateHelper();\n}\n\nHTMLDateEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\n\tinput.setAttribute('data-value', value);\n\tif(value){\n\t\tthis.parsed = TerminusClient.UTILS.DateHelper.parseDate(this.type, value);\n\t}\n\telse this.parsed = {};\n\tvar datepart = this.getDateComponentDOM(this.parsed, this.type, frame);\n\tvar timepart = this.getTimeComponentDOM(this.parsed, this.type, frame);\n\tif(timepart) input.appendChild(timepart);\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\n\tif(datepart) input.appendChild(datepart);\n\treturn input;\n}\n\nHTMLDateEditor.prototype.set = function(part, val, frame, ty){\n\tthis.parsed[part] = val;\n\tvar xsd = TerminusClient.UTILS.DateHelper.xsdFromParsed(this.parsed, ty);\n\tif(xsd){\n\t\tframe.set(xsd);\n\t}\n}\n\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, frame){\n\tif([\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:time\"].indexOf(ty) == -1){\n\t\treturn false;\n\t}\n\tvar self = this;\n\tvar hdom = document.createElement(\"input\");\n\thdom.setAttribute(\"class\", \"terminus-hour-input terminus-hour-\"+ty);\n\thdom.setAttribute(\"size\", 2);\n\thdom.setAttribute(\"placeholder\", \"HH\");\n\thdom.value = (parsed.hour ? parsed.hour : \"\");\n\thdom.addEventListener(\"input\", function(){\n\t\tself.set(\"hour\", this.value, frame, ty);\n\t});\n\tvar mdom = document.createElement(\"input\");\n\tmdom.setAttribute(\"class\", \"terminus-minute-input terminus-minute-\"+ty);\n\tmdom.setAttribute(\"size\", 2);\n\tmdom.setAttribute(\"placeholder\", \"MM\");\n\tmdom.value = (parsed.minute ? parsed.minute: \"\");\n\tmdom.addEventListener(\"input\", function(){\n\t\tself.set(\"minute\", this.value, frame, ty);\n\t});\n\tvar sdom = document.createElement(\"input\");\n\tsdom.setAttribute(\"class\", \"terminus-second-input terminus-second-\"+ty);\n\tsdom.setAttribute(\"size\", 8);\n\tsdom.setAttribute(\"placeholder\", \"SS.sss...\");\n\tsdom.value = (parsed.second ? parsed.second: \"\");\n\tsdom.addEventListener(\"input\", function(){\n\t\tself.set(\"second\", this.value, frame, ty);\n\t})\n\tvar tdom = document.createElement(\"span\");\n\ttdom.appendChild(hdom);\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\n\ttdom.appendChild(mdom);\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\n\ttdom.appendChild(sdom);\n\treturn tdom;\n}\n\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, frame){\n\tvar self = this;\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\n\t\tvar ydom = document.createElement(\"input\");\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\n\t\tydom.setAttribute(\"size\", 6);\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\n\t\tydom.addEventListener(\"input\", function(){\n\t\t\tself.set(\"year\", this.value, frame, ty);\n\t\t})\n\t}\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\n\t\tvar mdom = document.createElement(\"select\");\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\n\t\t\tvar opdom = document.createElement(\"option\");\n\t\t\topdom.value = i+1;\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\n\t\t\tif(parsed.month && parsed.month == i+1){\n\t\t\t\topdom.selected = true;\n\t\t\t}\n\t\t\tmdom.appendChild(opdom);\n\t\t}\n\t\tmdom.addEventListener(\"change\", function(){\n\t\t\tself.set(\"month\", this.value, frame, ty);\n\t\t})\n\t}\t\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\n\t\tvar ddom = document.createElement(\"input\");\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\n\t\tddom.setAttribute(\"size\", 2);\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\n\t\tddom.addEventListener(\"input\", function(){\n\t\t\tself.set(\"day\", this.value, frame, ty);\n\t\t})\n\t}\t\n\tif(ydom || mdom || ddom){\n\t\tvar dadom = document.createElement(\"span\");\n\t\tif(ddom) dadom.appendChild(ddom); \n\t\tif(mdom) {\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\n\t\t\tdadom.appendChild(mdom); \n\t\t}\n\t\tif(ydom) {\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\n\t\t\tdadom.appendChild(ydom); \n\t\t}\n\t\treturn dadom;\n\t}\n\treturn false;\n}\n\nmodule.exports={HTMLDateEditor}","const HTMLHelper = require('../HTMLHelper');\n\nfunction HTMLEntityViewer(options){\n\tthis.options(options);\n}\n\nHTMLEntityViewer.prototype.options = function(options){\n\tthis.onclick = (options && options.onclick ? options.onclick: false);\n}\n\nHTMLEntityViewer.prototype.renderFrame = function(frame, dataviewer){\n\t//this.client = dataviewer.getClient();\n\treturn this.render(frame.get());\t\n}\n\nHTMLEntityViewer.prototype.renderValue = function(dataviewer){\n\t//this.client = dataviewer.getClient();\n\treturn this.render(dataviewer.value());\n}\n\nHTMLEntityViewer.prototype.render = function(value){\n\tvar holder = document.createElement(\"span\");\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\n\tif(this.holder){\n\t\treturn this.holder;\n\t}\n\tif(value){\n\t\tvar dom = this.showValue(value)\n\t\tholder.appendChild(dom);\n\t}\n\treturn holder;\n}\n\nHTMLEntityViewer.prototype.showValue = function(value){\n\tif(this.onclick){\n\t\tvar self = this;\n\t\tvar a = document.createElement(\"a\");\n\t\ta.style.color = \"#0000aa\";\n\t\ta.appendChild(document.createTextNode(value));\n\t\ta.addEventListener(\"click\", function(event){\n\t\t\tself.onclick(value);\n\t\t});\n\t\ta.addEventListener(\"mouseover\", function(event){\n\t\t\ta.style.cursor = \"pointer\";\n\t\t});\n\t\treturn a; \t\n\t}\n\telse {\n\t\treturn document.createTextNode(value);\n\t}\n}\n\n\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, frame, dataviewer){\n\talert(\"Nooo\");\n\tvar span = document.createElement(\"span\");\n\tvar self = this;\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\n\tspan.appendChild(dataviewer.internalLink(value));\n\tif(controller = renderer.getController()){\n\t\tcontroller.getInstanceMeta(value).then(function(response){\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\n\t\t\tif(lab){ \n\t\t\t\tHTMLHelper.removeChildren(span);\n\t\t\t\tspan.appendChild(lab);\n\t\t\t}\t\n\t\t});\n\t}\n\treturn span;\n}\n\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\n\tvar nspan = document.createElement(\"span\");\n\tif(response && (il = HTMLHelper.getVariableValueFromBinding(\"InstanceLabel\", response))){\n\t\tnspan.appendChild(dv.internalLink(url, il));\n\t\tvar rt = HTMLHelper.getVariableValueFromBinding(\"InstanceType\", response);\n\t\tvar tit = url + \" Type: \" + rt;\n\t\tvar ic = HTMLHelper.getVariableValueFromBinding(\"InstanceComment\", response);\n\t\tif(typeof ic == \"object\" && ic[\"@value\"]){\n\t\t\ttit += \" \" + ic[\"@value\"];\n\t\t}\n\t\tnspan.setAttribute(\"title\", tit);\n\t\treturn nspan;\n\t}\n\treturn false;\n}\n\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\nHTMLEntityEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar input = document.createElement(\"input\");\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\n\tinput.setAttribute(\"type\", \"text\");\n\tinput.setAttribute('size', 80);\n\tinput.value = value;\n\tvar self = this;\n\tinput.addEventListener(\"change\", function(){\n\t\tvar url = this.value;\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\n\t\t\turl = \"doc:\" + url;\n\t\t}\n\t\tframe.set(url);\n\t});\n\treturn input;\n}\n\nmodule.exports={HTMLEntityEditor}","function HTMLImageViewer(options){}\n\nHTMLImageViewer.prototype.options = function(options){}\n\n\nHTMLImageViewer.prototype.renderFrame = function(frame, dataviewer){\n\treturn this.render(frame.get());\n}\n\nHTMLImageViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\t\nHTMLImageViewer.prototype.render = function(value){\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\n\tinput.setAttribute('data-value', value);\n\tif(value){\n\t\tvar img = document.createElement(\"a\");\n\t\timg.setAttribute('src', value);\n\t\tinput.appendChild(img);\n\t}\n\treturn input;\n}\n\nmodule.exports={HTMLImageViewer}\n\n\n","function HTMLImageEditor(options){}\nHTMLImageEditor.prototype.renderFrame = function(frame, dataviewer){\n\tif(this.type == \"xsd:base64Binary\"){\n\t\tvar input = document.createElement(\"textarea\");\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\n\t\tinput.value = value;\n\t\tinput.addEventListener(\"change\", function(){\n\t\t\tframe.set(this.value);\n\t\t});\n\t\treturn input;\n\t}\n\treturn false;\n}\n\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\n\tthis.options(options);\n}\n\nHTMLLinkViewer.prototype.options = function(options){\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\n}\n\nHTMLLinkViewer.prototype.renderFrame = function(frame, dataviewer){\n\treturn this.render(frame.get());\n}\n\nHTMLLinkViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\t\nHTMLLinkViewer.prototype.render = function(value){\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', this.css);\n\tinput.setAttribute('size', 80);\n\tinput.setAttribute('data-value', value);\n\tif(value){\n\t\tvar a = document.createElement(\"a\");\n\t\ta.setAttribute('href', value);\n\t\ta.appendChild(document.createTextNode(value));\n\t\tinput.appendChild(a);\n\t}\n\treturn input;\n}\n\nmodule.exports={HTMLLinkViewer}\n\n","const TerminusClient = require('@terminusdb/terminus-client');\n\nfunction HTMLNumberViewer(options){\n\tthis.options(options);\n}\n\nHTMLNumberViewer.prototype.options = function(options){\n\tthis.commas = (options && options.commas ? options.commas : true);\n}\n\nHTMLNumberViewer.prototype.renderFrame = function(frame, dataviewer){\n\treturn this.render(frame.get());\n}\n\nHTMLNumberViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\t\nHTMLNumberViewer.prototype.render = function(value){\n\tif(value === 0) value = \"0\";\n\tvar input = document.createElement(\"span\");\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\n\tinput.setAttribute('data-value', value);\n\tvalue = (this.commas ? TerminusClient.UTILS.TypeHelper.numberWithCommas(value) : value);\n\tinput.appendChild(document.createTextNode(value));\n\treturn input;\n}\n\nmodule.exports={HTMLNumberViewer}\n","const TerminusClient = require('@terminusdb/terminus-client');\n\nfunction HTMLRangeViewer(options){\n\tthis.options(options);\n}\n\nHTMLRangeViewer.prototype.options = function(options){\n\tthis.commas = (options && options.commas ? options.commas : true);\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\n}\n\nHTMLRangeViewer.prototype.renderFrame = function(frame, dataviewer){\n\treturn this.render(frame.get());\n}\n\nHTMLRangeViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\t\nHTMLRangeViewer.prototype.render = function(value){\n\tvar vals = TerminusClient.UTILS.TypeHelper.parseRangeValue(value, this.delimiter);\n\tvar d = document.createElement(\"span\");\n\td.setAttribute(\"class\", this.css);\n\tvar rvals = document.createElement(\"span\");\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\n\tvar svals = document.createElement(\"span\");\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\n\tvar x = (this.useCommas() ? TerminusClient.UTILS.TypeHelper.numberWithCommas(vals[0]) : vals[0]);\n\tvar tnode = document.createTextNode(x);\n\trvals.appendChild(tnode);\n\td.appendChild(rvals);\t\n\tif(vals.length == 2){\n\t\td.appendChild(getRangeSymbolDOM());\n\t\tvar x2 = (this.useCommas() ? TerminusClient.UTILS.TypeHelper.numberWithCommas(vals[1]) : vals[1]);\n\t\tvar t2node = document.createTextNode(x2);\n\t\tsvals.appendChild(t2node);\n\t\td.appendChild(svals);\t\n\t}\n\treturn d;\n}\n\nHTMLRangeViewer.prototype.useCommas = function(){\n\tif([\"xdd:gYearRange\", \"xdd:dateRange\"].indexOf(this.type) != -1) return false;\n\treturn this.commas;\n}\n\nfunction getRangeSymbolDOM(){\n\tvar d = document.createElement(\"span\");\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\n\td.appendChild(document.createTextNode(\" ... \"));\n\treturn d;\n}\n\nmodule.exports={HTMLRangeViewer}\n","const TerminusClient = require('@terminusdb/terminus-client');\nconst HTMLHelper = require('../HTMLHelper');\n\nfunction HTMLRangeEditor(options){\n\tthis.options(options);\n}\n\nHTMLRangeEditor.prototype.options = function(options){\n\tthis.commas = (options && options.commas ? options.commas : true);\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\n}\n\nHTMLRangeEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar vals = TerminusClient.UTILS.TypeHelper.parseRangeValue(value, this.delimiter);\n\tvar d = document.createElement(\"span\");\n\td.setAttribute(\"class\", this.css);\n\tvar rvals = document.createElement(\"span\");\n\tvar svals = document.createElement(\"span\");\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\n\tvar firstip = document.createElement(\"input\");\n\tfirstip.setAttribute('type', \"text\");\n\tfirstip.setAttribute('size', 16);\n\tif(data1){\n\t\tfirstip.value = data1;\n\t}\n\tvar secondip = document.createElement(\"input\");\n\tsecondip.setAttribute('type', \"text\");\n\tsecondip.setAttribute('size', 16);\n\tif(data2){\n\t\tthis.showing_range = true;\n\t\tsecondip.value = data2;\n\t}\n\trvals.appendChild(firstip);\n\td.appendChild(rvals);\t\n\tif(this.showing_range){\n\t\tsvals.appendChild(getRangeSymbolDOM());\n\t\tsvals.appendChild(secondip);\n\t}\n\td.appendChild(svals);\t\n\tvar but = document.createElement(\"button\");\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\n\tbut.appendChild(document.createTextNode(txt));\n\td.appendChild(but);\t\n\tvar self = this;\n\tbut.addEventListener(\"click\", function(){\n\t\tif(self.showing_range){\n\t\t\tself.showing_range = false;\n\t\t\tsecondip.value = \"\";\t\t\t\t\n\t\t\tHTMLHelper.removeChildren(svals);\n\t\t}\n\t\telse {\n\t\t\tself.showing_range = true;\n\t\t\tsecondip.value = \"\";\t\t\t\t\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\n\t\t\tsvals.appendChild(secondip);\n\t\t}\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\n\t\tbut.innerText = txt;\n\t\tchangeHandler();\n\t});\n\tvar changeHandler = function(){\n\t\tif(self.showing_range && secondip.value){\n\t\t\tif(firstip.value) frame.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\n\t\t\telse frame.set(secondip.value);\t\t\t\t\n\t\t}\n\t\telse {\n\t\t\tframe.set(firstip.value);\n\t\t}\n\t}\n\tfirstip.addEventListener(\"change\", changeHandler);\n\tsecondip.addEventListener(\"change\", changeHandler);\n\treturn d;\n}\n\nfunction getRangeSymbolDOM(){\n\tvar d = document.createElement(\"span\");\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\n\td.appendChild(document.createTextNode(\" ... \"));\n\treturn d;\n}\n\nmodule.exports={HTMLRangeEditor}\n","const GoogleMapHelper = require(\"./GoogleMapHelper\")\nfunction GoogleMapEditor(options){}\n\nGoogleMapEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar mapcontainer = document.createElement(\"div\");\n\tmapcontainer.setAttribute('class', \"gmap-window gmap-editor\");\n\tvar self = this;\n\tvar ghelper = new GoogleMapHelper();\n\tvar map = ghelper.initMap(mapcontainer, value, this.type);\n    if(ty == \"xdd:coordinate\"){\n\t    google.maps.event.addListener(map, 'click', function(event) {\n\t    \tvar position = event.latLng;\n\t    \tvar coo = \"[\" + position.lat() + \",\" + position.lng() + \"]\";\n\t    \tdataviewer.set(coo);\n\t        ghelper.clearMarkers();\n\t        var init = {\n\t    \t\tposition: position, \n\t    \t\tmap: map\n\t    \t}\n\t    \tvar marker = new google.maps.Marker(init);\n\t    \tghelper.markers.push(marker);\n\t  \t});\n\t}\n    else {\n    \tgoogle.maps.event.addListener(map, 'click', function(event) {\n        \tvar path = ghelper.polyline.getPath();\n        \tpath.push(event.latLng);\n      \t    var position = event.latLng;\n      \t    ghelper.addMarker(position, map, frame, '#' + path.getLength(), this.type);\n      \t});\n    }\n    return mapcontainer;\n}\n\nmodule.exports={GoogleMapEditor};","const GoogleMapHelper = require(\"./GoogleMapHelper\")\n\nfunction GoogleMapViewer(options){}\n\nGoogleMapViewer.prototype.renderFrame = function(frame, dataviewer){\n\treturn this.render(frame.get());\n}\n\nGoogleMapViewer.prototype.renderValue = function(dataviewer){\n\treturn this.render(dataviewer.value());\n}\n\t\nGoogleMapViewer.prototype.render = function(value){\n\tvar map = document.createElement(\"div\");\n\tmap.setAttribute('class', \"gmap-window gmap-viewer\");\n\tvar self = this;\n\tvar ghelper = new GoogleMapHelper();\n\tghelper.initMap(map, value, this.type);\t\t\n    return map;\n}\n\nmodule.exports={GoogleMapViewer};","function HTMLMarkupEditor(options){}\n\nHTMLMarkupEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar input = document.createElement(\"div\");\n\tinput.setAttribute('class', \"html-wysiwyg\");\n\tvar inner = document.createElement(\"span\");\n\tinner.setAttribute('class', \"html-literal literal-value\");\n\tinner.innerHTML=value;\n\tinput.appendChild(inner);\n\tif(typeof Quill != \"undefined\"){\n\t\tvar quill = new Quill(inner, { theme: 'snow' });\n\t\tquill.on(\"text-change\", function(){\n\t\t\tframe.set(quill.root.innerHTML);\n\t\t});\n\t}\n\treturn input;\n}\n\nmodule.exports={HTMLMarkupEditor}","function S2EntityEditor(options){}\n\nS2EntityEditor.prototype.renderFrame = function(frame, dataviewer){\n\tvar value = frame.get();\n\tvar cls = frame.range();\n\tvar cback = frame.set;\n\tvar ctl = dataviewer.getClient();\n\tvar d2ch = new TerminusDocumentChooser(ctl, cls, value);\n\td2ch.change = function(val){\n\t\tframe.set(val);\n\t}\n\td2ch.view = \"label\";\n\tvar d2dom = d2ch.getAsDOM();\n\treturn d2dom;\n}\n\n\nmodule.exports={S2EntityEditor}","const HTMLHelper = require('../HTMLHelper');\n\nfunction SimpleTable(){\n\tthis.holder = document.createElement(\"div\");\n\tthis.holder.setAttribute('class', 'terminus-simple-table-holder')\n}\n\nSimpleTable.prototype.options = function(options){\n\tfor(var k in options){\n\t\tthis[k] = options[k];\n\t}\n\treturn this;\n}\n\n\nSimpleTable.prototype.render = function(woqltable){\n\tif(woqltable) this.woqltable = woqltable;\n\tHTMLHelper.removeChildren(this.holder);\n\tvar ctls = this.getControlsDOM();\n\tvar tab = this.getTableDOM();\n\tif(ctls) this.holder.appendChild(ctls)\n\tthis.holder.appendChild(tab);\n\treturn this.holder;\n}\n\nSimpleTable.prototype.getControlsDOM = function(result){\n\tvar ctrls = document.createElement(\"span\");\n\tif(this.woqltable.config.pager()){\n\t\tvar paging = this.getPaging(result);\n\t\tif(paging) ctrls.appendChild(paging);\n\t}\n\treturn ctrls;\n}\n\nSimpleTable.prototype.getTableDOM = function(){\n\tconst columns = this.woqltable.getColumnsToRender();\n\tvar tab = document.createElement(\"table\");\n\ttab.setAttribute(\"class\", \"terminus-hover-table terminus-simple-table\");\n\tvar thead = this.getTableHeader(columns);\n\ttab.appendChild(thead);\n\tvar tbody = this.getTableBody(columns);\n\ttab.appendChild(tbody);\n\treturn tab;\n}\n\nSimpleTable.prototype.getTableHeader = function(cols){\n\tvar thead = document.createElement(\"thead\");\n\tvar thr = document.createElement(\"tr\");\n\tfor(var i = 0; i<cols.length; i++){\n\t\tvar th = this.getColumnHeader(cols[i]);\n\t\tthr.appendChild(th);\n\t}\n\tthead.appendChild(thr);\n\treturn thead;\n}\n\nSimpleTable.prototype.getColumnHeader = function(colid){\n\tvar th = document.createElement(\"th\");\n\tth.setAttribute('class', 'terminus-table-header-full-css');\n\tvar clab = this.woqltable.getColumnHeaderContents(colid);\n\tif(clab) th.appendChild(clab);\n\treturn th;\n}\n\nSimpleTable.prototype.getTableBody = function(cols){\n\tvar tbody = document.createElement(\"tbody\");\n\twhile(row = this.woqltable.next()){\n\t\tvar tr = this.getHTMLRow(row, cols);\n\t\tif(tr) tbody.appendChild(tr);\n\t}\n\treturn tbody;\n}\n\nSimpleTable.prototype.getHTMLRow = function(row, cols){\n\tvar tr = document.createElement(\"tr\");\n\tfor(var i = 0; i<cols.length; i++){\n\t\tvar td = this.getCell(cols[i], row);\n\t\ttr.appendChild(td);\n\t}\n\tvar self = this;\n\tif(this.woqltable.hasRowClick(row)){\n\t\tvar rc = this.woqltable.getRowClick(row);\n\t\ttr.addEventListener(\"click\", function(){\n\t\t\trc(row);\n\t\t});\n\t\ttr.addEventListener(\"mouseover\", function(){\n\t\t\tthis.style.cursor = \"pointer\";\n\t\t});\n\t}\n\tif(this.woqltable.hasRowHover(row)){\n\t\tvar rc = this.woqltable.getRowHover(row);\n\t\ttr.addEventListener(\"mouseover\", function(){\n\t\t\trc(row);\n\t\t});\n\t}\n\treturn tr;\n}\n\nSimpleTable.prototype.getCell = function(key, row){\n\tvar td = document.createElement(\"td\");\n\tif(this.woqltable.hasCellClick(row, key)){\n\t\tvar rc = this.woqltable.getCellClick(row, key);\n\t\ttd.addEventListener(\"click\", function(){\n\t\t\trc(row);\n\t\t});\n\t\ttd.addEventListener(\"mouseover\", function(){\n\t\t\tthis.style.cursor = \"pointer\";\n\t\t});\n\t}\n\tif(this.woqltable.hasCellHover(row, key)){\n\t\tvar rc = this.woqltable.getCellHover(row, key);\n\t\ttr.addEventListener(\"mouseover\", function(){\n\t\t\trc(row);\n\t\t});\n\t}\n\tvar c = this.getCellData(key, row);\n\tif(c) td.appendChild(c);\n\treturn td;\n}\n\nSimpleTable.prototype.getCellData = function(key, row){\n\tvar renderer = this.woqltable.getRenderer(key, row);\n\tif(renderer && typeof renderer == \"function\"){\n\t\treturn renderer(row[key], key, row);\n\t}\n\telse if(renderer && typeof renderer == \"object\"){\n\t\treturn this.woqltable.renderValue(renderer, row[key], key, row);\n\t}\n\tvar val = row[key]\n\tif(Array.isArray(val)){\n\t\tlet nval = \"\";\n\t\tfor(var i = 0; i<val.length; i++){\n\t\t\tnval += (val[i][\"@value\"] ? val[i][\"@value\"] : val[i]);\n\t\t\tif(i < (val.length -1)) nval += \", \";\n\t\t}\n\t\tval = nval;\n\t}\n\telse {\n\t\tif(val && val['@value']) val = val['@value'];\n\t}\n\treturn document.createTextNode(val);\n}\n\nSimpleTable.prototype.getPaging = function(){\n\tif(this.woqltable.result.query.isPaged()){\n\t\tvar pdom = document.createElement(\"div\");\n\t\tpdom.setAttribute(\"class\", \"table-page-size\");\n\t\tif(this.woqltable.config.pagesize()){\n\t\t\tlet psdom = this.getPageSize();\n\t\t\tif(psdom) pdom.appendChild(psdom);\n\t\t}\n\t\tif(this.woqltable.canChangePage()){\n\t\t\tvar pn = this.woqltable.result.query.getPage();\n\t\t\tif(pn > 2){\n\t\t\t\tpdom.appendChild(this.getFirst());\n\t\t\t}\n\t\t\tif(pn > 1){\n\t\t\t\tpdom.appendChild(this.getPrev(pn));\n\t\t\t}\n\t\t\tif(this.woqltable.config.page()) pdom.appendChild(this.getPageNumber(pn));\n\t\t\tpdom.appendChild(this.getNext(this.woqltable.result));\n\t\t}\n\t\treturn pdom;\n\t}\n}\n\nSimpleTable.prototype.showPaging = function(){\n\tif(this.woqltable.result.query.isPaged() && this.woqltable.config.pager() && this.woqltable.canChangePage()) return true;\n\treturn false;\n}\n\n\nSimpleTable.prototype.getPageSize = function(){\n\tif(this.showPaging()){\n\t\tvar chunk = document.createElement(\"span\");\n\t\tchunk.setAttribute(\"class\", \"woql-table-pagesize\");\n\t\tclabel = document.createElement(\"span\");\n\t\tclabel.appendChild(document.createTextNode(\"Page Size\"));\n\t\tchunk.appendChild(clabel);\n\t\tif(this.woqltable.config.change_pagesize){\n\t\t\tvar ctl = document.createElement(\"input\");\n\t\t\tctl.setAttribute(\"size\", 6);\n\t\t\tvar self = this;\n\t\t\tctl.value = this.woqltable.getPageSize();\n\t\t\tctl.addEventListener(\"blur\", function(){\n\t\t\t\tvar pval = (this.value ? parseInt(this.value) : false);\n\t\t\t\tself.woqltable.setPageSize(pval);\n\t\t\t});\n\t\t\tchunk.appendChild(ctl);\n\t\t}\n\t\telse {\n\t\t\tchunk.appendChild(document.createTextNode(this.woqltable.getPageSize()));\n\t\t}\n\t\treturn chunk;\n\t}\n\treturn false;\n}\n\nSimpleTable.prototype.getPageNumber = function(){\n\tvar ctl = document.createElement(\"input\");\n\tctl.setAttribute(\"size\", 4);\n\tctl.value = this.woqltable.result.query.getPage();\n\tvar self = this;\n\tctl.addEventListener(\"blur\", function(){\n\t\tvar pval = (this.value ? parseInt(this.value) : false);\n\t\tself.woqltable.setPage(pval);\n\t});\n\treturn ctl;\n}\n\nSimpleTable.prototype.getNext = function(result){\n\tvar ctl = document.createElement(\"button\");\n\tvar self = this;\n\tctl.appendChild(document.createTextNode(\"next\"));\n\tif(!this.woqltable.canAdvancePage(result)){\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\n\t}\n\telse {\n\t\tctl.addEventListener(\"click\", function(){\n\t\t\tself.woqltable.nextPage();\n\t\t});\n\t}\n\treturn ctl;\n}\n\nSimpleTable.prototype.getPrev = function(result){\n\tvar ctl = document.createElement(\"button\");\n\tctl.appendChild(document.createTextNode(\"previous\"));\n\tvar self = this;\n\tif(!this.woqltable.canRetreatPage(result)){\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\n\t}\n\telse {\n\t\tctl.addEventListener(\"click\", function(){\n\t\t\tself.woqltable.previousPage();\n\t\t});\n\t}\n\treturn ctl;\n}\n\nSimpleTable.prototype.getFirst = function(result){\n\tvar ctl = document.createElement(\"button\");\n\tctl.appendChild(document.createTextNode(\"first\"));\n\tvar self = this;\n\tif(!this.woqltable.canRetreatPage(result) || this.woqltable.getPage() <= 2){\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\n\t}\n\telse {\n\t\tctl.addEventListener(\"click\", function(){\n\t\t\tself.woqltable.firstPage();\n\t\t});\n\t}\n\treturn ctl;\n}\n\nmodule.exports = SimpleTable;\n","const HTMLHelper = require('../HTMLHelper');\nconst GraphResultsViewer = require('./GraphResultsViewer');\n\n\nfunction SimpleGraph(){\n\tthis.holder = document.createElement(\"div\");\n}\n\nSimpleGraph.prototype.setResult = function(result){\n\tthis.result = result;\n}\n\nSimpleGraph.prototype.render = function(wgraph){\n\tthis.graph = wgraph;\n\tHTMLHelper.removeChildren(this.holder);\n\t//var ctls = this.getControlsDOM(result);\n\tvar tab = this.getGraphDOM(this.result);\n\t//if(ctls) this.holder.appendChild(ctls)\n\tthis.holder.appendChild(tab);\n\treturn this.holder;\n}\n\n\nSimpleGraph.prototype.getGraphDOM = function(){\n\tthis.gviz = new GraphResultsViewer(this.graph.config);\n\tvar gdom = this.gviz.getAsDOM();\n\tvar h = this.graph.config.height() ? this.graph.config.height() : 800;\n\tvar w = this.graph.config.width() ? this.graph.config.width() : 800;\n\tgdom.setAttribute(\"style\", \"border: 1px solid #aaa; width: \" + w + \"px; height: \" + h + \"px; \" + this.graph.config.width() + \"px\");\n\tthis.gviz.setData(this.graph);\n\tthis.gviz.initDOM(gdom);\n\treturn gdom;\n}\n\nmodule.exports = SimpleGraph;\n","const HTMLHelper = require('../HTMLHelper');\n\nfunction GraphResultsViewer(config) {\n\tthis.svg;\n\tthis.visid = randomString(8);\n\tthis.currentDate = Date.now() / 1000; // nowish\n\t// Individual links, nodes and text graphical elements\n\tthis.link_elements;\n\tthis.node_elements;\n\t// DOM object that this this is directly drawn into\n\tthis.container = false;\n\t// Map of ids to loaded nodes for ease\n\tthis.loadedNodes = {};\n\tthis.focusNodes = [];\n\t// Currently displayed nodes and links\n\tthis.nodes;\n\tthis.links;\n\t// Var for selecting and deselecting elements\n\tthis.selected_id;\n\tthis.setConfigOptions(config);\n}\n\n/*\n * Loads the graph with new data and optionally starts the animation\n */\nGraphResultsViewer.prototype.load = function(show) {\n\tthis.initD3(this.d3DOM);\n\tthis.loadNewData();\n\tthis.updateGraph();\n\tif(show){\n\t\tthis.updateSimulation(\"init\");\n\t}\n}\n\n/*\n * Called to issue a new set of datapoints\n */\nGraphResultsViewer.prototype.setData = function(dqr, show){\n\t//this.setFocusNodeFromResult(dqr);\n\tif(this.result){\n\t\tthis.clear();\n\t}\n\tthis.result = dqr;\n\t//if(this.svg){\n\t\tthis.load(show);\n\t//}\n}\n\nGraphResultsViewer.prototype.loadNewData = function(){\n\t//this.nodes = jQuery.extend(true, [], this.result.getNodes());\n\tthis.nodes = this.copyNodes(this.result.getNodes());\n\tfor(var i = 0 ; i<this.nodes.length; i++){\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\n\t}\n\tthis.links = this.result.getEdges();\n\t//this.browser.rebuildController();\n}\n\nGraphResultsViewer.prototype.copyNodes = function(arr){\n\tvar narr = [];\n\tfor(var i = 0; i<arr.length; i++){\n\t\tvar obj = arr[i];\n\t\tvar nobj = {};\n\t\tfor(k in obj){\n\t\t\tnobj[k] =obj[k];\n\t\t}\n\t\tnarr.push(nobj);\n\t}\n\treturn narr;\n}\n\n/*\n * Called to indicate that the current set of datapoints has been updated\n */\nGraphResultsViewer.prototype.updateData = function(dqr, show) {\n\tthis.setFocusNodeFromResult(dqr);\n\tthis.result = dqr;\n\tthis.reload(show, \"update\", this.fix_nodes);\n}\n\nGraphResultsViewer.prototype.setFocusNodeFromResult = function(dqr) {\n\tvar fn = dqr.getFocusNode();\n\tif(fn){\n\t\tthis.selected_id = fn;\n\t\tthis.focusNodes.push(fn);\n\t}\n}\n\n/*\n * Called to indicate that the filter setting has been changed on the current datapoints\n */\nGraphResultsViewer.prototype.setFilter = function(dqr, show){\n\tthis.simulation.stop();\n\tthis.reload(show, \"filter\", true);\n}\n\nGraphResultsViewer.prototype.wake = function() {\n\tif(this.simulation)\tthis.updateSimulation(\"wake\");\n}\n\nGraphResultsViewer.prototype.hibernate = function() {\n\tthis.simulation.stop();\n}\n\n/*\n * Called when more data is added to the result but the query remains the same\n */\nGraphResultsViewer.prototype.reload = function(show, mode, no_animate) {\n\tfor(var i = 0 ; i<this.nodes.length; i++){\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\n\t}\n\t//var nnodes = jQuery.extend(true, [], this.result.getNodesAndFringes());\n\tvar nnodes = this.copyNodes(this.result.getNodesAndFringes());\t\n\tthis.nodes = [];\n\tvar snode = this.loadedNodes[this.selected_id];\n\tfor(var i = 0 ; i<nnodes.length; i++){\n\t\tvar nnode = nnodes[i];\n\t\tif(this.loadedNodes[nnode.id]){\n\t\t\tif(nnode.id == this.selected_id){\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\n\t\t\t}\n\t\t\telse if(!no_animate) {\n\t\t\t\tthis.loadedNodes[nnode.id].fx = null;\n\t\t\t\tthis.loadedNodes[nnode.id].fy = null;\n\t\t\t}\n\t\t\telse if(this.loadedNodes[nnode.id].x){\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif(this.explode_out && snode.x){\n\t\t\t\tnnode.x = snode.x;\n\t\t\t\tnnode.y = snode.y;\n\t\t\t}\n\t\t\tthis.loadedNodes[nnode.id] = nnode;\n\t\t}\n\t\tthis.nodes.push(this.loadedNodes[nnode.id]);\n\t}\n\tthis.links = this.result.getLinks();\n\tthis.updateGraph();\n\tif(show){\n\t\t//this.browser.rebuildController();\n\t\tthis.updateSimulation(mode);\n\t}\n}\n\nGraphResultsViewer.prototype.clear = function() {\n\tthis.nodes = [];\n\tthis.loadedNodes = {};\n\tthis.links = [];\n\tthis.updateGraph();\n\tHTMLHelper.removeChildren(this.d3DOM);\n\tthis.scale_factor = 1;\n}\n\n/*\n * Called to initialise the DOM when it is first loaded (called after setData)\n */\nGraphResultsViewer.prototype.initDOM = function(vdom) {\n\tif(!this.width) this.width = this.setWidth();\n\tif(!this.height) this.height = this.setHeight();\n\tthis.d3DOM = vdom;\n\tif(this.result){\n\t\tthis.load(true);\n\t}\n}\n\n/*\n * Generate the div that contains the visualisation panel\n */\nGraphResultsViewer.prototype.getAsDOM = function() {\n\tvar vdom = document.createElement(\"div\");\n\tvdom.setAttribute(\"class\", \"terminus-gviz-panel\");\n\tvdom.setAttribute(\"id\", this.visid);\n\tvdom.setAttribute(\"width\", \"100%\");\n\tthis.container = vdom;\n\treturn vdom;\n}\n\n/*\n * Calculates the width of the container area available for the SVG\n */\nGraphResultsViewer.prototype.setWidth = function() {\n\tif(this.container && this.container.clientWidth){\n\t\tthis.width = this.container.clientWidth;\n\t}\n\telse if(this.container.parentNode && this.container.parentNode.clientWidth){\n\t\tthis.width = this.container.parentNode.clientWidth;\n\t}\n\telse {\n\t\tvar w = 0; \n\t\tif(typeof jQuery != \"undefined\"){\n\t\t\tw = jQuery(this.container).width();\n\t\t\tif(w == 0){\n\t\t\t\tw = jQuery(this.container.parentNode).width();\n\t\t\t}\n\t\t}\n\t\tif(w == 0) {\n\t\t\tw = 800;\n\t\t}\n\t\tthis.width = w;\n\t}\n\treturn this.width;\n}\n\nGraphResultsViewer.prototype.setHeight = function() {\n\tif(this.container && this.container.clientHeight){\n\t\tthis.height = this.container.clientHeight;\n\t}\n\telse if(this.container.parentNode && this.container.parentNode.clientHeight){\n\t\tthis.height = this.container.parentNode.clientHeight;\n\t}\n\telse {\n\t\tvar w = 0;\n\t\tif(typeof jQuery != \"undefined\"){\n\t\t\tjQuery(this.container).height();\n\t\t\tif(w == 0){\n\t\t\t\tw = jQuery(this.container.parentNode).height();\n\t\t\t}\n\t\t}\n\t\tif(w == 0) {\n\t\t\tw = 800;\n\t\t}\n\t\tthis.height = w;\n\t}\n\treturn this.height;\n}\n\n\nGraphResultsViewer.prototype.initD3 = function(jqid) {\n\tvar self = this;\n\n\t/********************* Seed the data **************************/\n\tthis.svg = d3.select(jqid).append(\"svg\")\n\t\t.attr(\"width\", this.width)\n\t\t.attr(\"height\", this.height);\n\n\tvar distanceFun = function(link){\n\t\treturn self.getLinkDistance(link);\n\t}\n\n\t// create the force object\n\tthis.simulation  = d3.forceSimulation()\n\t\t//link distance varies with link type\n\t    .force(\"link\", d3.forceLink().distance(distanceFun).id(function(link) { return link.id; }))\n\t    //charge is the same for all nodes\n\t    .force('charge', d3.forceManyBody().strength(function(node){ return self.getCharge(node)}))\n\t    //collision radius changes with node type\n\t    .force('collision', d3.forceCollide().radius(function(node) {\n\t    \treturn (self.getCollisionRadius(node));\n\t    }))\n\t\t.force(\"center\", d3.forceCenter(this.width / 2, this.height / 2));\n\n\t// node drag\n\tthis.drag_drop = d3.drag()\n\t\t.on('start', function(node) {\n\t\t\tnode.fx = node.x\n\t\t\tnode.fy = node.y\n\t\t})\n\t\t.on('drag', function(node) {\n\t\t\tself.simulation.restart()\n\t\t\tnode.fx = d3.event.x;\n\t\t\tnode.fy = d3.event.y;\n\t\t})\n\t\t.on('end', function(node) {\n\t\t\tnode.fx = null;\n\t\t\tnode.fx = null;\n\t\t\tself.simulation.stop()\n\t\t});\n\n\tthis.svg.append(\"rect\")\n\t   .attr(\"width\", this.width)\n\t   .attr(\"height\", this.height)\n\t   .style(\"fill\", \"none\")\n\t   .style(\"pointer-events\", \"all\")\n\t   .call(d3.zoom().on(\"zoom\", function(){self.zoomed()}));\n\n\t// Append graphic element to svg which are groups for graph elements\n\tthis.link_group = this.svg.append(\"g\").classed(\"links\", true);\n\tthis.node_group = this.svg.append(\"g\").classed(\"nodes\", true);\n}\n\nGraphResultsViewer.prototype.zoomed = function() {\n\tthis.current_transform = d3.event.transform;\n\tif(this.node_elements)\n\t\tthis.node_elements.attr(\"transform\", d3.event.transform);\n    if(this.link_elements)\n    \tthis.link_elements.attr(\"transform\", d3.event.transform);\n}\n\n/***\n * updates the svg with the current nodes and links\n */\nGraphResultsViewer.prototype.updateGraph = function(nodes, links) {\n\tvar self = this;\n\n\tvar follow_node_wrapper = function(graph_node){\n\t\tself.nodeSelected(graph_node);\n\t}\n\tvar zoomed = function(){\n\t\tself.zoomed();\n\t}\n\n\tnodes = (typeof nodes != \"undefined\" ? nodes : this.nodes);\n\tlinks = (typeof links != \"undefined\" ? links : this.links);\n\tthis.node_elements  = this.node_group.selectAll(\"g\").data(nodes);\n\tthis.node_elements.exit().remove();\n\n\t/*Create and place the \"blocks\" containing the circle and the text */\n    var node_enter = this.node_elements.enter().append(\"g\");\n\n\t// enter and create new ones\n\tnode_enter.append(\"circle\")\n\t\t.style('opacity', 0.99)\n\t\t.attr('r', function(node){return self.getRadius(node)})\n\t\t.attr(\"cx\",  function(node){ return node.x})\n\t\t.attr(\"cy\",  function(node){ return node.y})\n\t\t.attr(\"type\", function(node) {return self.isFringe(node) ? \"fringe\" : \"node\"})\n\t\t.call(self.drag_drop)\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\n\t\t.on('click', follow_node_wrapper);\n\n    node_enter.append(\"text\")\n\t\t.attr(\"x\",  function(node){ return node.x})\n\t\t.attr(\"y\",  function(node){ return node.y})\n\t\t.text(function(node) { return self.getNodeIconUnicode(node)})\n\t\t.call(self.drag_drop)\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\n\t\t.on('click', follow_node_wrapper);\n\n\t// merge new and old nodes\n\tthis.node_elements = node_enter.merge(this.node_elements);\n\n\tthis.styleNodeElements();\n\n\t// update LINKS ********************************************\n\tthis.link_elements  = this.link_group.selectAll(\"line\").data(links);\n\n\t// remove old links\n\tthis.link_elements.exit().remove();\n\t// enter and create new ones\n\tvar link_enter = this.link_elements.enter().append(\"line\");\n\n\t// merge new and old links\n\tthis.link_elements = link_enter.merge(this.link_elements)\n\n\tthis.styleLinkElements();\n\n\t//execute the current state of the pan-zoom transform\n\tif(this.current_transform){\n\t\tif(this.node_elements)\n\t\t\tthis.node_elements.attr(\"transform\", this.current_transform);\n\t    if(this.link_elements)\n\t    \tthis.link_elements.attr(\"transform\", this.current_transform);\n\t}\n}\n\nGraphResultsViewer.prototype.updateSimulation = function(mode) {\n\tvar self = this;\n\t//move all of the graphical elements corresponding to the nodes with each tick\n\tvar ticker = function(){\n\t\tself.node_elements.selectAll(\"circle\")\n\t\t\t.attr(\"cx\",  function(node){ return node.x})\n\t\t\t.attr(\"cy\",  function(node){ return node.y});\n\t\tself.node_elements.selectAll(\"text\")\n\t\t\t.attr(\"x\",  function(node){ return node.x})\n\t\t\t.attr(\"y\",  function(node){ return node.y});\n\t\tself.link_elements\n\t\t\t.attr('x1', function(link){ return link.source.x})\n\t\t\t.attr('y1', function(link){ return link.source.y})\n\t\t\t.attr('x2', function(link){ return link.target.x})\n\t\t\t.attr('y2', function(link){ return link.target.y});\n\t}\n\tif(this.show_force){\n\t\tthis.simulation.nodes(this.nodes).on('tick', ticker).force('link').links(this.links);\n\t}\n\telse {\n\t\tthis.simulation.nodes(this.nodes).on('end', ticker).force('link').links(this.links);\n\t}\n\tif(this.nodes.length){\n\t\tif(mode == \"wake\" || mode == \"init\"){\n\t\t\tthis.simulation.restart();\n\t\t}\n\t\telse if(mode == \"filter\"){\n\t\t\tthis.simulation.restart();\n\t\t}\n\t\telse {\n\t\t\tthis.simulation.alpha(1).restart();\n\t\t}\n\t}\n}\n\nGraphResultsViewer.prototype.styleNodeElements = function() {\n\tvar self = this;\n\tif(this.node_elements){\n\t\tthis.node_elements.each(function(node){\n\t\t\tvar g = d3.select(this);\n\t\t\tvar sel = g.select(\"circle\");\n\t\t\tsel.select(\"title\").remove();\n\t\t\tsel.style(\"fill\", self.getNodeColour(node));\n\t\t\tsel.attr('r', self.getRadius(node));\n\t\t\tsel.classed(\"highlighted\", function(node) { return self.focusNodes.indexOf(node.id) != -1});\n\t\t\tsel.append(\"title\")\n\t\t\t\t.classed(\"terminus-gnode-title\", true)\n\t\t\t\t.text(self.getNodeText(node));\n\t\t\tvar txt = g.select(\"text\");\n\t\t\ttxt.select(\"title\").remove();\n\t\t\ttxt.attr('text-anchor', 'middle')\n\t\t\t\t.attr(\"title\", self.getNodeText(node))\n\t\t\t\t.attr('dominant-baseline', 'central')\n\t\t\t\t.style('font-family', \"'\" + self.fontfam + \"'\")\n\t\t\t\t.style('font-weight', self.getNodeIconWeight(node))\n\t\t\t\t.style('font-size', self.getNodeIconSize(node))\n\t\t\t\t.style(\"fill\", self.getNodeIconColour(node))\n\t\t\t\t.text(self.getNodeIconUnicode(node))\n\t\t\t\t.append(\"title\")\n\t\t\t\t\t.classed(\"terminus-gnode-title\", true)\n\t\t\t\t\t.text(self.getNodeText(node));\n\t\t});\n\t}\n}\n\nGraphResultsViewer.prototype.styleLinkElements = function() {\n\tvar self = this;\n\tif(this.link_elements){\n\t\tthis.link_elements.each(function(link){\n\t\t\tvar sel = d3.select(this);\n\t\t\tsel.select(\"title\").remove();\n\t\t\tsel.attr(\"stroke-width\", self.getLineWidth(link));\n\t\t\tsel.attr(\"marker-end\", self.getEdgeArrow(link));\n\t\t\tsel.style(\"stroke\", self.getEdgeColour(link));\n\t\t\tsel.append(\"title\")\n\t\t\t\t.classed(\"terminus-glink-title\", true)\n\t\t\t\t.text(self.getLinkText(link));\n\t\t});\n\t}\n}\n\nGraphResultsViewer.prototype.getEdgeArrow = function(edge) {\n\tif(edge){\n\t\tvar dir = this.getEdgeDirection(edge);\n\t\t//if(dir){\n\t\t\tvar col = this.getEdgeColour(edge);\n\t\t\tvar reference;\n\t\t\tthis.svg.append(\"svg:defs\").selectAll(\"marker\")\n\t\t\t\t.data([reference])\n\t\t\t\t.enter().append(\"svg:marker\")\n\t\t\t\t.attr(\"id\", String)\n\t\t\t\t.attr(\"viewBox\", \"0 -5 10 10\")\n\t\t\t\t.attr(\"refX\", 22)  // This sets how far back it sits, kinda\n\t\t\t\t.attr(\"refY\", 0)\n\t\t\t\t.attr(\"markerWidth\", this.getArrowWidth(edge))\n\t\t\t\t.attr(\"markerHeight\", this.getArrowHeight(edge))\n\t\t\t\t.attr(\"orient\", \"auto\")\n\t\t\t\t.attr(\"markerUnits\", \"userSpaceOnUse\")\n\t\t\t\t.append(\"svg:path\")\n\t\t\t\t\t.attr(\"d\", dir)\n\t\t\t\t\t.style(\"fill\", col);\n\t\t\t\treturn \"url(#\" + reference + \")\";\n\t\t//}\n\t}\n\treturn \"\";\n}\n\n\nGraphResultsViewer.prototype.nodeSelected = function(selected_node) {\n\tvar self = this;\n\tif(this.selected_id == selected_node.id && this.selection_grows){\n\t\tthis.selection_grows = false;\n\t\tthis.styleNodeElements();\n\t}\n\telse {\n\t\tthis.selection_grows = true;\n\t\tthis.selected_id = selected_node.id;\n\t\tthis.styleNodeElements();\n\t\t//this.browser.nodeSelected(selected_node);\n\t\tif(this.isFringe(selected_node)){\n\t\t\t//this.browser.followNode(selected_node);\n\t\t}\n\t}\n}\n\nGraphResultsViewer.prototype.getScaleTransform = function(x, y, scale_factor){\n\treturn \"scale(\"+ scale_factor + \") translate(\" + x + \",\" + y + \")\";\n}\n\nGraphResultsViewer.prototype.scale = function(min_ratio) {\n    // the new dimensions of the molecule\n    new_mol_width = this.width * min_ratio;\n    new_mol_height = this.height * min_ratio;\n\n    var y_trans = (this.height - new_mol_height) ;\n\n    var x_trans = (this.width - new_mol_width);\n    // do the actual moving\n    var self = this;\n    if(this.node_elements)\n    \tthis.node_elements.transition()\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\n    if(this.link_elements)\n        this.link_elements.transition()\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\n\tthis.scale_factor = min_ratio;\n\tthis.svg.selectAll(\"marker\").attr(\"markerWidth\", this.getArrowWidth())\n\t\t\t.attr(\"markerHeight\", this.getArrowHeight());\n}\n\n\nGraphResultsViewer.prototype.scaleToFit = function() {\n    // Center the view on the molecule(s) and scale it so that everything\n    // fits in the window\n    //no molecules, nothing to do\n    if (this.nodes.length === 0)\n        return;\n\n    // Get the bounding box\n    min_x = d3.min(this.nodes.map(function(d) {return d.x;}));\n    min_y = d3.min(this.nodes.map(function(d) {return d.y;}));\n    max_x = d3.max(this.nodes.map(function(d) {return d.x;}));\n    max_y = d3.max(this.nodes.map(function(d) {return d.y;}));\n\n    // The width and the height of the graph\n    mol_width = max_x - min_x;\n    mol_height = max_y - min_y;\n\n    mol_width = mol_width * 1.05;\n    mol_height = mol_height * 1.05;\n    // how much larger the drawing area is than the width and the height\n    width_ratio = this.width / mol_width;\n    height_ratio = this.height / mol_height;\n\n    // we need to fit it in both directions, so we scale according to\n    // the direction in which we need to scale the most\n    min_ratio = Math.min(width_ratio, height_ratio);\n    if(min_ratio < 1){\n    \tthis.scale(min_ratio);\n    }\n};\n\n// recentre graph\nGraphResultsViewer.prototype.recentre = function(graph_node) {\n\tthis.translated = true;\n\t// get the x and y you need to transform the nodes by\n\tthis.dcx = (this.width/2-graph_node.x);\n\tthis.dcy = (this.height/2-graph_node.y);\n\t//zoom.translate([dcx,dcy]); If we do zooming we'll need to do something here\n\tthis.node_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\n\tthis.link_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\n\tthis.text_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\n}\n\n\nGraphResultsViewer.prototype.setConfigOptions = function(config) {\n\t//configuration options for different types of behaviour\n\t// Need to explicitly know font family name for unicode glyphs\n\tthis.fontfam = (config && (config.fontfamily()) ? config.fontfamily() : 'Font Awesome 5 Free');\n\tthis.selected_grows = (config && typeof config.selected_grows() != \"undefined\" ? config.selected_grows() : true);\n\tthis.show_force = (config && typeof config.show_force() != \"undefined\" ? config.show_force() : true);\n\tthis.fix_nodes = (config && typeof config.fix_nodes() != \"undefined\" ? config.fix_nodes() : false);\n\tthis.explode_out = (config && typeof config.explode_out() != \"undefined\" ? config.explode_out(): false);\n\tthis.width = (config && config.width() ? config.width(): false);\n\tthis.height = (config && config.height() ? config.height(): false);\n\tthis.defaults = {\n\t\tedge: {\n\t\t\ttype: \"edge\",\n\t\t\tdistance: (config && config.edge && config.edge.distance ? config.edge.distance : 70),\n\t\t\tarrow: (config && config.edge && config.edge.arrow ? config.edge.arrow : { width: 36, height: 16}),\n\t\t\tsymmetric: (config && config.edge && config.edge.symmetric ? config.edge.symmetric : true),\n\t\t\tcolor: (config && config.edge && config.edge.color ? config.edge.color : [150,150,255]),\n\t\t\tweight: (config && config.edge && config.edge.weight ? config.edge.weight : 0.3),\n\t\t\tsize: (config && config.edge && config.edge.size ? config.edge.size : 4)\n\t\t},\n\t\tnode: {\n\t\t\ttype: \"node\",\n\t\t\tradius: (config && config.node && config.node.radius ? config.node.radius : 14),\n\t\t\tcharge: (config && config.node && config.node.charge ? config.node.charge : -60),\n\t\t\tcollisionRadius: (config && config.node && config.node.collisionRadius ? config.node.collisionRadius : 20),\n\t\t\tcolor: (config && config.node && config.node.color ? config.node.color : [0,255,255]),\n\t\t\ticon: {\n\t\t\t\tweight: (config && config.node && config.node.icon && config.node.icon.weight ? config.node.icon.weight : 900),\n\t\t\t\tcolor: (config && config.node && config.node.icon && config.node.icon.color ? config.node.icon.color : [0,0,255]),\n\t\t\t\tunicode: (config && config.node && config.node.icon && config.node.icon.unicode ? config.node.icon.unicode : \"\\uf4fb\"),\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.icon.size ? config.node.icon.size : 10),\n\t\t\t\tfaclass: (config && config.node && config.node.icon && config.node.icon.faclass ? config.node.icon.faclass : \"fas fa-user-astronaut\")\n\t\t\t},\n\t\t\ttext: {\n\t\t\t\tcolor: (config && config.node && config.node.text && config.node.text.color ? config.node.text.color : [0,0,0]),\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.text.size ? config.node.text.size : 10)\n\t\t\t},\n\t\t\tborder: {\n\t\t\t\tcolor: (config && config.node && config.node.border && config.node.border.color ? config.node.border.color : [0,0,0]),\n\t\t\t\tsize: (config && config.node && config.node.border && config.node.border.size ? config.node.border.size : 10)\n\t\t\t}\n\t\t}\n\t}\n}\n\n/*\n * Dimensions / forces / etc all settable with a scale factor - for zooming\n */\nGraphResultsViewer.prototype.getMultiplier = function(node) {\n\tvar mult = (node && node.size ? node.size : 1);\n\tif(node.id == this.selected_id && this.selection_grows){\n\t\tmult = mult * 2;\n\t}\n\treturn mult;\n}\n\nGraphResultsViewer.prototype.getRadius = function(node) {\n\tvar radius = (node && node.radius ? node.radius : this.defaults.node.radius);\n\tvar r = (this.scale_factor ? Math.min(this.scale_factor * radius, radius) : radius);\n\tr = r * this.getMultiplier(node);\n\treturn r;\n}\n\nGraphResultsViewer.prototype.getCollisionRadius = function(node) {\n\tvar colrad = (node && node.collisionRadius ? node.collisionRadius : this.defaults.node.collisionRadius );\n\tvar v = (this.scale_factor ? Math.min(this.scale_factor * colrad, colrad) : colrad);\n\treturn v * this.getMultiplier(node);\n}\n\nGraphResultsViewer.prototype.getCharge = function(node) {\n\tvar charge = (node && node.charge ? node.charge : this.defaults.node.charge);\n\tif(charge < 0){\n\t\tvar v = (this.scale_factor ? Math.max(this.scale_factor * charge, charge) : charge);\n\t}\n\telse {\n\t\tvar v = (this.scale_factor ? Math.min(this.scale_factor * charge, charge) : charge);\n\t}\n\treturn v * this.getMultiplier(node);\n}\n\nGraphResultsViewer.prototype.getLinkDistance = function(link) {\n\tvar linkDistance = (link && link.distance ? link.distance : this.defaults.edge.distance);\n\tvar x = (this.scale_factor ? Math.min(this.scale_factor * linkDistance, linkDistance) : linkDistance);\n\treturn x;\n}\n\nGraphResultsViewer.prototype.getNodeIconSize = function(node) {\n\tif(node && node.icon && node.icon.size){\n\t\treturn node.icon.size + \"em\";\n\t}\n\treturn (this.getMultiplier(node) + \"em\");\n}\n\nGraphResultsViewer.prototype.getNodeColour = function(node) {\n\tvar col = (node && node.color ? node.color : this.defaults.node.color);\n\tif(this.isFringe(node)){\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\n\t}\n\telse {\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\n\t}\n}\n\nGraphResultsViewer.prototype.getNodeIcon = function(node) {\n\tvar fac = (node && node.icon && node.icon.faclass ? node.icon.faclass : this.defaults.node.icon.faclass);\n\treturn fac;\n}\n\nGraphResultsViewer.prototype.getNodeIconUnicode= function(node) {\n\tif(node && typeof node.icon != \"undefined\"){\n\t\tif(node.icon.unicode){\n\t\t\treturn node.icon.unicode;\n\t\t}\n\t\tif(node.icon.label === true)\treturn this.getNodeText(node);\n\t\telse if(node.icon.label) return node.icon.label;\n\t}\n\treturn this.defaults.node.icon.unicode;\n}\n\nGraphResultsViewer.prototype.getNodeIconWeight = function(node) {\n\treturn (node && node.icon && node.icon.weight ? node.icon.weight : this.defaults.node.icon.weight );\n}\n\nGraphResultsViewer.prototype.getNodeIconColour = function(node) {\n\tvar col = (node && node.icon && node.icon.color ? node.icon.color : this.defaults.node.icon.color );\n\tif(this.isFringe(node)){\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\n\t}\n\telse {\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\n\t}\n}\n\nGraphResultsViewer.prototype.getEdgeColour = function(edge) {\n\tvar col = (edge && edge.color ? edge.color : this.defaults.edge.color );\n\tvar weight = (edge && edge.weight ? edge.weight : this.defaults.edge.weight);\n\tvar nc = col.concat([weight]);\n\treturn \"rgba(\"+nc.join(\",\")+\")\";\n}\n\nGraphResultsViewer.prototype.getEdgeDirection = function(edge) {\n\tif(edge && edge.symmetric){\n\t\treturn \"M10,-5 L0,0 L10,5\";\n\t}\n\treturn \"M0,-5 L10,0 L0,5\";\n\treturn false;\n}\n\nGraphResultsViewer.prototype.getLineWidth = function(link) {\n\tvar x = (link && link.size ? link.size : this.defaults.edge.size);\n\treturn x;\n}\n\n\nGraphResultsViewer.prototype.getNodeText = function(node) {\n\tif(node && node.text) return node.text;\n\treturn node.id;\n}\n\nGraphResultsViewer.prototype.getLinkText = function(edge) {\n\tif(edge && edge.text) return edge.text;\n\tif(edge && edge.id) return edge.id;\n\treturn \"\";\n}\n\nGraphResultsViewer.prototype.getArrowWidth = function(edge) {\n\tvar w = (edge && edge.arrow && edge.arrow.width ? edge.arrow.width : this.defaults.edge.arrow.width);\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\n}\n\nGraphResultsViewer.prototype.getArrowHeight = function(edge) {\n\tvar w = (edge && edge.arrow && edge.arrow.height ? edge.arrow.height : this.defaults.edge.arrow.height );\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\n}\n\nGraphResultsViewer.prototype.isNeighbourLink = function(node, link) {\n\treturn link.target.id === node.id || link.source.id === node.id;\n}\n\nGraphResultsViewer.prototype.isFringe = function(node){\n\tif(this.result && this.result.added && this.result.added.upgraded){\n\t\tif(this.result.added.upgraded.indexOf(node.id) != -1){\n\t\t\tnode.type = \"node\";\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn node.type && node.type == \"fringe\";\n}\n\nfunction randomString(length) {\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');\n    if (! length) {\n        length = Math.floor(Math.random() * chars.length);\n    }\n    var str = '';\n    for (var i = 0; i < length; i++) {\n        str += chars[Math.floor(Math.random() * chars.length)];\n    }\n    return str;\n}\n\nmodule.exports = GraphResultsViewer;\n","const HTMLHelper = require('../HTMLHelper');\n\nfunction SimpleStream(){\t\n\tthis.holder = document.createElement(\"div\");\n}\n\nSimpleStream.prototype.options = function(options){\n\tfor(var k in options){\n\t\tthis[k] = options[k];\n\t}\n\treturn this;\n}\n\n\nSimpleStream.prototype.render = function(stream){\n\tif(stream) this.stream = stream;\n\tHTMLHelper.removeChildren(this.holder);\n\t//var ctls = this.getControlsDOM();\n\t//var tab = this.getTableDOM();\n\t//if(ctls) this.holder.appendChild(ctls)\n\t//this.holder.appendChild(tab);\n\treturn this.holder;\n}\n\nmodule.exports = SimpleStream;","function SimpleChooser(){}\n\nSimpleChooser.prototype.options = function(options){\n\tthis.options = options;\n\treturn this;\n}\n\nSimpleChooser.prototype.render = function(chooser){\n\tif(chooser) this.chooser = chooser;\n\tif(this.chooser.config.show_empty() == false && this.chooser.count() < 1) return false;\n\tvar ccdom = document.createElement(\"span\");\n\tccdom.setAttribute(\"class\", \"woql-chooser\");\n\tvar ccsel = document.createElement(\"select\");\n\tccsel.setAttribute(\"class\", \" woql-chooser\");\n\tvar self = this;\n\tccsel.addEventListener(\"change\", function(){\n\t\tself.chooser.set(this.value);\n\t});\n\tvar opts = [];\n\tif(this.chooser.config.show_empty()){\n\t\topts.push(this.getEmptyOption())\n\t}\n\tthis.chooser.first();\n\twhile(choice = this.chooser.next()){\n\t\tvar opt = this.createOptionFromChoice(choice);\n\t\topts.push(opt);\n\t}\n\tfor(var i = 0; i<opts.length; i++){\n\t\tccsel.appendChild(opts[i]);\n\t}\n\tccdom.appendChild(ccsel);\n\treturn ccdom;\n}\n\nSimpleChooser.prototype.getEmptyOption = function(){\n\tvar choice = { id: \"\", label: this.chooser.config.show_empty()};\n\treturn this.createOptionFromChoice(choice);\n}\n\nSimpleChooser.prototype.createOptionFromChoice = function(choice){\n\tvar opt = document.createElement(\"option\");\n\topt.setAttribute(\"class\", \"terminus-woql-chooser-choice\");\n\topt.value = choice.id;\n\tif(choice.selected) opt.selected = true;\n\tif(typeof choice.label == \"string\"){\n\t\topt.appendChild(document.createTextNode(choice.label));\n\t}\n\telse if(choice.label){\n\t\topt.appendChild(choice.label);\n\t}\n\tif(choice.title){\n\t\topt.setAttribute(\"title\", choice.title);\n\t}\n\treturn opt;\n}\n\nmodule.exports = SimpleChooser;","const TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\nconst UTILS = require('../Utils');\nconst HTMLHelper = require('./HTMLHelper');\n//const TerminusFrame = require(\"../old/viewer/TerminusFrame\");\nconst TerminusClient = require('@terminusdb/terminus-client');\nconst SimpleFrameViewer = require(\"./document/SimpleFrameViewer\");\nconst Datatypes = require(\"./Datatypes\");\nconst DatatypeRenderers = require(\"./DatatypeRenderers\");\n\n\nfunction DocumentPane(client, docid, clsid){\n\tthis.client = client;\n\tthis.container = document.createElement('span');\n\tthis.container.setAttribute('class', 'terminus-document-cont');\n\tthis.defaultPaneView = { showConfig: false, editConfig: false, intro: false, loadSchema: false };\n\tthis.docid = (docid ? docid : false);\n\tthis.clsid = (clsid ? clsid : false);\n\tthis.datatypes = new DatatypeRenderers();\n    //Datatypes.initialiseDataRenderers(this.datatypes);\n}\n\nDocumentPane.prototype.load = function(){\n\tif(this.docid || this.clsid){\n\t\tthis.frame = new TerminusClient.DocumentFrame(this.client, this.view);\n\t\tthis.frame.owner = this;\n\t}\n\tif(this.docid){\n\t\treturn this.frame.load(this.docid, this.clsid)\n\t\t.then(() => this.filterFrame());\n\t}\n\tif(this.clsid){\n\t\treturn this.frame.load(false, this.clsid).then(() => {\n\t\t\tthis.frame.document.fillFromSchema(\"_:\");\n\t\t\tthis.filterFrame();\n\t});\t\n\t}\n\treturn Promise.reject(\"Either document id or class id must be specified before loading a document\");\n}\n\nDocumentPane.prototype.options = function(opts){\n\tthis.showQuery = (opts && typeof opts.showQuery != \"undefined\" ? opts.showQuery : false);\n\tthis.showConfig = (opts && typeof opts.showConfig != \"undefined\" ? opts.showConfig : false);\n\tthis.editConfig = (opts && typeof opts.editConfig != \"undefined\" ? opts.editConfig : false);\n\tthis.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\n\tthis.documentLoader = (opts && typeof opts.loadDocument != \"undefined\" ? opts.loadDocument : false);\n\tthis.loadSchema = (opts && typeof opts.loadSchema != \"undefined\" ? opts.loadSchema : false);\n\tthis.viewers = (opts && typeof opts.viewers != \"undefined\" ? opts.viewers : false);\n    Datatypes.initialiseDataRenderers(this.datatypes, false, opts);\n    return this;\n}\n\nDocumentPane.prototype.filterFrame = function(){\n\tvar self = this;\n\tvar myfilt = function(frame, rule){\n\t\tif(typeof rule.render() != \"undefined\"){\n\t\t\tframe.render = rule.render();\n\t\t}\n\t\telse {\n\t\t\tif(rule.renderer()){\n\t\t\t\tvar renderer = self.loadRenderer(rule.renderer(), frame, rule.args);\t\t\n\t\t\t}\n\t\t\tif(renderer && renderer.render){\n\t\t\t\tframe.render = function(fframe){\n\t\t\t\t\treturn renderer.render(fframe);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(rule.compare()){\n\t\t\tframe.compare = rule.compare();\n\t\t}\n\t}\n\tthis.frame.applyRules(false, false, myfilt);\n}\n\nDocumentPane.prototype.loadDocument = function(docid, config){\n\tthis.docid = docid;\n\tthis.view = config;\n\treturn this.load();\n}\n\nDocumentPane.prototype.loadClass = function(cls, config){\n\tthis.clsid = cls;\n\tthis.docid = false;\n\tthis.view = config;\n\treturn this.load();\n}\n\n\n\nDocumentPane.prototype.setClassLoader = function(cloader){\n\tthis.classLoader = cloader;\n\tif(this.queryPane){\n\t\tthis.queryPane.appendChild(this.classLoader);\n\t}\n\treturn this;\n}\n\nDocumentPane.prototype.getQueryPane = function(){\n\tvar pane = document.createElement(\"div\");\n\tpane.setAttribute(\"class\", \"terminus-document-query\");\n\tif(this.documentLoader){\n\t\tpane.appendChild(this.documentLoader);\n\t}\n\tif(this.classLoader){\n\t\tpane.appendChild(this.classLoader);\n\t}\n\treturn pane;\n}\n\nDocumentPane.prototype.getAsDOM = function(){\n\tif(this.intro){\n\t\tthis.container.appendChild(UTILS.getHeaderDom(this.intro));\n\t}\n\tvar configspan = document.createElement(\"span\");\n\tconfigspan.setAttribute(\"class\", \"pane-config-icons\");\n\tthis.container.appendChild(configspan);\n\tif(this.showQuery && (this.documentLoader || this.classLoader)){\n\t\tvar ipdom = this.getQueryPane();\n\t\tvar ispan = document.createElement(\"span\");\n\t\tispan.setAttribute(\"class\", \"document-pane-config\");\n\t\tvar ic = document.createElement(\"i\");\n\t\tispan.appendChild(ic);\n\t\tif(this.showQuery != \"always\") configspan.appendChild(ispan);\n\t\tvar self = this;\n\t\tfunction showQueryConfig(){\n\t\t\tispan.title=\"Click to Hide Query\";\n\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\n\t\t\tif(configspan.nextSibling) self.container.insertBefore(ipdom, configspan.nextSibling);\n\t\t\telse self.container.appendChild(ipdom);\n\t\t}\n\t\tfunction hideQueryConfig(){\n\t\t\tispan.title=\"Click to View Query\";\n            ic.setAttribute(\"class\", \"fas fa fa-search\");\n\t\t\tself.container.removeChild(ipdom);\n\t\t}\n\t\tispan.addEventListener(\"click\", () => {\n\t\t\tif(this.showingQuery) hideQueryConfig();\n\t\t\telse showQueryConfig();\n\t\t\tthis.showingQuery = !this.showingQuery;\n\t\t});\n\t\tshowQueryConfig();\n\t\tif(this.showQuery == \"icon\") hideQueryConfig();\n\t\tthis.queryPane = ipdom;\n\t}\n\tif(this.showConfig){\n        this.showingConfig = (this.showConfig != \"icon\");\n\t\tvar mode = (this.editConfig ? \"edit\" : \"view\");\n\t\tthis.input = this.createInput(mode);\n\t\tvar ndom = this.input.getAsDOM();\n        var nspan = document.createElement(\"span\");\n        nspan.addEventListener('mouseover', function(){\n            this.style.cursor = \"pointer\";\n\t\t});\n\t\tnspan.setAttribute(\"class\", \"result-pane-config\");\n\t\tvar nc = document.createElement(\"i\");\n\t\tnspan.appendChild(nc);\n\t\tconfigspan.appendChild(nspan);\n\t\tvar self = this;\n\t\tfunction showDocConfig(){\n\t\t\tnspan.title=\"Click to Hide View Configuration\";\n\t\t\tnc.setAttribute(\"class\", \"fas fa fa-times-circle\");\n\t\t\tif(configspan.nextSibling) self.container.insertBefore(ndom, configspan.nextSibling);\n\t\t\telse self.container.appendChild(ndom);\n\t\t\t//stylize only after ta or pre have been appended\n\t\t\tif((self.input.snippet.value) || (self.input.snippet.innerHTML))\n\t\t\t\tself.input.stylizeSnippet();\n\t\t}\n\t\tfunction hideDocConfig(){\n\t\t\tnspan.title=\"Click to View Configuration\";\n            nc.setAttribute(\"class\", \"fas fa fa-vial\");\n\t\t\tself.container.removeChild(ndom);\n\t\t}\n\t\tnspan.addEventListener(\"click\", () => {\n\t\t\tif(this.showingConfig) hideDocConfig();\n\t\t\telse showDocConfig();\n\t\t\tthis.showingConfig = !this.showingConfig;\n        });\n        showDocConfig();\n\t\tif(this.showConfig == \"icon\") hideDocConfig();\n\t}\n\tthis.resultDOM = document.createElement(\"span\");\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-document-results\");\n\t//var form = (this.input.format == \"js\" ? \"javascript\" : \"json\");\n\t//UTILS.stylizeEditor(ui, this.input.snippet, {width: this.input.width, height: this.input.height}, form);\n\tthis.container.appendChild(this.resultDOM);\n\tthis.renderResult();\n\treturn this.container;\n}\n\nDocumentPane.prototype.renderResult = function(){\n\tif(this.resultDOM){\n\t\tHTMLHelper.removeChildren(this.resultDOM);\n\t}\n\telse {\n\t\tthis.resultDOM = document.createElement(\"span\");\n\t\tthis.resultDOM.setAttribute(\"class\", \"terminus-document-results\");\n\t\t//var form = (this.input.format == \"js\" ? \"javascript\" : \"json\");\n\t\t//UTILS.stylizeEditor(ui, this.input.snippet, {width: this.input.width, height: this.input.height}, form);\n\t\tthis.container.appendChild(this.resultDOM);\n\t}\n\tif(this.frame && this.frame.document.render){\n\t\tvar fpt = this.frame.document.render();\n\t\tif(fpt){\n\t\t\tthis.resultDOM.appendChild(fpt);\n\t\t}\n\t}\n}\n\nDocumentPane.prototype.loadRenderer = function(rendname, frame, args, termframe){\n\tvar evalstr = \"new \" + rendname + \"(\";\n\tif(args) evalstr += JSON.stringify(args);\n\tevalstr += \");\";\n\ttry {\n\t\tvar nr = eval(evalstr);\n\t\tnr.frame = frame;\n\t\tnr.datatypes = this.datatypes;\n\t\treturn nr;\n\t}\n\tcatch(e){\n\t\tconsole.log(\"Failed to load \" + rendname + e.toString());\n\t\treturn false;\n\t}\n}\n\n\nDocumentPane.prototype.createInput = function(mode){\n    let input = new TerminusCodeSnippet(\"rule\", mode);\n    if(this.view){\n    \tinput.setQuery(this.view);\n\t}\n\tvar self = this;\n\tinput.submit = function(qObj){\n\t\tself.updateView(qObj);\n\t};\n\treturn input;\n}\n\nDocumentPane.prototype.updateView = function(docview){\n\tthis.view = docview;\n\tthis.frame.options(this.view);\n\tif(this.input) this.input.setQuery(this.view);\n\tthis.frame.applyRulesToDocument(this.frame.document, this.frame.config);\n\tthis.frame.renderer = this.frame.document;\n\tthis.renderResult();\n}\n\nDocumentPane.prototype.updateResult = function(result){\n\tthis.result = result;\n\tthis.updateQuery(result.query);\n\tthis.refreshViews();\n}\n\nDocumentPane.prototype.empty = function(){\n\treturn (typeof this.view == \"undefined\");\n}\n\nDocumentPane.prototype.clearMessages = function(){}\nDocumentPane.prototype.showError = function(){}\n\nDocumentPane.prototype.submitQuery = function(qObj){\n\tthis.clearMessages();\n\ttdv.owner = this;\n\ttdv.setDatatypes(Datatypes.initialiseDataRenderers);\n\ttdv.loadDocument(id).then(() => {\n\t\tlet dom = tdv.render();\n\t\tif(dom) holder.appendChild(dom);\n\t});\n\treturn holder;   \n}\n\nmodule.exports = DocumentPane;\n","const HTMLHelper = require(\"../HTMLHelper\");\n\nfunction SimpleFrameViewer(){}\n\nSimpleFrameViewer.prototype.getScope = function(frame){\n\tif(frame.isProperty()) return \"property\";\n\tif(frame.isObject()) return \"object\";\n\tif(frame.isData()) return \"data\";\n}\n\nSimpleFrameViewer.prototype.setDatatypeViewers = function(datatypes){\n\tthis.datatypes = datatypes;\n}\n\n\nSimpleFrameViewer.prototype.getDatatypeViewer = function(frame, mode){\n\tvar dv = frame.display_options.dataviewer;\n\tif(!dv){\n\t\tif(frame.isChoice()) var t = \"oneOf\";\n\t\telse if(frame.isDocument()) var t = \"document\";\n\t\telse t = frame.getType();\n\t\tif(mode && mode == \"edit\"){\n\t\t\tvar r = this.datatypes.getEditor(t);\n\t\t}\n\t\telse {\n\t\t\tvar r = this.datatypes.getRenderer(t);\n\t\t}\n\t\tdv = r.name;\n\t}\n\tif(frame.display_options.args){\n\t\tvar args = frame.display_options.args ;\n\t}\n\telse {\n\t\tif(r && r.args){\n\t\t\t args = r.args;\n\t\t}\n\t\telse args = false;\n\t}\n\tvar rend = this.datatypes.createRenderer(dv, args);\n\trend.type = frame.getType();\n\treturn rend;\n}\n\nSimpleFrameViewer.prototype.render = function(frame){\n\tif(!frame) frame = this.frame;\n\tif(!frame) return;\n\n\tvar scope = this.getScope(frame);\n\tif(frame.display_options.header_features && frame.display_options.header_features.length){\n\t\tvar hfeatures = this.getFeaturesDOM(frame.display_options.header_features, scope, frame, frame.display_options.mode);\n\t}\n\telse var hfeatures = false;\n\tif(frame.display_options.features && frame.display_options.features.length){\n\t\tvar features = this.getFeaturesDOM(frame.display_options.features, scope, frame, frame.display_options.mode);\n\t}\n\telse var features = false;\n\tvar orient = (scope == \"object\" || scope == \"property\") ? \"page\" : \"line\";\n\tvar ndom = HTMLHelper.getFrameDOM(scope, frame, orient, hfeatures, features);\n\tif(!ndom) return false;\n\tif(this.framedom){\n\t\tthis.framedom.replaceWith(ndom);\n\t}\n\tthis.framedom = ndom;\n\tif(frame.display_options.style){\n\t\tthis.framedom.setAttribute(\"style\", frame.display_options.style);\t\t\t\t\n\t}\n\treturn this.framedom;\n}\t\n\nSimpleFrameViewer.prototype.getFeaturesDOM = function(flist, scope, frame, mode){\n\tvar features = document.createElement(\"span\");\n\tfeatures.setAttribute(\"class\", \"terminus-features terminus-\" + scope + \"-features features-\" + featuresToCSS(flist));\n\tfor(var i = 0; i<flist.length; i++){\n\t\tlet render = false;\n\t\tlet style = false;\n\t\tlet args = false;\n\t\tlet fid = flist[i];\n\t\tif(typeof fid == \"object\"){\n\t\t\tfid = Object.keys(flist[i])[0];\n\t\t\tif(flist[i][fid].hidden) continue;\n\t\t\tif(flist[i][fid].style) style = flist[i][fid].style;\n\t\t\tif(flist[i][fid].render) render = flist[i][fid].render;\n\t\t\tif(flist[i][fid].args){\n\t\t\t\targs = flist[i][fid].args;\n\t\t\t} \n\t\t}\n\t\telse if(typeof fid != \"string\") continue;\n\t\tif(render){\n\t\t\tvar dom = render(frame, fid, scope, mode, args);\n\t\t\tif(style) dom.setAttribute(\"style\", style);\n\t\t\tif(dom)\tfeatures.appendChild(dom);\n\t\t}\n\t\telse if(fid == \"value\"){\n\t\t\tif(scope == \"data\"){\n\t\t\t\tvar dv = this.getDatatypeViewer(frame, mode, args);\n\t\t\t\tif(dv) {\n\t\t\t\t\tvar dom = dv.renderFrame(frame, this);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar dom = document.createTextNode(frame.get());\t\t\t\n\t\t\t\t}\n\t\t\t\tif(dom){\n\t\t\t\t\tif(style) dom.setAttribute(\"style\", style);\t\t\t\n\t\t\t\t\tfeatures.appendChild(dom);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(scope == 'object'){\n\t\t\t\t\tvar vals = frame.renderProperties();\n\t\t\t\t\tfor(var j = 0; j<vals.length; j++){\n\t\t\t\t\t\tif(style) vals[j].setAttribute(\"style\", style);\n\t\t\t\t\t\tfeatures.appendChild(vals[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar vals = frame.renderValues();\t\t    \n\t\t\t\t\tvar cont = document.createElement(\"span\");\n\t\t\t\t\tif(style) cont.setAttribute(\"style\", style);\n\t\t\t\t\tfor(var j = 0; j<vals.length; j++){\n\t\t\t\t\t\tcont.appendChild(vals[j]);\n\t\t\t\t\t}\n\t\t\t\t\tfeatures.appendChild(cont);\n\t\t\t\t}\t\t\t\t\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif(fid == \"id\" && mode == \"edit\" && scope == \"object\" && frame.isNew()){\n\t\t\t\tvar rend = this.datatypes.createRenderer(\"HTMLStringEditor\", args);\n\t\t\t\tvar dom = rend.renderFrame(frame, this);\n\t\t\t}\n\t\t\telse var dom = false;\n\t\t\tvar dom = HTMLHelper.getFeatureDOM(frame, fid, scope, mode, args, dom);\n\t\t\tif(dom){\n\t\t\t\tif(style) dom.setAttribute(\"style\", style);\t\t\t\n\t\t\t\tfeatures.appendChild(dom);\n\t\t\t}\n\t\t}\n\t}\n\treturn features;\n}\t\t\t\t\t\n\t\nfunction featuresToCSS(flist){\n\tvar s = \"\";\n\tfor(var i = 0; i<flist.length; i++){\n\t\tif(typeof flist[i] == \"object\"){\n\t\t\ts += Object.keys(flist[i])[0] + \"-\";\n\t\t}\n\t\telse {\n\t\t\ts += flist[i] + \"-\";\n\t\t}\n\t}\n\treturn s.substring(0, s.length-1);\n}\n\n\n\nmodule.exports = SimpleFrameViewer;","const TerminusClient = require('@terminusdb/terminus-client');\nconst ScriptPane = require(\"./html/ScriptPane\");\nconst HTMLHelper = require('./html/HTMLHelper');\nconst TerminusViewer = require(\"./html/TerminusViewer\");\n\nfunction TerminusQueryViewer(ui, options){\n\tthis.ui = ui;\n\tthis.tv = new TerminusViewer(ui.client);\n\tthis.options = options;\n\tthis.panes = [];\n\tthis.new_pane = false;\n\tthis.new_pane_type = false;\n\tthis.meta = {};\n\tthis.container = document.createElement(\"div\");\n\tthis.container.setAttribute(\"class\", \"terminus-query-page\");   \n}\n\nTerminusQueryViewer.prototype.newPaneOptions = function(){ \n\tvar opts = {\n\t\tshowQuery: \"always\", \n\t\teditQuery: true,\n\t\tshowHeader: true, \n\t\tcss: \"terminus-full-query-pane\"\n\t};\n\treturn opts;\n} \n\nTerminusQueryViewer.prototype.defaultResultOptions = function(){ \n\tvar opts = {\n\t\tshowConfig: \"icon\", \n\t\teditConfig: true,\n\t\tshowHeader: false, \n\t\tviewers: [new TerminusClient.View.graph()],\n\t};\n\treturn opts;\n} \n\nTerminusQueryViewer.prototype.getNewQueryPane = function(){\n\tlet table = TerminusClient.View.table();\n\tlet qpane = this.tv.getQueryPane(false, [table], false, [this.defaultResultOptions()], this.newPaneOptions());\n\treturn qpane;\n}\n\nTerminusQueryViewer.prototype.addQueryPane = function(){\n\tvar qpane = this.getNewQueryPane();\n\tthis.panes.push(qpane);\n\treturn qpane;\n}\n\nTerminusQueryViewer.prototype.addScriptPane = function(q){\n\tlet qpane = new ScriptPane(this.ui.client, q);\n\tthis.panes.push(qpane);\n\treturn qpane;\n}\n\nTerminusQueryViewer.prototype.addScriptPaneDOM = function(){\n\tlet qpane = new ScriptPane(this.ui.client);\n\tthis.addNewPaneDOM(qpane);\n}\n\nTerminusQueryViewer.prototype.addQueryPaneDOM = function(){\n\tlet qpane = this.addQueryPane();\n\tthis.addNewPaneDOM(qpane);\n}\n\nTerminusQueryViewer.prototype.setNewDocumentPaneDOM = function(){\n\tthis.new_pane = this.tv.getDocumentPane();\n\t//this.new_pane = new DocumentPane(this.ui.client).options({showQuery: true, editQuery: true});\n\tthis.new_pane_type = \"document\";\n}\n\nTerminusQueryViewer.prototype.addNewPaneDOM = function(qpane){\n\tvar lpane = this.panes[this.panes.length-1];\n\t//if(lpane && lpane.empty()){\n\t//\tthis.panes[this.panes.length-1] = qpane;\n\t//\tthis.paneDOM.removeChild(this.paneDOM.lastChild)\t\t \n\t//}\n\t//else {\n\t\tthis.panes.push(qpane);\n\t//}\n\tvar qdom = qpane.getAsDOM();\n\tvar qhdr = this.getPaneHeader();\n\tqdom.prepend(qhdr);\n\tthis.paneDOM.appendChild(qdom);\n}\n\nTerminusQueryViewer.prototype.getAsDOM = function(q){\n\tHTMLHelper.removeChildren(this.container);\n\tif(!this.paneDOM) this.paneDOM = this.getPanesDOM();\n\tthis.container.appendChild(this.paneDOM);\n\tthis.controlDOM = this.getControlsDOM();\n\t//this.container.appendChild(this.controlDOM);\n\tvar cont = document.createElement(\"span\");\n\tcont.setAttribute(\"class\", \"terminus-new-query-pane\");\n\tvar newPaneButton = document.createElement('button');\n\t\tnewPaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\t\tnewPaneButton.appendChild(document.createTextNode('Add New Query'));\n\t\tnewPaneButton.addEventListener('click', () => this.addQueryPaneDOM());\t   \n\tcont.appendChild(newPaneButton); \n\tthis.container.appendChild(cont);\n\treturn this.container;\n}\n\nTerminusQueryViewer.prototype.getPanesDOM = function(q){\n\tthis.panesDOM = document.createElement(\"div\");\n\tthis.panesDOM.setAttribute(\"class\", \"terminus-query-panes\");\n\tfor(var i = 0; i<this.panes.length; i++){\n\t\tvar pd = this.panes[i].getAsDOM();\n\t\tvar qhdr = this.getPaneHeader();\n\t\tpd.prepend(qhdr);\n\t\tthis.panesDOM.appendChild(pd);\n\t}\n\tif(!this.new_pane){\n\t\tthis.new_pane = this.getNewQueryPane();\n\t}\n\tvar npd = this.new_pane.getAsDOM();\n\tvar nqhdr = this.getNewPaneHeader();\n\tthis.new_pane.headerDOM = nqhdr;\n\tthis.new_pane.paneDOM = npd;\n\tnpd.prepend(nqhdr);\n\tthis.panesDOM.appendChild(npd);\n\treturn this.panesDOM;\n}\n\nTerminusQueryViewer.prototype.removePane = function(pane, index){\n\tHTMLHelper.removeChildren(pane.paneDOM);\n\tpane.paneDOM.appendChild(pane.headerDOM);\n\tif(this.panes[i]){\n\t\tthis.panes.splice(i, 1);\n\t}\n}\n\nTerminusQueryViewer.prototype.showPane = function(pane){\n\t//HTMLHelper.removeChildren(pane.paneDOM);\n\t//var pd = pane.getAsDOM();\n\t//var qhdr = this.getPaneHeader();\n\t//pd.prepend(qhdr);\n\t//pane.headerDOM = qhdr;\t\n}\n\nTerminusQueryViewer.prototype.hidePane = function(pane){\n\t\n}\n\n\n\nTerminusQueryViewer.prototype.getPaneHeader = function(){\n\tvar hdr = document.createElement(\"div\");\n\t//hdr.appendChild(this.getControlsDOM());\n\treturn hdr;\n}\n\nTerminusQueryViewer.prototype.getNewPaneHeader = function(){\n\tvar hdr = document.createElement(\"div\");\n\t//hdr.appendChild(this.getControlsDOM(\"new\"));\n\treturn hdr;\n}\n\nTerminusQueryViewer.prototype.getControlsDOM = function(isnew){\n\tvar c = document.createElement(\"div\");\n\tc.setAttribute(\"class\", \"terminus-query-page-controls\");    \n\tif(isnew == \"new\"){\n\t\tvar newPaneButton = document.createElement('button');\n\t\tnewPaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\t\tnewPaneButton.appendChild(document.createTextNode('WOQL Query'));\n\t\t//newPaneButton.addEventListener('click', () => this.addQueryPaneDOM());\t    \n\t\tc.appendChild(newPaneButton);\n\t\tvar newScriptButton = document.createElement('button');\n\t\tnewScriptButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\t\tnewScriptButton.appendChild(document.createTextNode('Script'));\n\t\t//newScriptButton.addEventListener('click', () => this.addScriptPaneDOM());\t    \n\t\tc.appendChild(newScriptButton);\n\t\tvar newDocButton = document.createElement('button');\n\t\tnewDocButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\t\tnewDocButton.appendChild(document.createTextNode('Document Query'));\n\t\tnewDocButton.addEventListener('click', () => this.setNewDocumentPaneDOM());\t    \n\t\tc.appendChild(newDocButton);\n\t}\n\telse {\n\t\tvar savePaneButton = document.createElement('button');\n\t\tsavePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\t\tsavePaneButton.appendChild(document.createTextNode('Save'));\n\t\tc.appendChild(savePaneButton);\n\t\tvar closePaneButton = document.createElement('button');\n\t\tclosePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\t\tclosePaneButton.appendChild(document.createTextNode('Close'));\n\t\tc.appendChild(closePaneButton);\n\t\tvar collapsePaneButton = document.createElement('button');\n\t\tcollapsePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\n\t\tcollapsePaneButton.appendChild(document.createTextNode('Collapse'));\t\t\n\t\tc.appendChild(collapsePaneButton);\n\t}\n\treturn c;\n}\n\n\nmodule.exports=TerminusQueryViewer\n","const TerminusClient = require('@terminusdb/terminus-client');\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\nconst UTILS = require('../Utils');\nconst HTMLHelper = require('./HTMLHelper');\n\n\nfunction ScriptPane(client, script){\n\tthis.client = client;\n\tthis.script = (script ? script : \"\");\n\tthis.container = document.createElement('div');\n    this.container.setAttribute('class', 'terminus-script-pane-cont');\n}\n\nScriptPane.prototype.empty = function(){\n\treturn this.script == \"\";\n}\n\n\nScriptPane.prototype.createInput = function(ui){\n\tlet input = new TerminusCodeSnippet(\"code\", \"edit\");\n\tif(this.script){\n\t\tinput.setQuery(this.script);\n\t}\n\tvar self = this;\n\tinput.submit = function(qObj){\n\t\tself.executeScript(qObj, ui);\n\t};\n\treturn input;\n}\n\n\nScriptPane.prototype.executeScript = function(script, ui){\n    if(ui) ui.clearMessages();\n    this.script = script;\n\tvar client = this.client;\n\tvar WOQL = TerminusClient.WOQL;\n\ttry {\n\t\tvar res = eval(script);\n\t\tif(res){\n\t\t\tthis.updateResult(res);\n\t\t}\n\t\telse {\n\t\t\t//executed ok message \n\t\t}\n\t}\n\tcatch(e){\n\t\tif(ui) ui.showError(e);\n\t\tconsole.error(e);\n\t}\n}\n\nScriptPane.prototype.showOKMessage = function(){\n    var msg = document.createTextNode(\"Script executed ok\");\n    this.updateResult(msg);\n}\n\nScriptPane.prototype.updateResult = function(res){\n    HTMLHelper.removeChildren(this.resultDOM);\n    this.resultDOM.appendChild(res);\n}\n\n\nScriptPane.prototype.getAsDOM = function(ui){\n\tthis.container.appendChild(UTILS.getHeaderDom('Enter Script'));\n\tthis.input = this.createInput(ui);\n\tthis.container.appendChild(this.input.getAsDOM());\n\tthis.resultDOM = document.createElement(\"div\");\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-script-results\"); \n\t//var form = (this.input.format == \"js\" ? \"javascript\" : \"json\");\n\t//UTILS.stylizeEditor(ui, this.input.snippet, {width: this.input.width, height: this.input.height}, form);\n\tif(this.result){\n        this.resultDOM.appendChild(this.result);\n    }\n\tthis.container.appendChild(this.resultDOM);\n\treturn this.container;\n}\n\n\nmodule.exports = ScriptPane;\n","/*\n * Draws the screen for viewing and updating the schema\n * and provides wrappers around the client's schema API\n */\nconst UTILS=require('./Utils')\nconst TerminusClient = require('@terminusdb/terminus-client');\nconst HTMLHelper = require('./html/HTMLHelper');\nconst TerminusViewer = require('./html/TerminusViewer');\n\n\nfunction TerminusSchemaViewer(ui){\n\tthis.ui = ui;\n\tthis.tv = new TerminusViewer(ui.client);\n\n\tthis.mode = \"view\";\n\tthis.format = \"turtle\";\n\tthis.confirm_before_update = false;\n\tthis.woql = TerminusClient.WOQL;\n\tthis.views = { \n\t\tclasses: {\n\t\t\ttitle: \"Classes\"\n\t\t}, \n\t\tproperties: {\n\t\t\ttitle: \"Properties\"\n\t\t}, \n\t\towl: {\n\t\t\ttitle: \"OWL\"\t\n\t\t}\n\t}\n\tthis.views_dom = document.createElement(\"div\");\n\tthis.current_view = \"classes\";\n\tthis.retrieveViews();\n}\n\nTerminusSchemaViewer.prototype.getClassesPane = function() {\n\tlet WOQL = TerminusClient.WOQL;\n\tlet query = this.woql.limit(100)\n\t\t\t.start(0)\n\t\t\t.and(\n\t\t\t\tWOQL.quad(\"v:Class\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\n\t\t\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\t\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:subClassOf\", \"v:Parent\", \"db:schema\"),\n\t\t\t\tWOQL.opt().quad(\"v:Child\", \"rdfs:subClassOf\", \"v:Class\", \"db:schema\"),\n\t\t\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\n\t\t\t\tWOQL.opt().quad(\"v:Class\", \"tcs:tag\", \"v:Abstract\", \"db:schema\")\n\t);\t\n\t\n\tvar table = TerminusClient.View.table();\n\ttable.column_order(\"Class\", \"Label\", \"Comment\", \"Parent\", \"Child\", \"Abstract\")\n\ttable.column('Comment').header('Description');\n\ttable.column('Class').header('Class ID');\n\ttable.column('Label').header('Name');\n\ttable.column('Child').header('Subclasses');\n\ttable.column('Parent').header('Parent Classes');\n\ttable.column('Range').header('Type');\n\n\tvar graph = TerminusClient.View.graph();\n\tgraph.edges([\"v:Class\", \"v:Parent\"], [\"v:Child\", \"v:Class\"], [\"v:Class\", \"v:Abstract\"]);\n\t\n\t\n\tgraph.height(800);\n\tgraph.width(1200);\n\tgraph.edge(\"v:Class\", \"v:Parent\").text(\"Parent Class\").distance(120);\n\tgraph.edge(\"v:Child\", \"v:Class\").text(\"Parent Class\").distance(120);\n\tgraph.edge(\"v:Class\", \"v:Abstract\").text(\"Abstract Class\").weight(2).color([0,0,0]);\n\tgraph.node(\"Parent\").size(20).color([180, 220, 250]).icon({label: true, size: 0.7, color: [90, 90, 140]});\n\tgraph.node(\"Class\").text(\"v:Label\").size(32).collisionRadius(80).icon({label: true, size: 0.7, color: [24, 34, 89]});\n\n\tvar rpc = { viewers: [graph] }\n    var qp = this.tv.getQueryPane(query, [table], false, [rpc]);\n\t//var qp = this.tv.getQueryPane(query, [graph, table]);\n\n\treturn qp;\n}\n\nTerminusSchemaViewer.prototype.getPropertiesPane = function() {\n\tlet query = this.woql.from(this.ui.client.connectionConfig.dbURL())\n\t   .limit(100)\n\t   .start(0)\n\t   .propertyMetadata();\n\n    var table = TerminusClient.View.table();\n\ttable.column_order(\"Property\", \"Label\", \"Range\", \"Domain\", \"Comment\")\n\ttable.column('Comment').header('Description');\n\ttable.column('Property').header('Property ID');\n\ttable.column('Label').header('Name');\n\ttable.column('Domain').header('Domain');\n\ttable.column('Range').header('Type');\n\n\tvar graph = TerminusClient.View.graph();\n\tgraph.height(800);\n\tgraph.width(1200);\n\tgraph.edges([\"Domain\", \"Property\"], [\"Property\", \"Range\"]);\n\tgraph.edge(\"Domain\", \"Property\").text(\"Domain Class\").color([20, 200, 20]).distance(120);\n\tgraph.edge(\"Property\", \"Range\").text(\"Property Type\").distance(100);\n\tgraph.node(\"Type\").hidden(true);\n\tgraph.node(\"Range\").text(\"v:Range\").size(20).collisionRadius(100).color([220, 250, 180]).icon({label: true, size: 0.8, color: [50, 60, 40]});\n\tgraph.node(\"Range\").v(\"Type\").in(\"owl:datatypeProperty\").hidden(true);\n\tgraph.node(\"Property\").text(\"v:Label\").size(24).collisionRadius(100).color([180, 220, 250]).icon({label: true, size: 0.8, color: [50, 60, 40]});\n\tgraph.node(\"Domain\").color([220, 250, 180]).size(20).collisionRadius(100).icon({label: true, size: 0.7, color: [24, 34, 89]});\n\tvar rpc = { viewers: [graph] }\n\tvar qp = this.tv.getQueryPane(query, [table], false, [rpc]);\n\t//var qp = this.tv.getQueryPane(query, [graph, table]);\n\treturn qp;\n}\n\nTerminusSchemaViewer.prototype.refreshPanes = function(){\n\tif(this.views.classes.pane) this.views.classes.pane.load();\n\tif(this.views.properties.pane) this.views.properties.pane.load();\n}\n\nTerminusSchemaViewer.prototype.retrieveViews = function(){\n\tif(!this.views.classes.pane){\n\t\tlet pane = this.getClassesPane();\n\t\tthis.views.classes.pane = pane;\n\t\tlet dom = pane.getAsDOM();\n\t\tif(this.current_view != \"classes\") dom.style.display = \"none\";\n\t\tthis.views_dom.appendChild(dom);\n\t\tpane.load();\n\t\tthis.views.classes.dom = dom;\n\t}\n\tif(!this.views.properties.pane){\n\t\tlet pane = this.getPropertiesPane();\n\t\tthis.views.properties.pane = pane;\n\t\tlet dom = pane.getAsDOM();\n\t\tif(this.current_view != \"properties\") dom.style.display = \"none\";\n\t\tthis.views_dom.appendChild(dom);\n\t\tthis.views.properties.dom = dom;\n\t\tpane.load();\n\t}\n\tif(!this.views.owl.dom){\n\t\tthis.views.owl.dom = this.getOWLView();\n\t\tthis.views_dom.appendChild(this.views.owl.dom);\n\t\tif(this.current_view != \"owl\") this.views.owl.dom.style.display = \"none\";\t\t\n\t}\n}\n\n\n/*\n * Retrieves schema from API and writes the response into the page\n */\nTerminusSchemaViewer.prototype.getAsDOM = function(){\n\n\tthis.holder = document.createElement(\"div\");\n\tthis.controldom = document.createElement(\"div\");\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\n\tthis.controldom.appendChild(this.getTabsDOM());\n\tthis.view = document.createElement(\"div\");\n\tthis.view.setAttribute(\"class\", \"terminus-schema-view\");\n\tthis.view.appendChild(this.views_dom);\n\tthis.pagedom = document.createElement(\"div\");\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\n\tthis.holder.appendChild(this.controldom);\n\tthis.pagedom.appendChild(this.view);\n\tthis.holder.appendChild(this.pagedom);\n\treturn this.holder;\n}\n\nTerminusSchemaViewer.prototype.getOWLView = function(){\n\tvar owldom = document.createElement(\"div\");\n\tthis.loadSchema();\n\treturn owldom;\n}\n\nTerminusSchemaViewer.prototype.updateOWLContents = function(){\n\tvar owldom = this.views.owl.dom;\n\tHTMLHelper.removeChildren(owldom);\n\tif(this.mode == 'view'){\n\t\towldom.appendChild(this.getSchemaEditButton());\n\t\towldom.appendChild(this.getSchemaViewDOM());\n\t}\n\telse if(this.mode == \"edit\"){\n\t\towldom.appendChild(this.getSchemaSaveButtons());\n\t\towldom.appendChild(this.getSchemaEditDOM());\n\t\towldom.appendChild(this.getSchemaSaveButtons());\n\t}\n}\n\n\nTerminusSchemaViewer.prototype.getTabsDOM = function(){\n\tvar ul = document.createElement('ul');\n\tul.setAttribute('class', 'terminus-ul-horizontal');\n\tfor(var k in this.views){\n\t\tvar a = this.getTabDOM(k, this.views[k].title);\n\t\tul.appendChild(a);\n\t\tif(k == this.current_view) \tUTILS.setSelectedSubMenu(a);\n\t}\n\treturn ul;\n}\n\nTerminusSchemaViewer.prototype.getTabDOM = function(view, title){\n\tvar a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        self.switchView(this, view);\n    })\n\ta.appendChild(document.createTextNode(title));\n    return a;\n}\n\nTerminusSchemaViewer.prototype.switchView = function(a, view){\n\tUTILS.setSelectedSubMenu(a);\n\tif(view != this.current_view){\n\t\tthis.current_view = view;\n\t\tthis.toggleTabs();\n\t}\n}\n\nTerminusSchemaViewer.prototype.toggleTabs = function(){\n\tfor(var k in this.views){\n\t\tif(this.views[k].dom && k == this.current_view) this.views[k].dom.style.display = \"block\";\n\t\telse if(this.views[k].dom) this.views[k].dom.style.display = \"none\";\n\t}\n}\n\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\n\tvar self = this;\n\tthis.ui.showBusy(\"Fetching Database Schema\");\n\treturn this.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\n\t.then(function(response){\n\t\tself.ui.clearBusy();\n\t\tself.schema = response;\n\t\tself.updateOWLContents() \n\t})\n\t.catch(function(error){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showError(error);\n\t});\n}\n\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\n\tvar ssb = document.createElement(\"span\");\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\n\tssb.appendChild(this.getCancelButton());\n\tssb.appendChild(this.getSaveButton());\n\treturn ssb;\n}\n\nTerminusSchemaViewer.prototype.getCancelButton = function(is_import){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.ui.clearMessages();\n\t\tself.mode = \"view\";\n\t\tself.updateOWLContents();\n\t}\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\n}\n\nTerminusSchemaViewer.prototype.getSaveButton = function(){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.ui.clearMessages();\n\t\tvar text = self.schema_edit_dom.value;\n\t\tif(typeof(self.schema) == \"object\"){\n\t\t\ttext = JSON.parse(text);\n\t\t}\n\t\tvar opts = {};\n\t\topts['terminus:encoding'] =  'terminus:' + self.format;\n\t\tif(!(TerminusClient.UTILS.empty(self.schema_edit_dom_name)))\n\t\t\topts['schemaId'] = self.ui.client.connectionConfig.dbURL() + '/' + self.schema_edit_dom_name.value;\n\t\telse opts['schemaId'] = self.ui.client.connectionConfig.dbURL() + '/' + 'schema';\n\t\treturn self.updateSchema(text, opts);\n\t}\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\n}\n\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\n\tvar ssb = document.createElement(\"span\");\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\n\tvar self = this;\n\tvar func = function(){\n\t\tself.mode = \"edit\";\n\t\tself.updateOWLContents();\n\t}\n\tvar but = this.getSchemaButton(\"Edit\", \"update_schema\", func);\n\tssb.appendChild(but);\n\treturn ssb;\n}\n\n/*\n * Updates schema, then fetches updated version and updates the page with it\n */\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts) {\n\tthis.ui.showBusy(\"Updating Database Schema\");\n\tvar self = this;\n\treturn this.ui.client.updateSchema(false, text, opts)\n\t.then(function(response){\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\n\t\t\tself.mode = \"view\";\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\n\t\t\tself.refreshPanes();\n\t\t\tself.updateOWLContents();\n\t\t}\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\n\t\t\tself.ui.clearBusy();\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\n\t\t}\n\t\telse {\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\n\t\t}\n\t})\n\t.catch(function(error){\n\t\tself.ui.clearBusy();\n\t\tif(error.data && error.data['terminus:witnesses']){\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"schema\");\n\t\t}\n\t\telse {\n\t\t\tself.ui.showError(error);\n\t\t}\n\t});\n}\n\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\n\tvar np = document.createElement(\"div\");\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\n\tif(this.ui.showControl(\"add_new_library\")) var sid = this.getSchemaNameInputDOM(np);\n\tvar ipval = document.createElement(\"textarea\");\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\n\tipval.setAttribute(\"width\", \"100%\");\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\n\tif(typeof(this.schema) == \"string\"){\n\t\tipval.innerHTML = this.schema;\n\t}\n\telse if(typeof (this.schema) == \"object\") {\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\n\t}\n\tif(this.ui.showControl(\"add_new_library\")) this.schema_edit_dom_name = sid;\n\tthis.schema_edit_dom = ipval;\n\tnp.appendChild(ipval);\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\n\treturn np;\n}\n\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\n\tvar self = this;\n\tvar np = document.createElement(\"div\");\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\n\tvar ipval = document.createElement(\"pre\");\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\n\tif(typeof(this.schema) == \"string\"){\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\n         .replace(/</g, \"&lt;\")\n         .replace(/>/g, \"&gt;\")\n         .replace(/\"/g, \"&quot;\")\n         .replace(/'/g, \"&#039;\");\n\t\tipval.innerHTML = txt;\n\t}\n\telse if(typeof (this.schema) == \"object\") {\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\n\t}\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\n\tif(!cm) np.appendChild(ipval);\n\treturn np;\n}\n\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\n\tvar opt = document.createElement(\"button\");\n\topt.appendChild(document.createTextNode(label));\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\n\topt.addEventListener(\"click\", func);\n\treturn opt;\n}\n\n\nmodule.exports=TerminusSchemaViewer\n","/* User interface elements that relate to server context\n *\n * TerminusServerController is a control widget that invokes server actions\n * TerminusServerViewer is a window that displays server actions and server screens\n *\n */\n const Datatables = require('./plugins/datatables.terminus');\n const UTILS =require('./Utils');\n const HTMLHelper = require('./html/HTMLHelper');\n \n function TerminusServerController(ui){\n\t this.ui = ui;\n }\n\nTerminusServerController.prototype.getAsDOM = function(){\n\tvar rsc = document.createElement(\"div\");\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\n\tvar self = this;\n\tif(this.ui && this.ui.server()){\n\t\tvar scd = document.createElement(\"div\");\n\t\tscd.setAttribute(\"class\", \"terminus-server-connection\");\n        var nav = document.createElement('div');\n        nav.setAttribute('class', 'span3');\n        var ul = document.createElement('ul');\n        ul.setAttribute('class', 'terminus-ul');\n        nav.appendChild(ul);\n        rsc.appendChild(nav);\n        // connected to server\n        // change server\n        if(this.ui.showControl(\"change-server\")){\n            var a = document.createElement('a');\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n            var self = this;\n            a.addEventListener(\"click\", function(){\n\t\t\t\tUTILS.activateSelectedNav(this, self);\n\t\t\t\tself.ui.clearMessages();\n                self.ui.showLoadURLPage();\n            })\n            var icon = document.createElement('i');\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\n            a.appendChild(icon);\n            var txt = document.createTextNode('Change Server');\n            a.appendChild(txt);\n            ul.appendChild(a);\n        }\n        // view databases\n        if(this.ui.showControl(\"db\")){\n            var a = document.createElement('a');\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n            var self = this;\n            a.addEventListener(\"click\", function(){\n                UTILS.activateSelectedNav(this, self);\n                if(self.ui.db()){\n                    self.ui.clearDB();\n\t\t\t\t\tself.ui.redrawControls();\n                }\n\t\t\t\tself.ui.clearMessages();\n                self.ui.showServerMainPage();\n            })\n            var icon = document.createElement('i');\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-home');\n            a.appendChild(icon);\n            var txt = document.createTextNode('Home');\n            a.appendChild(txt);\n            ul.appendChild(a);\n        }\n\t\tif(this.ui.showControl(\"create_database\")){\n            var a = document.createElement('a');\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n            var self = this;\n            a.addEventListener(\"click\", function(){\n               UTILS.activateSelectedNav(this, self);\n                if(self.ui.db()){\n                    self.ui.clearDB();\n\t\t\t\t\tself.ui.redrawControls();\n\t\t\t\t}\n\t\t\t\tself.ui.clearMessages();\n                self.ui.showCreateDBPage();\n            })\n            var icon = document.createElement('i');\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\n            a.appendChild(icon);\n            var txt = document.createTextNode('Create Database');\n            a.appendChild(txt);\n            ul.appendChild(a);\n        }\n        if(this.ui.showControl(\"collaborate\")){\n            var a = document.createElement('a');\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n            var self = this;\n            a.addEventListener(\"click\", function(){\n               UTILS.activateSelectedNav(this, self);\n                if(self.ui.db()){\n                    self.ui.clearDB();\n\t\t\t\t\tself.ui.redrawControls();\n                }\n\t\t\t\tself.ui.clearMessages();\n                self.ui.showCollaboratePage();\n            })\n            var icon = document.createElement('i');\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-share-alt');\n            a.appendChild(icon);\n            var txt = document.createTextNode('Collaborate');\n            a.appendChild(txt);\n            ul.appendChild(a);\n\t\t}\n\t}\n\treturn rsc;\n}\n\nTerminusServerController.prototype.getServerLabelDOM = function(){\n\tvar srec = this.ui.client.connection.getServerRecord();\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\n\tdesc += \" Server URL: \"+ this.ui.server();\n\tvar val = document.createElement(\"span\");\n\tval.setAttribute(\"class\", \"terminus-server-value\");\n\tval.setAttribute(\"title\", desc);\n\tval.appendChild(document.createTextNode(lab));\n    val =  document.createElement('div');\n\treturn val;\n}\n\nfunction TerminusServerViewer(ui){\n\tthis.ui = ui;\n\tthis.server = this.ui.server();\n\tthis.max_cell_size = 500;\n\tthis.max_word_size = 40;\n\tthis.css_base = window.css_base;//\"https://terminusdb.github.io/terminus-dashboard/dist/\";\n\n}\n\nTerminusServerViewer.prototype.getAsDOM = function(selected){\n\tvar self = this;\n\tvar pd = document.createElement(\"span\");\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\n\tif(this.ui.server()){\n\t\tvar scd = document.createElement(\"span\");\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\n\t\tif(this.ui.showView(\"server\")){\n\t\t\tscd.appendChild(this.getServerDetailsDOM());\n\t\t}\n\t\tif(this.ui.showView(\"change-server\")){\n\t\t\tvar csbut = document.createElement(\"button\");\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\n\t\t\tcsbut.addEventListener(\"click\", function(){\n\t\t\t\tif(self.ui.db()){\n\t\t\t\t\tself.ui.clearDB();\n\t\t\t\t}\n\t\t\t\tself.ui.showLoadURLPage();\n\t\t\t})\n\t\t\t// 11092019 scd.appendChild(csbut);\n\t\t}\n\t\tif(this.ui.showView(\"create_database\")){\n\t\t\tvar crbut = document.createElement(\"button\");\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\n\t\t\tcrbut.addEventListener(\"click\", function(){\n\t\t\t\tif(self.ui.db()){\n\t\t\t\t\tself.ui.clearDB();\n\t\t\t\t}\n\t\t\t\tself.ui.clearMessages();\n\t\t\t\tself.ui.showCreateDBPage();\n\t\t\t})\n\t\t}\n\t\tif(this.ui.showView(\"db\")){\n\t\t\tscd.appendChild(this.getDBListDOM());\n\t\t}\n\t\tpd.appendChild(scd);\n\t}\n\telse {\n\t\tself.ui.showLoadURLPage();\n\t}\n\treturn pd;\n}\n\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-welcome-box terminus-no-res-alert\");\n\tvar icon = document.createElement(\"img\");\n\ticon.setAttribute(\"class\", \"terminus-server-main-logo\")\n\tvar url = this.css_base + \"css/img/TerminusDB_Logo_Original.png\" \n\ticon.setAttribute(\"src\", url);\n\tscd.appendChild(icon);\n\tvar scl = document.createElement(\"p\");\n\tscl.setAttribute(\"class\", \"terminus-server-running\")\n\tscl.appendChild(document.createTextNode(\"Terminus Server running at \"))\n\tscl.appendChild(document.createTextNode(this.ui.server()))\n\tscd.appendChild(scl);\n\treturn scd;\n}\n\nTerminusServerViewer.prototype.wrapTableLinkCell = function(tdElement,dbid, text){\n\tvar self = this;\n\tvar wrap = document.createElement(\"p\");\n//\twrap.setAttribute(\"href\", \"#\");\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\n\tHTMLHelper.wrapShortenedText(wrap, text, this.max_cell_size, this.max_word_size);\n\ttdElement.addEventListener(\"click\", function(){\n\t\tself.ui.connectToDB(dbid);\n\t\tself.ui.showDBMainPage();\n\t});\n\treturn wrap;\n}\n\nTerminusServerViewer.prototype.getDBListDOM = function(){\n\t//var self = this;\n\tvar sec = document.createElement(\"div\");\n\tsec.setAttribute(\"class\", \"terminus-db-list\");\n\t//sec.appendChild(UTILS.getHeaderDom('Databases'));\n\tvar scd = document.createElement(\"table\");\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-hover-table terminus-margin-top\");\n\tvar thead = document.createElement(\"thead\");\n\tvar thr = document.createElement(\"tr\");\n\tvar th1 = document.createElement(\"th\");\n\tth1.appendChild(document.createTextNode(\"Database ID\"));\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-header-full-css\");\n\tth1.style.width = \"20%\";\n\tvar th2 = document.createElement(\"th\");\n\tth2.appendChild(document.createTextNode(\"Title\"));\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-header-full-css\");\n\tth2.style.width = \"30%\";\n\tvar th3 = document.createElement(\"th\");\n\tth3.appendChild(document.createTextNode(\"Description\"));\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-header-full-css\");\n\tth3.style.width = \"50%\";\n\tvar th4 = document.createElement(\"th\");\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-header-full-css\");\n\tth4.appendChild(document.createTextNode(\"Size\"));\n\tvar th5 = document.createElement(\"th\");\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-header-full-css\");\n\tth5.appendChild(document.createTextNode(\"Created\"));\n\tvar th6 = document.createElement(\"th\");\n\tth6.appendChild(document.createTextNode(\"Delete\"));\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-header-full-css\");\n\tthr.appendChild(th1);\n\tthr.appendChild(th2);\n\tthr.appendChild(th3);\n\t//thr.appendChild(th4);\n\t//thr.appendChild(th5);\n\t//thr.appendChild(th6);\n\tthead.appendChild(thr);\n\tscd.appendChild(thead);\n\tvar tbody = document.createElement(\"tbody\");\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\n\tfor(let fullid in dbrecs){\n\t\tlet dbrec = dbrecs[fullid];\n\t\tconst dbid = fullid.split(\":\")[1];\n\t\tlet tr = document.createElement(\"tr\");\n\t\tvar td1 = document.createElement(\"td\");\n\t\ttd1.appendChild(this.wrapTableLinkCell(td1,dbid, dbid));\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id terminus-db-pointer\");\n\t\tvar td2 = document.createElement(\"td\");\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title terminus-db-pointer\");\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\n\t\ttd2.appendChild(this.wrapTableLinkCell(td2,dbid, txt));\n\t\tvar td3 = document.createElement(\"td\");\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description terminus-db-pointer\");\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\n\t\ttd3.appendChild(this.wrapTableLinkCell(td3,dbid, txt));\n\t\tvar td4 = document.createElement(\"td\");\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size terminus-db-pointer\");\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\n\t\ttd4.appendChild(this.wrapTableLinkCell(td4,dbid, txt));\n\t\tvar td5 = document.createElement(\"td\");\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created terminus-db-pointer\");\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\n\t\ttd5.appendChild(this.wrapTableLinkCell(td5,dbid, txt));\n\t\tvar td6 = document.createElement(\"td\");\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\n\t\tvar delbut = this.ui.getDeleteDBButton(dbid);\n\t\tif(delbut) td6.appendChild(delbut);\n\n\t\ttr.appendChild(td1);\n\t\ttr.appendChild(td2);\n\t\ttr.appendChild(td3);\n\t\t//tr.appendChild(td4);\n\t\t//tr.appendChild(td5);\n\t\t//tr.appendChild(td6);\n\t\ttbody.appendChild(tr);\n\t}\n\tscd.appendChild(tbody);\n\tsec.appendChild(scd);\n\n\tif(this.ui.pluginAvailable(\"datatables\")){\n        var dt = new Datatables.CspDatatables(this.ui);\n\t\tvar tab = dt.draw(scd);\n\t}\n\treturn sec;\n}\n\n\nmodule.exports = {TerminusServerViewer,TerminusServerController}\n","const TerminusClient = require('@terminusdb/terminus-client');\nconst HTMLHelper = require('../html/HTMLHelper');\nconst UTILS= require('../Utils')\n\n/*** client side processing ***/\nfunction CspDatatables(ui){\n    this.ui = ui;\n}\n\nCspDatatables.prototype.convertToDatatable = function(tab){\n    var dt = this;\n    var table = jQuery(tab).DataTable({\n         searching : false,\n         pageLength: 25,\n         lengthMenu: [10, 25, 50, 75, 100],\n         paging    : true,\n         select    : true,\n         initComplete: function(settings) {\n                        var ict =settings.oInstance.api();\n                        ict.$('td').each(function(){\n                            this.setAttribute('title', $(this).html())\n                        })},\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\n         createdRow: function(row) {\n                            var td = $(row).find(\".truncate\");\n                            td.attr(\"title\", td.html());}\n    }); //jQuery(tab)\n\n    // on click of row connect to db, on click of 5th column delete db\n    jQuery(tab, 'tbody').on('click', 'td', function(){\n        if(table.cell(this).index().column == 5){\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\n            dt.ui.deleteDatabase(dbId);\n            return;\n        }\n        else dt.ui.showDBMainPage();\n     }); // on click\n\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\n    tab.setAttribute('cellpadding', '1');\n    tab.setAttribute('cellspacing', '0');\n    tab.setAttribute('border'     , '0');\n    return tab;\n}\n\nCspDatatables.prototype.draw = function(dtResult){\n    return(this.convertToDatatable(dtResult));\n}\n\n/*** server side processing ***/\nfunction Datatables(wResViewer, qPage){\n   this.wrViewer = wResViewer;\n   this.wQuery = wResViewer.wQuery;\n   this.ui = wResViewer.ui;\n   this.qPage = qPage;\n   this.currDTSettings = wResViewer.settings;\n}\n\n/*\n    query: new woqlquery with current pagination changes\n    pageInfo: current drawCallBack page change info\n    resultDOM: result dom on veiwer page\n*/\nDatatables.prototype.executeQuery = function(qObj, pageInfo, resultDOM){\n    var self = this;\n    // return this.wQuery.execute(query)\n    return qObj.execute(this.ui.client)\n    .then(function(result){\n      var dtResult = {};\n      var wqRes = new TerminusClient.WOQLResult(result, qObj);\n      dtResult = self.wrViewer.formatResultsForDatatableDisplay(result.bindings, pageInfo)\n      return dtResult.data;\n    })\n    .catch(function(err){\n      console.error(err);\n      self.ui.showError(err);\n    });\n}\n\n/* get query string based on datatable pagination and current query */\n/*Datatables.prototype.getQueryOnPagination = function(wq, settings){\n    switch(settings.query){\n        case 'Show_All_Documents':\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_All_Data':\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_All_Schema_Elements':\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_Document_Classes':\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\n            return wq.getClassMetaDataQuery(sqp);\n        break;\n        case 'Show_All_Properties':\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_All_Classes':\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_Data_Class':\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\n        break;\n        case 'Show_Property_Class':\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\n        break;\n        case 'Show_Document_Info_by_Id':\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\n        break;\n        case 'Show_All_Document_classes':\n            return wq.getClassesQuery(settings.pageLength, settings.start);\n        break;\n        default:\n            console.log('Invalid woql option passed');\n        break;\n\n    }\n}   */\n/*\n    pageInfo: current drawCallBack page change info\n*/\nDatatables.prototype.generateNewQueryOnPageChange = function(pageInfo){\n    if(this.qPage) UTILS.deleteStylizedEditor(this.ui, pageInfo.qTextDom);\n    var qObj = UTILS.getCurrentWoqlQueryObject(null, pageInfo);\n    //var query = this.getQueryOnPagination(this.wQuery, pageInfo)\n    if(this.qPage) {\n        if(pageInfo.queryMode.value == 'woql')\n            pageInfo.qTextDom.value = JSON.stringify(qObj.prettyPrint(), undefined, 2);\n        else pageInfo.qTextDom.value = JSON.stringify(qObj, undefined, 2);\n        UTILS.stylizeEditor(this.ui, pageInfo.qTextDom, 'query', 'javascript');\n    }\n    //return query;\n    return qObj;\n}\n\n/*\n    dt: Datatable reference\n    len : current number of records to display\n*/\nDatatables.prototype.getCallbackSettings = function(dt, dtAPIChangeSettings){\n    var pageInfo = {};\n    pageInfo.pageLength  = dtAPIChangeSettings._iDisplayLength;\n    pageInfo.start       = dtAPIChangeSettings._iDisplayStart;\n    pageInfo.draw        = dtAPIChangeSettings.iDraw;\n    pageInfo.qTextDom    = dt.qTextDom;\n    pageInfo.queryMode   = dt.queryMode;\n    if(this.qPage) pageInfo.query = dt.query;\n    else pageInfo.query = 'Show_All_Document_classes';\n    pageInfo.chosenValue = dt.chosenValue;\n    return pageInfo;\n}\n\n/*\n    tab: datatable table dom\n    settings : settings from woql txt generator\n    resultDOM: result dom of viewer\n*/\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\n    // delete previous datatable\n    HTMLHelper.removeChildren(this.dtdom);\n    this.dtdom = document.createElement('div');\n    this.dtdom.appendChild(tab);\n    resultDOM.appendChild(this.dtdom);\n    // saving query text box dom to change limit value on change of datatable page length\n    this.qTextDom = settings.qTextDom;\n    this.query = settings.query;\n    this.chosenValue = settings.chosenValue;\n    this.queryMode = settings.queryMode;\n}\n\n// update datatables settings so it can be reused in WOQLTextboxGenerator to re write query in woql/ jsonld\nDatatables.prototype.updateCurrDTSettings = function(pageInfo){\n    this.currDTSettings.pageLength = pageInfo.pageLength;\n    this.currDTSettings.start      = pageInfo.start;\n}\n\nDatatables.prototype.getNewDataOnChange = function(drawnTab, aSettings, resultDOM){\n    var pageInfo = this.getCallbackSettings(this, aSettings);\n    this.updateCurrDTSettings(pageInfo);\n   // var query = this.generateNewQueryOnPageChange(pageInfo);\n    var qObj = this.generateNewQueryOnPageChange(pageInfo);\n    return this.executeQuery(qObj, pageInfo, resultDOM);\n    //return this.executeQuery(query, pageInfo, resultDOM);\n    //return  dtResult.result.data;\n}\n\nDatatables.prototype.getDataFromServer = function(dtResult, resultDOM){\n    var dt = this;\n    var tab = dtResult.tab;\n    this.setUp(tab, this.wrViewer.settings, resultDOM);\n    // initialize datatables\n    var table = jQuery(tab).DataTable({\n         searching   : false,\n         pageLength  : dt.wrViewer.settings.pageLength,\n         serverSide  : true,\n         processing  : true,\n         lengthMenu  : [25, 50, 75, 100],\n         dom         : 'RBlftip',\n         columns     : dtResult.result.columns,\n         paging      : true,\n         select      : true,\n         autoWidth   : true,\n         ajax        : function (data, callback, settings) {\n                            if(Object.entries(dtResult.result.data).length > 0){\n                                // first draw is loaded\n                                var res = dtResult.result.data;\n                                dtResult.result.data = {};\n                                callback(res);\n                            }\n                            else{\n                                dt.getNewDataOnChange(this, settings, resultDOM)\n                                    .then(function(result){\n                                     callback(result);\n                                })\n                            }\n                       },\n         buttons     : [{ extend: 'copy', text: 'Copy to clipboard' },\n                        { extend: 'excel', text: 'Export to Excel' }],\n         columnDefs  : [{ targets:'_all',\n                          className:\"truncate\"}],\n         createdRow  : function(row){\n                            var td = $(row).find(\".truncate\");\n                            td.attr(\"title\", td.html());},\n         scrollX     : true\n    }); //jQuery(tab)\n\n    // on click of doc\n    jQuery(tab, 'tbody').on('click', 'td', function(){\n        if(table.cell(this).data){\n            if(this.innerText.substring(0, 4) == \"doc:\"){\n                if(dt.wrViewer.result.ui) {\n        \t\t\tdt.wrViewer.result.ui.showDocument(this.innerText);\n        \t\t\tdt.wrViewer.result.ui.redraw();\n        \t\t\tdt.wrViewer.selectDocumentNavBar(dt.ui);\n        \t\t}\n            }\n        }\n     }); // on click\n\n    //styling\n    tab.setAttribute('class'      , 'stripe dataTable');\n    tab.setAttribute('style'      , 'margin: 0!important');\n    tab.setAttribute('cellpadding', '1');\n    tab.setAttribute('cellspacing', '1');\n    tab.setAttribute('border'     , '0');\n\n    return tab;\n}\n\n/*\nserverside: true or false\n*/\nDatatables.prototype.draw = function(dtResult, resultDOM){\n    return(this.getDataFromServer(dtResult, resultDOM));\n}\n\nmodule.exports={Datatables, CspDatatables}\n","const UTILS = require(\"./Utils.js\");\n\nfunction TerminusURLLoader(ui, val){\n\tthis.ui = ui;\n\tthis.val = val;\n\tthis.url_input = false;\n\tthis.key_input = false;\n}\n\nTerminusURLLoader.prototype.getLabelDOM = function(){\n\treturn document.createTextNode(\"Connect\");\n}\n\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-display-flex terminus-field-\"+fname);\n\tvar lab = document.createElement(\"span\");\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\n\tlab.appendChild(document.createTextNode(ltxt))\n\tip.setAttribute(\"type\", \"text\");\n\tip.setAttribute(\"placeholder\", pholder);\n\tsci.appendChild(lab);\n\tsci.appendChild(ip);\n\treturn sci;\n}\n\nTerminusURLLoader.prototype.getAsDOM = function(){\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\n\tscd.appendChild(UTILS.getHeaderDom('Connect To Terminus Server'));\n\tvar mfd = document.createElement('div');\n\tmfd.setAttribute('class', 'terminus-form-border terminus-margin-top');\n\tscd.appendChild(mfd);\n\tthis.url_input = document.createElement(\"input\");\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\n\tif(this.val){\n\t\tthis.url_input.value = this.val;\n\t}\n\tvar dht = document.createElement('div');\n\tdht.setAttribute('class', 'terminus-form-margin-top');\n\tmfd.appendChild(dht);\n\tif(!this.ui.attachedServer()){\n\t\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\n\t}\n\tthis.key_input = document.createElement(\"input\");\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\n\tvar loadbuts = document.createElement(\"div\");\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\n\tvar loadbut = document.createElement(\"button\");\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn terminus-btn-float-right\");\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\n\tvar self = this;\n\tloadbut.addEventListener(\"click\", function(){\n\t\tlet keyval = self.key_input.value;\n\t\tlet url = (self.ui.attachedServer() ? self.ui.attachedServer() : self.url_input.value); \n\t\tif(url){\n\t\t\tself.ui.load(url, keyval);\n\t\t}\n\t});\n\tloadbuts.appendChild(loadbut);\n\tmfd.appendChild(loadbuts);\n\treturn scd;\n}\n\n\nmodule.exports=TerminusURLLoader\n"],"sourceRoot":""}