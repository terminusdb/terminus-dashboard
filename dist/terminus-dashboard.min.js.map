{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/index.js","webpack://TerminusDashboard/./node_modules/axios/lib/utils.js","webpack://TerminusDashboard/./src/client/HTMLFrameHelper.js","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./src/query/WOQLQuery.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/errorMessage.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/frameHelper.js","webpack://TerminusDashboard/./src/client/RenderingMap.js","webpack://TerminusDashboard/./src/client/TerminusClassChooser.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/const.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/utils.js","webpack://TerminusDashboard/./src/query/WOQLResultsViewer.js","webpack://TerminusDashboard/./src/client/ObjectViewer.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/bind.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/buildURL.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/isCancel.js","webpack://TerminusDashboard/./node_modules/axios/lib/defaults.js","webpack://TerminusDashboard/./node_modules/axios/lib/adapters/xhr.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/createError.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/mergeConfig.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/Cancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionCapabilities.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/terminusIDParser.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/framePattern.js","webpack://TerminusDashboard/./src/client/TerminusDocument.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/client/viewers/String.js","webpack://TerminusDashboard/./src/client/viewers/DateHelper.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapHelper.js","webpack://TerminusDashboard/./src/client/PropertyViewer.js","webpack://TerminusDashboard/./src/client/DataViewer.js","webpack://TerminusDashboard/./src/client/TerminusDB.js","webpack://TerminusDashboard/./src/client/TerminusDocumentChooser.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlClient.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/buffer/index.js","webpack://TerminusDashboard/(webpack)/buildin/global.js","webpack://TerminusDashboard/./node_modules/base64-js/index.js","webpack://TerminusDashboard/./node_modules/ieee754/index.js","webpack://TerminusDashboard/./node_modules/isarray/index.js","webpack://TerminusDashboard/./node_modules/axios/index.js","webpack://TerminusDashboard/./node_modules/axios/lib/axios.js","webpack://TerminusDashboard/./node_modules/axios/node_modules/is-buffer/index.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/Axios.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/InterceptorManager.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/transformData.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/normalizeHeaderName.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/settle.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/enhanceError.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/parseHeaders.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/isURLSameOrigin.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/cookies.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/isAbsoluteURL.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/combineURLs.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/CancelToken.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/spread.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/objectFrame.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woql.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/WOQLResult.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/client/ObjectRenderer.js","webpack://TerminusDashboard/./src/client/viewers/StringEditor.js","webpack://TerminusDashboard/./src/client/viewers/Boolean.js","webpack://TerminusDashboard/./src/client/viewers/BooleanEditor.js","webpack://TerminusDashboard/./src/client/viewers/Choice.js","webpack://TerminusDashboard/./src/client/viewers/ChoiceEditor.js","webpack://TerminusDashboard/./src/client/viewers/Coordinate.js","webpack://TerminusDashboard/./src/client/viewers/CoordinateEditor.js","webpack://TerminusDashboard/./src/client/viewers/Date.js","webpack://TerminusDashboard/./src/client/viewers/DateEditor.js","webpack://TerminusDashboard/./src/client/viewers/Entity.js","webpack://TerminusDashboard/./src/client/viewers/EntityEditor.js","webpack://TerminusDashboard/./src/client/viewers/Image.js","webpack://TerminusDashboard/./src/client/viewers/ImageEditor.js","webpack://TerminusDashboard/./src/client/viewers/Link.js","webpack://TerminusDashboard/./src/client/viewers/Number.js","webpack://TerminusDashboard/./src/client/viewers/Range.js","webpack://TerminusDashboard/./src/client/viewers/RangeEditor.js","webpack://TerminusDashboard/./src/client/viewers/SanitizedHTML.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapEditor.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapViewer.js","webpack://TerminusDashboard/./src/client/viewers/HTMLMarkupEditor.js","webpack://TerminusDashboard/./src/client/viewers/S2EntityEditor.js","webpack://TerminusDashboard/./src/client/ValueRenderer.js","webpack://TerminusDashboard/./src/client/TerminusViolation.js","webpack://TerminusDashboard/./src/client/TerminusQuery.js","webpack://TerminusDashboard/./src/query/WOQLTextboxGenerator.js","webpack://TerminusDashboard/./src/client/TerminusPropertyChooser.js","webpack://TerminusDashboard/./src/client/TerminusMapping.js","webpack://TerminusDashboard/./src/client/TerminusSchema.js","webpack://TerminusDashboard/./src/client/TerminusServer.js","webpack://TerminusDashboard/./src/client/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","WOQLClient","ConnectionCapabilities","ConnectionConfig","IDParser","ErrorMessage","FrameHelper","ObjectFrame","WOQL","WOQLResult","isBuffer","toString","isArray","val","isObject","isFunction","forEach","obj","fn","length","isArrayBuffer","isFormData","FormData","isArrayBufferView","ArrayBuffer","isView","buffer","isString","isNumber","isUndefined","isDate","isFile","isBlob","isStream","pipe","isURLSearchParams","URLSearchParams","isStandardBrowserEnv","navigator","product","window","document","merge","result","assignValue","arguments","deepMerge","extend","a","b","thisArg","trim","str","replace","TerminusPluginManager","require","TerminusClient","HTMLFrameHelper","type","control","label","callback","disabled","dpropDOM","createElement","setAttribute","button","appendChild","createTextNode","addEventListener","this","innerHTML","objId","getElementsByClassName","style","background","view","pluginAvailable","icon","options","selected","sel","opt","labelFromURL","which","renderer","viewsDOM","setMode","getActionControl","isNew","cancel","url","location","href","loc","split","sh","getShorthand","bits","htmlid","prop","wrap","text","max_cell_size","max_word_size","substring","replacements","words","word","newstr","k","varname","lastIndexOf","help","input","infoDOM","linfo","lspacer","lval","Codemirror","getHeaderDom","hd","h","stylizeCodeDisplay","ui","txt","dom","cmConfig","pr","colorizePre","removeSelectedNavClass","el","classList","remove","showSubMenus","add","tolggleContent","content","display","stylizeEditor","cm","ar","colorizeTextArea","updateTextArea","deleteStylizedEditor","qip","nextElementSibling","removeChildren","showHttpResult","response","action","currForm","terminator","br","retHttpHeaders","headers","hdres","json","then","rd","data","JSON","stringify","pre","getResponse","getInfoAlertDom","msg","ald","getFunctionSignature","sigs","spec","descr","args","server_url","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","toggleVisibility","contains","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","displayDocumentSubMenus","showControl","setSelectedSubMenu","checkForMandatoryId","activateSelectedNav","nav","preloaded","loaded","loading","precluded","plugins","css","js","requires","setPluginOptions","opts","init","calculatePreloaded","toload","calculateRequiredInitPlugins","self","loadPlugins","pins","pid","indexOf","push","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","plugin","version_check","pluginmeta","version","jQuery","slider","e","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","console","log","Error","element","span","className","body","insertBefore","getComputedStyle","getPropertyValue","removeChild","ticker","cback","loadPlugin","pug","cssid","loadDynamicCSS","scripts","sid","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","getElementById","parentNode","cssurl","pluginLoadable","pluginLoadedOrLoading","getPluginDOM","plugid","cl","cbox","id","checked","clab","togglePlugin","redraw","unloadPlugin","drawPlugins","num","getAsDOM","dm","clh","showPlugins","WOQLQuery","client","default_limit","prefixes","connectionConfig","platformEndpoint","server","colid","dbid","serverURL","schemaURL","dbURL","docURL","pref","standard_urls","setPrefixes","shorten","execute","wrapped","select","getConcreteDocumentClassPattern","varc","and","getSubclassQueryPattern","not","getAbstractQueryPattern","quad","clsname","sub","queryWrappedWithLimit","query","limit","start","getAllDocumentQuery","constraint","triple","getEverythingQuery","wjson","getPropertyListQuery","getElementMetaDataQuery","getClassListMetaDataQuery","getClassMetaDataQuery","getDataOfChosenClassQuery","chosen","getDataOfChosenPropertyQuery","getInstanceMeta","getDocumentQuery","getClassesQuery","getErrorAsMessage","api","err","formatErrorMessage","status","method","nmsg","keys","getAPIErrorMessage","getAccessDeniedMessage","accessDenied","db","getInvalidURIMessage","parseAPIError","error","redirected","rdf","rdfs","xsd","owl","tcs","tbs","xdd","v","terminus","vio","docs","prefix","node","hasChildNodes","childNodes","Math","random","Date","getTime","link","full","ida","idb","unshorten","sha","shb","validURL","nurl","urlFragment","charAt","toUpperCase","slice","urlStr","baseUrl","stype","urlFirst","urlTmp","ext","viewIncludesProperties","parts","join","ty","parsed","parseXsdDate","parseXsdTime","parseXsdDateTime","year","month","day","tz","extractXsdTimezone","abs","parseInt","timezone","nparsed","hour","minute","second","xparsed","addXsdPadding","ret","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertTimestampToXsd","datetime","ptime","dividor","vals","scriptid","src","existingScript","script","onload","rel","ObjectViewer","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","SantizedHTMLViewer","GoogleMapEditor","GoogleMapViewer","HTMLMarkupEditor","S2EntityEditor","RenderingMap","registeredDataViewers","registeredDataEditors","registeredPropertyViewers","registeredPropertyEditors","registeredObjectViewers","registeredObjectEditors","getValidDataViewerList","frametype","valids","concat","getValidDataEditorList","nftypes","getValidPropertyViewerList","proptype","proprange","propdom","getValidPropertyEditorList","getViewer","vi","renderers","viewer","eval","alert","getAvailablePropertyViewers","viewers","nviewers","sets","getAvailablePropertyEditors","getAvailableDataViewers","getAvailableDataEditors","getViewerForDataFrame","getEditorForDataFrame","registerViewerForTypes","types","registerEditorForTypes","registerEditorForFrameType","registerViewerForFrameType","registerViewerForProperties","properties","registerEditorForProperties","HTMLPropertyViewer","patternMatchesRenderer","pattern","FramePattern","checkRenderer","compiled_options","compileOptions","parent","facets","getDefaultFacets","facet","deffacet","getDefaultFacet","hide_disabled_buttons","features","controls","viewerType","viewerOptions","header","header_viewer","HTMLObjectHeaderViewer","filter","sort","rules","output","frame_type","subject","subjectClass","range","children","depth","index","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","j","values","isUpdated","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","frame","ftype","renderder","getLabel","stringMatch","compareIDs","vala","valb","RegExp","test","constructor","renderer_type","TerminusClassChooser","choice","show_single","setRoot","root","setFilter","change","cls","ccdom","ccsel","wq","getResultsAsOptions","clist","choices","bindings","empty_choice","opt1","added","bclass","getVariableValueFromBinding","lab","freeze","CONNECT","GET_SCHEMA","UPDATE_SCHEMA","UPDATE_DOCUMENT","CLASS_FRAME","WOQL_SELECT","GET_DOCUMENT","DELETE_DATABASE","DELETE_DOCUMENT","CREATE_DATABASE","CREATE_DOCUMENT","WOQL_UPDATE","authorityActionsToArr","Array","map","item","URIEncodePayload","payload","encodeURIComponent","payloadArr","keyElement","valueElement","Datatables","UTILS","res","WOQLResultsViewer","wresult","wQuery","settings","queryPage","qPage","pman","count","hasBindings","showTable","show_table","orderColumns","sample","ordered","unshift","resultDOM","displayResultHeader","rs","rh","getTableDOM","nor","dtResult","getTable","tab","draw","getDtTableDOMOnChange","pageInfo","formatResultsForDatatableDisplay","columns","colDataData","formattedResult","ordered_headings","wrapShortenedText","innerText","outerHTML","recordsTotal","recordsFiltered","getTableBody","tbody","tr","td","getDocumentLocalLink","selectDocumentNavBar","showDocument","dtPlugin","thead","thr","th","HTMLObjectViewer","headerViewer","getObjectHeaderViewer","render","renderedDOM","getObjectDOM","replaceWith","getObjectIDMarker","getObjectBodyDOM","orientation","getContentOrientation","pcls","sp","vholder","getFeatureDOM","feature","hasFeatureViewer","featureViewer","redrawHeader","nheader","redrawBody","nbody","addRenderedProperty","renderedprop","clear","goTo","subj","goToName","idm","sumDOM","controlsDOM","objDOM","showFeature","facetDOM","getObjectFacetDOM","getObjectLabelDOM","idDOM","getObjectIDDOM","typeDOM","getObjectTypeDOM","getObjectStatusDOM","viewDOM","getViewPropertyDOM","hideDOM","getViewerSelectorDOM","getObjectControlsDOM","getObjectSummaryDOM","sum","getSummary","getInfoboxDOM","addDOM","getAddPropertyDOM","getModeSelectorDOM","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","rpropDOM","getObjectResetDOM","upropDOM","getObjectUpdateDOM","showDOM","getObjectShowDOM","getObjectHideDOM","viewables","getAvailableFacets","mpropDOM","getSelectionControl","currentFacet","setFacet","isNewDocument","required","isClassChoice","cs","getAvailableClassChoices","mlabDOM","changeClass","getClassMeta","cmt","addables","getAddableProperties","cardControlAllows","addNewProperty","getViewableProperties","goToProperty","clone","reset","getAvailableViewers","currentViewer","setViewer","hide","show","save","apply","utils","encode","params","paramsSerializer","serializedParams","toISOString","hashmarkIndex","__CANCEL__","normalizeHeaderName","DEFAULT_CONTENT_TYPE","setContentTypeIfUnset","adapter","defaults","process","XMLHttpRequest","transformRequest","transformResponse","parse","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","validateStatus","common","settle","buildURL","parseHeaders","isURLSameOrigin","createError","config","Promise","resolve","reject","requestData","requestHeaders","request","auth","username","password","Authorization","btoa","open","onreadystatechange","readyState","responseURL","responseHeaders","getAllResponseHeaders","responseType","responseText","statusText","onabort","onerror","ontimeout","cookies","xsrfValue","withCredentials","read","undefined","toLowerCase","setRequestHeader","onDownloadProgress","onUploadProgress","upload","cancelToken","promise","abort","send","enhanceError","message","code","config1","config2","Cancel","CONST","connection","setClientKey","getClientKey","curl","addConnection","capabilities","capabilitiesKeys","pred","auths","scope","actions","actionsArr","nrec","serverConnected","capabilitiesPermit","connectionMode","client_checks_capabilities","rec","getServerRecord","getDBRecord","srvr","connectionObj","okeys","oid","dbCapabilityID","getServerDBRecords","dbrecs","removeDB","dbidCap","newParams","docid","setServer","setDB","doc","setDocument","connected_mode","include_key","includeKey","queryURL","frameURL","baseURL","inputStr","context","parser","parseServerURL","parseDBID","setSchemaURL","parseSchemaURL","parseDocumentURL","setQueryURL","parseQueryURL","setClassFrameURL","parseClassFrameURL","setContext","validPrefixedURL","expandPrefixed","validIDString","stripOptionalPath","bit","FramePatternMatcher","FrameRule","rule","testRules","onmatch","matched_rules","patternMatchesFrame","checkFrame","setPattern","isProperty","isData","rend","setRenderer","func","compare","Renderers","TerminusDBViewer","TerminusDocumentViewer","page_config","editor","load_schema","config_options","getBuiltInViewerOptions","dbViewer","classmeta","instancemeta","refreshPage","getJsonLdViewer","getDocument","clearBusy","pagedom","document_json_response","ohv","getDocumentJsonldCreateButton","json_editor","getEncodingChooserDOM","scd","nbuts","enc","oframe","ojson","viewMode","ccDOM","getDocumentChooserDOM","holder","dcip","nbut","mcls","d2ch","TerminusDocumentChooser","sdom","nlab","click","prepend","getDocumentCreatorSelect","termcc","new_class","showCreateDocument","getDocumentCreatorDOM","cr","showBusy","createDocument","getListOfDocuments","showError","getDocumentJsonldSaveButton","sv","updateDocument","toggleControlActions","lod","getClassesDOM","getDocumentEditControls","dpc","getDocumentSubMenus","ul","active","controldom","loadDocumentHome","sd","elid","loadCreateDocument","loadDocumentSchema","setLabel","loadDocument","loadDataFrames","ncls","getClassFrame","loadSchemaFrames","deleteDocument","URL","extr","showViolations","durl","subjid","dataframes","domain","classframes","loadClassFrames","newDoc","fillFromSchema","getOptionsFromPageConfig","ObjectRenderer","controller","FrameConfig","pageconf","getClient","extract","labdom","dfs","getDataFrames","getStdURL","rends","getDocumentPageControls","CspDatatables","wResViewer","wrViewer","convertToDatatable","dt","table","DataTable","searching","pageLength","lengthMenu","paging","initComplete","oInstance","$","each","html","columnDefs","targets","createdRow","row","find","attr","on","cell","column","showDBMainPage","dbInfo","parents","dbId","deleteDatabase","executeQuery","getQueryOnPagination","sqp","chosenValue","generateNewQueryOnPageChange","qTextDom","getCallbackSettings","dtAPIChangeSettings","_iDisplayLength","_iDisplayStart","iDraw","setUp","dtdom","getNewDataOnChange","drawnTab","aSettings","getDataFromServer","serverSide","processing","autoWidth","ajax","entries","buttons","scrollX","size","getDOM","dataviewer","HTMLDateHelper","months","getMonthName","GoogleMapHelper","polygon","polyline","markers","width","height","mapLat","mapLong","zoom","stroke","color","opacity","weight","fill","line","destroy","translatePolygonToArray","vertices","getPath","seenValue","getLength","xy","getAt","lat","lng","translateArrayToPolygon","array","jsonified","latlong","createPolygon","coords","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","setMap","createPolyline","Polyline","clearMarkers","addMarker","position","marker","Marker","addListener","getCoordsFromMarkers","set","x","initMap","mapContainer","center","parseFloat","setPath","event","trigger","getPropertyHeaderViewer","HTMLPropertyHeaderViewer","propDOM","npropDOM","getPropertyDOM","getPropertyIDMarker","getPropertyBodyDOM","addRenderedValue","renderedval","wrapper","expModeMenu","getPropertyControlsDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","getPropertySummaryDOM","prelude","getPropertyFacetDOM","getViewValueDOM","getPropertyIDDOM","getPropertyRangeDOM","hasCardinalityRestriction","getPropertyCardinalityDOM","getPropertyCommentDOM","getComment","restriction","getRestriction","min","max","getActionControlDOM","settingsDOM","getPropertyDeleteDOM","getAddValueDOM","getPropertyResetDOM","getPropertyUpdateDOM","getPropertyShowDOM","getPropertyHideDOM","getSettingsControlDOM","addClass","getViewableValues","goToValue","showValue","HTMLDataViewer","getValueHeaderViewer","HTMLDataHeaderViewer","JSONObjectViewer","valDOM","nvalDOM","getValueDOM","getValueIDMarker","getValueBodyDOM","vdom","getDataValueViewer","getSummaryDOM","HTMLTerminusClient","fireInternalLink","preventDefault","load","internalLink","onclick","onClick","getValueFacetDOM","getValueTypeDOM","getValueStatusDOM","getValueControlsDOM","getValueDeleteDOM","getValueCloneDOM","getValueResetDOM","getValueUpdateDOM","getValueShowDOM","getValueHideDOM","TerminusDBController","wquery","TerminusDBCreator","dbc","dbrec","nm","getControlHTML","showQueryPage","showMappingPage","showSchemaPage","showDocumentPage","ic","tcdom","gb","bi","tds","bt","tts","nlabs","pd","sth","banner","dhp","scs","getDeleteOnHomePage","getDbInfoBox","info","del","dbdel","confirm","getDBSummary","q","nd","sct","mfd","sci","slab","idip","titip","descip","schem","kip","datip","butfield","cancbut","loadbut","schema","gatherips","createDatabase","showServerMainPage","show_button","getS2DOM","getIDDOM","docchooser","cfilter","tdom","s2config","dataType","contentType","delay","cache","placeholder","keyCode","dbut","toggleView","getChangeViewText","TerminusUI","ApiExplorer","TerminusDBsdk","TerminusViolations","TerminusQueryViewer","TerminusMappingViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","setOptions","connect","connectToDB","showView","explorer","showExplorer","dbdets","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","getCrashString","showMessage","delrec","lid","dbn","dets","fname","getConnectionEndpoint","clearServer","clearDB","TerminusServerViewer","redrawMainPage","showLoadURLPage","showCreateDBPage","mapping","getDocViewerOptions","getDocCreatorOptions","main","showResult","clearMessages","messages","clearMainPage","setMessageDOM","setbuttonControls","setControllerDOM","setExplorerDOM","setPluginsDOM","setViewerDOM","comps","slocation","toggleControl","drawControls","toggleDashboardWidget","widget","drawExplorer","loadControls","ncontrol","exp","ae","sc","TerminusServerController","show_controls","pseudoCapability","show_views","busy","getBusyLoader","bsyDom","pbc","pbsa","pbia","md","msgHolder","vios","nvios","cmsg","views","document_options","schema_options","piman","addPlugin","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getClassFrames","viewDocument","update","use_fetch","return_full_response","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","navOnSelect","createNavs","navConfig","navDom","cont","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","getSignature","getForm","getServerForm","form","fd","inpLabel","cd","inpId","keyLabel","resd","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","inpKey","docLabel","inpDoc","inp","docUrl","getApiSendButton","getApiForm","schurl","buttonSelf","gtxtar","txtar","dcurl","schemaUrlDom","htmlEditor","getValue","sg","sig","DispatchRequest","URIError","dispatch","dburl","makeDocumentConsistentWithURL","addOptionsToDocument","docurl","qurl","addOptionsToWOQL","cfurl","pdoc","_","addKeyToPayload","dispatchFetch","redirect","referrer","hdrs","credentials","Headers","fetch","ok","btoaImplementation","Buffer","from","axios","delete","catch","post","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","Uint8Array","__proto__","arg","encodingOrOffset","allocUnsafe","TypeError","byteOffset","byteLength","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","len","copy","fromObject","assertSize","loweredCase","utf8ToBytes","base64ToBytes","slowToString","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","arr","indexSize","arrLength","valLength","String","buf","readUInt16BE","foundIndex","hexWrite","offset","Number","remaining","strLen","substr","utf8Write","blitBuffer","asciiWrite","byteArray","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","allocUnsafeSlow","_isBuffer","y","list","pos","swap16","swap32","swap64","equals","inspect","match","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","out","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","dst","g","Function","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","Axios","mergeConfig","createInstance","defaultConfig","instance","instanceConfig","CancelToken","isCancel","all","promises","spread","default","InterceptorManager","dispatchRequest","interceptors","chain","interceptor","fulfilled","rejected","shift","getUri","handlers","use","eject","transformData","isAbsoluteURL","combineURLs","throwIfCancellationRequested","throwIfRequested","reason","fns","normalizedName","isAxiosError","number","fileName","lineNumber","columnNumber","stack","ignoreDuplicateOf","originURL","msie","userAgent","urlParsingNode","resolveURL","protocol","host","search","hash","hostname","port","pathname","requestURL","expires","path","secure","cookie","toGMTString","decodeURIComponent","now","relativeURL","executor","resolvePromise","token","parentframe","empty","originalFrames","PropertyFrame","cframe","predicate","DataFrame","ClassFrame","Restriction","loadRestriction","jsonld_context","cf","isValid","hasSchema","frames","domainValue","getPropertyClassFrame","getChosenClassFrame","isLogic","getChosenFrame","addFrame","getAsFrame","ff","getAsFrames","isnew","restrictions","props","cascading","ignore_failure","filled","missing","getMissingPropertyList","nmissing","newb","getFilledPropertyList","newid","genBNID","pf","cloned","getChild","childid","pframe","getProperty","addProperty","createEmpty","createEmptyChoice","clss","getClassChoices","df","addPropertyValue","addValue","removeProperty","removePropertyValue","removeValue","first","parentObject","renderProperties","sortProperties","nprops","unsorted","standardCompare","kid","hasRestriction","extracts","updated","childUpdated","deletePropertyValue","gets","renderValues","sortedVals","sortValues","rangeValue","comment","originalValue","nrend","setNew","isValidType","hasCardRestriction","getType","isObjectProperty","isDatatypeProperty","isRestriction","isDocument","isChoice","getChoiceOptions","elements","option","lang","getTypeShorthand","contents","normalizer","loadFromObjectFrame","par","child","getChosenClassFrames","objframe","nc","operands","dataframe","cloneDataFrame","other","domcls","operand","cardinality","maxCardinality","minCardinality","nrest","results","cursor","chain_ended","contains_update","paging_transitive_properties","when","Query","Update","or","queries","eq","isa","JSON_or_IRI","minus_triple","S","P","O","plus_triple","minus_quad","G","plus_quad","arith","plus","minus","times","divide","advanceCursor","last","isPaged","getPagingProperty","pageprop","setPagingProperty","addStart","nval","getContext","nq","nspaces","spaces","prettyPrint","indent","show_context","clauses","nxt","nvals","setLimit","getLimit","getPage","psize","hasStart","getStart","setPage","pagenum","pstart","setStart","nextPage","firstPage","previousPage","npage","hasSelect","getSelectVariables","setPageSize","lastUpdate","Context","defaultContext","DB_IRI","def","scm","Subject","Predicate","Object_or_Literal","Graph","abstract","getEverything","GraphIRI","getAllDocuments","documentMetadata","propertyMetadata","elementMetadata","classMetadata","getDataOfClass","getDataOfProperty","documentProperties","simpleGraphQuery","no_compress","compress","nprop","curor","next","prev","compareValues","asc_or_desc","getVariableList","getBindings","textdom","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","refresh","setCodemirrorSize","defaultCharWidth","setOption","setSize","setTimeout","runMode","theme","ValueRenderer","PropertyViewer","PropertyRenderer","originalValues","changed","originalProperties","newProperties","TerminusDashboard","decorateRenderer","getOptionsForChild","getOptionsForValue","getOptionsForObject","buildValueRenderers","getViewerForProperty","adorig","getDataFramesToRender","vr","kids","getChildrenToRender","kidf","viewIncludesChildren","allkids","getChildren","clsmeta","deleteProperty","addPropertyClass","rest","currentnum","new_property","hideDisabledControls","hide_disabled_controls","nocascade","parentFacetChange","page","multiline","summary","containsPage","setView","nukeViewer","ptype","valcount","vsum","getFeaturesForFacet","getOptionsForProperty","buildPropertyRenderers","getViewerForObject","getPropertiesToRender","renders","nkid","parentobj","newrend","demandid","inputID","dval","ctl","getController","new_object","isPartOfNewDocument","pfacet","vrend","propcount","nviewer","standardSort","patterns","sorted","rdft","rdfc","extractLDO","extractJSONLD","extracted","big","isBigType","getTypeSize","vallab","els","foptions","inputs","badData","lldom","getInputDOMs","long","latdom","longdom","getLatLongDOM","firstcol","delbut","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","DateHelper","allowbce","date_spacer","time_spacer","datetime_separator","helper","parseDate","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","mdom","mlab","dadom","ydom","ddom","part","xsdFromParsed","opdom","getEntityViewHTML","getEntityLabel","dv","nspan","il","tit","img","commas","numberWithCommas","delimiter","parseRangeValue","rvals","svals","useCommas","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","mapcontainer","ghelper","latLng","coo","inner","quill","nf","nvr","inline","getAPIURL","DBURL","getEntityReference","entities","bd","new_value","text_summary_length","getViewerForValue","objlit","getViewerForDataValue","ft","TerminusViolation","context_msg","vioHeading","getPropertyAsDOM","pdom","ldom","WOQLTextboxGenerator","meta","generator","gentype","generators","loadGenerator","hasGeneratorOptions","changeGenerator","ng","redrawGenerator","inputDOM","getQueryButtonsDOM","getResultViewDom","qbox","getQueryCreatorChoiceDOM","qtHolder","qTextBox","getQueryTextAreaDOM","buttonsDOM","qcc","gen","box","TerminusPropertyChooser","tq","qman","datatable","gatherDatatableSettings","txtArea","queryName","getQueryButtonGroups","qGroupQueries","qrow","srcElement","textContent","nodeName","qeb","ch","setDatatableSettings","getQueryFormatSelect","fsel","owoql","queryMode","head","eqh","fmt","qbut","qval","qbuts","qexs","qh","qcGroup","nqbut","aqbut","qvalue","ebut","pbut","prbut","qdGroup","termpc","qdocGroup","docch","docdom","d2dom","clGroup","dtGroup","docGroup","labopt","comopt","cprop","tsel","o1","o2","getFormFieldDOM","getFormField","submit","jsonip","map_source","map_target","confirm_before_update","loadSchema","msgtype","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getSchemaEditButton","getImportButton","getFormatChoices","fc","tc","tj","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","getClassFrameDOM","ssb","getCancelButton","getSaveButton","getImportSaveButton","getSchemaButton","getImportPreviewButton","is_import","doImport","schema_edit_dom","origurl","newschema","appendSchema","showConfirmPage","s2","nschema","np","docviewer","ipval","klab","modes","overwrite","append","rsc","getServerLabelDOM","srec","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","wrapTableLinkCell","tdElement","sec","lihed","th1","th2","th3","th4","th5","th6","fullid","td1","td2","td3","td4","td5","td6","deleteDBPermitted","delDB","url_input","key_input","getLabelDOM","ip","ltxt","pholder","stit","loadbuts"],"mappings":"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","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 35);\n","'use strict';\r\nmodule.exports = {\r\n\t\t\t\t WOQLClient:require('./lib/woqlClient'),\r\n                  ConnectionCapabilities:require('./lib/connectionCapabilities'),\r\n                  ConnectionConfig:require('./lib/connectionConfig'),\r\n                  IDParser:require('./lib/terminusIDParser'),\r\n                  ErrorMessage:require('./lib/errorMessage'),\r\n                  FrameHelper:require('./lib/frameHelper'),\r\n                  ObjectFrame:require('./lib/objectFrame'),\r\n                  WOQL:require('./lib/woql'),\r\n\t\t\t  \t  WOQLResult:require('./lib/WOQLResult')};\r\n","'use strict';\n\nvar bind = require('./helpers/bind');\nvar isBuffer = require('is-buffer');\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||\n                                           navigator.product === 'NativeScript' ||\n                                           navigator.product === 'NS')) {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = merge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Function equal to merge with the difference being that no reference\n * to original objects is kept.\n *\n * @see merge\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction deepMerge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = deepMerge(result[key], val);\n    } else if (typeof val === 'object') {\n      result[key] = deepMerge({}, val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  deepMerge: deepMerge,\n  extend: extend,\n  trim: trim\n};\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nlet HTMLFrameHelper = {};\r\n\r\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\r\n\tvar pman = new TerminusPluginManager();\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control terminus-save-btn \" + type + \"-\" + control);\r\n\tvar pman = new TerminusPluginManager();\r\n    /*if(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tvar faic = this.getControlIcon(control);\r\n\t\tif(disabled){\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\r\n\t\t\ticon.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\r\n\t\t\ticon.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(icon);\r\n\t}\r\n\telse{*/\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.appendChild(document.createTextNode(label));\r\n\t\tif(disabled){\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\r\n\t\t\tbutton.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action \" + type + \"-\" + control);\r\n\t\t\tbutton.addEventListener(\"click\", function(){\r\n\t\t\t\tif(this.innerHTML == 'Save'){\r\n\t\t\t\t\tvar objId = document.getElementsByClassName('terminus-object-id-input');\r\n\t\t\t\t\tif(objId.length>0){\r\n\t\t\t\t\t\tif(!objId[0].value){\r\n\t\t\t\t\t\t\tobjId[0].setAttribute('placeholder', 'Required field');\r\n\t\t\t\t\t\t\tobjId[0].style.background = '#f8d7da';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse callback(control);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse callback(control);\r\n\t\t\t\t}\r\n\t\t\t\telse callback(control);\r\n\t\t\t\t//(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(button);\r\n\t//}\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLFrameHelper.getSettingsControl = function(view){\r\n\tvar pman = new TerminusPluginManager();\r\n\tif(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\r\n\t\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\r\n\t\ticon.setAttribute('style', 'margin: 10px;')\r\n\t\treturn icon;\r\n\t}\r\n\telse{\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.setAttribute('class', 'terminus-btn');\r\n\t\tbutton.appendChild(document.createTextNode('Settings'));\r\n\t\treturn button;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getControlIcon = function(control){\r\n\tvar icon;\r\n\tswitch(control){\r\n\t\tcase 'delete':\r\n\t\t\ticon = '-alt-delete';\r\n\t\tbreak;\r\n\t\tcase 'add':\r\n\t\t\ticon = '-plus';\r\n\t\tbreak;\r\n\t\tcase 'reset':\r\n\t\t\ticon = '-undo';\r\n\t\tbreak;\r\n\t\tcase 'save':\r\n\t\t\ticon = '-save';\r\n\t\tbreak;\r\n\t\tcase 'hide':\r\n\t\t\ticon = '-eye-slash';\r\n\t\tbreak;\r\n\t}\r\n\treturn icon;\r\n}\r\n\r\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\r\n\tfor(var i = 0; i < options.length; i++){\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\tif(typeof options[i] == \"object\"){\r\n\t\t\topt.value = options[i].value;\r\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.FrameHelper.labelFromURL(options[i].value)));\r\n\t\t\topt.appendChild(label);\r\n\t\t}\r\n\t\telse {\r\n\t\t\topt.value = options[i];\r\n\t\t\tlabel = TerminusClient.FrameHelper.labelFromURL(opt.value);\r\n\t\t\topt.appendChild(document.createTextNode(label));\r\n\t\t}\r\n\t\tif(selected == opt.value){\r\n\t\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t\t}\r\n\t\tsel.appendChild(opt);\r\n\t}\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\treturn sel;\r\n}\r\n\r\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\r\n\tvar viewsDOM = document.createElement(\"span\");\r\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\r\n\tif(renderer.mode == \"view\"){\r\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\r\n\t}\r\n\telse if(renderer.isNew()){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){ renderer.cancel();}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\r\n\t}\r\n\treturn viewsDOM;\r\n}\r\n\r\nHTMLFrameHelper.goToName = function(s, p, i){\r\n\tvar url = window.location.href;\r\n\tif(url){\r\n\t\tvar wbits = url.split(\"#\");\r\n\t\tvar loc = wbits[0];\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(s);\r\n\t    if(!sh) sh = s;\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tvar htmlid = sh;\r\n\t\tif(p){\r\n\t\t\tvar prop = TerminusClient.FrameHelper.getShorthand(p);\r\n\t\t\tif(!prop ) prop = p;\r\n\t\t\tvar bits = prop.split(\":\");\r\n\t\t\tif(bits.length > 1) prop = bits[1];\r\n\t\t\thtmlid += \"_\" + prop;\r\n\t\t\tif(i){\r\n\t\t\t\thtmlid += \"_\" + i;\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.location = loc + \"#\" + htmlid;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.wrapShortenedText = function(wrap, text, max_cell_size, max_word_size){\r\n\tif(max_cell_size && (text.length > max_cell_size)){\r\n\t\twrap.setAttribute(\"title\", text);\r\n\t\ttext = text.substring(0, max_cell_size) + \"...\";\r\n\t}\r\n\tif(max_word_size){\r\n\t\tconst replacements = {}\r\n\t\tconst words = text.split(\" \");\r\n\t\tfor(var i = 0; i < words.length; i++){\r\n\t\t\tvar word = words[i];\r\n\t\t\tif(word.length > max_word_size){\r\n\t\t\t\twrap.setAttribute(\"title\", text);\r\n\t\t\t\tvar newstr = word.substring(0, max_word_size) + \"...\";\r\n\t\t\t\treplacements[word] = newstr;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var k in replacements){\r\n\t\t\ttext = text.replace(k, replacements[k]);\r\n\t\t}\r\n\t}\r\n\twrap.appendChild(document.createTextNode(text));\r\n}\r\n\r\nHTMLFrameHelper.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\tconst obj = bind[key];\r\n\t\t\tif(typeof obj == \"object\" && obj['@value']) return obj['@value'];\r\n\t\t\treturn obj;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\n/*HTMLFrameHelper.getFrameRow = function(){\r\n\tvar row = document.createElement('div');\r\n\trow.setAttribute('class', 'terminus-frame-row');\r\n\treturn row;\r\n}\r\n\r\nHTMLFrameHelper.getFrameGroup = function(frow){\r\n\tvar fl = document.createElement('div');\r\n\tfl.setAttribute('class', 'terminus-frame-length');\r\n\tfrow.appendChild(fl);\r\n\r\n\tvar fg = document.createElement('div');\r\n\tfg.setAttribute('class', 'terminus-frame-group');\r\n\tfl.appendChild(fg);\r\n\treturn fl;\r\n}*/\r\n\r\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\r\n\t/*var frow = this.getFrameRow();\r\n\tvar fgroup = this.getFrameGroup(frow);*/\r\n\tvar infoDOM = document.createElement(\"span\");\r\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\r\n\t//fgroup.appendChild(infoDOM);\r\n\tif(help){\r\n\t\tinfoDOM.setAttribute(\"title\", help);\r\n\t}\r\n\tif(label){\r\n\t\tvar linfo = document.createElement(\"span\");\r\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\r\n\t\tlinfo.appendChild(document.createTextNode(label));\r\n\t\tinfoDOM.appendChild(linfo);\r\n\t}\r\n\tvar lspacer = document.createElement(\"span\");\r\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\r\n\tlspacer.appendChild(document.createTextNode(\" \"));\r\n\tinfoDOM.appendChild(lspacer);\r\n\tvar lval = document.createElement(\"span\");\r\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value terminus-property-label-align\");\r\n\tif(input){\r\n\t\tinput.value = value;\r\n\t\tlval.appendChild(input);\r\n\t}\r\n\telse if(value) {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(value);\r\n        if(sh){\r\n    \t   \tvar bits = sh.split(\":\");\r\n            sh = bits[1];\r\n   \t\t\tlval.setAttribute(\"title\", value);\r\n\t\t\tlval.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlval.appendChild(document.createTextNode(value));\r\n\t\t}\r\n\t}\r\n\tinfoDOM.appendChild(lval);\r\n\treturn infoDOM;\r\n}\r\n\r\nmodule.exports=HTMLFrameHelper\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Set of functions used across scripts\r\n */\r\nconst Codemirror= require('./plugins/codemirror.terminus');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n// function to read Files\r\nfunction readFile(file){\r\n    if (window.XMLHttpRequest){\r\n        // code for IE7+, Firefox, Chrome, Opera, Safari\r\n        xmlhttp=new XMLHttpRequest();\r\n    }\r\n    else{\r\n        // code for IE6, IE5\r\n        xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    xmlhttp.open(\"GET\",file,false);\r\n    xmlhttp.send();\r\n    xmlDoc=xmlhttp.responseText;\r\n    return xmlDoc;\r\n} // readFile()\r\n\r\n// function to write api call signatures from woql client\r\nfunction getFunctionSignature(which){\r\n  var sigs = {};\r\n  sigs.connect = {\r\n    spec   : \"WOQLClient.connect(surl, key)\",\r\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\r\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\r\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\r\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\r\n                + \" or the promise will be rejected.\"\r\n                + \"\\n1)The first (surl) argument: {string} argument it is the Server Url\"\r\n                + \"\\n2)The second(key) argument: {string} argument contains an API key\",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {server_url : 'url', key: 'Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.create = {\r\n    spec    : \"WOQLClient.createDatabase(dburl, details, key)\",\r\n    descr   : \"\\n\\nCreate a Terminus Database\"\r\n                + \"\\n1)The first (dburl) argument:{string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(details) argument:{object}, details which is the payload\"\r\n                + \"\\n which included information of the new database to be created\"\r\n                +  \"\\n3)The third (key) argument:{string}, contains an API key \",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {database_url : 'url', details: '', key: ' Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.delete = {\r\n      spec  : \"WOQLClient.deleteDatabase(dburl, key)\",\r\n      descr : \"\\n\\nDeletes a Database\"\r\n                + \"\\n1)The first (dburl) argument: {string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n      result: \"HTTP 200 on success, otherwise error code\",\r\n  };\r\n  sigs.getSchema = {\r\n    spec   : \"WOQLClient.getSchema(surl, options)\",\r\n    descr  : \"\\n\\nGets the schema of a database.\"\r\n             +\"\\n1)The first (surl) argument: {string}, it is a dbUrl/schema\"\r\n             + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.getClassFrames = {\r\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\r\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\r\n              +  \"\\nThe first (cfurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database or\"\r\n              +  \"\\n2) omitted - the current database will be used\"\r\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\r\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.updateSchema = {\r\n    spec    : \"WOQLClient.updateSchema(schurl, docs, options)\",\r\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\r\n                +\"\\n1)The first (surl) argument :{string}, is a dbUrl/schema\"\r\n                + \"\\n2)The second(docs) argument:{object}, is a valid owl ontology (new schema to be updated) in turtle format\"\r\n                + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document : 'doc'},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.createDocument = {\r\n    spec   : \"WOQLClient.createDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nCreates a new document in the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", fail_on_id_denied: false}\r\n  };\r\n  sigs.viewDocument = {\r\n    spec    : \"WOQLClient.getDocument(docurl, options)\",\r\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url'},\r\n    options: { format: \"turtle\"}\r\n  };\r\n  sigs.updateDocument = {\r\n    spec   : \"WOQLClient.updateDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\r\n                + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n                + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n                + \"\\n3)The third (key) argument:{string} argument contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.deleteDocument = {\r\n    spec  : \"WOQLClient.deleteDocument(docurl, key)\",\r\n    descr : \"\\n\\nDeletes a document from the specified database\"\r\n            + \"\\n1)The first (docurl) argument: {string},is a dbUrl/document/document_id\"\r\n            + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args  : {document_url : 'url'},\r\n  };\r\n  sigs.select = {\r\n    spec: \"WOQLClient.select(dburl, query, options)\",\r\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {woql: 'woql'},\r\n  };\r\n  sigs.update = {\r\n    spec  : \"WOQLClient.update(dburl, query, options)\",\r\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\r\n              + \"\\n1)The first (dburl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args  : {woql: 'woql'},\r\n  };\r\n  sigs.lookup = {\r\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', term: 'string'},\r\n  };\r\n  sigs.map = {\r\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {source: 'json', target: \"json\", woql: 'json'},\r\n  };\r\n  sigs.getClassFrame = {\r\n    spec: \"WOQLClient.getClassFrame(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  sigs.getPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', property: 'url'},\r\n  };\r\n  sigs.getFilledPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {document_url: 'url', property: 'url'},\r\n  };\r\n  sigs.getSubClasses = {\r\n    spec: \"WOQLClient.getSubClasses(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  return sigs[which];\r\n}//getFunctionSignature\r\n\r\n// returns dom element for header text\r\nfunction getHeaderDom(text){\r\n  var hd = document.createElement('div');\r\n  hd.setAttribute('class', 'terminus-module-head');\r\n  var h = document.createElement('h3');\r\n  h.innerHTML = text;\r\n  hd.appendChild(h);\r\n  return hd;\r\n} // getHeaderTextDom\r\n\r\n// returns dom for alert banner\r\nfunction getInfoAlertDom(type, label, msg){\r\n  var ald = document.createElement('div');\r\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\r\n  else ald.setAttribute('class', 'alert');\r\n  var str = document.createElement('STRONG');\r\n  str.innerHTML = label;\r\n  ald.appendChild(str);\r\n  var txt = document.createTextNode(msg);\r\n  ald.appendChild(txt);\r\n  return ald;\r\n} // getInfoAlertDom()\r\n\r\n// formats response results from platform\r\nfunction getResponse(currForm, action, response, terminator){\r\n\r\n  var rd = document.createElement('div');\r\n\r\n  // get header result\r\n  rd.appendChild(getHeaderDom('Result'));\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  var data = JSON.stringify(response, 0, 4);\r\n\r\n  var pre = document.createElement('pre');\r\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\r\n  pre.innerHTML = data;\r\n\r\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\r\n  if(!cm) rd.appendChild(pre);\r\n\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  currForm.appendChild(rd);\r\n\r\n  return currForm;\r\n}\r\n\r\n// formats the response from fetch call and spits out Http header and result\r\nfunction showHttpResult(response, action, currForm, terminator){\r\n    //var currForm = document.createElement('div');\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n    // get header result\r\n    currForm.appendChild(getHeaderDom('HTTP Header'));\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n     var retHttpHeaders  = '';\r\n\r\n     // iterate over all headers\r\n     for (let [key, value] of response.headers) {\r\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\r\n     }\r\n\r\n    // http header result\r\n    var hdres = document.createElement('pre');\r\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\r\n    var txt = document.createTextNode(retHttpHeaders);\r\n    hdres.appendChild(txt);\r\n\r\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\r\n    if(!cm) currForm.appendChild(hdres);\r\n\r\n    return response.json()\r\n    .then(function(response){\r\n      getResponse(currForm, action, response, terminator); // get return response\r\n    })\r\n\r\n} // UTILS.showHttpResult()\r\n\r\n\r\nfunction deleteStylizedEditor(ui, qip){\r\n    if(ui.pluginAvailable(\"codemirror\")){\r\n\t\tvar cm = qip.nextElementSibling;\r\n\t\tcm.setAttribute('class', 'terminus-hide');\r\n\t\tTerminusClient.FrameHelper.removeChildren(cm);\r\n\t}\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   view: defines the size of editor to appear in pages (schema/ query)\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeEditor(ui, txt, view, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return;\r\n\tvar cm = new Codemirror(txt, mode, cmConfig);\r\n\tvar ar = cm.colorizeTextArea(view);\r\n\tcm.updateTextArea(ar);\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   dom: stylized pre area is appended to dom\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return false;\r\n    var cm = new Codemirror(txt, mode, cmConfig);\r\n    var pr = cm.colorizePre();\r\n    dom.appendChild(pr);\r\n    return true;\r\n}\r\n\r\n/* name: classname to find and remove classes from elements\r\n*/\r\nfunction removeSelectedNavClass(name){\r\n    var el = document.getElementsByClassName(name);\r\n    if (el.length < 1) return;\r\n    for(var i=0; i<(el.length + 1); i++){\r\n        el[i].classList.remove(name);\r\n    }\r\n}\r\n\r\nfunction setSelectedSubMenu(a){\r\n    removeSelectedNavClass(\"terminus-submenu-selected\");\r\n    a.classList.add(\"terminus-submenu-selected\");\r\n}\r\n\r\n// toggles between contents\r\nfunction tolggleContent(icon, content){\r\n    if (content.style.display === \"block\"){\r\n        removeSelectedNavClass(\"fa-chevron-up\");\r\n        icon.classList.add(\"fa-chevron-down\");\r\n        content.style.display = \"none\";\r\n    }\r\n    else{\r\n        removeSelectedNavClass(\"fa-chevron-down\");\r\n        icon.classList.add(\"fa-chevron-up\");\r\n        content.style.display = \"block\";\r\n    }\r\n}\r\n\r\n// controls current selected nav bar\r\nfunction activateSelectedNav(nav, terminator){\r\n    removeSelectedNavClass(\"terminus-selected\");\r\n\t//checkDocumentSubMenus(terminator);\r\n\tnav.classList.add(\"terminus-selected\");\r\n}\r\n\r\nfunction hideDocumentSubMenus(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n}\r\n\r\nfunction checkDocumentSubMenus(terminator){\r\n\tif(terminator.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\thideDocumentSubMenus(gd[0]);\r\n\t}\r\n\tif(terminator.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\thideDocumentSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction toggleVisibility(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n    else if(el.classList.contains('terminus-hide')){\r\n        el.classList.remove('terminus-hide');\r\n\t\tel.classList.add('terminus-display');\r\n\t}\r\n}\r\n\r\nfunction extractValueFromCell(cellValue){\r\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\r\n    return ihtml.firstChild.innerHTML;\r\n}\r\n\r\nfunction displayDocumentSubMenus(ui) {\r\n\t//display submenus on click of documents\r\n\tif(ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\tshowSubMenus(gd[0]);\r\n\t}\r\n\tif(ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\tshowSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction checkForMandatoryId(){\r\n    var objId = document.getElementsByClassName('terminus-object-id-input');\r\n    if(objId.length>0){\r\n        if(!objId[0].value){\r\n            objId[0].setAttribute('placeholder', 'Required field');\r\n            objId[0].style.background = '#f8d7da';\r\n            return false;\r\n        }\r\n        else return true;\r\n    }\r\n}\r\n\r\nfunction showSubMenus (el){\r\n\tel.classList.remove('terminus-hide');\r\n\tel.classList.add('terminus-display');\r\n}\r\n\r\n\r\nmodule.exports={tolggleContent,\r\n               removeSelectedNavClass,\r\n               stylizeCodeDisplay,\r\n               stylizeEditor,\r\n               deleteStylizedEditor,\r\n               showHttpResult,\r\n               getHeaderDom,\r\n               getInfoAlertDom,\r\n               getFunctionSignature,\r\n               toggleVisibility,\r\n               extractValueFromCell,\r\n               displayDocumentSubMenus,\r\n               setSelectedSubMenu,\r\n               checkForMandatoryId,\r\n               activateSelectedNav}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nfunction TerminusPluginManager(){\r\n\tthis.preloaded = [];\r\n\tthis.loaded = [];\r\n\tthis.loading = [];\r\n\tthis.precluded = [];\r\n\tthis.plugins = {};\r\n\tthis.plugins[\"font-awesome\"] = {\r\n\t\tlabel: \"Font Awesome\",\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\r\n\t};\r\n\tthis.plugins[\"quill\"] = {\r\n\t\tlabel: \"Quill\",\r\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\r\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\r\n\t};\r\n\tthis.plugins[\"codemirror\"] = {\r\n\t\tlabel : \"Code Mirror\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\r\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\"\r\n\t  ],\r\n\t\tcss: [\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\r\n\t\t]\r\n\t};\r\n\tthis.plugins[\"jquery\"] = {\r\n\t\tlabel: \"jQuery\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\r\n\t};\r\n\tthis.plugins[\"jqueryui\"] = {\r\n\t\tlabel: \"jQuery UI\",\r\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\r\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"datatables\"] = {\r\n\t\tlabel: \"Data Tables\",\r\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\r\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\r\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"prettify\"] = {\r\n\t\tlabel: \"Prettify\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\r\n\t\trequires: ['jquery']\r\n\t};*/\r\n\tthis.plugins[\"gmaps\"] = {\r\n\t\tlabel: \"Google Maps\",\r\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\r\n\t\t//plugin: \"gmaps.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"d3\"] = {\r\n\t\tlabel: \"d3\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"select2\"] = {\r\n\t\tlabel: \"Select 2\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"jsoneditor\"] = {\r\n\t\tlabel: \"JSON Editor\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.css\"],\r\n\t\t//plugin: \"jsoneditor.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"bootstrap\"] = {\r\n\t\tlabel: \"Bootstrap\",\r\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\r\n\t};\r\n\tthis.plugins[\"flot\"] = {\r\n\t\tlabel: \"Flot\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\r\n\t\trequires: [\"jquery\"]\r\n\t};*/\r\n}\r\n\r\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\r\n\tfor(var p in opts){\r\n\t\tif(!this.plugins[p]) continue;\r\n\t\tfor(var k in opts[p]){\r\n\t\t\tthis.plugins[p][k] = opts[p][k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.init = function(opts, then){\r\n\tif(opts) this.setPluginOptions(opts);\r\n\tthis.calculatePreloaded();\r\n\tvar toload = this.calculateRequiredInitPlugins(opts);\r\n\tif(toload && toload[0].length) {\r\n\t\tif(toload[1].length){\r\n\t\t\tvar self = this;\r\n\t\t\tvar nthen = function(){\r\n\t\t\t\tself.loadPlugins(toload[1], then);\r\n\t\t\t}\r\n\t\t\tthis.loadPlugins(toload[0], nthen);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.loadPlugins(toload[0], then);\r\n\t\t}\r\n\t}\r\n\telse if(then){\r\n\t\tthen();\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\r\n\tif(opts){\r\n\t\tvar pins = [];\r\n\t\tfor(var pid in opts){\r\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\r\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\r\n\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\r\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\r\n\t\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar pins = this.getDefaultPlugins();\r\n\t}\r\n\tvar needed_pins = [];\r\n\tfor(var i = 0; i<pins.length; i++){\r\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\r\n\t\t\tneeded_pins.push(pins[i])\r\n\t\t}\r\n\t}\r\n\tvar loading_order = [[], []];\r\n\tfor(var i = 0; i<needed_pins.length; i++){\r\n\t\tif(this.plugins[needed_pins[i]]){\r\n\t\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\r\n\t\t\t\tloading_order[1].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tloading_order[0].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn loading_order;\r\n}\r\n\r\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\r\n\treturn this.plugins;\r\n}\r\n\r\nTerminusPluginManager.prototype.calculatePreloaded = function(){\r\n\tfor(var pl in this.plugins){\r\n\t\tif(this.pluginAvailable(pl)){\r\n\t\t\tthis.preloaded.push(pl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\r\n\tif(typeof this.plugins[plugin] == \"object\"){\r\n\t\tvar pluginmeta = this.plugins[plugin];\r\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\r\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\r\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\r\n\t\tswitch(plugin){\r\n\t\t\tcase \"jquery\": {\r\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\r\n\t\t\t\tif(version_check && required_version){}\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jqueryui\": {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\r\n\t\t\t\t}\r\n\t\t\t\tcatch(e){}\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"quill\": {\r\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jsoneditor\": {\r\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"codemirror\": {\r\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\r\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\r\n\t\t\t}\r\n\t\t\tcase \"font-awesome\": {\r\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\r\n\t\t\t\treturn this.fontAwesomeCheck();\r\n\t\t\t}\r\n\t\t\tcase \"datatables\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"select2\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"gmaps\": {\r\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"openlayers\": {\r\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"d3\": {\r\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\r\n\tvar span = document.createElement('span');\r\n\tspan.className = 'fa';\r\n\tspan.style.display = 'none';\r\n\tif(document.body){\r\n\t\tdocument.body.insertBefore(span, document.body.firstChild);\r\n\t\tfunction css(element, property) {\r\n\t\t  return window.getComputedStyle(element, null).getPropertyValue(property);\r\n\t\t}\r\n\t\tvar loaded = false;\r\n\t\tvar fontAwsm = css(span, 'font-family');\r\n\t\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\r\n\t\t\tloaded = true;\r\n\t\t}\r\n\t\tdocument.body.removeChild(span);\r\n\t\treturn loaded;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\r\n\tvar defplugs = [\"font-awesome\"];\r\n\treturn defplugs;\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\r\n\tvar ticker = plugins.length;\r\n\tvar cback = function(){\r\n\t\tif(--ticker <= 1 && then){\r\n\t\t\tthen();\r\n\t\t}\r\n\t};\r\n\tfor(var i = 0; i < plugins.length; i++){\r\n\t\tthis.loadPlugin(plugins[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\r\n\tvar pug = this.plugins[plugin];\r\n\tif(pug.css){\r\n\t\tfor(var i=0; i<pug.css.length; i++){\r\n\t\t\tvar cssid = plugin + \"_css_\" + i;\r\n\t\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssid, pug.css[i]);\r\n\t\t}\r\n\t}\r\n\tvar scripts = (pug.js ? pug.js : []);\r\n\tif(plugin == \"gmaps\" && pug.key){\r\n\t\tscripts[0] += \"?key=\" + pug.key;\r\n\t}\r\n\tif(pug.plugin){\r\n\t\t//scripts.push(\"plugins/\" + pug.plugin);\r\n\t}\r\n\tif(plugin == \"codemirror\"){\r\n\t\tvar cm = scripts[0];\r\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\r\n\t\tscripts.splice(0, 1);\r\n\t\tvar self = this;\r\n\t\tvar cback = function(){\r\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\r\n\t\t}\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, cm, cback);\r\n\t}\r\n\telse {\r\n\t\tthis.loadPluginScripts(plugin, scripts, then);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\r\n\tvar ticker = scripts.length - 1;\r\n\tvar self = this;\r\n\tvar cback = function(){\r\n\t\tif(ticker == 0) {\r\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\r\n\t\t\t\tself.loaded.push(plugin);\r\n\t\t\t}\r\n\t\t\tif(self.loading.indexOf(plugin) != -1){\r\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\r\n\t\t\t}\r\n\t\t\tthen();\r\n\t\t}\r\n\t\tticker--;\r\n\t};\r\n\tif(scripts.length == 0){\r\n\t\tthis.loaded.push(plugin);\r\n\t}\r\n\telse {\r\n\t\tthis.loading.push(plugin);\r\n\t}\r\n\tfor(var i = 0; i<scripts.length; i++){\r\n\t\tvar sid = plugin + \"_js_\" + i;\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, scripts[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPageCSS = function(css){\r\n\tcssfid = \"terminus_client_css\";\r\n\tvar cssdom = document.getElementById(cssfid);\r\n\tif(cssdom){\r\n\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t}\r\n\tif(css){\r\n\t\tcssurl = \"css/\" + css + \".css\";\r\n\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssfid, cssurl);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\r\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\r\n\tif(this.loaded.indexOf(pid) != -1) return true;\r\n\tif(this.preloaded.indexOf(pid) != -1) return true;\r\n\tif(this.loading.indexOf(pid) != -1) return true;\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.disabled = function(pid, obj){\r\n\tif(this.precluded.indexOf(pid) != -1) return true;\r\n\tif(obj.requires){\r\n\t\tfor(var i = 0; i<obj.requires.length; i++){\r\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\r\n\tvar a = document.createElement(\"a\");\r\n\tvar cl = document.createElement(\"span\");\r\n\ta.appendChild(cl);\r\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\r\n\tvar cbox = document.createElement(\"input\");\r\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\r\n\tcbox.type = \"checkbox\";\r\n\tif(this.preloaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\telse if(this.loaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.loading.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.disabled(plugid, obj)){\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\tvar clab = document.createElement(\"label\");\r\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\r\n\tclab.setAttribute(\"for\", cbox.id);\r\n\tclab.appendChild(document.createTextNode(obj.label));\r\n\tcl.appendChild(clab);\r\n\tcl.appendChild(cbox);\r\n\tvar self = this;\r\n\tcbox.addEventListener(\"change\", function(){\r\n\t\tself.togglePlugin(plugid, ui);\r\n\t});\r\n\treturn a;\r\n}\r\n\r\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\r\n\tif(this.loaded.indexOf(plugid) == -1){\r\n\t\tvar then = function(){\r\n\t\t\tui.redraw();\r\n\t\t}\r\n\t\tthis.loadPlugin(plugid, then);\r\n\t}\r\n\telse {\r\n\t\tthis.unloadPlugin(plugid);\r\n\t}\r\n\tTerminusClient.FrameHelper.removeChildren(ui.plugins);\r\n\tui.drawPlugins();\r\n}\r\n\r\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\r\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\r\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar pug = this.plugins[plugid];\r\n\tvar num = (pug.js) ? pug.js.length : 0;\r\n\tif(pug.plugin) num++;\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_js_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tnum = (pug.css ? pug.css.length : 0);\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_css_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\r\n}\r\n\r\nTerminusPluginManager.prototype.getAsDOM = function(ui){\r\n\tvar dm = document.createElement(\"span\");\r\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\r\n\tvar clh = document.createElement(\"span\");\r\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\r\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\r\n\tdm.appendChild(clh);\r\n\tvar a = document.createElement('a');\r\n\tthis.showPlugins(a, ui);\r\n\tclh.appendChild(a);\r\n\ta.style.display = 'none';\r\n\tclh.addEventListener('click', function(){\r\n\t\tif(a.style.display == 'none')\r\n\t\t\ta.style.display = 'block';\r\n\t\telse a.style.display = 'none';\r\n\t})\r\n\treturn dm;\r\n}\r\n\r\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\r\n\ta.setAttribute('style', 'background-color: #111;');\r\n\tfor(var pid in this.plugins){\r\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\r\n\t}\r\n}\r\n\r\nmodule.exports=TerminusPluginManager\r\n","const WOQLResult = require('./WOQLResultsViewer');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction WOQLQuery(client, options, ui){\r\n\tthis.client = client;\r\n\tthis.options = options;\r\n\tthis.ui = ui;\r\n\tthis.default_limit = 1000;\r\n\tthis.prefixes = {};\r\n\tif(client.connectionConfig.platformEndpoint()){\r\n\t\tvar sid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\"));\r\n\t\tthis.sid = sid;\r\n\t\tvar colid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\")) + client.connectionConfig.dbid;\r\n\t\tthis.prefixes['s'] = colid + \"/ontology/main#\";\r\n\t\tthis.prefixes['g'] = sid;\r\n\t\tthis.prefixes['db'] = colid + \"/\";\r\n\t\tthis.prefixes['doc'] = colid + \"/candidate/\";\r\n\t\tthis.prefixes['dg'] = colid + \"/graph/main/\";\r\n\t}\r\n\telse {\r\n\t\tthis.sid = client.connectionConfig.serverURL();\r\n\t\tthis.prefixes['s'] = client.connectionConfig.schemaURL() + \"#\";\r\n\t\tthis.prefixes['dg'] = client.connectionConfig.dbURL() + \"/schema\";\r\n\t\tthis.prefixes['doc'] = client.connectionConfig.docURL();\r\n\t\tthis.prefixes['db'] = client.connectionConfig.dbURL() + \"/\";\r\n\t\tthis.prefixes['g'] = client.connectionConfig.serverURL();\r\n\t}\r\n\tfor(var pref in TerminusClient.FrameHelper.standard_urls){\r\n\t\tthis.prefixes[pref] = TerminusClient.FrameHelper.standard_urls[pref];\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPrefixes = function(prefixes){\r\n\tthis.prefixes = prefixes;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.shorten = function(url){\r\n\tfor(var pref in this.prefixes){\r\n\t\tif(this.prefixes[pref] == url.substring(0, this.prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(this.prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nWOQLQuery.prototype.execute = function(woql){\r\n\tvar wrapped = this.wrap(woql);\r\n\tvar self = this;\r\n\treturn this.client.select(false, wrapped)\r\n\t.then(function(response){\r\n\t\tvar res = new WOQLResult.WOQLResult(response, self, self.options, self.ui);\r\n\t\treturn res;\r\n\t});\r\n}\r\n\r\nWOQLQuery.prototype.wrap = function(woql){\r\n\tvar wjson = {\r\n\t\t\"@context\" : this.prefixes,\r\n\t\t\"from\": [\r\n\t\t\tthis.client.connectionConfig.dbURL(),\r\n\t\t\twoql\r\n\t\t]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\nWOQLQuery.prototype.getConcreteDocumentClassPattern = function(varc){\r\n\tvar varc = varc || \"v:Class\";\r\n\tvar pat = {\r\n\t\tand: [\r\n\t\t\tthis.getSubclassQueryPattern(varc, \"tcs:Document\"),\r\n\t\t\t{\r\n\t\t\t\tnot: [this.getAbstractQueryPattern(varc)]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn pat;\r\n}\r\n\r\nWOQLQuery.prototype.getAbstractQueryPattern = function(varname){\r\n\tvar qp = {\r\n\t\tquad: [varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\"]\r\n\t}\r\n\treturn qp;\r\n}\r\n\r\nWOQLQuery.prototype.getSubclassQueryPattern = function(varname, clsname){\r\n\tvar sqp = {sub: [varname, clsname]};\r\n\treturn sqp;\r\n}\r\n\r\nWOQLQuery.prototype.queryWrappedWithLimit = function(query, limit, start){\r\n\tlimit = limit ? limit : this.default_limit ;\r\n\tstart = start ? start : 0;\r\n\tvar wjson = {\r\n\t\tlimit: [limit, {\r\n\t\t\tstart: [start, query]\r\n\t\t}]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getAllDocumentQuery = function(constraint, limit, start){\r\n\tvar query = {\r\n\t\tand: [\r\n\t\t\t{\r\n\t\t\t\ttriple: [\"v:Document\", \"rdf:type\", \"v:Type\"]\r\n\t\t\t},\r\n\t\t\tthis.getSubclassQueryPattern(\"v:Type\", \"tcs:Document\")\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\tquery.and.push(constraint);\r\n\t}\r\n\treturn this.queryWrappedWithLimit(query, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getEverythingQuery = function(constraint, limit, start){\r\n\tvar wjson = {triple: [\"v:Subject\", \"v:Predicate\", \"v:Object\"]};\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getPropertyListQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// elementMetadata() in new woql query\r\nWOQLQuery.prototype.getElementMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassListMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassMetaDataQuery = WOQLQuery.prototype.getClassListMetaDataQuery;\r\n\r\nWOQLQuery.prototype.getDataOfChosenClassQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", \"rdf:type\", chosen]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"v:Property\", \"v:Value\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfChosenPropertyQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", chosen, \"v:Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [url, \"rdfs:label\", \"v:InstanceLabel\"]},\r\n\t\t\t{triple: [url, \"rdf:type\", \"v:InstanceType\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [url, \"rdfs:comment\", \"v:InstanceComment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getDocumentQuery = function(id, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [id, \"v:Property\", \"v:Property_Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassesQuery = function(limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [\"v:ID\", \"rdf:type\", \"v:Class\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:comment\", \"v:Comment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tsub: ['v:Class', 'tcs:Document']\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nmodule.exports=WOQLQuery\r\n","function getErrorAsMessage(url, api, err) {\r\n\t// console.log('getErrorAsMessage');\r\n\tlet str = '';\r\n\tif (err.response) {\r\n\t\terr = err.response;\r\n\t\tif (err.data) str += `${formatErrorMessage(err.data)}`;\r\n\t} else if (err.body) str += `${formatErrorMessage(err.data)}`;\r\n\r\n\tif (err.status) str += `Code: ${err.status}`;\r\n\tif (err.action) str += `, Action: ${err.action}`;\r\n\tif (err.type) str += `, Type: ${err.type}`;\r\n\tif (url) str += `, url: ${url}`;\r\n\tif (api && api.method) str += `, method: ${api.method}`;\r\n\treturn str;\r\n}\r\n\r\nfunction formatErrorMessage(msg) {\r\n\tif (typeof msg === 'object') {\r\n\t\tlet nmsg = '';\r\n\t\tfor (const key of Object.keys(msg)) {\r\n\t\t\tnmsg += `${key} ${msg[key]} `;\r\n\t\t}\r\n\t\treturn nmsg;\r\n\t}\r\n\treturn msg;\r\n}\r\n\r\nfunction accessDenied(action, db, server) {\r\n\tconst err = {};\r\n\terr.status = 403;\r\n\terr.url = (server || '') + (db || '');\r\n\terr.type = 'client';\r\n\terr.action = action;\r\n\terr.body = `${err.action} not permitted for ${err.url}`;\r\n\treturn err;\r\n}\r\n\r\nfunction getAPIErrorMessage(url, api, err) {\r\n\treturn `API Error ${getErrorAsMessage(url, api, err)}`;\r\n}\r\n\r\nfunction getAccessDeniedMessage(url, api, err) {\r\n\treturn `Access Denied ${getErrorAsMessage(url, api, err)}`;\r\n}\r\n\r\nfunction getInvalidURIMessage(url, call) {\r\n\tconst str = `Invalid argument to\r\n            ${call}. \r\n            ${url}\r\n            is not a valid Terminus DB API endpoint`;\r\n\treturn str;\r\n}\r\n\r\n/**\r\n * Utility functions for generating and retrieving error messages\r\n * and storing error state\r\n */\r\n\r\nfunction parseAPIError(response) {\r\n\tconst err = {};\r\n\terr.status = response.status;\r\n\terr.type = response.type;\r\n\tif (response.data && typeof response.data === 'object') {\r\n\t\tlet msg;\r\n\t\ttry {\r\n\t\t\tmsg = response.text();\r\n\t\t} catch (e) {\r\n\t\t\ttry {\r\n\t\t\t\tmsg = response.json();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tmsg = response.toString();\r\n\t\t\t}\r\n\t\t}\r\n\t\terr.body = msg;\r\n\t} else if (response.data) err.body = response.data;\r\n\terr.url = response.url;\r\n\terr.headers = response.headers;\r\n\terr.redirected = response.redirected;\r\n\treturn err;\r\n}\r\n\r\n\r\nmodule.exports = {\r\n\tgetErrorAsMessage,\r\n\tgetAPIErrorMessage,\r\n\tgetAccessDeniedMessage,\r\n\taccessDenied,\r\n\tgetInvalidURIMessage,\r\n\tparseAPIError\r\n};\r\n","/**\r\n * Helper functions for dealing with frames and linked data documents\r\n */\r\nconst FrameHelper = {\r\n\tstandard_urls: {\r\n\t\trdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\r\n\t\trdfs: 'http://www.w3.org/2000/01/rdf-schema#',\r\n\t\txsd: 'http://www.w3.org/2001/XMLSchema#',\r\n\t\towl: 'http://www.w3.org/2002/07/owl#',\r\n\t\ttcs: 'http://terminusdb.com/schema/tcs#',\r\n\t\ttbs: 'http://terminusdb.com/schema/tbs#',\r\n\t\txdd: 'http://terminusdb.com/schema/xdd#',\r\n\t\tv: 'http://terminusdb.com/woql/variable/',\r\n\t\tterminus: 'http://terminusdb.com/schema/terminus#',\r\n\t\tvio: 'http://terminusdb.com/schema/vio#',\r\n\t\tdocs: 'http://terminusdb.com/schema/documentation#'\r\n\t}\r\n};\r\n\r\nFrameHelper.addURLPrefix = function (prefix, url) {\r\n\tthis.standard_urls[prefix] = url;\r\n};\r\n\r\n\r\nFrameHelper.removeChildren = function (node) {\r\n\tif (node) {\r\n\t\twhile (node.hasChildNodes()) {\r\n\t\t\tnode.removeChild(node.childNodes[0]);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nFrameHelper.empty = function (obj) {\r\n\t   // null and undefined are \"empty\"\r\n\tif (!obj) return true;\r\n\t// Assume if it has a length property with a non-zero value\r\n\t// that that property is correct.\r\n\tif (obj.length > 0) return false;\r\n\tif (obj.length === 0) return true;\r\n\t// Otherwise, does it have any properties of its own?\r\n\t// Note that this doesn't handle\r\n\t// toString and valueOf enumeration bugs in IE < 9\r\n\t// for (const key in obj) {\r\n\tif (typeof obj === 'object') {\r\n\t\tfor (const key of Object.keys(obj)) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) return false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFrameHelper.genBNID = function () {\r\n\tconst r = Math.random().toString(36).substring(7);\r\n\tconst d = new Date();\r\n\tconst bnid = `_:${r}${d.getTime()}`;\r\n\treturn bnid;\r\n};\r\n\r\nFrameHelper.getShorthand = function (link) {\r\n\tif (typeof link === 'object' && link.length) link = link[0];\r\n\tif (link && typeof link === 'string') {\r\n\t\tfor (const pref of Object.keys(this.standard_urls)) {\r\n\t\t\tconst full = this.standard_urls[pref];\r\n\t\t\tif (link.substring(0, full.length) === full) {\r\n\t\t\t\tconst sh = `${pref}:${link.substring(full.length)}`;\r\n\t\t\t\treturn sh;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.compareIDs = function (ida, idb) {\r\n\tif (ida === idb) return true;\r\n\tif (this.unshorten(ida) === idb) return true;\r\n\tif (this.unshorten(ida) === this.unshorten(idb)) return true;\r\n\tconst sha = this.getShorthand(ida);\r\n\tconst shb = this.getShorthand(idb);\r\n\tif (sha && ((sha === idb) || (sha === shb))) return true;\r\n\tif (shb && shb === ida) return true;\r\n\treturn false;\r\n};\r\n\r\n\r\n\r\nFrameHelper.shorten = function(url, prefixes){\r\n\tfor(var pref in prefixes){\r\n\t\tif(prefixes[pref] == url.substring(0, prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nFrameHelper.unshorten = function (url) {\r\n\tif (this.validURL(url)) return url;\r\n\tif (!url) return url;\r\n\tconst bits = url.split(':');\r\n\tif (bits[1]) {\r\n\t\tif (this.standard_urls[bits[0]]) {\r\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\n// Valid URLs are those that start with http:// or https://\r\nFrameHelper.validURL = function (str) {\r\n\tif (str && (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://')) return true;\r\n\treturn false;\r\n};\r\n\r\n\r\nFrameHelper.labelFromURL = function (url) {\r\n\tlet nurl = this.urlFragment(url);\r\n\tnurl = (nurl || url);\r\n\tif (nurl.lastIndexOf('/') < nurl.length - 1) {\r\n\t\tnurl = nurl.substring(nurl.lastIndexOf('/') + 1);\r\n\t}\r\n\tnurl = nurl.replace('_', ' ');\r\n\treturn nurl.charAt(0).toUpperCase() + nurl.slice(1);\r\n};\r\n\r\nFrameHelper.urlFragment = function (url) {\r\n\turl = (typeof url !== 'string') ? window.location.href : url;\r\n\tlet bits = url.split('#');\r\n\tif (bits.length <= 1) {\r\n\t\tif (!this.validURL(url)) {\r\n\t\t\tbits = url.split(':');\r\n\t\t}\r\n\t}\r\n\tif (bits.length >= 1) {\r\n\t\tconst [, urlStr] = bits;\r\n\r\n\t\tif (urlStr) {\r\n\t\t\tconst [baseUrl] = urlStr.split('?');\r\n\t\t\turl = baseUrl;\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\nFrameHelper.isStringType = function (stype) {\r\n\tif (stype === 'http://www.w3.org/2001/XMLSchema#string') return true;\r\n\tif (stype === 'xsd:string') return true;\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.lastURLBit = function (url) {\r\n\turl = (typeof url === 'undefined') ? window.location.href : url;\r\n\tconst [urlFirst] = url.split('#');\r\n\tconst [urlTmp] = urlFirst.split('?');\r\n\turl = urlTmp.substring(url.lastIndexOf('/') + 1);\r\n\treturn url;\r\n};\r\n\r\n\r\nFrameHelper.getStdURL = function (pref, ext, url) {\r\n\tif (this.standard_urls[pref]) {\r\n\t\tif (url) {\r\n\t\t\tif (url === this.standard_urls[pref] + ext) return url;\r\n\t\t} else {\r\n\t\t\treturn this.standard_urls[pref] + ext;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.viewIncludesProperties = function (view) {\r\n\tif (view === 'full' || view === 'production' || view === 'terse') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.viewIncludesChildren = function (view, type) {\r\n\treturn this.viewIncludesProperties(view, type);\r\n};\r\n\r\nFrameHelper.viewIncludesValue = function (view, type) {\r\n\treturn this.viewIncludesProperties(view, type);\r\n};\r\n\r\nFrameHelper.numberWithCommas = function (value) {\r\n\tif (value >= 1000 || value <= -1000) {\r\n\t    const parts = value.toString().split('.');\r\n\t    if (value <= -1000) parts[0] = parts[0].substring(1);\r\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\r\n\t    if (value <= -1000) value = `-${parts.join('.')}`;\r\n\t    else value = parts.join('.');\r\n\t}\r\n\treturn value;\r\n};\r\n\r\nFrameHelper.datatypes = [\r\n\t'xdd:coordinate', 'xdd:coordinatePolyline',\r\n\t'xdd:coordinatePolygon', 'xdd:dateRange', 'xdd:gYearRange', 'xdd:integerRange',\r\n\t'xdd:decimalRange', 'xdd:cc', 'xdd:email', 'xdd:html', 'xdd:url', 'xsd:anySimpleType',\r\n\t'xsd:string', 'xsd:boolean', 'xsd:decimal', 'xsd:double', 'xsd:float', 'xsd:time', 'xsd:date',\r\n\t'xsd:dateTime', 'xsd:dateTimeStamp', 'xsd:gYear', 'xsd:gMonth', 'xsd:gDay', 'xsd:gYearMonth',\r\n\t'xsd:gMonthDay', 'xsd:duration', 'xsd:yearMonthDuration', 'xsd:dayTimeDuration',\r\n\t'xsd:byte', 'xsd:short', 'xsd:integer', 'xsd:long', 'xsd:unsignedByte',\t'xsd:unsignedInt',\r\n\t'xsd:unsignedLong',\t'xsd:nonNegativeInteger', 'xsd:positiveInteger', 'xsd:negativeInteger',\r\n\t'xsd:nonPositiveInteger', 'xsd:base64Binary', 'xsd:anyURI', 'xsd:language', 'xsd:normalizedString',\r\n\t'xsd:token', 'xsd:NMTOKEN',\t'xsd:Name',\t'xsd:NCName', 'xsd:NOTATION', 'xsd:QName', 'xsd:ID',\r\n\t'xsd:IDREF', 'xsd:ENTITY', 'rdf:XMLLiteral', 'rdf:PlainLiteral', 'rdfs:Literal', 'xdd:json'\r\n];\r\n\r\nFrameHelper.parseDate = function (ty, value) {\r\n\tlet parsed;\r\n\tif (ty === 'xsd:date') {\r\n\t\tparsed = this.parseXsdDate(value);\r\n\t} else if (ty === 'xsd:time') {\r\n\t\tparsed = this.parseXsdTime(value);\r\n\t} else if (ty === 'xsd:dateTime') {\r\n\t\tparsed = this.parseXsdDateTime(value);\r\n\t} else if (ty === 'xsd:gYear') {\r\n\t\tparsed = { year: value };\r\n\t} else if (ty === 'xsd:gYearRange') {\r\n\t\tparsed = { year: value };\r\n\t} else if (ty === 'xsd:gMonth') {\r\n\t\tparsed = { month: value.substring(2) };\r\n\t} else if (ty === 'xsd:gDay') {\r\n\t\tparsed = { day: value };\r\n\t} else if (ty === 'xsd:gYearMonth') {\r\n\t\tconst bits = value.split('-');\r\n\t\twhile (bits.length < 2) bits.push('');\r\n\t\tparsed = { year: bits[0], month: bits[1] };\r\n\t} else if (ty === 'xsd:gMonthDay') {\r\n\t\tconst bits = value.split('-');\r\n\t\twhile (bits.length < 2) bits.push('');\r\n\t\tparsed = { month: bits[0], day: bits[1] };\r\n\t} else if (ty === 'xsd:dateTimeStamp') {\r\n\t\tparsed = this.parseXsdDateTime(value);\r\n\t}\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.parseXsdDate = function (val) {\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tlet year;\r\n\tif (val.substring(0, 1) === '-') {\r\n\t\tyear = val.substring(0, 5);\r\n\t} else {\r\n\t\tyear = val.substring(0, 4);\r\n\t}\r\n\tlet parsed;\r\n\tif (year && Math.abs(year) < 10000) {\r\n\t\tlet month = val.substring(year.length + 1, year.length + 3);\r\n\t\tif (month) { month = parseInt(month, 10); } else return false;\r\n\t\tlet day = val.substring(year.length + 4);\r\n\t\tif (day) day = parseInt(day, 10);\r\n\t\telse return false;\r\n\t\tparsed = {\r\n\t\t\tyear,\r\n\t\t\t   month,\r\n\t\t\t   day,\r\n\t\t\t   timezone: tz\r\n\t\t};\r\n\t}\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.addXsdPadding = function (parsed) {\r\n\tconst nparsed = {};\r\n\tif (typeof parsed.year !== 'undefined' && parsed.year !== false && parsed.year < 1000) {\r\n\t\tif (Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? `-000${Math.abs(parsed.year)}` : `000${parsed.year}`);\r\n\t\telse if (Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? `-00${Math.abs(parsed.year)}` : `00${parsed.year}`);\r\n\t\telse nparsed.year = (parsed.year < 0 ? `-0${Math.abs(parsed.year)}` : `0${parsed.year}`);\r\n\t} else if (parsed.year) {\r\n\t\tnparsed.year = parsed.year;\r\n\t}\r\n\tif (typeof parsed.month !== 'undefined' && parsed.month !== false && parsed.month < 10) {\r\n\t\tnparsed.month = `0${parsed.month}`;\r\n\t} else if (parsed.month) {\r\n\t\tnparsed.month = parsed.month;\r\n\t}\r\n\tif (typeof parsed.day !== 'undefined' && parsed.day !== false && parsed.day < 10) {\r\n\t\tnparsed.day = `0${parsed.day}`;\r\n\t} else if (parsed.day) {\r\n\t\tnparsed.day = parsed.day;\r\n\t}\r\n\tif (typeof parsed.hour !== 'undefined' && parsed.hour !== false && parsed.hour < 10) {\r\n\t\tnparsed.hour = `0${parsed.hour}`;\r\n\t} else if (parsed.hour) {\r\n\t\tnparsed.hour = parsed.hour;\r\n\t}\r\n\tif (typeof parsed.minute !== 'undefined' && parsed.minute !== false && parsed.minute < 10) {\r\n\t\tnparsed.minute = `0${parsed.minute}`;\r\n\t} else if (parsed.minute) {\r\n\t\tnparsed.minute = parsed.minute;\r\n\t}\r\n\tif (typeof parsed.second !== 'undefined' && parsed.second !== false && parsed.second < 10) {\r\n\t\tnparsed.second = `0${parsed.second}`;\r\n\t} else if (parsed.second) {\r\n\t\tnparsed.second = parsed.second;\r\n\t}\r\n\treturn nparsed;\r\n};\r\n\r\n\r\nFrameHelper.xsdFromParsed = function (parsed, ty) {\r\n\tconst xparsed = this.addXsdPadding(parsed);\r\n\tlet ret;\r\n\tif (ty === 'xsd:gYear') {\r\n\t\tret = (xparsed.year ? xparsed.year : false);\r\n\t} else if (ty === 'xsd:time') {\r\n\t\treturn (xparsed.hour && xparsed.minute && xparsed.second) ? `${xparsed.hour}:${xparsed.minute}:${xparsed.second}` : false;\r\n\t} else if (ty === 'xsd:date') {\r\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}` : false;\r\n\t} else if (ty === 'xsd:dateTime' || ty === 'xsd:dateTimeStamp') {\r\n\t\tret = (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}T` : false;\r\n\t\tif (ret) ret += `${xparsed.hour ? xparsed.hour : '12'}:${xparsed.minute ? xparsed.minute : '00'}:${xparsed.second ? xparsed.second : '00'}`;\r\n\t} else if (ty === 'xsd:gMonth') {\r\n\t\tret = (xparsed.month ? `--${xparsed.month}` : false);\r\n\t} else if (ty === 'xsd:gDay') {\r\n\t\tret = (xparsed.day ? `---${xparsed.day}` : false);\r\n\t} else if (ty === 'xsd:gYearMonth') {\r\n\t\tret = (xparsed.year && xparsed.month) ? `${xparsed.year}-${xparsed.month}` : false;\r\n\t} else if (ty === 'xsd:gMonthDay') {\r\n\t\tret = (xparsed.day && xparsed.month) ? `--${xparsed.month}-${xparsed.day}` : false;\r\n\t}\r\n\tif (xparsed.timezone) {\r\n\t\tret += xparsed.timezone;\r\n\t}\r\n\treturn ret;\r\n};\r\n\r\n\r\nFrameHelper.parseXsdTime = function (val) {\r\n\tif (!val) return {};\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tconst parsed = {\r\n\t\thour: val.substring(0, 2),\r\n\t\tminute: val.substring(3, 5),\r\n\t\tsecond: val.substring(6),\r\n\t\ttimezone: tz\r\n\t};\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.convertTimestampToXsd = function (val) {\r\n\t  const a = new Date(val * 1000);\r\n\t  const parsed = {\r\n\t\tyear: a.getFullYear(),\r\n\t\tmonth: a.getMonth() + 1,\r\n\t\tday: a.getDate(),\r\n\t\thour: a.getHours(),\r\n\t\tminute: a.getMinutes(),\r\n\t\tsecond: a.getSeconds()\r\n\t  };\r\n\t  return parsed;\r\n};\r\n\r\nFrameHelper.parseXsdDateTime = function (val) {\r\n\tif (!val) return {};\r\n\tif (typeof val === 'number') {\r\n\t\treturn this.convertTimestampToXsd(val);\r\n\t}\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tconst datetime = this.parseXsdDate(val);\r\n\tconst ptime = this.parseXsdTime(val.substring(val.indexOf('T') + 1));\r\n\r\n\tfor (const i of Object.keys(ptime)) {\r\n\t\tdatetime[i] = ptime[i];\r\n\t}\r\n\tdatetime.timezone = tz;\r\n\treturn datetime;\r\n};\r\n\r\nFrameHelper.extractXsdTimezone = function (val) {\r\n\tif (val && val.charAt(val.length - 1) === 'Z') {\r\n\t\treturn 'Z';\r\n\t}\r\n\tif (val && (val.charAt(val.length - 6) === '+' || val.charAt(val.length - 6) === '-')) {\r\n\t\tval.substring(val.length - 6);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.parseRangeValue = function (val, dividor) {\r\n\tdividor = (dividor || ',');\r\n\tlet vals = [];\r\n\tif (typeof val === 'object' && val.length) {\r\n\t\tvals = val;\r\n\t} else if (val) {\r\n\t\tif (typeof val !== 'string') {\r\n\t\t\tval = `${val}`;\r\n\t\t}\r\n\t\tif (val.length && (val.charAt(0) === '[') && val.charAt(val.length - 1) === ']') {\r\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\r\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length - 1));\r\n\t\t} else {\r\n\t\t\tvals.push(val);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n};\r\n\r\nFrameHelper.loadDynamicScript = function (scriptid, src, callback) {\r\n\tconst existingScript = document.getElementById(scriptid);\r\n\tif (!existingScript) {\r\n\t\tconst script = document.createElement('script');\r\n\t\tscript.src = src; // URL for the third-party library being loaded.\r\n\t\tdocument.body.appendChild(script);\r\n\t\tscript.onload = function () {\r\n\t\t\tscript.id = scriptid; // do it here so it doesn't trigger the callback below on multiple calls\r\n\t\t\tif (callback) callback(scriptid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) {\r\n\t\tcallback(scriptid);\r\n\t}\r\n};\r\n\r\nFrameHelper.loadDynamicCSS = function (cssid, src, callback) {\r\n\tconst existingScript = document.getElementById(cssid);\r\n\tif (!existingScript) {\r\n\t\tconst link = document.createElement('link');\r\n\t\tlink.href = src; // URL for the third-party library being loaded.\r\n\t\tlink.id = cssid; // e.g., googleMaps or stripe\r\n\t\tlink.rel = 'stylesheet';\r\n\t\tdocument.body.appendChild(link);\r\n\t\tlink.onload = function () {\r\n\t\t\tif (callback) callback(cssid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) callback(cssid);\r\n};\r\n\r\nmodule.exports = FrameHelper;\r\n","const ObjectViewer= require(\"./ObjectViewer\")\r\nconst HTMLStringViewer = require('./viewers/String');\r\nconst HTMLStringEditor = require('./viewers/StringEditor');\r\nconst HTMLBooleanViewer = require('./viewers/Boolean');\r\nconst HTMLBooleanEditor = require('./viewers/BooleanEditor');\r\nconst HTMLChoiceViewer = require('./viewers/Choice');\r\nconst HTMLChoiceEditor = require('./viewers/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('./viewers/Coordinate');\r\nconst HTMLCoordinateEditor = require('./viewers/CoordinateEditor');\r\nconst HTMLDateViewer = require('./viewers/Date');\r\nconst HTMLDateEditor = require('./viewers/DateEditor');\r\nconst HTMLEntityViewer = require('./viewers/Entity');\r\nconst HTMLEntityEditor = require('./viewers/EntityEditor');\r\nconst HTMLImageViewer = require('./viewers/Image');\r\nconst HTMLImageEditor = require('./viewers/ImageEditor');\r\nconst HTMLLinkViewer = require('./viewers/Link');\r\nconst HTMLNumberViewer = require('./viewers/Number');\r\nconst HTMLRangeViewer = require('./viewers/Range');\r\nconst HTMLRangeEditor = require('./viewers/RangeEditor');\r\nconst SantizedHTMLViewer = require('./viewers/SanitizedHTML');\r\nconst GoogleMapEditor = require('./viewers/GoogleMapEditor');\r\nconst GoogleMapViewer = require('./viewers/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('./viewers/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('./viewers/S2EntityEditor');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet RenderingMap = {\r\n\tregisteredDataViewers: {},\r\n\tregisteredDataEditors: {},\t\r\n\tregisteredPropertyViewers: {},\r\n\tregisteredPropertyEditors: {},\r\n\tregisteredObjectViewers: {},\r\n\tregisteredObjectEditors: {},\r\n\tgetValidDataViewerList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringViewer'];\r\n\t\tif(frametype && typeof this.registeredDataViewers[frametype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[frametype]);\r\n\t\t}\r\n\t\tif(typeof this.registeredDataViewers[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidDataEditorList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringEditor'];\r\n\t\tif(frametype && typeof this.registeredDataEditors[frametype] != \"undefined\"){\r\n\t\t\tvar nftypes = this.registeredDataEditors[frametype];\r\n\t\t\tif(nftypes){\r\n\t\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof this.registeredDataEditors[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataEditors[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidPropertyViewerList: function(property, proptype, proprange, propdom){\r\n\t\tvar valids = ['HTMLPropertyViewer'];\r\n\t\tif(property && typeof this.registeredPropertyViewers[property] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[property]);\r\n\t\t}\r\n\t\tif(proprange && typeof this.registeredPropertyViewers[proprange] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proprange]);\r\n\t\t}\r\n\t\tif(propdom && typeof this.registeredPropertyViewers[propdom] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[propdom]);\r\n\t\t}\r\n\t\tif(proptype && typeof this.registeredPropertyViewers[proptype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proptype]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidPropertyEditorList: function(property, proptype, proprange, propdom){\r\n\t\tvar valids = ['HTMLPropertyViewer'];\r\n\t\tif(property && typeof this.registeredPropertyEditors[property] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[property]);\r\n\t\t}\r\n\t\tif(proprange && typeof this.registeredPropertyEditors[proprange] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proprange]);\r\n\t\t}\r\n\t\tif(propdom && typeof this.registeredPropertyEditors[propdom] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[propdom]);\r\n\t\t}\r\n\t\tif(proptype && typeof this.registeredPropertyEditors[proptype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proptype]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetViewer: function(type, options){\r\n\t\tvar vi = this.renderers[type];\r\n\t\toptions = (options ? options: {});\r\n\t\ttry {\r\n\t\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\t\r\n\t\t\treturn viewer;\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"failed on create \" + e.toString());\r\n\t\t}\r\n\t},\r\n\tgetAvailablePropertyViewers: function(type, renderer) {\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidPropertyViewerList(type);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailablePropertyEditors: function(type, renderer) {\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidPropertyEditorList();\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t\t\r\n\t},\r\n\tgetAvailableDataViewers: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataViewerList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailableDataEditors: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataEditorList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetViewerForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataViewerList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tgetEditorForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataEditorList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tregisterViewerForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataViewers[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataViewers[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataViewers[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataEditors[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataEditors[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataEditors[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t},\r\n\tregisterEditorForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataEditors[frametype] == \"undefined\") this.registeredDataEditors[frametype] = [];\r\n\t\tif(this.registeredDataEditors[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataEditors[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataViewers[frametype] == \"undefined\") this.registeredDataViewers[frametype] = [];\r\n\t\tif(this.registeredDataViewers[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataViewers[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForProperties: function(viewer, label, properties){\r\n\t\tfor(var i = 0; i < properties.length; i++){\r\n\t\t\tif(typeof this.registeredPropertyViewers[properties[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredPropertyViewers[properties[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredPropertyViewers[properties[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredPropertyViewers[properties[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForProperties: function(viewer, label, properties){\r\n\t\tfor(var i = 0; i < properties.length; i++){\r\n\t\t\tif(typeof this.registeredPropertyEditors[properties[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredPropertyEditors[properties[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredPropertyEditors[properties[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredPropertyEditors[properties].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\trenderers: {\r\n\t\tHTMLStringViewer: { label: \"String Viewer\"},\r\n\t\tHTMLStringEditor: { label: \"String Editor\"},\r\n\t\tHTMLPropertyViewer: { label: \"HTML Property Viewer\"}\r\n\t},\r\n\tpatternMatchesRenderer: function(pattern, renderer){\r\n\t\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\t\tif(!fp.checkRenderer(renderer)) return false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar fp = new FramePattern(pattern);\r\n\t\t\treturn fp.checkRenderer(renderer);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nRenderingMap.addPlugin = function(plugin){\r\n\tif(plugin == \"gmaps\"){\r\n\t\tthis.registerEditorForTypes(\"GoogleMapEditor\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tthis.registerViewerForTypes(\"GoogleMapViewer\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugin == \"quill\"){\r\n\t\tthis.registerEditorForTypes(\"HTMLMarkupEditor\", \"Quill WYSIWIG HTML Editor\", [\"xdd:html\"]);\r\n\t}\r\n\tif(plugin == \"select2\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n\tif(plugin == \"jsoneditor\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n}\r\n\r\nRenderingMap.getAvailableObjectViewers = function(renderer){\r\n\tvar entries = ['html', 'json'];\r\n\treturn entries;\r\n}\r\n\r\nRenderingMap.decorateRenderer = function(options, renderer){\r\n\tvar compiled_options = this.compileOptions(options, renderer);\r\n\tif(compiled_options && compiled_options.mode){\r\n\t\trenderer.mode = compiled_options.mode;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.mode) renderer.mode = renderer.parent.mode;\r\n\t\telse renderer.mode = \"view\";\r\n\t}\r\n\tif(compiled_options && compiled_options.view){\r\n\t\trenderer.view = compiled_options.view;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.view) renderer.view = renderer.parent.view;\r\n\t\telse renderer.view = \"full\";\r\n\t}\r\n\tif(compiled_options && compiled_options.facets){\r\n\t\trenderer.facets = compiled_options.facets;\r\n\t}\r\n\telse {\r\n\t\trenderer.facets = renderer.getDefaultFacets();\r\n\t}\r\n\tif(compiled_options && compiled_options.facet && typeof renderer.facets[compiled_options.facet] == \"object\"){\r\n\t\trenderer.facet = compiled_options.facet;\r\n\t}\t\r\n\telse {\r\n\t\tvar deffacet = renderer.getDefaultFacet();\r\n\t\tif(typeof renderer.facets[deffacet] == \"object\"){\r\n\t\t\trenderer.facet = deffacet;\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.facet = key(renderer.facets);\r\n\t\t}\r\n\t}\r\n\tif(compiled_options && compiled_options.hide_disabled_buttons){\r\n\t\trenderer.hide_disabled_buttons = compiled_options.hide_disabled_buttons;\r\n\t}\r\n\telse if(renderer.parent) renderer.hide_disabled_buttons = parent.hide_disabled_buttons;\r\n\telse renderer.hide_disabled_buttons = true;\r\n\tif(compiled_options && typeof compiled_options.features == \"object\"){\r\n\t\trenderer.features = compiled_options.features;\r\n\t}\r\n\telse {\r\n\t\trenderer.features = renderer.facets[renderer.facet].features;\r\n\t\t//renderer.features = renderer.getDefaultFeatures(renderer.facet);\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.controls == \"object\"){\r\n\t\trenderer.controls = compiled_options.controls;\r\n\t}\r\n\telse {\r\n\t\trenderer.controls = renderer.facets[renderer.facet].controls;\r\n\t\t//renderer.controls = renderer.getDefaultControls();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.viewerType != \"undefined\"){\r\n\t\trenderer.viewerType = compiled_options.viewerType;\r\n\t\tif(compiled_options.viewerOptions)\r\n\t\t\trenderer.viewerOptions = compiled_options.viewerOptions;\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.header != \"undefined\"){}\r\n\telse {\r\n\t\trenderer.header_viewer = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.filter != \"undefined\"){}\r\n\telse {}\r\n\tif(compiled_options && typeof compiled_options.sort != \"undefined\"){}\r\n\telse {}\r\n\treturn options;\r\n}\t\r\n\r\nRenderingMap.compileOptions = function(options, renderer){\r\n\tvar compiled_options = {};\r\n\tvar rules = [];\r\n\tfor(var key in options){\r\n\t\tif(key != \"rules\"){\r\n\t\t\tcompiled_options[key] = options[key];\r\n\t\t}\r\n\t}\r\n\tif(options.rules){\r\n\t\tfor(var i = 0; i<options.rules.length; i++){\r\n\t\t\tvar match = (!options.rules[i].pattern || this.patternMatchesRenderer(options.rules[i].pattern, renderer));\r\n\t\t\tif(match && options.rules[i].output){\r\n\t\t\t\tfor(var k in options.rules[i].output){\r\n\t\t\t\t\tcompiled_options[k] = options.rules[i].output[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn compiled_options;\r\n}\r\n\r\n\r\nRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", \"Checkbox Viewer\", [\"xsd:boolean\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", \"Checkbox Editor\", [\"xsd:boolean\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLChoiceViewer\", \"Choice Viewer\", \"oneOf\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLChoiceEditor\", \"Choice Selector\", \"oneOf\");\r\nRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", \"Coordinate Viewer\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", \"Coordinate Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", \"Date Viewer\", [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", \"Date Editor\", [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLEntityViewer\", \"Document Viewer\", \"document\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLEntityEditor\", \"Document Selector\", \"document\");\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", \"Link Viewer\", [\"xdd:url\", \"xsd:anyURI\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", \"Number with commas\", \r\n\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", \"Range Viewer\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", \"Range Editor\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", \"Sanitized HTML\", [\"xsd:string\", \"xdd:html\"]);\r\n\r\nFramePattern = function(pattern){\r\n\tthis.renderer = (pattern.renderer ? pattern.renderer : false);\r\n\tthis.label = (pattern.value ? pattern.value : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif(pattern.children){\r\n\t\tfor(var i = 0 ; i < pattern.children.length ; i++){\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth != \"undefined\" ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\r\n}\r\n\r\nFramePattern.prototype.checkRenderer = function(renderer){\r\n\tvar rtype = this.getRendererType(renderer);\r\n\tif(!rtype) return false;\r\n\tif(this.renderer && this.renderer != rtype) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, renderer)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, renderer)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, renderer)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, renderer)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, renderer)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, renderer)) return false;\r\n\tif(this.range && !this.checkRange(rtype, renderer)) return false;\r\n\tif(this.value && !this.checkValue(rtype, renderer)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, renderer)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, renderer)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, renderer)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, renderer)) return false;\r\n\treturn true;\r\n} \r\n\r\nFramePattern.prototype.illegalRuleType = function(rtype){\r\n\tif(rtype == 'value' && (this.children.length || this.label)) return true;\r\n\tif(rtype == 'object' && this.range ) return true;\r\n\treturn false;\r\n}\r\n\r\n/* subject is an id or an array of ids, \r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function(subject, renderer){\r\n\tif(typeof this.subject != \"object\" || !this.subject.length) this.subject = [this.subject];\r\n\tvar rsubj = renderer.subject();\r\n\tfor(var i = 0 ; i<this.subject.length; i++){\r\n\t\tif(this.IDsMatch(subject[i], rsubj)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function(rtype, renderer){\r\n\tfor(var i = 0 ; i<this.children.length; i++){\r\n\t\tvar found = false;\r\n\t\tif(rtype == \"object\"){\r\n\t\t\tfor(var prop in renderer.properties){\r\n\t\t\t\tif(this.children[i].checkRenderer(renderer.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j <= renderer.values.length; j++){\r\n\t\t\t\tif(this.children[j].checkRenderer(renderer.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!found) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkStatus = function(rtype, renderer){\r\n\tif(typeof this.status != \"object\" || this.status.length == 0) this.status = [this.status];\r\n\tfor(var i = 0; i<this.status.length; i++){\r\n\t\tif(this.status[i] == \"updated\" && !renderer.isUpdated()) return false;\r\n\t\tif(this.status[i] == \"new\" && !renderer.isNew()) return false;\r\n\t\tif(this.status[i] == \"unchanged\" && renderer.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkDepth = function(rtype, renderer){\r\n\treturn this.numberMatch(this.depth, renderer.depth());\r\n}\r\n\r\nFramePattern.prototype.checkParent = function(rtype, renderer){\r\n\treturn this.parent.checkRenderer(renderer.parent);\r\n}\r\n\r\nFramePattern.prototype.checkIndex = function(rtype, renderer){\r\n\tif(rtype == 'value'){\r\n\t\treturn this.index == renderer.index;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkProperty  = function(rtype, renderer){\r\n\tif(typeof this.property != \"object\" || !this.property.length) this.property = [this.property];\r\n\tfor(var i = 0 ; i<this.property.length; i++){\r\n\t\tif(this.propertyIDsMatch(renderer.property(), this.property[i])){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function(rtype, renderer){\r\n\tif(typeof this.value != \"object\" || !this.value.length) this.value = [this.value];\r\n\tfor(var i = 0 ; i<this.value.length; i++){\r\n\t\tif(rtype == \"value\"){\r\n\t\t\tif(this.valuesMatch(renderer.value(), this.value[i])){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j<= renderer.values.length;  j++){\r\n\t\t\t\tif(this.getRendererType(renderer.values[i]) == 'value' &&\r\n\t\t\t\t\t\tthis.valuesMatch(renderer.values[i].value(), this.value[i])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"object\"){\r\n\t\t\tfor(var prop in renderer.properties){\r\n\t\t\t\tif(this.checkValue(this.getRendererType(renderer.properties[prop]), renderer.properties[prop])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkRange  = function(rtype, renderer){\r\n\tif(typeof this.range != \"object\" || !this.range.length) this.range = [this.range];\r\n\tfor(var i = 0 ; i<this.range.length; i++){\r\n\t\tif(this.rangeIDsMatch(renderer.range(), this.range[i])){ \r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkSubjectClass = function(rtype, renderer){\r\n\tif(typeof this.subjectClass != \"object\" || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tvar rcls = renderer.subjectClass();\r\n\tfor(var i = 0 ; i<this.subjectClass.length; i++){\r\n\t\tif(this.classIDsMatch(this.subjectClass[i], rcls)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, renderer){\r\n\tif(rtype == \"object\") return this.frame_type == \"object\";\r\n\tif(rtype == \"value\") {\r\n\t\tif(renderer.frame){\r\n\t\t\treturn this.frame_type == renderer.frame.ftype();\r\n\t\t}\r\n\t\telse {\r\n\t\t\talert(JSON.stringify(renderer));\r\n\t\t\talert(\"No frame\");\r\n\t\t}\r\n\t}\r\n\tif(rtype == \"property\") return false;\r\n}\r\n\r\nFramePattern.prototype.checkLabel = function(rtype, renderer){\r\n\tif(typeof renderder.getLabel != \"function\"){\r\n\t\tconsole.log(new Error(\"Rule passed to check label with broken renderer object - no getLabel\"));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, renderer.getLabel());\r\n}\r\n\r\nFramePattern.prototype.IDsMatch = function(ida, idb){\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n}\r\n\r\nFramePattern.prototype.classIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.propertyIDsMatch = function(ida, idb){\r\n\tvar match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n}\r\nFramePattern.prototype.rangeIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.valuesMatch = function(vala, valb){\r\n\treturn vala == valb;\r\n}\r\nFramePattern.prototype.numberMatch = function(vala, valb){\r\n\tif(typeof vala == \"string\"){\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n}\r\n\r\nFramePattern.prototype.stringMatch = function(vala, valb){\r\n\tvar pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n}\r\n\r\nFramePattern.prototype.getRendererType = function(renderer){\r\n    if(renderer.constructor.name == \"ObjectRenderer\") return \"object\";\r\n    if(renderer.constructor.name == \"PropertyRenderer\") return \"property\";\r\n    if(renderer.constructor.name == \"ValueRenderer\") return \"value\";\r\n\tif(renderer.renderer_type) return renderer.renderer_type;\r\n\tconsole.log(new Error(\"frame configuration passed non-renderer type \" + renderer.constructor.name));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n}\r\n\r\n\r\nmodule.exports=RenderingMap\r\n\r\n\r\n","/*\r\n * Utility class which runs a query against the schema and presents the returned classes as a drop-down / class filter list\r\n */\r\n\r\nconst WOQLQuery = require('../query/WOQLQuery');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nTerminusClassChooser = function(ui, filter, chosen){\r\n\tthis.ui = ui;\r\n\tthis.choice = (chosen ? chosen : false);\r\n\tthis.filter = filter;\r\n\tthis.show_single = true;\r\n}\r\n\r\nTerminusClassChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusClassChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusClassChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify class chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusClassChooser.prototype.getAsDOM = function(style){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"terminus-class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", style + \" terminus-type-select terminus-class-select\");\r\n\t// ccsel.setAttribute(\"class\", \"terminus-class-select terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tthis.choice = this.value;\r\n\t\tself.change(this.value);\r\n\t\tthis.value = \"\";\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar woql = wq.getClassListMetaDataQuery(this.filter);\r\n\tvar self = this;\r\n\twq.execute(woql)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tif(opts){\r\n\t\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\t\tccsel.appendChild(opts[i]);\r\n\t\t\t}\r\n\t\t\tself.options = opts;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tccdom.removeChild(ccsel);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusClassChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(clist.bindings){\r\n\t\tif(this.show_single == false && clist.bindings.length < 2) return false;\r\n\t\tif(this.empty_choice){\r\n\t\t\tvar opt1 = document.createElement(\"option\");\r\n\t\t\topt1.setAttribute(\"class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\t\topt1.value = \"\";\r\n\t\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\t\tchoices.push(opt1);\r\n\t\t}\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", clist.bindings[i]);\r\n\t\t\tif(!bclass) bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Class\", clist.bindings[i]);\r\n\t\t\tif(bclass && added.indexOf(bclass) == -1){\r\n\t\t\t\tadded.push(bclass);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = bclass;\r\n\t\t\t\tif(opt.value == this.choice){\r\n\t\t\t\t\topt.selected = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar lab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(bclass);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\n\r\n\r\nmodule.exports=TerminusClassChooser\r\n","\r\nmodule.exports = Object.freeze({\r\n\tCONNECT: 'connect',\r\n\tGET_SCHEMA: 'get_schema',\r\n\tUPDATE_SCHEMA: 'update_schema',\r\n\tUPDATE_DOCUMENT: 'update_document',\r\n\tCLASS_FRAME: 'class_frame',\r\n\tWOQL_SELECT: 'woql_select',\r\n\tGET_DOCUMENT: 'get_document',\r\n\tDELETE_DATABASE: 'delete_database',\r\n\tDELETE_DOCUMENT: 'delete_document',\r\n\tCREATE_DATABASE: 'create_database',\r\n\tCREATE_DOCUMENT: 'create_document',\r\n\tWOQL_UPDATE: 'woql_update'\r\n});\r\n\r\n/*\r\n{\"extends\": \"strongloop\",\r\n  \"env\": {\r\n\t\t\"browser\": true,\r\n\t\t\"node\": true,\r\n\t\t\"es6\": true\r\n  },\r\n  \"rules\":{\"max-len\": [\"error\", { \"code\": 100 }]},\r\n \"parserOptions\": { \"ecmaVersion\": 6 }}\r\n*/\r\n","function authorityActionsToArr(action) {\r\n\tif (Array.isArray(action) === false) return [];\r\n\r\n\treturn action.map(item => item['@id']);\r\n}\r\n\r\nfunction URIEncodePayload(payload) {\r\n\tif (typeof payload === 'string') return encodeURIComponent(payload);\r\n\tconst payloadArr = [];\r\n\tfor (const key of Object.keys(payload)) {\r\n\t\tif (typeof payload[key] === 'object') {\r\n\t\t\tfor (const keyElement of Object.keys(payload[key])) {\r\n\t\t\t\t const valueElement = payload[key][keyElement];\r\n\t\t\t\t payloadArr.push(`${encodeURIComponent(keyElement)}=${encodeURIComponent(valueElement)}`);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tpayloadArr.push(`${encodeURIComponent(key)}=${encodeURIComponent(payload[key])}`);\r\n\t\t}\r\n\t}\r\n\treturn payloadArr.join('&');\r\n}\r\n\r\nmodule.exports = { authorityActionsToArr, URIEncodePayload };\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst Datatables = require('../plugins/datatables.terminus');\r\nconst UTILS=require('../Utils');\r\nconst HTMLFrameHelper = require('../client/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLResult(res, query, options, ui){\r\n\tthis.ui = ui;\r\n\tthis.query = query;\r\n\tthis.bindings = ((res && res.bindings) ? res.bindings : []);\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.shorten = function(url){\r\n\treturn this.query.shorten(url);\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\tif(result) return (result.bindings && result.bindings.length);\r\n\telse return (this.bindings && this.bindings.length);\r\n}\r\n\r\n\r\n\r\nfunction WOQLResultsViewer(ui, wresult, wQuery, options, settings, queryPage){\r\n\tthis.ui = ui;\r\n\tthis.result = wresult;\r\n\tthis.wQuery = wQuery;\r\n\tthis.max_cell_size = 400;\r\n\tthis.max_word_size = 60;\r\n\tthis.options = options;\r\n\tthis.qPage = queryPage;\r\n\t//this.wqlRes = new WOQLResult();\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.settings = settings;\r\n}\r\n\r\nWOQLResultsViewer.prototype.showTable = function(){\r\n\tif(this.options && typeof this.options.show_table != \"undefined\") return this.options.show_table;\r\n\treturn true;\r\n}\r\n\r\nWOQLResultsViewer.prototype.orderColumns = function(sample){\r\n\tvar ordered = [];\r\n\tfor(var h in sample){\r\n\t\tif(ordered.indexOf(h) == -1){\r\n\t\t\tordered.unshift(h);\r\n\t\t}\r\n\t}\r\n\treturn ordered;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getAsDOM = function(resultDOM, displayResultHeader){\r\n\tvar rs = document.createElement('div');\r\n\tresultDOM.appendChild(rs);\r\n\tif(displayResultHeader){\r\n\t\tvar rh = document.createElement('div');\r\n\t\trh.setAttribute(\"class\", \"terminus-margin-top-bottom terminus-module-head\");\r\n\t\trh.appendChild(document.createTextNode(\"Results\"));\r\n\t\trs.appendChild(rh);\r\n\t}\r\n\tif(this.result && this.result.hasBindings() && this.showTable()){\r\n\t\tthis.getTableDOM(this.result.bindings, rs);\r\n\t\treturn rs;\r\n\t}\r\n\telse {\r\n\t\tnor = document.createElement('div');\r\n\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\trs.appendChild(nor);\r\n\t\treturn rs;\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableDOM = function(bindings, resultDOM){\r\n\tif(this.pman.pluginAvailable(\"datatables\")){\r\n\t\tvar dtResult = this.getTable(bindings, true, {});\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\tvar dt = new Datatables.Datatables(this, this.qPage);\r\n\t\tdt.draw(dtResult, resultDOM);\r\n\t\tresultDOM.classList.add('terminus-expandable');\r\n\t\tresultDOM.classList.add('terminus-dt-result-cont');\r\n\t\treturn tab;\r\n    }\r\n\telse {\r\n\t\tvar tab = this.getTable(bindings, false, {});\r\n\t\tresultDOM.appendChild(tab);\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDtTableDOMOnChange = function(bindings, resultDOM, pageInfo){\r\n\t\tvar dtResult = this.getTable(bindings, true, pageInfo);\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.formatResultsForDatatableDisplay = function(bindings, pageInfo){\r\n    var columns = [], colDataData = {}, data = [], formattedResult = {}, arr = [];\r\n\tvar dtResult = {};\r\n    var ordered_headings = this.orderColumns(bindings[0]);\r\n\t// get columns\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[i]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n        columns.push({data: clab});\r\n\t}\r\n\t// get data for respective columns\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tcolDataData = {};\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\r\n\t\t\t\tvar wrap = document.createElement(\"p\");\r\n\t\t\t\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(wrap, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t\tlab = wrap.innerText;\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\t\telse if(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\t\tvar a = document.createElement(\"a\");\r\n\t\t\t\t\ta.setAttribute(\"title\", lab);\r\n\t\t\t\t\ta.setAttribute(\"href\", '#');\r\n\t\t\t\t\ta.appendChild(document.createTextNode(lab));\r\n\t\t\t\t\tlab = a.outerHTML;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[j]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[j]) : ordered_headings[j];\r\n\t\t\tcolDataData[clab] = lab;\r\n\t\t}\r\n\t\tdata.push(colDataData);\r\n\t}\r\n\tdtResult.columns                = columns;\r\n\tformattedResult.data            = data;\r\n\tformattedResult.recordsTotal    = 65;\r\n\tformattedResult.recordsFiltered = 65;\r\n\tformattedResult.draw \t\t\t= pageInfo.draw;\r\n\tdtResult.data \t\t\t\t\t= formattedResult;\r\n\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableBody = function(bindings, ordered_headings){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar self = this;\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tvar tr = document.createElement(\"tr\");\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tvar td = document.createElement(\"td\");\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t}\r\n\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\tvar a = this.getDocumentLocalLink(lab);\r\n\t\t\t\ttd.appendChild(a);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(td, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t}\r\n\t\t\ttr.appendChild(td);\r\n\t\t}\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nWOQLResultsViewer.prototype.selectDocumentNavBar = function(ui) {\r\n\tUTILS.removeSelectedNavClass(\"terminus-selected\");\r\n\tvar dnav = document.getElementsByClassName('terminus-document-nav');\r\n\tdnav[0].classList.add(\"terminus-selected\");\r\n\tUTILS.displayDocumentSubMenus(ui);\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDocumentLocalLink = function(lab){\r\n\tvar a = document.createElement(\"a\");\r\n\ta.setAttribute(\"title\", lab);\r\n\ta.setAttribute(\"href\", '#');\r\n\tvar self = this;\r\n\ta.addEventListener(\"click\", function(){\r\n\t\tif(self.result.ui) {\r\n\t\t\tself.result.ui.showDocument(this.title);\r\n\t\t\t//self.result.ui.redraw();\r\n\t\t\tself.selectDocumentNavBar(self.ui);\r\n\t\t}\r\n\t});\r\n\ta.appendChild(document.createTextNode(lab));\r\n\treturn a;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTable = function(bindings, dtPlugin, pageInfo){\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar ordered_headings = this.orderColumns(bindings[0]);\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar th = document.createElement(\"th\");\r\n\t\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\t\tvar clab = (ordered_headings[i].indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n\t\tth.appendChild(document.createTextNode(clab));\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\ttab.appendChild(thead);\r\n\tif(dtPlugin){\r\n\t\tvar tbody = document.createElement(\"tbody\");\r\n\t\ttab.appendChild(tbody);\r\n\t\tvar dtResult ={};\r\n\t\tdtResult.result = this.formatResultsForDatatableDisplay(bindings, pageInfo);\r\n\t\tdtResult.tab = tab;\r\n\t\treturn dtResult;\r\n\t}\r\n\telse {\r\n\t\tvar tbody = this.getTableBody(bindings, ordered_headings);\r\n\t\ttab.appendChild(tbody);\r\n\t\treturn tab;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports={WOQLResultsViewer, WOQLResult}\r\n","/**\r\n * Object for producing a HTML view of a given object in a frame\r\n */\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLObjectViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.properties = [];\r\n\tthis.headerViewer = renderer.getObjectHeaderViewer();\r\n\t//this.featureViewers = {};\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nHTMLObjectViewer.prototype.render = function(){\r\n\tif(this.renderedDOM){\r\n\t\tvar renderedDOM = this.getObjectDOM();\r\n\t\tthis.renderedDOM.replaceWith(renderedDOM);\r\n\t\tthis.renderedDOM = renderedDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.renderedDOM = this.getObjectDOM();\r\n\t}\r\n\tthis.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getObjectBodyDOM();\r\n\tif(this.body) this.renderedDOM.appendChild(this.body);\r\n\treturn this.renderedDOM;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\r\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\r\n\treturn sp;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-properties-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\r\n    for(var prop in this.properties){\r\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\r\n\tif(this.hasFeatureViewer(feature)){\r\n\t\treturn this.featureViewer[feature](this.renderer, this);\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redraw = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getObjectBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a rendered version of a property to the internal properties array\r\n */\r\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\r\n\tthis.properties[prop] = renderedprop;\r\n}\r\n\r\nHTMLObjectViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = {};\r\n}\r\n\r\n/**\r\n * Removes the object from the dom\r\n */\r\nHTMLObjectViewer.prototype.remove = function(){\r\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\r\n}\r\n\r\nHTMLObjectViewer.prototype.goTo = function(subj, property){\r\n\tHTMLFrameHelper.goToName(subj, property);\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the object on the page\r\n */\r\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\r\n\tvar sh = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n    if(!sh) sh = renderer.subject();\r\n    if(sh){\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tidm.setAttribute(\"name\", sh);\r\n    }\r\n\treturn idm;\r\n}\r\n\r\nfunction HTMLObjectHeaderViewer(){}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\r\n\t\tif(idDOM) objDOM.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\r\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\r\n\tif(renderer.showFeature(\"add\")){\r\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\r\n\t\tif(addDOM) controlsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\tif(lab){\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\r\n\tvar val = renderer.subject();\r\n\tvar input = false;\r\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\r\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\r\n\t\tinput = document.createElement(\"input\");\r\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\r\n\t\tinput.required  = true;\r\n\t\tif(val == \"_:\") val = \"\";\r\n\t\trenderer.idDOM = input;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\r\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\r\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.changeClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\r\n\tvar lab = renderer.subjectClass();\r\n\tvar cmt = \"All objects have types, identified by a unique URL\";\r\n\tif(cm){\r\n\t\tlab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", cm);\r\n\t\tcmt = HTMLFrameHelper.getVariableValueFromBinding(\"Comment\", cm);\r\n\t\tcmt = (cmt ? renderer.subjectClass() + \" \" + cmt : renderer.subjectClass());\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\r\n\tvar addables = renderer.getAddableProperties();\r\n\tif(addables && addables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\r\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.addNewProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableProperties();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.goToProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\r\n\tif(renderer.isNewDocument()){\r\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\telse {\r\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nmodule.exports={HTMLObjectViewer,HTMLObjectHeaderViewer}\r\n","'use strict';\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%40/gi, '@').\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    var hashmarkIndex = url.indexOf('#');\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n","'use strict';\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar normalizeHeaderName = require('./helpers/normalizeHeaderName');\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  // Only Node.JS has a process variable that is of [[Class]] process\n  if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  } else if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Accept');\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n","'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildURL = require('./../helpers/buildURL');\nvar parseHeaders = require('./../helpers/parseHeaders');\nvar isURLSameOrigin = require('./../helpers/isURLSameOrigin');\nvar createError = require('../core/createError');\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(createError('Request aborted', config, 'ECONNABORTED', request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      var cookies = require('./../helpers/cookies');\n\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?\n        cookies.read(config.xsrfCookieName) :\n        undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (config.withCredentials) {\n      request.withCredentials = true;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (requestData === undefined) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n","'use strict';\n\nvar enhanceError = require('./enhanceError');\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n","'use strict';\n\nvar utils = require('../utils');\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n * @returns {Object} New object resulting from merging config2 to config1\n */\nmodule.exports = function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  var config = {};\n\n  utils.forEach(['url', 'method', 'params', 'data'], function valueFromConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    }\n  });\n\n  utils.forEach(['headers', 'auth', 'proxy'], function mergeDeepProperties(prop) {\n    if (utils.isObject(config2[prop])) {\n      config[prop] = utils.deepMerge(config1[prop], config2[prop]);\n    } else if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (utils.isObject(config1[prop])) {\n      config[prop] = utils.deepMerge(config1[prop]);\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  utils.forEach([\n    'baseURL', 'transformRequest', 'transformResponse', 'paramsSerializer',\n    'timeout', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',\n    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress', 'maxContentLength',\n    'validateStatus', 'maxRedirects', 'httpAgent', 'httpsAgent', 'cancelToken',\n    'socketPath'\n  ], function defaultToConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  return config;\n};\n","'use strict';\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n","const UTILS = require('./utils.js');\r\nconst CONST = require('./const.js');\r\nconst ErrorMessage = require('./errorMessage');\r\n/*\r\n * Creates an entry in the connection registry for the server\r\n * and all the databases that the client has access to\r\n * maps the input authorties to a per-db array for internal storage and easy\r\n * access control checks\r\n * {doc:dbid => {terminus:authority =>\r\n * [terminus:woql_select, terminus:create_document, auth3, ...]}}\r\n *\r\n */\r\n\r\nfunction ConnectionCapabilities(connectionConfig, key) {\r\n\tthis.connection = {};\r\n\tthis.connectionConfig = connectionConfig;\r\n\tif (this.connectionConfig.server && key) {\r\n\t\tthis.setClientKey(this.connectionConfig.server, key);\r\n\t}\r\n}\r\n\r\nConnectionCapabilities.prototype.getClientKey = function (serverURL) {\r\n\tif (!serverURL) serverURL = this.connectionConfig.serverURL();\r\n\tif (serverURL && this.connection[serverURL]) return this.connection[serverURL].key;\r\n\treturn false;\r\n};\r\n\r\n\r\n/*\r\n * Utility functions for changing the state of connections with Terminus servers\r\n */\r\nConnectionCapabilities.prototype.setClientKey = function (curl, key) {\r\n\tif (typeof key === 'string' && key.trim()) {\r\n\t\tif (typeof this.connection[curl] === 'undefined') {\r\n\t\t\tthis.connection[curl] = {};\r\n\t\t}\r\n\t\tthis.connection[curl].key = key.trim();\r\n\t}\r\n};\r\n\r\n\r\n/**\r\n * @params {string} curl a valid terminusDB server URL\r\n * @params {object} capabilities it is the connect call response\r\n */\r\nConnectionCapabilities.prototype.addConnection = function (curl, capabilities) {\r\n\tif (typeof this.connection[curl] === 'undefined') {\r\n\t\tthis.connection[curl] = {};\r\n\t}\r\n\tconst capabilitiesKeys = capabilities ? Object.keys(capabilities) : [];\r\n\r\n\tfor (const pred of capabilitiesKeys) {\r\n\t    if (pred === 'terminus:authority' && capabilities[pred]) {\r\n\t      const auths = Array.isArray(capabilities[pred]) === true\r\n\t        ? capabilities[pred]\r\n\t        : [capabilities[pred]];\r\n\r\n\t      for (let i = 0; i < auths.length; i += 1) {\r\n\t        let scope = auths[i]['terminus:authority_scope'];\r\n\t        const actions = auths[i]['terminus:action'];\r\n\r\n\t        if (Array.isArray(scope) === false) scope = [scope];\r\n\t        const actionsArr = UTILS.authorityActionsToArr(actions);\r\n\r\n\t        for (let j = 0; j < scope.length; j += 1) {\r\n\t          const nrec = scope[j];\r\n\t          if (typeof this.connection[curl][nrec['@id']] === 'undefined') {\r\n\t            this.connection[curl][nrec['@id']] = nrec;\r\n\t          }\r\n\t          this.connection[curl][nrec['@id']]['terminus:authority'] = actionsArr;\r\n\t        }\r\n\t      }\r\n\t    } else {\r\n\t      this.connection[curl][pred] = capabilities[pred];\r\n\t    }\r\n\t}\r\n};\r\n\r\nConnectionCapabilities.prototype.serverConnected = function () {\r\n\treturn typeof this.connection[this.connectionConfig.server] !== 'undefined';\r\n};\r\n\r\nConnectionCapabilities.prototype.capabilitiesPermit = function (action, dbid, server) {\r\n\tif (!this.connectionConfig.connectionMode()\r\n         || this.connectionConfig.client_checks_capabilities !== true\r\n         || action === CONST.CONNECT) { return true; }\r\n\r\n\tserver = server || this.connectionConfig.server;\r\n\tdbid = dbid || this.connectionConfig.dbid;\r\n\r\n\tlet rec;\r\n\r\n\tif (action === CONST.CREATE_DATABASE) {\r\n\t\trec = this.getServerRecord(server);\r\n\t} else if (dbid) rec = this.getDBRecord(dbid);\r\n\telse console.log('no dbid', server, dbid);\r\n\tif (rec) {\r\n\t\tconst auths = rec['terminus:authority'];\r\n\t\tif (auths && auths.indexOf(`terminus:${action}`) !== -1) return true;\r\n\t} else {\r\n\t\tconsole.log('problem with ', this.connection, action, server, dbid);\r\n\t}\r\n\tthis.error = ErrorMessage.accessDenied(action, dbid, server);\r\n\treturn false;\r\n};\r\n\r\nConnectionCapabilities.prototype.getServerRecord = function (srvr) {\r\n\tconst url = (srvr || this.connectionConfig.server);\r\n\tconst connectionObj = this.connection[url] || {};\r\n\tconst okeys = Object.keys(connectionObj);\r\n\r\n\tfor (const oid of okeys) {\r\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Server') {\r\n\t\t\treturn this.connection[url][oid];\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\r\n\tconst url = (srvr || this.connectionConfig.server);\r\n\tdbid = (dbid || this.connectionConfig.dbid);\r\n\tif (typeof this.connection[url] !== 'object') {\r\n\t\treturn false;\r\n\t}\r\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\r\n\r\n\tdbid = this.dbCapabilityID(dbid);\r\n\r\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\r\n\r\n\treturn undefined;\r\n};\r\n\r\nConnectionCapabilities.prototype.getServerDBRecords = function (srvr) {\r\n\tconst url = (srvr || this.connectionConfig.server);\r\n\tconst dbrecs = {};\r\n\tconst connectionObj = this.connection[url] || {};\r\n\r\n\tfor (const oid of Object.keys(connectionObj)) {\r\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Database') {\r\n\t\t\tdbrecs[oid] = this.connection[url][oid];\r\n\t\t}\r\n\t}\r\n\treturn dbrecs;\r\n};\r\n\r\n/*\r\n * removes a database record from the connection registry (after deletion, for example)\r\n */\r\nConnectionCapabilities.prototype.removeDB = function (dbid, srvr) {\r\n\tdbid = dbid || this.connectionConfig.dbid;\r\n\r\n\tif (dbid && this.connectionConfig.dbid && this.connectionConfig.dbid === dbid) {\r\n\t\tthis.connectionConfig.dbid = false;\r\n\t}\r\n\r\n\tconst url = srvr || this.connectionConfig.server;\r\n\tconst dbidCap = this.dbCapabilityID(dbid);\r\n\tif (dbidCap && this.connection[url] && this.connection[url][dbidCap]) {\r\n\t\tdelete this.connection[url][dbidCap];\r\n\t}\r\n};\r\n\r\n\r\nConnectionCapabilities.prototype.dbCapabilityID = function (dbid) {\r\n\treturn `doc:${dbid}`;\r\n};\r\n\r\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\r\n\tconst url = srvr || this.connectionConfig.server;\r\n\tdbid = dbid || this.connectionConfig.dbid;\r\n\tif (typeof this.connection[url] !== 'object') {\r\n\t\treturn false;\r\n\t}\r\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\r\n\r\n\tdbid = this.dbCapabilityID(dbid);\r\n\r\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\r\n\r\n\treturn undefined;\r\n};\r\n\r\nmodule.exports = ConnectionCapabilities;\r\n","\r\nconst IDParser = require('./terminusIDParser');\r\n\r\nfunction ConnectionConfig(params) {\r\n\tconst newParams = params || {};\r\n\tthis.server = false;\r\n\tthis.dbid = false;\r\n\tthis.docid = false;\r\n\tif (newParams.server) this.setServer(newParams.server);\r\n\tif (newParams.db) this.setDB(newParams.db);\r\n\tif (newParams.doc) this.setDocument(newParams.doc);\r\n\t/*\r\n     * client configuration options - connected_mode = connected\r\n     * tells the client to first connect to the server before invoking other services\r\n     */\r\n\r\n\tthis.connected_mode = newParams.connected_mode || 'connected';\r\n\t// include a terminus:user_key API key in the calls\r\n\tthis.include_key = newParams.include_key || true;\r\n\t// client side checking of access control (in addition to server-side access control)\r\n\tthis.client_checks_capabilities = newParams.client_checks_capabilities || true;\r\n}\r\n\r\nConnectionConfig.prototype.serverURL = function () {\r\n\treturn this.server;\r\n};\r\n\r\n\r\nConnectionConfig.prototype.connectionMode = function () {\r\n\treturn this.connected_mode === 'connected';\r\n};\r\n\r\nConnectionConfig.prototype.includeKey = function () {\r\n\treturn this.include_key === true;\r\n};\r\n\r\nConnectionConfig.prototype.schemaURL = function () {\r\n\treturn `${this.dbURL()}/schema`;\r\n};\r\nConnectionConfig.prototype.queryURL = function () {\r\n\treturn `${this.dbURL()}/woql`;\r\n};\r\nConnectionConfig.prototype.frameURL = function () {\r\n\treturn `${this.dbURL()}/frame`;\r\n};\r\nConnectionConfig.prototype.docURL = function () {\r\n\treturn `${this.dbURL()}/document/${this.docid ? this.docid : ''}`;\r\n};\r\n\r\nConnectionConfig.prototype.dbURL = function (call) {\r\n\t// url swizzling to talk to platform using server/dbid/platform/ pattern..\r\n\tif (this.platformEndpoint()) {\r\n\t\tconst baseURL = this.server.substring(0, this.server.lastIndexOf('/platform/'));\r\n\r\n\t\tif (!call || call !== 'create') {\r\n\t\t\treturn `${baseURL}/${this.dbid}/platform`;\r\n\t\t} if (call === 'platform') {\r\n\t\t\treturn `${baseURL}/${this.dbid}`;\r\n\t\t}\r\n\t}\r\n\treturn this.server + this.dbid;\r\n};\r\n\r\nConnectionConfig.prototype.platformEndpoint = function () {\r\n\tif (this.server && this.server.lastIndexOf('/platform/') === this.server.length - 10) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/**\r\n * Utility functions for setting and parsing urls and determining\r\n * the current server, database and document\r\n */\r\nConnectionConfig.prototype.setServer = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseServerURL(inputStr)) {\r\n\t\tthis.server = parser.server();\r\n\t\tthis.dbid = false;\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionConfig.prototype.setDB = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseDBID(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tthis.dbid = parser.dbid();\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// @param {string} inputStr TerminusDB server URL or a valid TerminusDB Id or omitted\r\n\r\nConnectionConfig.prototype.setSchemaURL = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseSchemaURL(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tthis.dbid = parser.dbid();\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionConfig.prototype.setDocument = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseDocumentURL(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tif (parser.dbid()) this.dbid = parser.dbid();\r\n\t\tif (parser.docid()) this.docid = parser.docid();\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionConfig.prototype.setQueryURL = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseQueryURL(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tthis.dbid = parser.dbid();\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionConfig.prototype.setClassFrameURL = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseClassFrameURL(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tthis.dbid = parser.dbid();\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nmodule.exports = ConnectionConfig;\r\n","/*\r\n11.75s$ npm install\r\n6.39s$ npm test\r\n*/\r\n/*\r\n * Helper class for parsing and decomposing Terminus URLs /\r\n * and dealing with namespace prefixed URLs\r\n */\r\n// const URL = require('url').URL;\r\n\r\n/*\r\n\"@context\": {\r\n    \"owl\":\"http://www.w3.org/2002/07/owl#\",\r\n    \"rdf\":\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\r\n    \"xsd\":\"http://www.w3.org/2001/XMLSchema#\"\r\n  } */\r\n\r\n\r\nfunction IDParser(context) {\r\n\tthis.context = context;\r\n\tthis.server_url = false;\r\n\tthis.db = false;\r\n\tthis.doc = false;\r\n}\r\n\r\nIDParser.prototype.server = function () {\r\n\treturn this.server_url;\r\n};\r\n\r\nIDParser.prototype.dbid = function () {\r\n\treturn this.db;\r\n};\r\n\r\nIDParser.prototype.docid = function () {\r\n\treturn this.doc;\r\n};\r\n\r\nIDParser.prototype.setContext = function (context) {\r\n\tthis.context = context;\r\n};\r\n\r\nIDParser.prototype.parseServerURL = function (str) {\r\n\tthis.server_url = false;\r\n\r\n\tif (this.validURL(str)) {\r\n\t\tthis.server_url = str;\r\n\t} else if (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tthis.server_url = this.expandPrefixed(str, this.context);\r\n\t}\r\n\r\n\tif (this.server_url && this.server_url.lastIndexOf('/') !== this.server_url.length - 1\r\n\t) {\r\n\t\tthis.server_url += '/';\r\n\t}\r\n\treturn this.server_url;\r\n};\r\n\r\nIDParser.prototype.parseDBID = function (str) {\r\n\tthis.db = false;\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\tif (this.validURL(str)) {\r\n\t\tif (str.lastIndexOf('/') === str.length - 1) {\r\n\t\t\t// trim trailing slash\r\n\t\t\tstr = str.substring(0, str.length - 1);\r\n\t\t}\r\n\t\tconst index = str.lastIndexOf('/');\r\n\r\n\t\tconst serverURL = str.substring(0, index);\r\n\t\t// only dbNamer\r\n\t\tstr = str.substring(index + 1);\r\n\r\n\t\tif (this.parseServerURL(serverURL) === false) return false;\r\n\t}\r\n\r\n\tif (this.validIDString(str)) {\r\n\t\tthis.db = str;\r\n\t}\r\n\treturn this.db;\r\n};\r\n\r\nIDParser.prototype.parseDocumentURL = function (str) {\r\n\tthis.doc = false;\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\r\n\tif (this.validURL(str)) {\r\n\t\tlet dbURL = str;\r\n\t\tif (str.lastIndexOf('/document/') !== -1) {\r\n\t\t\t// get dbURL\r\n\t\t\tdbURL = str.substring(0, str.lastIndexOf('/document/'));\r\n\t\t\tstr = str.substring(str.lastIndexOf('/document/') + 10);\r\n\t\t}\r\n\t\tif (this.parseDBID(dbURL) === false) return false;\r\n\t}\r\n\tif (str.substring(0, 4) === 'doc:') str = str.substring(4);\r\n\t// check if the document's name hasn't space or '/'\r\n\tif (this.validIDString(str)) {\r\n\t\tthis.doc = str;\r\n\t}\r\n\treturn this.doc;\r\n};\r\n\r\nIDParser.prototype.parseSchemaURL = function (str) {\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\tif (this.validURL(str)) {\r\n\t\tstr = this.stripOptionalPath(str, 'schema');\r\n\t}\r\n\treturn this.parseDBID(str);\r\n};\r\n\r\nIDParser.prototype.parseQueryURL = function (str) {\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\tif (this.validURL(str)) {\r\n\t\tstr = this.stripOptionalPath(str, 'woql');\r\n\t\tstr = this.stripOptionalPath(str, 'query');\r\n\t}\r\n\treturn this.parseDBID(str);\r\n};\r\n\r\nIDParser.prototype.stripOptionalPath = function (str, bit) {\r\n\tif (str.indexOf(`/${bit}`) !== -1) str = str.substring(0, str.indexOf(`/${bit}`));\r\n\treturn str;\r\n};\r\n\r\nIDParser.prototype.parseClassFrameURL = function (str) {\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\tif (this.validURL(str)) {\r\n\t\tstr = this.stripOptionalPath(str, 'frame');\r\n\t}\r\n\treturn this.parseDBID(str);\r\n};\r\n\r\n// Valid URLs are those that start with http:// or https://\r\nIDParser.prototype.validURL = function (str) {\r\n\tif (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://') return true;\r\n\treturn false;\r\n};\r\n\r\nIDParser.prototype.validPrefixedURL = function (str, context) {\r\n\tif (typeof str !== 'string' || typeof context !== 'object') return false;\r\n\tconst parts = str.split(':');\r\n\tif (parts.length !== 2) return false;\r\n\tif (parts[0].length < 1 || parts[1].length < 1) return false;\r\n\tif (context && context[parts[0]] && this.validIDString(parts[1])) return true;\r\n\treturn false;\r\n};\r\n\r\nIDParser.prototype.validIDString = function (str) {\r\n\tif (typeof str !== 'string') return false;\r\n\tif (str.indexOf(':') !== -1 || str.indexOf(' ') !== -1 || str.indexOf('/') !== -1) return false;\r\n\treturn true;\r\n};\r\n\r\nIDParser.prototype.expandPrefixed = function (str, context) {\r\n\tconst parts = str.split(':');\r\n\treturn context[parts[0]] + parts[1];\r\n};\r\n\r\nmodule.exports = IDParser;\r\n","/**\r\n * FramePatternMatcher does pattern matching on frames \r\n * Does a given pattern match a given frame?\r\n */\r\nconst FramePatternMatcher = {}\r\n\r\n/**\r\n * Runs an array of matching rules across a frame and calls the passed onmatch function on each match\r\n * The optional onmatch function is called with each hit and is passed the frame and the rule that hit it.\r\n * A list of the matched rules is returned. \r\n * \r\n */\r\nFramePatternMatcher.testRules = function(rules, frame, onmatch){\r\n\tvar matched_rules = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar match = (!rules[i].pattern || this.patternMatchesFrame(rules[i].pattern, frame));\r\n\t\tif(match){\r\n\t\t\tmatched_rules.push(rules[i]);\r\n\t\t\tif(onmatch && typeof onmatch == \"function\"){\r\n\t\t\t\tonmatch(frame, rules[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn matched_rules;\r\n}\r\n\r\n/**\r\n * Determines whether a given pattern matches a given frame\r\n */\r\nFramePatternMatcher.patternMatchesFrame = function(pattern, frame){\r\n\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\tif(!fp.checkFrame(frame)) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\telse {\r\n\t\tvar fp = new FramePattern(pattern);\r\n\t\treturn fp.checkFrame(frame);\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * A frame pattern can have the following variables\r\n * renderer : object, property, data, * - matches a specific part of the frame \r\n * label : matches the label of a property\r\n * frame_type: object, data, document, oneOf\r\n * subject: id of the subject\r\n * subjectClass: class of the subject\r\n * range: type of a property (applies to property and data)\r\n * property: property id or list of property ids (parent property if it is an object or data)\r\n * value: value of the property\r\n * parent: a pattern relating to the parent of this frame\r\n * children: patterns for matching on the children of a frame\r\n * depth: how deep are we in the document? starts from 0\r\n * index: the index of a value in an array\r\n * status: updated, error, new, ok,  \r\n */\r\n\r\nFramePattern = function(pattern){\r\n\tif(pattern){\r\n\t\tthis.setPattern(pattern);\r\n\t}\r\n}\r\n\r\nFramePattern.prototype.setPattern = function(pattern){\r\n\tthis.renderer = (pattern.renderer ? pattern.renderer : false);\r\n\tthis.label = (pattern.label ? pattern.label : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif(pattern.children){\r\n\t\tfor(var i = 0 ; i < pattern.children.length ; i++){\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth != \"undefined\" ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\t\t\r\n}\r\n\t\r\nFramePattern.prototype.checkFrame = function(frame){\r\n\tvar rtype = this.getRendererType(frame);\r\n\tif(!rtype) return false;\r\n\tif(this.renderer && (this.renderer != rtype) && (this.renderer != \"*\" )) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, frame)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, frame)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, frame)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, frame)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, frame)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, frame)) return false;\r\n\tif(this.range && !this.checkRange(rtype, frame)) return false;\r\n\tif(this.value && !this.checkValue(rtype, frame)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, frame)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, frame)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, frame)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, frame)) return false;\r\n\treturn true;\r\n} \r\n\r\nFramePattern.prototype.illegalRuleType = function(rtype){\r\n\t//data frames have no children\r\n\tif(rtype == 'data' && this.children.length ) return true;\r\n\t//object frames have no range\r\n\tif(rtype == 'object' && this.range ) return true;\r\n\treturn false;\r\n}\r\n\r\n/* subject is an id or an array of ids, \r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function(subject, frame){\r\n\tif(typeof this.subject != \"object\" || !this.subject.length) this.subject = [this.subject];\r\n\tvar rsubj = frame.subject();\r\n\tfor(var i = 0 ; i<this.subject.length; i++){\r\n\t\tif(this.IDsMatch(subject[i], rsubj)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function(rtype, frame){\r\n\tfor(var i = 0 ; i<this.children.length; i++){\r\n\t\tvar found = false;\r\n\t\tif(rtype == \"object\"){\r\n\t\t\tfor(var prop in frame.properties){\r\n\t\t\t\tif(this.children[i].checkFrame(frame.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j <= renderer.values.length; j++){\r\n\t\t\t\tif(this.children[j].checkFrame(frame.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!found) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkStatus = function(rtype, frame){\r\n\tif(typeof this.status != \"object\" || this.status.length == 0) this.status = [this.status];\r\n\tfor(var i = 0; i<this.status.length; i++){\r\n\t\tif(this.status[i] == \"updated\" && !frame.isUpdated()) return false;\r\n\t\tif(this.status[i] == \"new\" && !frame.isNew()) return false;\r\n\t\tif(this.status[i] == \"unchanged\" && frame.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkDepth = function(rtype, frame){\r\n\treturn this.numberMatch(this.depth, frame.depth());\r\n}\r\n\r\nFramePattern.prototype.checkParent = function(rtype, frame){\r\n\treturn this.parent.checkFrame(frame.parent);\r\n}\r\n\r\nFramePattern.prototype.checkIndex = function(rtype, frame){\r\n\tif(rtype == 'data'){\r\n\t\treturn this.index == frame.index;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkProperty  = function(rtype, frame){\r\n\tif(typeof this.property != \"object\" || !this.property.length) this.property = [this.property];\r\n\tfor(var i = 0 ; i<this.property.length; i++){\r\n\t\tif(this.propertyIDsMatch(frame.property(), this.property[i])){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function(rtype, frame){\r\n\tif(typeof this.value != \"object\" || !this.value.length) this.value = [this.value];\r\n\tfor(var i = 0 ; i<this.value.length; i++){\r\n\t\tif(rtype == \"data\"){\r\n\t\t\tif(this.valuesMatch(frame.value(), this.value[i])){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j<= frame.values.length;  j++){\r\n\t\t\t\tif(this.getRendererType(frame.values[i]) == 'data' &&\r\n\t\t\t\t\t\tthis.valuesMatch(frame.values[i].get(), this.value[i])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"object\"){\r\n\t\t\tfor(var prop in frame.properties){\r\n\t\t\t\tif(this.checkValue(this.getRendererType(frame.properties[prop]), frame.properties[prop])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkRange  = function(rtype, frame){\r\n\tif(typeof this.range != \"object\" || !this.range.length) this.range = [this.range];\r\n\tfor(var i = 0 ; i<this.range.length; i++){\r\n\t\tif(this.rangeIDsMatch(frame.range(), this.range[i])){ \r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkSubjectClass = function(rtype, frame){\r\n\tif(typeof this.subjectClass != \"object\" || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tvar rcls = frame.subjectClass();\r\n\tfor(var i = 0 ; i<this.subjectClass.length; i++){\r\n\t\tif(this.classIDsMatch(this.subjectClass[i], rcls)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, frame){\r\n\tif(rtype == \"object\") return this.frame_type == \"object\";\r\n\tif(rtype == \"data\") {\r\n\t\tif(frame.frame){\r\n\t\t\treturn this.frame_type == frame.frame.ftype();\r\n\t\t}\r\n\t}\r\n\tif(rtype == \"property\") return false;\r\n}\r\n\r\nFramePattern.prototype.checkLabel = function(rtype, frame){\r\n\tif(typeof frame.getLabel != \"function\"){\r\n\t\tconsole.log(new Error(\"Rule passed to check label with broken renderer object - no getLabel\"));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, frame.getLabel());\r\n}\r\n\r\nFramePattern.prototype.IDsMatch = function(ida, idb){\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n}\r\n\r\nFramePattern.prototype.classIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.propertyIDsMatch = function(ida, idb){\r\n\tvar match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n}\r\nFramePattern.prototype.rangeIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.valuesMatch = function(vala, valb){\r\n\treturn vala == valb;\r\n}\r\nFramePattern.prototype.numberMatch = function(vala, valb){\r\n\tif(typeof vala == \"string\"){\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n}\r\n\r\nFramePattern.prototype.stringMatch = function(vala, valb){\r\n\tvar pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n}\r\n\r\nFramePattern.prototype.getRendererType = function(frame){\r\n\tif(frame.isProperty()) return \"property\";\r\n    if(frame.isObject()) return \"object\";\r\n    if(frame.isData()) return \"data\";\r\n\tif(frame.renderer_type) return frame.renderer_type;\r\n\tconsole.log(new Error(\"frame configuration passed non-renderer type \" + frame.constructor.name));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n}\r\n\r\nfunction FrameRule(){\r\n\tthis.rule = { pattern: {}};\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.renderer = function(...rend){\r\n\tthis.rule.pattern.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.setRenderer = function(rend){\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.render = function(func){\r\n\tthis.rule.render = func;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.args = function(json){\r\n\tthis.rule.args = json;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.compare = function(func){\r\n\tthis.rule.compare = func;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.frame_type = function(...frametype){\r\n\tthis.rule.pattern.frametype = frame_type;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.label = function(...label){\r\n\tthis.rule.pattern.label = label;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.subject = function(...subject){\r\n\tthis.rule.pattern.subject = subject;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.subjectClass = function(...subjectClass){\r\n\tthis.rule.pattern.subjectClass = subjectClass;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.property = function(...property){\r\n\tthis.rule.pattern.property = property;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.depth = function(depth){\r\n\tthis.rule.pattern.depth = depth;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.range = function(...range){\r\n\tthis.rule.pattern.range = range;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.value = function(...value){\r\n\tthis.rule.pattern.value = value;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.pattern = function(){\r\n\treturn this.rule.pattern;\r\n}\r\n\r\nFrameRule.prototype.json = function(){\r\n\treturn this.rule;\r\n}\r\n\r\nFrameRule.prototype.parent = function(parent){\r\n\tthis.rule.pattern.parent = parent.pattern();\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.children = function(...children){\r\n\tif(typeof this.rule.pattern.children == \"undefined\"){\r\n\t\tthis.rule.pattern.children = [];\r\n\t}\r\n\tfor(var i = 0; i<children.length; i++){\r\n\t\tthis.rule.pattern.children.push(children[i].pattern());\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.index = function(...index){\r\n\tthis.rule.pattern.index = index;\r\n\treturn this;\t\r\n}\r\n\r\nFrameRule.prototype.status = function(...status){\r\n\tthis.rule.pattern.status = status;\r\n\treturn this;\t\r\n}\r\n\r\n\r\nmodule.exports = {FramePatternMatcher, FrameRule} ;\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst Renderers = require('./ObjectRenderer');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst ObjectViewer = require('./ObjectViewer');\r\nconst TerminusDBViewer = require('./TerminusDB');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst UTILS=require('../Utils');\r\n\r\nfunction TerminusDocumentViewer(ui, action, options){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.db = this.ui.db();\r\n\tthis.init();\r\n\tthis.page_config = (options && options.page_config ? options.page_config : \"view\");\r\n\tthis.mode = (options && options.mode ? options.mode : \"view\");\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n\tthis.load_schema = (options && options.load_schema ? options.load_schema : true);\r\n\tthis.config_options = this.getBuiltInViewerOptions();\r\n\tthis.options = (options ? options : this.config_options[action]);\r\n\tthis.action = action;\r\n\tthis.document = false;\r\n\tthis.dbViewer = new TerminusDBViewer.TerminusDBViewer(this.ui);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.init = function(){\r\n\tconst tbv = new TerminusDBViewer.TerminusDBViewer(this.ui);\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getClassMetaDataQuery();\r\n\tvar self = this;\r\n\tself.classmeta = {};\r\n\tself.instancemeta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar cls = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", wresult.bindings[i]);\r\n\t\t\t\tif(cls && typeof self.classmeta[cls] == \"undefined\"){\r\n\t\t\t\t\tself.classmeta[cls] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getJsonLdViewer = function(){\r\n\tswitch(this.page_config){\r\n\t\tcase 'view':\r\n\t\t\tvar self = this;\r\n\t\t\tthis.ui.client.getDocument()\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t    TerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n\t\t\t\tvar label = response['@id']; // get doc id\r\n\t\t\t\tvar header = document.createElement('div');\r\n\t\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t\t\theader.appendChild(document.createTextNode('jsonld format of ' + label));\r\n\t\t\t\tself.pagedom.appendChild(header);\r\n\t\t\t    var res = document.createElement('pre');\r\n\t\t\t\tself.document_json_response = response;\r\n\t\t\t\tres.innerHTML = JSON.stringify(response, undefined, 2);\r\n\t\t\t    res.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\t\tUTILS.stylizeCodeDisplay(self.ui, res, self.pagedom, 'javascript');\r\n\t\t\t})\r\n\t\t\t.catch(function(e){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tthrow(e);\r\n\t\t\t});\r\n\t\tbreak;\r\n\t\tcase 'create':\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\t\tvar header = document.createElement('div');\r\n\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t \tvar ohv = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t\t\theader.appendChild(ohv.getObjectIDDOM(this.renderer));\r\n\t\t\t//header.appendChild(document.createTextNode('Create new document in jsonld format'));\r\n\t\t\theader.appendChild(this.getDocumentJsonldCreateButton());\r\n\t\t\tthis.pagedom.appendChild(header);\r\n\t\t\tvar res = document.createElement('textarea');\r\n\t\t\tthis.json_editor = res;\r\n\t\t\tthis.pagedom.appendChild(res);\r\n\t\t\tres.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\tUTILS.stylizeEditor(this.ui, res, 'doc-json-create', 'javascript');\r\n\t\t\tbreak;\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getEncodingChooserDOM = function() {\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group\");\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar enc = document.createElement('select');\r\n\tenc.setAttribute('class', 'terminus-doc-config terminus-enc');\r\n\tvar oframe = document.createElement('option');\r\n\toframe.setAttribute('value', 'frame');\r\n\toframe.appendChild(document.createTextNode('HTML'));\r\n\tenc.appendChild(oframe);\r\n\tvar ojson = document.createElement('option');\r\n\tojson.setAttribute('value', 'jsonld');\r\n\tojson.appendChild(document.createTextNode('JSON-LD'));\r\n\tenc.appendChild(ojson);\r\n\tnbuts.appendChild(enc);\r\n\tvar self = this;\r\n\tenc.addEventListener('change', function(e){\r\n\t\tself.viewMode = this.value;\r\n\t\tswitch(self.page_config){\r\n\t\t\tcase 'view':\r\n\t\t\t\tself.page_config = 'view';\r\n\t\t\t\tif(this.value == 'frame'){\r\n\t\t\t\t\tself.renderer = false;\r\n\t\t\t\t\tself.refreshPage();\r\n\t\t\t\t}\r\n\t\t\t\telse self.getJsonLdViewer();\r\n\t\t\tbreak;\r\n\t\t\tcase 'create':\r\n\t\t\t\tself.page_config = 'create';\r\n\t\t\t\tif(this.value == 'frame'){\r\n\t\t\t\t\tself.renderer = false;\r\n\t\t\t\t\tself.refreshPage();\r\n\t\t\t\t}\r\n\t\t\t\telse self.getJsonLdViewer();\r\n\t\t\tbreak;\r\n\t\t}\r\n\t})\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(nbuts);\r\n\tscd.appendChild(ccDOM);\r\n\treturn scd;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentChooserDOM = function(holder){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-get-doc terminus-document-chooser terminus-form-horizontal terminus-control-group\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-doc-control-label terminus-control-label-padding\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID to view.\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.setAttribute('title', 'Enter Document ID to view');\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('class', 'fa fa-check');\r\n\tnbut.appendChild(i);\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) {\r\n\t\t\tself.ui.showDocument(dcip.value);\r\n\t\t}\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\tholder.appendChild(scd);\r\n};\r\n\r\nTerminusDocumentViewer.prototype.getDocumentCreatorSelect = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\treturn tcdom;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-create-doc terminus-document-creator terminus-form-horizontal terminus-control-group\");\r\n\t// get dropdown with list of types\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\t// get input type\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('title', 'Input which document type to create');\r\n\ti.setAttribute('class', 'fa fa-check');\r\n\tnbut.appendChild(i);\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tccDOM.setAttribute(\"class\", \"create-document-list terminus-display-flex\");\r\n\tccDOM.appendChild(this.getDocumentCreatorSelect());\r\n\t//ccDOM.appendChild(tcdom);\r\n\tccDOM.appendChild(dcip);\r\n\tccDOM.appendChild(nbut);\r\n\tccDOM.appendChild(this.getEncodingChooserDOM());\r\n\tscd.appendChild(ccDOM);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDocumentViewer.prototype.getDocumentJsonldCreateButton = function(){\r\n\tvar cr = document.createElement('button');\r\n\tcr.innerHTML = 'Save';\r\n\tcr.setAttribute('class', 'terminus-btn terminus-btn-float-right');\r\n\tvar self = this;\r\n\tcr.addEventListener('click', function(){\r\n\t\tif (!UTILS.checkForMandatoryId()) return;\r\n\t\tself.ui.showBusy();\r\n\t\tself.createDocument(self.renderer.idDOM.value, JSON.parse(self.json_editor.value))\r\n\t\t.then(function(page_config){\r\n\t\t\tif(page_config == 'home'){\r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n\t\t\t\tself.getListOfDocuments(self.pagedom);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tself.page_config = \"view\";\r\n\t\t\t\tself.mode = self.page_config;\r\n\t\t\t\tself.renderer = false;\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t})\r\n\treturn cr;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentJsonldSaveButton = function(){\r\n\tvar sv = document.createElement('button');\r\n\tsv.innerHTML = 'Save';\r\n\tsv.setAttribute('class', 'terminus-btn terminus-btn-float-right');\r\n\tvar self = this;\r\n\tsv.addEventListener('click', function(){\r\n\t\tself.ui.showBusy();\r\n\t\tself.updateDocument(JSON.parse(self.json_editor.value))\r\n\t\t.then(function(){\r\n\t\t\tself.page_config = \"view\";\r\n\t\t\tself.renderer = false;\r\n\t\t\tself.refreshPage();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t})\r\n\treturn sv;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.toggleControlActions = function(button){\r\n\tvar enc = document.getElementsByClassName('terminus-enc');\r\n\tif(button.innerHTML === 'Edit'){\r\n\t\tif(enc.length > 0) enc[0].style.display = 'none';\r\n\t\tbutton.innerHTML = 'Cancel';\r\n\t\tif(this.viewMode == 'frame'){\r\n\t\t\tthis.page_config = \"edit\";\r\n\t\t\tthis.renderer = false;\r\n\t\t\tthis.refreshPage();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\t\tvar label = this.document_json_response['@id']; // get doc id\r\n\t\t\tvar header = document.createElement('div');\r\n\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t\theader.appendChild(document.createTextNode('Edit ' + label + ' in jsonld format'));\r\n\t\t\theader.appendChild(this.getDocumentJsonldSaveButton());\r\n\t\t\tthis.pagedom.appendChild(header);\r\n\t\t\tvar res = document.createElement('textarea');\r\n\t\t\tthis.json_editor = res;\r\n\t\t\tthis.pagedom.appendChild(res);\r\n\t\t\tres.appendChild(document.createTextNode(JSON.stringify(this.document_json_response, undefined, 2)));\r\n\t\t\tres.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\tUTILS.stylizeEditor(this.ui, res, 'doc-json', 'javascript');\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tbutton.innerHTML = 'Edit';\r\n\t\tif(enc.length > 0) enc[0].style.display = 'block';\r\n\t\tif(this.viewMode == 'frame'){\r\n\t\t\tthis.page_config = \"view\";\r\n\t\t\tthis.renderer = false;\r\n\t\t\tthis.refreshPage();\r\n\t\t}\r\n\t\telse{ //jsonld\r\n\t\t\tthis.getJsonLdViewer();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getListOfDocuments = function(holder){\r\n\tvar lod = document.createElement('div');\r\n\tlod.setAttribute('class', 'terminus-list-of-doc');\r\n\tlod.appendChild(UTILS.getHeaderDom('List of Documents'))\r\n\tholder.appendChild(lod);\r\n\tthis.dbViewer.getClassesDOM(holder);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentEditControls = function(holder, doc){\r\n\tvar sp = document.createElement('span');\r\n\tsp.setAttribute('class', 'terminus-document-page-controls');\r\n\tholder.appendChild(sp);\r\n    sp.appendChild(this.getEncodingChooserDOM());\r\n\tvar dpc = document.createElement('button');\r\n\tdpc.setAttribute('class', 'terminus-btn terminus-document-config');\r\n\tdpc.innerHTML = 'Edit';\r\n\tsp.appendChild(dpc);\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"click\", function(){\r\n\t\tself.toggleControlActions(dpc);\r\n\t})\r\n }\r\n\r\nTerminusDocumentViewer.prototype.getDocumentSubMenus = function(feature, ul, holder, active){\r\n \tvar a = document.createElement('a');\r\n     a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n \tvar self = this;\r\n \tswitch(feature){\r\n \t\tcase 'get_document':\r\n \t\t\ta.appendChild(document.createTextNode('View Document'));\r\n \t\t\t// set selected nav after redrawMainPage and home page\r\n \t\t\tif(active) a.classList.add('terminus-submenu-selected');\r\n \t\t\tif((this.page_config == 'view') || (this.page_config == 'home')){ // hide in create mode\r\n \t\t\t\tvar sp = document.createElement('span');\r\n \t\t\t\tsp.setAttribute('class', 'terminus-display-flex');\r\n \t\t\t\tholder.appendChild(sp);\r\n \t\t\t\tthis.getDocumentChooserDOM(sp);\r\n \t\t\t\tthis.viewMode = 'frame';\r\n \t\t\t}\r\n \t\t\tif(this.page_config == 'view') this.getDocumentEditControls(sp);\r\n \t\t\ta.addEventListener('click', function(){\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(self.controldom);\r\n \t\t\t\tself.page_config = 'home';\r\n \t\t\t\tself.loadDocumentHome();\r\n \t\t\t});\r\n \t\tbreak;\r\n \t\tcase 'create_document':\r\n \t\t\ta.appendChild(document.createTextNode('Create Document'));\r\n \t\t    if(active) a.classList.add('terminus-submenu-selected');\r\n \t\t    holder.appendChild(self.getDocumentCreatorDOM());\r\n \t\t\ta.addEventListener('click', function(){\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(holder);\r\n \t\t\t\tUTILS.setSelectedSubMenu(this);\r\n \t\t\t\tholder.appendChild(self.getDocumentCreatorDOM());\r\n \t\t\t});\r\n \t\tbreak;\r\n \t\tdefault:\r\n \t\t\tconsole.log('Invalid features in TerminusDocument');\r\n \t\tbreak;\r\n \t} // switch(feature)\r\n \tul.appendChild(a);\r\n }\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentHome = function(){\r\n \tvar self = this;\r\n \tvar ul = document.createElement('ul');\r\n \tul.setAttribute('class','terminus-ul-horizontal');\r\n \tthis.controldom.appendChild(ul);\r\n \tvar holder = document.createElement('div');\r\n \tholder.setAttribute('class', 'terminus-doc-holder');\r\n \tthis.controldom.appendChild(holder);\r\n \tvar controls = document.createElement('span');\r\n \tcontrols.setAttribute('class', 'terminus-display-flex');\r\n \tholder.appendChild(controls);\r\n \tswitch(this.page_config){\r\n \t\tcase 'view':\r\n \t\t\tif(this.ui.showControl(\"get_document\"))\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, true);\r\n \t\t\tcontrols.appendChild(this.getDocumentCreatorSelect());\r\n \t\tbreak;\r\n \t\tcase 'create':\r\n \t\t\tif(this.ui.showControl(\"create_document\")){\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, false);\r\n \t\t\t\tthis.getDocumentSubMenus('create_document', ul, holder, true);\r\n \t\t\t}\r\n \t\tbreak;\r\n \t\tcase 'home':\r\n \t\t\tif(this.ui.showControl(\"get_document\"))\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, true);\r\n \t\t    var sd = document.createElement('div');\r\n \t\t\tsd.setAttribute('class', 'terminus-class-chooser-align');\r\n \t\t\tcontrols.appendChild(sd);\r\n \t\t\tsd.appendChild(this.getDocumentCreatorSelect());\r\n \t\t\tthis.getListOfDocuments(holder);\r\n \t\tbreak;\r\n \t\tcase 'default':\r\n \t\t\tconsole.log('Invalid page config passed in TerminusDocument.js');\r\n \t\tbreak;\r\n \t}\r\n }\r\n\r\nTerminusDocumentViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-document-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-document-viewer\");\r\n\tthis.loadDocumentHome();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getInstanceMeta = function(elid){\r\n\tvar self = this;\r\n\tif(self.instancemeta && typeof self.instancemeta[elid] != \"undefined\") return self.instancemeta[elid] ;\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getInstanceMeta(elid);\r\n\treturn wq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tvar res = wresult.bindings[0];\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn false;\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getClassMeta = function(cls){\r\n\tif(typeof this.classmeta[cls]){\r\n\t\treturn this.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadCreateDocument = function(url){\r\n\tif(url){\r\n\t\tthis.ui.showBusy(\"Fetching frame for document class \" + url);\r\n\t\tvar self = this;\r\n\t\tthis.mode = \"edit\";\r\n\t\tthis.page_config = \"create\";\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1) {\r\n\t\t\turl = \"schema:\" + url;\r\n\t\t}\r\n\t\treturn this.loadDocumentSchema(url)\r\n\t\t.then(function(response){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.setLabel();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\tthis.page_config = \"view\";\r\n\turl = url.replace(\"/candidate\", \"/platform/document\");\r\n\tthis.ui.showBusy(\"Loading Document from \" + url);\r\n\treturn this.ui.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.loadDataFrames(response);\r\n\t\tself.setLabel();\r\n\t\tself.refreshPage();\r\n\t\tif(self.load_schema){\r\n\t\t\tself.loadDocumentSchema(self.document.cls).then(function(){ self.refreshPage()}).catch(function(e){console.error(e)});\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error) {\r\n\t\tconsole.error(error);\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.ui.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\tself.loadSchemaFrames(response, cls);\r\n\t\tself.refreshPage();\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.deleteDocument = function(URL){\r\n\tthis.document = false;\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Deleting Document \" + URL);\r\n\treturn this.ui.client.deleteDocument(URL)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.createDocument = function(id, extr){\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Creating document\");\r\n\treturn this.ui.client.createDocument(id, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(id);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t\tself.page_config = 'home';\r\n\t\treturn self.page_config;\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.updateDocument = function(extr){\r\n\tvar durl = this.document.subjid;\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Updating document \" + durl);\r\n\treturn this.ui.client.updateDocument(durl, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(durl);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.page_config){\r\n\t\t\tthis.options = this.getOptionsFromPageConfig(this.page_config);\r\n\t\t}\r\n\t\ttry{\r\n\t\t\tthis.renderer = new Renderers.ObjectRenderer(this.document, false, this.options);\r\n\t\t\tthis.renderer.mode = this.mode;\r\n\t\t\tthis.renderer.controller = this;\r\n\t\t}catch(e){\r\n\t \t\tconsole.error('TerminusDocumentViewer render',e.toString())\r\n\t \t}\r\n\t}\r\n\tif(this.renderer){\r\n\t\treturn this.renderer.render();\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getBuiltInViewerOptions = function(){\r\n\treturn FrameConfig;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getOptionsFromPageConfig = function(pageconf){\r\n\tif(typeof this.config_options[pageconf] == \"object\") {\r\n\t\treturn this.config_options[pageconf];\r\n\t}\r\n\treturn this.options;\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.getClient = function(){\r\n\treturn this.ui.client;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.extract = function(options){\r\n\treturn this.renderer.extract();\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getLabel = function(){\r\n\tvar lab = (this.cls ? this.cls : false);\r\n\tif(!lab) lab = (this.docid ? this.docid : \"Void\");\r\n\treturn lab;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.setLabel = function(){\r\n\tif(this.document && this.labdom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.labdom);\r\n\t\tvar dfs = this.document.getDataFrames(TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\"));\r\n\t\tfor(var i = 0; i< dfs.length; i++){\r\n\t\t\tvar lab = dfs[i].get();\r\n\t\t\tif(lab) {\r\n\t\t\t\tthis.labdom.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.refreshPage = function(){\r\n\tif(this.pagedom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\tvar rends = this.render();\r\n\t\tif(rends){\r\n\t\t\tthis.pagedom.appendChild(rends);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentPageControls = function(){\r\n\tvar dpc = document.createElement(\"select\");\r\n\tdpc.setAttribute(\"class\", \"terminus-form-select terminus-document-config\");\r\n\tfor(var i in this.config_options){\r\n\t\tif(i === 'create') continue; // create docuemnt option from config is not taken in edit mode\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = i;\r\n\t\tif(this.page_config == i){\r\n\t\t\topt.selected = true;\r\n\t\t}\r\n\t\topt.appendChild(document.createTextNode(this.config_options[i].label));\r\n\t\tdpc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"change\", function(){\r\n\t\tself.page_config = this.value;\r\n\t\tself.renderer = false;\r\n\t\tself.refreshPage();\r\n\t})\r\n\treturn dpc;\r\n}\r\n\r\nmodule.exports=TerminusDocumentViewer\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst HTMLFrameHelper = require('../client/HTMLFrameHelper');\r\nconst UTILS= require('../Utils')\r\n\r\n/*** client side processing ***/\r\nfunction CspDatatables(ui){\r\n    this.ui = ui;\r\n}\r\n\r\nCspDatatables.prototype.convertToDatatable = function(tab){\r\n    var dt = this;\r\n    var table = jQuery(tab).DataTable({\r\n         searching : false,\r\n         pageLength: 25,\r\n         lengthMenu: [10, 25, 50, 75, 100],\r\n         paging    : true,\r\n         select    : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\r\n         createdRow: function(row) {\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());}\r\n    }); //jQuery(tab)\r\n\r\n    // on click of row connect to db, on click of 5th column delete db\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).index().column == 5){\r\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\r\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\r\n            dt.ui.deleteDatabase(dbId);\r\n            return;\r\n        }\r\n        else dt.ui.showDBMainPage();\r\n     }); // on click\r\n\r\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '0');\r\n    tab.setAttribute('border'     , '0');\r\n    return tab;\r\n}\r\n\r\nCspDatatables.prototype.draw = function(dtResult){\r\n    return(this.convertToDatatable(dtResult));\r\n}\r\n\r\n/*** server side processing ***/\r\nfunction Datatables(wResViewer, qPage){\r\n   this.wrViewer = wResViewer;\r\n   this.wQuery = wResViewer.wQuery;\r\n   this.ui = wResViewer.ui;\r\n   this.qPage = qPage;\r\n}\r\n\r\n/*\r\n    query: new woqlquery with current pagination changes\r\n    pageInfo: current drawCallBack page change info\r\n    resultDOM: result dom on veiwer page\r\n*/\r\nDatatables.prototype.executeQuery = function(query, pageInfo, resultDOM){\r\n    var self = this;\r\n    return this.wQuery.execute(query)\r\n      .then(function(result){\r\n          var dtResult = {};\r\n          dtResult = self.wrViewer.formatResultsForDatatableDisplay(result.bindings, pageInfo)\r\n          return dtResult.data;\r\n      })\r\n      .catch(function(err){\r\n          console.error(err);\r\n          self.ui.showError(err);\r\n      });\r\n}\r\n\r\n/* get query string based on datatable pagination and current query */\r\nDatatables.prototype.getQueryOnPagination = function(wq, settings){\r\n    switch(settings.query){\r\n        case 'Show_All_Documents':\r\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Data':\r\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Schema_Elements':\r\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Classes':\r\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\r\n            return wq.getClassMetaDataQuery(sqp);\r\n        break;\r\n        case 'Show_All_Properties':\r\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Classes':\r\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Data_Class':\r\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Property_Class':\r\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Info_by_Id':\r\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Document_classes':\r\n            return wq.getClassesQuery(settings.pageLength, settings.start);\r\n        break;\r\n        default:\r\n            console.log('Invalid woql option passed');\r\n        break;\r\n\r\n    }\r\n}\r\n\r\n/*\r\n    pageInfo: current drawCallBack page change info\r\n*/\r\nDatatables.prototype.generateNewQueryOnPageChange = function(pageInfo){\r\n    if(this.qPage) UTILS.deleteStylizedEditor(this.ui, pageInfo.qTextDom);\r\n    var query = this.getQueryOnPagination(this.wQuery, pageInfo)\r\n    if(this.qPage) {\r\n        pageInfo.qTextDom.value = JSON.stringify(query,undefined, 2);\r\n        UTILS.stylizeEditor(this.ui, pageInfo.qTextDom, 'query', 'javascript');\r\n    }\r\n    return query;\r\n}\r\n\r\n/*\r\n    dt: Datatable reference\r\n    len : current number of records to display\r\n*/\r\nDatatables.prototype.getCallbackSettings = function(dt, dtAPIChangeSettings){\r\n    var pageInfo = {};\r\n    pageInfo.pageLength  = dtAPIChangeSettings._iDisplayLength;\r\n    pageInfo.start       = dtAPIChangeSettings._iDisplayStart;\r\n    pageInfo.draw        = dtAPIChangeSettings.iDraw;\r\n    pageInfo.qTextDom    = dt.qTextDom;\r\n    if(this.qPage) pageInfo.query = dt.query;\r\n    else pageInfo.query = 'Show_All_Document_classes';\r\n    pageInfo.chosenValue = dt.chosenValue;\r\n    return pageInfo;\r\n}\r\n\r\n/*\r\n    tab: datatable table dom\r\n    settings : settings from woql txt generator\r\n    resultDOM: result dom of viewer\r\n*/\r\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\r\n    // delete previous datatable\r\n    TerminusClient.FrameHelper.removeChildren(this.dtdom);\r\n    this.dtdom = document.createElement('div');\r\n    this.dtdom.appendChild(tab);\r\n    resultDOM.appendChild(this.dtdom);\r\n    // saving query text box dom to change limit value on change of datatable page length\r\n    this.qTextDom = settings.qTextDom;\r\n    this.query = settings.query;\r\n    this.chosenValue = settings.chosenValue;\r\n}\r\n\r\nDatatables.prototype.getNewDataOnChange = function(drawnTab, aSettings, resultDOM){\r\n    var pageInfo = this.getCallbackSettings(this, aSettings);\r\n    var query = this.generateNewQueryOnPageChange(pageInfo);\r\n    return this.executeQuery(query, pageInfo, resultDOM);\r\n    //return  dtResult.result.data;\r\n}\r\n\r\nDatatables.prototype.getDataFromServer = function(dtResult, resultDOM){\r\n    var dt = this;\r\n    var tab = dtResult.tab;\r\n    this.setUp(tab, this.wrViewer.settings, resultDOM);\r\n    // initialize datatables\r\n    var table = jQuery(tab).DataTable({\r\n         searching   : false,\r\n         pageLength  : dt.wrViewer.settings.pageLength,\r\n         serverSide  : true,\r\n         processing  : true,\r\n         lengthMenu  : [25, 50, 75, 100],\r\n         dom         : 'RBlftip',\r\n         columns     : dtResult.result.columns,\r\n         paging      : true,\r\n         select      : true,\r\n         autoWidth   : true,\r\n         ajax        : function (data, callback, settings) {\r\n                            if(Object.entries(dtResult.result.data).length > 0){\r\n                                // first draw is loaded\r\n                                var res = dtResult.result.data;\r\n                                dtResult.result.data = {};\r\n                                callback(res);\r\n                            }\r\n                            else{\r\n                                dt.getNewDataOnChange(this, settings, resultDOM)\r\n                                    .then(function(result){\r\n                                     callback(result);\r\n                                })\r\n                            }\r\n                       },\r\n         buttons     : [{ extend: 'copy', text: 'Copy to clipboard' },\r\n                        { extend: 'excel', text: 'Export to Excel' }],\r\n         columnDefs  : [{ targets:'_all',\r\n                          className:\"truncate\"}],\r\n         createdRow  : function(row){\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());},\r\n         scrollX     : true\r\n    }); //jQuery(tab)\r\n\r\n    // on click of doc\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).data){\r\n            if(this.innerText.substring(0, 4) == \"doc:\"){\r\n                if(dt.wrViewer.result.ui) {\r\n        \t\t\tdt.wrViewer.result.ui.showDocument(this.innerText);\r\n        \t\t\tdt.wrViewer.result.ui.redraw();\r\n        \t\t\tdt.wrViewer.selectDocumentNavBar(dt.ui);\r\n        \t\t}\r\n            }\r\n        }\r\n     }); // on click\r\n\r\n    //styling\r\n    tab.setAttribute('class'      , 'stripe dataTable');\r\n    tab.setAttribute('style'      , 'margin: 0!important');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '1');\r\n    tab.setAttribute('border'     , '0');\r\n\r\n    return tab;\r\n}\r\n\r\n/*\r\nserverside: true or false\r\n*/\r\nDatatables.prototype.draw = function(dtResult, resultDOM){\r\n    return(this.getDataFromServer(dtResult, resultDOM));\r\n}\r\n\r\nmodule.exports={Datatables, CspDatatables}\r\n","function HTMLStringViewer(options){\r\n\tthis.size = ((options && options.size) ? options.size : false);\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n}\r\n\r\nHTMLStringViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = document.createTextNode(value);\r\n\tinput.appendChild(value);\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLStringViewer}\r\n\r\n\r\n","function HTMLDateHelper(){\r\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n}\r\n\r\nHTMLDateHelper.prototype.getMonthName = function(num){\r\n\treturn this.months[num-1];\r\n}\r\n\r\nmodule.exports={HTMLDateHelper}","\r\nfunction GoogleMapHelper(options){\r\n\tthis.polygon = false;\r\n\tthis.polyline = false;\r\n\tthis.markers = [];\r\n\tthis.init(options);\r\n}\r\n\r\nGoogleMapHelper.prototype.init = function(config){\r\n\tthis.type = ((config && config.type) ? config.type: 'Shape'); \r\n\tthis.width = ((config && config.width) ? config.width : '400px'); \r\n\tthis.height = ((config && config.height ) ? config.height : '400px'); \r\n\tthis.mapLat = ((config && config.mapLat) ? config.mapLat : '41.9010004'); \r\n\tthis.mapLong = ((config && config.mapLong ) ? config.mapLong : '12.500061500000015');\r\n\tthis.zoom = ((config && config.zoom) ? config.zoom : 3);\r\n\tthis.stroke = ((config && config.stroke) ? config.stroke : { color: '#FF0000', opacity: 0.3, weight: 3});\r\n\tthis.fill = ((config && config.fill) ? config.fill : { color: '#FF0000', opacity: 0.1});\r\n\tthis.line = ((config && config.line) ? config.line : { color: '#000000', opacity: 0.9, weight: 3});\r\n}\r\n\r\nGoogleMapHelper.prototype.destroy = function(){\r\n    this.clear();\r\n} \r\n\r\nGoogleMapHelper.prototype.translatePolygonToArray = function(polygon){\r\n   var data = \"[\";\r\n   var vertices = polygon.getPath();\r\n   var seenValue = false;\r\n   for (var j=0; j<vertices.getLength(); j++){\r\n       if(seenValue){\r\n           data = data + \",\";\r\n       }\r\n       var xy = vertices.getAt(j);\r\n       data = data + \"[\" + xy.lat() + \",\" + xy.lng() + \"]\"\r\n       seenValue = true;\r\n   }\r\n   data = data + \"]\";\r\n   return data;\r\n};\r\n\r\nGoogleMapHelper.prototype.translateArrayToPolygon = function(array){\r\n   var jsonified = JSON.parse(array);\r\n   var output = [];\r\n   for(var i=0;i<jsonified.length;i++){\r\n       var latlong = {}\r\n       latlong.lat = jsonified[i][0];\r\n       latlong.lng = jsonified[i][1];\r\n       output.push(latlong);\r\n   }\r\n   return output;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolygon = function(coords, map) {\r\n\tvar polygon = new google.maps.Polygon({\r\n        paths: coords,\r\n        strokeColor: this.stroke.color,\r\n        strokeOpacity: this.stroke.opacity,\r\n        strokeWeight: this.stroke.weight,\r\n        fillColor: this.fill.color,\r\n        fillOpacity: this.fill.opacity\r\n\t});\r\n    polygon.setMap(map);\r\n\treturn polygon;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolyline = function(coords){\r\n\tvar init = {\r\n\t      strokeColor: this.line.color,\r\n\t      strokeOpacity: this.line.opacity,\r\n\t      strokeWeight: this.line.weight\r\n\t};\r\n\tif(coords){\r\n\t\tinit.paths = coords;\r\n\t}\r\n\tvar poly = new google.maps.Polyline(init);\r\n\treturn poly;\r\n}\r\n\r\nGoogleMapHelper.prototype.clearMarkers = function() {\r\n\tfor (var i = 0; i < this.markers.length; i++ ) {\r\n\t\tthis.markers[i].setMap(null);\r\n\t}\r\n\tthis.markers.length = 0;\r\n}\r\n\r\n\r\nGoogleMapHelper.prototype.addMarker = function(position, map, renderer, title, ty) {\r\n\tvar init = {\r\n\t\tposition: position, \r\n\t\tmap: map\r\n\t}\r\n\tif(title){\r\n\t\tinit.title = title;\r\n\t}\r\n\tvar marker = new google.maps.Marker(init);\r\n\tvar self = this;\r\n\tif(this.markers.length == 0 && ty == \"xdd:coordinatePolygon\"){\r\n     \tmarker.addListener('click', function() {\r\n\t\t\tvar coords = self.getCoordsFromMarkers();\r\n    \t\tself.polygon = self.createPolygon(coords, map);\r\n            self.clearMarkers();\r\n            self.polyline.setMap(null);\r\n            renderer.set(self.translatePolygonToArray(self.polygon));\r\n        });                \t\r\n    }\r\n\tthis.markers.push(marker);\r\n\tif(ty == \"xdd:coordinatePolyline\"){\r\n\t\tvar x = this.translatePolygonToArray(this.polyline);\r\n\t\trenderer.set(x);\r\n\t}\r\n\treturn marker;\r\n}\r\n\r\nGoogleMapHelper.prototype.getCoordsFromMarkers = function(){\r\n\treturn this.polyline.getPath();\r\n}\r\n\r\nGoogleMapHelper.prototype.clear = function(){\r\n\tif(this.polygon) {\r\n\t\tthis.polygon.setMap(null);\r\n\t\tthis.polygon = false;\r\n\t}\r\n\tif(this.polyline) {\r\n\t\tthis.clearMarkers();\r\n\t\tthis.polyline.setMap(null);\r\n\t}\r\n}\r\n\r\nGoogleMapHelper.prototype.initMap = function(mapContainer, renderer, value, type){\r\n\tmapContainer.style.width = this.width;\r\n\tmapContainer.style.height = this.height;\r\n\tif(typeof google == \"undefined\"){\r\n\t\talert(\"google is not effing loaded\");\r\n\t\treturn false;\r\n\t}\r\n\tvar map = new google.maps.Map(mapContainer, {\r\n\t    zoom: this.zoom,\r\n\t\tcenter: {lat: parseFloat(this.mapLat), lng: parseFloat(this.mapLong)}  \r\n\t});\r\n\tif(type == \"xdd:coordinatePolygon\"){\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t\tif(value){\r\n\t    \tthis.polygon = this.createPolygon(coords, map);\r\n\t    }\r\n\t}\r\n\telse if(type == \"xdd:coordinatePolyline\"){\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\t\t\r\n\t\tif(value){\r\n\t    \tthis.polyline.setPath(coords);\r\n\t    }\r\n\t}\t\r\n\telse if(type == \"xdd:coordinate\"){\r\n\t\tif(value){\r\n\t\t\tthis.clearMarkers();\r\n            var lat = parseFloat(value.substring(1, value.indexOf(\",\")));\r\n\t\t\tvar long = parseFloat(value.substring(value.indexOf(\",\")+1, value.length-1));\r\n            var init = {\r\n            \tposition: {lat: lat, lng: long},\r\n        \t\tmap: map\r\n\t        }\r\n\t        var marker = new google.maps.Marker(init);\r\n\t        this.markers.push(marker);\r\n\t\t}\r\n\t}\r\n    google.maps.event.trigger(map, 'resize');\r\n    return map;\r\n}\r\n\r\nmodule.exports=GoogleMapHelper;","const HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n/**\r\n * Property Viewer\r\n */\r\nfunction HTMLPropertyViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.values = [];\r\n\tthis.headerViewer = renderer.getPropertyHeaderViewer();\r\n}\r\n\r\n\r\n/**\r\n * Draws the property as header and body components\r\n */\r\nHTMLPropertyViewer.prototype.render = function(){\r\n\t//var block = document.createElement('div');\r\n\t//block.setAttribute('style', 'display: flex; margin: 10px');\r\n\t//var br = document.createElement('br');\r\n\t//block.appendChild(br);\r\n\tif(this.propDOM){\r\n\t\tvar npropDOM = this.getPropertyDOM();\r\n\t\t//npropDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t\t\t//block.appendChild(npropDOM);\r\n\t\tthis.propDOM.replaceWith(npropDOM);\r\n\t\tthis.propDOM = npropDOM;\r\n\t\t//this.propDOM = block;\r\n\t}\r\n\telse {\r\n\t\t//block.appendChild(this.getPropertyDOM());\r\n\t\t//this.propDOM = block;\r\n\t\tthis.propDOM = this.getPropertyDOM();\r\n\t\t//this.propDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t}\r\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.propDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getPropertyBodyDOM();\r\n\tif(this.body) this.propDOM.appendChild(this.body);\r\n\treturn this.propDOM;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\r\n\tif(orientation == \"label\"){\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\t//terminus-property-frame-spacer\r\n\r\n\tsp.setAttribute(\"class\", \"terminus-property-frame terminus-zebra-frame terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\r\n\tsp.setAttribute('data-property', this.renderer.property());\r\n\treturn sp;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-values-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\r\n\tfor(var i =0; i<this.values.length; i++){\r\n\t\tvholder.appendChild(this.values[i]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\r\n\tthis.values.push(renderedval);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.propDOM);\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Removes the property from the dom\r\n */\r\nHTMLPropertyViewer.prototype.remove = function(){\r\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\r\n}\r\n\r\n/**\r\n * Redraws the property to reflect an updated state\r\n */\r\nHTMLPropertyViewer.prototype.redraw = function(){\r\n\tvar npropDOM = this.getPropertyDOM();\r\n\tthis.propDOM.replaceWith(npropDOM);\r\n\tthis.propDOM = npropDOM;\r\n\tthis.values = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getPropertyBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\r\n\treturn idm;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\r\n\tHTMLFrameHelper.goToName(subj, property, index);\r\n}\r\n\r\nfunction HTMLPropertyHeaderViewer(){}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\r\n\tvar wrapper = document.createElement(\"span\");\r\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar expModeMenu = this.getPropertyControlsDOM(wrapper, renderer);\r\n\t\tif(orientation == 'page') this.expModeMenu = expModeMenu;\r\n\t\telse this.expModeMenu = null;\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\r\n\t\tif(renderer.showFeature(\"status\")){\r\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\r\n\t\t}\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\telse if(renderer.showFeature(\"status\")){\r\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\tif(statDOM) wrapper.appendChild(statDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\r\n\tvar prelude = document.createElement(\"span\");\r\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\r\n\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\r\n\t\tif(facetDOM) prelude.appendChild(facetDOM);\r\n\t\t//if(facetDOM && this.expModeMenu) this.expModeMenu.appendChild(facetDOM);//\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\r\n\t\tif(viewDOM) prelude.appendChild(viewDOM);\r\n\t\t//if(viewDOM && this.expModeMenu) this.expModeMenu.appendChild(viewDOM); //prelude.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\r\n\t\tif(idDOM) prelude.appendChild(idDOM);\r\n\t\t//if(idDOM && this.expModeMenu) this.expModeMenu.appendChild(idDOM); //\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\r\n\t\tif(typeDOM)\tprelude.appendChild(typeDOM);\r\n\t\t/*if(typeDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(typeDOM);//\r\n\t\t\ttypeDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\r\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\r\n\t\tif(hideDOM) prelude.appendChild(hideDOM);\r\n\t\t//\tthis.expModeMenu.appendChild(hideDOM); \t\t\thideDOM.style.display = 'block';\r\n\r\n\t}\r\n\tif(renderer.showFeature(\"comment\")){\r\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\r\n\t\tif(sumDOM) prelude.appendChild(sumDOM);\r\n\t\t/*if(sumDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(sumDOM); //\r\n\t\t\tsumDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\twrapper.appendChild(prelude);\r\n\tobjDOM.appendChild(wrapper);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\r\n\tvar lab = renderer.getComment();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\r\n\tvar restriction = renderer.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\r\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\r\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\r\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\r\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\r\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\r\n\tvar settings = document.createElement(\"div\");\r\n\tcontrolsDOM.appendChild(settings);\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tif(false && orientation == 'page'){ // expert mode\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('property');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.getActionControlDOM(menu, renderer);\r\n\t    settings.appendChild(sControl);\r\n\t\treturn menu;\r\n\t}\r\n\telse this.getActionControlDOM(controlsDOM, renderer);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(wrapper, renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\r\n\t//controlsDOM.setAttribute(\"style\", \"display: table-cell;\");\r\n\t// get settings icon or button\r\n\tvar expModeMenu = this.getSettingsControlDOM(controlsDOM, renderer);\r\n\twrapper.appendChild(controlsDOM);\r\n\treturn expModeMenu;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\r\n\tif(renderer.isClassChoice()){\r\n\t\tvar cs = renderer.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.addClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){renderer.add(\"edit\")};\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableValues();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\r\n\t\tvar callback = function(val){\r\n\t\t\trenderer.goToValue(val);\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\r\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\r\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\r\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\r\n}\r\n\r\nfunction HTMLDataViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = renderer.getValueHeaderViewer();\r\n}\r\n\r\nmodule.exports={HTMLPropertyViewer,HTMLPropertyHeaderViewer}\r\n","/**\r\n * Draws the property as header and body components\r\n */\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst HTMLStringViewer = require('./viewers/String');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction HTMLDataViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = renderer.getValueHeaderViewer();\r\n}\r\n\r\nHTMLDataViewer.prototype.render = function(){\r\n\tif(this.valDOM){\r\n\t\tvar nvalDOM = this.getValueDOM();\r\n\t\tthis.valDOM.replaceWith(nvalDOM);\r\n\t\tthis.valDOM = nvalDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.valDOM = this.getValueDOM();\r\n\t}\r\n\tthis.valDOM.appendChild(this.getValueIDMarker(this.renderer));\r\n\tthis.body = this.getValueBodyDOM();\r\n\tif(this.body) this.valDOM.appendChild(this.body);\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.renderer.facet == 'page'){ //expert mode\r\n\t\t\tif(this.header && this.expModeMenu) {\r\n\t\t\t\tthis.expModeMenu.appendChild(this.header);\r\n\t\t\t\t//this.valDOM.appendChild(this.expModeMenu);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.header) this.valDOM.appendChild(this.header);\r\n\t}\r\n\treturn this.valDOM;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tsp.setAttribute(\"class\", \"terminus-property-value property-value-\" + this.renderer.currentFacet() + \" property-value-\" + this.renderer.mode);\r\n\tif(this.renderer.mode == \"view\"){\r\n\t\tsp.setAttribute('data-value', this.renderer.value());\r\n\t}\r\n\treturn sp;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueBodyDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', ' terminus-property-body property-value-body property-value-body-'+this.renderer.currentFacet() + ' terminus-property-body-align');\r\n\t//vholder.setAttribute('style', 'display: flex;');\r\n\tif(this.renderer.showFeature(\"body\")){\r\n        var valueViewer = this.renderer.getDataValueViewer();\r\n    \tvar vdom = valueViewer.getDOM(this.renderer, this);\r\n    }\r\n    else if(this.renderer.showFeature(\"summary\")){\r\n\t\tvar vdom = this.getSummaryDOM();\r\n    }\r\n    else {\r\n    \treturn false;\r\n    }\r\n    if(vdom) vholder.appendChild(vdom);\r\n\tif(false && this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('data');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property value'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n\t\t\ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.expModeMenu = menu;\r\n\t\tvholder.appendChild(sControl);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\n/**\r\n * Removes the value from the dom\r\n */\r\nHTMLDataViewer.prototype.remove = function(){\r\n\tthis.valDOM.parentNode.removeChild(this.valDOM);\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getValueBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLDataViewer.prototype.getValueIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-value-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop + \"_\" + renderer.index);\r\n\treturn idm;\r\n}\r\n\r\nHTMLDataViewer.prototype.getSummaryDOM = function(){\r\n\tvar sum = this.renderer.getSummary();\r\n\treturn HTMLTerminusClient.FrameHelper.getInfoboxDOM(\"value-summary\", false, sum.long, sum.long);\r\n}\r\n\r\nHTMLDataViewer.prototype.fireInternalLink = function(link){\r\n\tvar self = this;\r\n\tvar fire = function(e){\r\n\t\te.preventDefault();\r\n\t\tself.renderer.load(link);\t\t\r\n\t}\r\n\treturn fire;\r\n}\r\n\r\nHTMLDataViewer.prototype.internalLink = function(link, label){\r\n\tvar onclick = this.fireInternalLink(link);\r\n\tvar a = document.createElement(\"a\");\r\n\ta.onClick = onclick;\r\n\ta.href=link;\r\n\ta.addEventListener(\"click\", onclick);\r\n\tif(label){\r\n\t\ta.appendChild(document.createTextNode(label));\r\n\t}\r\n\telse {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(link);\r\n\t\tif(sh){\r\n\t\t\ta.setAttribute(\"title\", link);\r\n\t\t\ta.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ta.appendChild(document.createTextNode(link));\r\n\t\t}\r\n\t}\r\n\treturn a;\r\n}\r\n\r\nHTMLDataViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.valDOM);\r\n}\r\n\r\n\r\nfunction HTMLDataHeaderViewer(){}\r\n\r\nHTMLDataHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tif(renderer.currentFacet() == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-value-header terminus-value-header-\" + renderer.currentFacet());\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getValueFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getValueTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getValueStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getValueControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"value-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueTypeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"value-type\", \"Type\", renderer.type(), \"All data values have types, identified by a unique URL\");\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-value-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"value\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getValueDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getValueCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getValueResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getValueUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getValueShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getValueHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-value-update\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to save - no change\");\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"value\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"data-viewer\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction JSONObjectViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.properties = [];\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nJSONObjectViewer.prototype.render = function(){\r\n\talert(\"render json tbd\");\r\n}\r\nJSONObjectViewer.prototype.redraw = function(){\r\n\talert('redraw json tbd');\r\n}\r\n\r\nmodule.exports={HTMLDataViewer,HTMLDataHeaderViewer,JSONObjectViewer}\r\n","/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\nconst TerminusDocumentChooser = require('./TerminusDocumentChooser');\r\nconst WOQLQuery=require('../query/WOQLQuery');\r\nconst UTILS=require('../Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nfunction TerminusDBController(ui){\r\n\t this.ui = ui;\r\n}\r\n\r\n/*\r\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\r\n */\r\nTerminusDBController.prototype.getAsDOM = function(){\r\n\tvar self = this;\r\n\tvar dbc = document.createElement(\"div\");\r\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\r\n\tif(this.ui && this.ui.db()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\r\n\t\tvar lab = document.createElement(\"span\");\r\n\t\tlab.setAttribute(\"class\", \"terminus-label terminus-db-label terminus-control-panel-label\");\r\n\t\tlab.appendChild(document.createTextNode(\"DB \"));\r\n\t\tvar val = document.createElement(\"span\");\r\n\t\tval.setAttribute(\"class\", \"terminus-value terminus-db-value terminus-control-panel-value\");\r\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\r\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\tval.appendChild(document.createTextNode(nm));\r\n\t\tscd.appendChild(lab);\r\n\t\tscd.appendChild(val);\r\n\t\t//dbc.appendChild(scd);\r\n\t\tvar nav = document.createElement('div');\r\n\t\tnav.setAttribute('class', 'span3');\r\n\t\tdbc.appendChild(nav);\r\n\t\tvar ul = document.createElement('ul');\r\n\t\tul.setAttribute('class','terminus-ul' );\r\n\t\tnav.appendChild(ul);\r\n\t\t// connected to db\r\n\t\tvar a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Database: ' + nm;\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n\t\tif(this.ui.showControl(\"db\")){\r\n\t\t\tvar item = this.getControlHTML(\"Database Home\", \"fa-home\");\r\n\t\t\titem.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDBMainPage();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t    }\r\n\t\tif(this.ui.showControl(\"delete_database\")){\r\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.deleteDatabase();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_select\")){\r\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showQueryPage();\r\n\t\t\t});\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_update\")){\r\n\t\t\tvar item = this.getControlHTML(\"Mapping\", \"fa-file-import\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showMappingPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showSchemaPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif((this.ui.showControl(\"get_document\") || this.ui.showControl(\"create_document\"))){\r\n\t\t\tvar item = this.getControlHTML(\"Document\", \"fa-book\");\r\n\t\t\titem.classList.add('terminus-document-nav');\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDocumentPage();\r\n\t\t\t\t//UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n                //this.classList.add(\"terminus-selected\");\r\n\t\t\t\t//UTILS.displayDocumentSubMenus(self.ui);\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\t/*if(this.ui.showControl(\"get_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-get-doc');\r\n\t\t\ta.appendChild(self.getDocumentChooserDOM());\r\n\t\t\ta.classList.add();\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"create_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-create-doc');\r\n\t\t\ta.appendChild(self.getDocumentCreatorDOM());\r\n\t\t\tul.appendChild(a);\r\n\t\t} */\r\n\t}\r\n\treturn dbc;\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\r\n    var self = this;\r\n    var a = document.createElement('a');\r\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(text);\r\n    a.appendChild(txt);\r\n    return a;\r\n}\r\n\r\nTerminusDBController.prototype.getDocumentChooserDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-chooser terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"ID \"));\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"View\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showDocument(dcip.value);\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDBController.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"Type \"));\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"Create\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\r\n\tvar gb = document.createElement('div');\r\n\tgb.setAttribute('class', 'terminus-doc-btn-group');\r\n\tvar bi = document.createElement('button');\r\n\tbi.setAttribute('class', 'terminus-doc-btn-selected terminus-doc-toggle-btn');\r\n\tbi.appendChild((document.createTextNode('D')));\r\n\tvar tds = document.createElement('span');\r\n\ttds.setAttribute('class', 'terminus-tooltiptext');\r\n\ttds.appendChild(document.createTextNode('Dropdown List'));\r\n\tbi.appendChild(tds);\r\n\tvar bt = document.createElement('button');\r\n\tbt.setAttribute('class', 'terminus-doc-toggle-btn');\r\n\tbt.appendChild((document.createTextNode('T')));\r\n\tvar tts = document.createElement('span');\r\n\ttts.setAttribute('class', 'terminus-tooltiptext');\r\n\ttts.appendChild(document.createTextNode('Text Input'));\r\n\tbt.appendChild(tts);\r\n\tgb.appendChild(bt);\r\n\tgb.appendChild(bi);\r\n\tvar nlabs = document.createElement(\"div\");\r\n\tnlabs.setAttribute('class', 'terminus-doc-btn-gp-align');\r\n\tnlabs.appendChild(gb);\r\n\tscd.appendChild(nlabs);\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tnlabs.appendChild(ccDOM);\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(tcdom);\r\n\tvar which = \"select\";\r\n\tbt.addEventListener(\"click\", function(){\r\n\t\t// create document of TerminusClient.FrameHelper.removeChildren(nlabs);\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(dcip);\r\n\t\tccDOM.appendChild(nbut);\r\n\t});\r\n\r\n\tbi.addEventListener(\"click\", function(){\r\n\t\t// create document from dropdown\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(tcdom);\r\n\t});\r\n\treturn scd;\r\n};\r\n\r\nfunction TerminusDBViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, ui);\r\n}\r\n\r\nTerminusDBViewer.prototype.getAsDOM = function(selected){\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-db-home-page\");\r\n\tvar sth = document.createElement('div');\r\n\tvar banner = document.createElement('div');\r\n\t//pd.appendChild(banner);\r\n\tbanner.setAttribute('class', 'terminus-banner');\r\n\tvar dhp = document.createElement(\"span\");\r\n\tdhp.setAttribute('class', 'terminus-home-heading');\r\n\tdhp.appendChild(document.createTextNode(\"DB Home Page - \"));\r\n\tsth.appendChild(dhp);\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-details\");\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-db-details-value \");\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec){\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\r\n\t\tscs.appendChild(document.createTextNode(nm));\r\n\t\tscs.setAttribute('class', 'terminus-home-heading');\r\n\t}\r\n\tscd.appendChild(scs);\r\n\tsth.appendChild(scd);\r\n\tbanner.appendChild(sth);\r\n\t//pd.appendChild(sth);\r\n\t//pd.appendChild(UTILS.getHeaderDom('Summary'));\r\n\tthis.getDeleteOnHomePage(pd);\r\n\t//this.getDBSummary(pd);\r\n\tvar lod = document.createElement('div');\r\n\tlod.setAttribute('class', 'terminus-list-of-doc');\r\n\tlod.appendChild(UTILS.getHeaderDom('List of Documents'))\r\n\tpd.appendChild(lod);\r\n\tthis.getClassesDOM(pd);\r\n\treturn pd;\r\n}\r\n\r\nTerminusDBViewer.prototype.getDbInfoBox = function(r, module){\r\n\tvar sp = document.createElement('span');\r\n    sp.setAttribute('class', 'terminus-db-info-box');\r\n\tvar info = document.createElement('div');\r\n\tinfo.appendChild(document.createTextNode(module.charAt(0).toUpperCase() + module.slice(1)));\r\n\tinfo.setAttribute('class', 'terminus-db-info');\r\n\tsp.appendChild(info);\r\n\r\n    var i = document.createElement('i');\r\n\tswitch(module){\r\n\t\tcase 'size':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-balance-scale');\r\n\t\t    var txt = document.createTextNode('2 Gb');\r\n\t\tbreak;\r\n\t\tcase 'created':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-calendar');\r\n\t\t    var txt = document.createTextNode('16 July 2015');\r\n\t\tbreak;\r\n\t\tcase 'modified':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-clock');\r\n\t\t    var txt = document.createTextNode('22 Dec 2019');\r\n\t\tbreak;\r\n\t}\r\n    sp.appendChild(i);\r\n\tif(txt) sp.appendChild(txt);\r\n    r.appendChild(sp);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDeleteOnHomePage = function(d){\r\n\t// delete database\r\n\tif(this.ui.db() == \"terminus\") return;\r\n    var del = document.createElement('button');\r\n    del.setAttribute('class', 'terminus-btn terminus-btn-float-right terminus-home-del');\r\n    del.setAttribute('type', 'button');\r\n    del.innerHTML = 'Delete Database';\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec)\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n    var self = this;\r\n    var dbdel = this.ui.db();\r\n\r\n    del.addEventListener(\"click\", function(){\r\n      \tvar deleteConfirm = confirm(`Do you want to delete ${dbdel} Database?`);\r\n\t\tif (deleteConfirm == true) {\r\n\t\t\tself.ui.deleteDatabase(dbdel);\r\n\t\t}\r\n    });\r\n    d.appendChild(del);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDBSummary = function(d){\r\n    var r = document.createElement('span');\r\n    r.setAttribute('class', 'terminus-db-info-box-display');\r\n    d.appendChild(r);\r\n\r\n    /* getDbInfoBox() calls can change according to further requirments */\r\n    this.getDbInfoBox(r, 'size');\r\n    this.getDbInfoBox(r, 'created');\r\n    this.getDbInfoBox(r, 'modified');\r\n}\r\n\r\nTerminusDBViewer.prototype.getClassesDOM = function(d){\r\n\tvar q = this.wquery.getClassesQuery(25, 0);\r\n\tvar self = this;\r\n\tthis.wquery.execute(q)\r\n\t.then(function(result){\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, self.wquery, {}, {}, false);\r\n\t\tif(self.result){\r\n\t\t\tvar nd = self.result.getAsDOM(d, false);\r\n\t\t\tif(nd){\r\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\r\n\t        }\r\n\t\t\telse{\r\n\t\t\t\tnor = document.createElement('div');\r\n\t\t\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\t\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\t\t\td.appendChild(nor);\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tconsole.error(err);\r\n\t\tself.ui.showError(err);\r\n\t});\r\n\treturn d;\r\n}\r\n\r\n\r\nfunction TerminusDBCreator(ui){\r\n\tthis.ui = ui;\r\n}\r\n\r\nTerminusDBCreator.prototype.getAsDOM = function(selected){\r\n\tvar scd = document.createElement(\"div\");\r\n\t/* test delete when over var txtHolder = document.createElement(\"div\");\r\n\ttxtHolder.appendChild(document.createTextNode('expecting laoder herer'));\r\n\tscd.appendChild(txtHolder);\r\n\tthis.ui.getLoader(scd);*/\r\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\r\n\tvar sct = document.createElement(\"h3\");\r\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\r\n\tsct.appendChild(document.createTextNode(\"Create New Database\"));\r\n\tscd.appendChild(sct);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"ID\"));\r\n\tsci.appendChild(slab);\r\n\tvar idip = document.createElement(\"input\");\r\n\tidip.setAttribute(\"type\", \"text\");\r\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\r\n\tsci.appendChild(idip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Title\"));\r\n\tvar titip = document.createElement(\"input\");\r\n\ttitip.setAttribute(\"type\", \"text\");\r\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\r\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tsci.appendChild(slab);\r\n\tsci.appendChild(titip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Description\"));\r\n\tsci.appendChild(slab);\r\n\tvar descip = document.createElement(\"textarea\");\r\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\r\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\r\n\tsci.appendChild(descip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\r\n\tsci.appendChild(slab);\r\n\tvar schem = document.createElement(\"input\");\r\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tschem.setAttribute(\"type\", \"text\");\r\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(schem);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Key\"));\r\n\tsci.appendChild(slab);\r\n\tvar kip = document.createElement(\"input\");\r\n\tkip.setAttribute(\"placeholder\", \"Server API Key\");\r\n\tkip.setAttribute(\"type\", \"text\");\r\n\tkip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(kip);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\r\n\tsci.appendChild(slab);\r\n\tvar datip = document.createElement(\"input\");\r\n\tdatip.setAttribute(\"type\", \"text\");\r\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(datip);\r\n\t//mfd.appendChild(sci);\r\n\tvar butfield = document.createElement(\"div\");\r\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar cancbut = document.createElement(\"button\");\r\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn\");\r\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\r\n\tvar self = this;\r\n\tvar gatherips = function(){\r\n\t\tvar input = {};\r\n\t\tinput.id = idip.value;\r\n\t\tinput.title = titip.value;\r\n\t\tinput.description = descip.value;\r\n\t\tinput.schema = schem.value;\r\n\t\tinput.key = kip.value;\r\n\t\tinput.data = datip.value;\r\n\t\treturn input;\r\n\t}\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tvar input = gatherips();\r\n\t\tself.ui.createDatabase(input);\r\n\t})\r\n\tcancbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.showServerMainPage();\r\n\t})\r\n\tbutfield.appendChild(cancbut);\r\n\tbutfield.appendChild(loadbut);\r\n\tmfd.appendChild(butfield);\r\n\r\n\treturn scd;\r\n}\r\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\r\n\t            TerminusDBController:TerminusDBController,\r\n\t            TerminusDBCreator:TerminusDBCreator}\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\n/*\r\n * Utility class which allows the user to choose a document by id or by label (if select2 and full text indexing is turned on)\r\n */\r\n\r\nTerminusDocumentChooser = function(ui, root, value, view){\r\n\tthis.ui = ui;\r\n\tthis.root = root;\r\n\tthis.choice = value;\r\n\tthis.view = (view ? view : \"id\");\r\n\tthis.show_button = true;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.change = function(docid){\r\n\talert(\"Need to specify doc chooser function (\" + docid + \")\");\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getAsDOM = function(style){\r\n\tif(this.view == \"label\" && \tthis.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\treturn this.getS2DOM(style);\r\n\t}\r\n\treturn this.getIDDOM();\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getS2DOM = function(style){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar cfilter = wq.getSubclassQueryPattern(\"v:Class\", \"'\"+this.root+\"'\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, cfilter);\r\n\ttermcc.empty_choice = \"Filter by Type\";\r\n\ttermcc.show_single = false;\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.filter = new_class;\r\n\t\t}\r\n\t}\r\n\ttdom = termcc.getAsDOM(style);\r\n\tif(tdom) docchooser.appendChild(tdom);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-entity-reference-value\");\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-entity-class-input\");\r\n\tholder.appendChild(sel);\r\n\tvar opt = document.createElement(\"option\");\r\n\tvar lookup = function (params) {\r\n\t\tparams.class = self.filter;\r\n\t\treturn JSON.stringify(params);\r\n    }\r\n\tvar searchurl = this.ui.client.dbURL() + \"/search\";\r\n\tvar s2config = {\r\n\t\tajax: {\r\n\t\t    url: searchurl,\r\n\t\t    dataType: 'json',\r\n\t\t    data: lookup,\r\n\t\t    type: \"POST\",\r\n\t\t\tcontentType: \"application/json; charset=utf-8\",\r\n\t\t    delay: 250,\r\n\t\t    cache: true\r\n\t\t},\r\n\t\tplaceholder: \"Enter Document Name\",\r\n\t\twidth: 200\r\n\t};\r\n\tjQuery(sel).select2(s2config).change(function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\tdocchooser.appendChild(holder);\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getIDDOM = function(){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-document-chooser terminus-query-text\");\r\n\t//11092019 dcip.setAttribute(\"class\", \"terminus-form-value terminus-document-chooser\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tdcip.addEventListener('keypress', function(e){\r\n\t\tvar key = e.which || e.keyCode;\r\n\t\t// on enter\r\n\t\tif (key === 13 && dcip.value) {\r\n\t\t\tself.choice = dcip.value;\r\n\t\t\tself.change(dcip.value);\r\n\t\t}\r\n\t});\r\n\tdocchooser.appendChild(dcip);\r\n\tif(this.show_button){\r\n\t\tvar dbut = document.createElement(\"button\");\r\n\t\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\");\r\n\t\tvar self = this;\r\n\t\tdbut.addEventListener(\"click\", function(){\r\n\t\t\tif(dcip.value) {\r\n\t\t\t\tself.choice = dcip.value;\r\n\t\t\t\tself.change(dcip.value);\r\n\t\t\t}\r\n\t\t});\r\n\t\t//11092019 dbut.appendChild(document.createTextNode(\"View Document Properties\"));\r\n\t\tdbut.appendChild(document.createTextNode(\"Go\"));\r\n\t\tdocchooser.appendChild(dbut);\r\n\t}\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.toggleView = function(){\r\n\tif(this.view == \"id\") this.view = \"label\";\r\n\telse this.view = \"id\";\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getChangeViewText = function(){\r\n\tif(this.view == \"id\"){\r\n\t\treturn \"Document Lookup\";\r\n\t}\r\n\treturn \"Load Document ID\";\r\n}\r\n\r\nmodule.exports=TerminusDocumentChooser\r\n","const TerminusUI = require('./TerminusUI');\r\nconst RenderingMap = require('./client/RenderingMap');\r\nmodule.exports={TerminusUI:TerminusUI,\r\n                RenderingMap:RenderingMap}","/**\r\n * Terminus UI object\r\n *\r\n * Traffic control of messages going between different Terminus UI pages and features\r\n *\r\n * @param opts - options array\r\n */\r\nconst ApiExplorer = require('./ApiExplorer');\r\nconst TerminusDocumentViewer = require('./client/TerminusDocument');\r\nconst TerminusDBsdk = require('./client/TerminusDB');\r\nconst TerminusViolations = require('./client/TerminusViolation');\r\nconst TerminusQueryViewer = require('./client/TerminusQuery');\r\nconst TerminusMappingViewer = require('./client/TerminusMapping');\r\nconst TerminusSchemaViewer = require('./client/TerminusSchema');\r\nconst TerminusServersdk = require('./client/TerminusServer');\r\nconst TerminusURLLoader = require('./client/TerminusURL');\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS=require('./Utils');\r\nconst RenderingMap = require('./client/RenderingMap');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusUI(opts){\r\n\tthis.client = new TerminusClient.WOQLClient();\r\n\tthis.controls = [];\r\n\tthis.setOptions(opts);\r\n}\r\n\r\n/*\r\n * Client connects to specified server and specified part\r\n * opts is a json with the following fields:\r\n * server: mandatory URL of the server to connect to\r\n * key: optional client API key\r\n * dbid: id of the database to connect to\r\n * schema: if set, the UI will load the schema page after connecting\r\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\r\n * document: if set, the document page corresponding to this document will be loaded after connecting\r\n *\r\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\r\n */\r\nTerminusUI.prototype.connect = function(opts){\r\n\tvar self = this;\r\n\tthis.client.connectionConfig.server = false;\r\n\tvar key = ((opts && opts.key) ? opts.key : false);\r\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\r\n\treturn this.client.connect(opts.server, key)\r\n\t.then( function(response) {\r\n\t\tself.clearBusy();\r\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\r\n\t\t\tself.connectToDB(opts.db);\r\n\t\t\tif(opts.document && self.showView(\"get_document\")){\r\n\t\t\t\tresponse = self.showDocument(opts.document);\r\n\t\t\t}\r\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\r\n\t\t\t\tresponse = self.showSchemaPage(opts.schema);\r\n\t\t\t}\r\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\r\n\t\t\t\tself.showQueryPage(opts.query);\r\n\t\t\t}\r\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\r\n\t\t\t\tself.showExplorer(opts.explorer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showServerMainPage();\r\n\t\t}\r\n\t\tself.redraw();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(err) {\r\n\t\tself.clearBusy();\r\n\t\tself.showError(err);\r\n\t\tthrow(err);\r\n\t});\r\n}\r\n\r\n/**\r\n * Sends a request to create a new database to the server and interprets the response\r\n *\r\n * dbdets is a json object with the following fields:\r\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\r\n * title: the text name of the new database for tables, etc. mandatory\r\n * description: text description of the database (optional)\r\n * key: a API client key for server auth\r\n * schema: the url of another Terminus DB from which to import schema\r\n * instance: the url of another Terminus DB from which to import data\r\n *\r\n */\r\nTerminusUI.prototype.createDatabase = function(dbdets){\r\n\tvar self = this;\r\n\tif(!dbdets.id || !dbdets.title){\r\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\r\n\t}\r\n\tvar dbid = dbdets.id;\r\n\tvar myserver = this.client.connectionConfig.server;\r\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\r\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\r\n\treturn this.client.createDatabase(dbid, dbdoc)\r\n\t.then(function(response){ //import schema into newly created DB\r\n\t\tif(dbdets.schema){\r\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\r\n\t\t\tvar opts = (dbdets.key ?  {\"terminus:user_key\": dbdets.key } : {});\r\n\t\t\topts['terminus:encoding'] = \"terminus:turtle\";\r\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\r\n\t\t\t\tself.client.connectionConfig.server = myserver;\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tvar nopts = {'terminus:encoding':  \"terminus:turtle\"};\r\n\t\t\t\treturn self.client.updateSchema(false, response, nopts);\r\n\t\t\t})\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.clearBusy();\r\n\t\t\t\tself.redraw();\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.clearBusy();\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.then(function(response){ //reload list of databases in background..\r\n\t\treturn self.refreshDBList()\r\n\t\t.then(function(response){\r\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/**\r\n * Deletes the database with the passed id from the currently connected server\r\n */\r\nTerminusUI.prototype.deleteDatabase = function(dbid){\r\n\tvar self = this;\r\n\tvar delrec = this.client.connection.getDBRecord();\r\n\tvar lid = (dbid ? dbid : this.db());\r\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\r\n\tthis.showBusy(\"Deleting database \" + dbn);\r\n\treturn this.client.deleteDatabase(dbid)\r\n\t.then(function(response){\r\n\t\tself.clearBusy();\r\n\t\tself.client.connectionConfig.dbid = false;\r\n\t\tself.removeDB(dbid);\r\n\t\tself.showServerMainPage();\r\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\r\n\t\tself.refreshDBList();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Transforms a details (id, title, description) array into  json-ld document\r\n */\r\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\r\n\tvar doc = {\r\n\t\t\"@context\" : {\r\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\r\n\t\t},\r\n\t\t\"@type\": \"terminus:Database\"\r\n\t}\r\n\tif(dets.title){\r\n\t\tdoc['rdfs:label'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.title\r\n\t\t};\r\n\t}\r\n\tif(dets.description){\r\n\t\tdoc['rdfs:comment'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.description\r\n\t\t};\r\n\t}\r\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\r\n\treturn doc;\r\n}\r\n\r\nTerminusUI.prototype.getBadArguments = function(fname, str){\r\n\treturn \"Bad arguments to \" + fname + \": \" + str;\r\n}\r\n\r\nTerminusUI.prototype.getCrashString = function(fname, str){\r\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\r\n}\r\n\r\n/*\r\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\r\n */\r\nTerminusUI.prototype.load = function(url, key){\r\n\tvar args = {};\r\n\tif(url && url.indexOf(\"/document/\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\r\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\r\n\t}\r\n\telse if(url && url.indexOf(\"/schema\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\r\n\t\targs.schema = {};\r\n\t}\r\n\telse if(url && url.indexOf(\"/woql\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\r\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\r\n\t}\r\n\targs.server = url;\r\n\tif(key) args.key = key;\r\n\treturn this.connect(args);\r\n}\r\n\r\n/**\r\n * Fetches the DB URL from the url by chopping off the extra bits\r\n */\r\nTerminusUI.prototype.getConnectionEndpoint = function(url){\r\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/document\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nTerminusUI.prototype.server = function(){\r\n\treturn this.client.connectionConfig.server;\r\n}\r\n\r\nTerminusUI.prototype.db = function(){\r\n\treturn this.client.connectionConfig.dbid;\r\n}\r\n\r\nTerminusUI.prototype.clearServer = function(){\r\n\tthis.client.connectionConfig.server = false;\r\n}\r\n\r\nTerminusUI.prototype.connectToDB = function(dbid){\r\n\tthis.client.connectionConfig.dbid = dbid;\r\n\tTerminusClient.FrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\r\n\tTerminusClient.FrameHelper.standard_urls['scm'] = this.client.connectionConfig.dbURL() + \"/schema#\";\r\n}\r\n\r\nTerminusUI.prototype.clearDB = function(){\r\n\tthis.client.connectionConfig.dbid = false;\r\n}\r\n\r\nTerminusUI.prototype.removeDB = function(db, url){\r\n\tthis.client.connection.removeDB(db, url);\r\n}\r\n\r\nTerminusUI.prototype.getDBRecord = function(db, url){\r\n\treturn this.client.connection.getDBRecord(db, url);\r\n}\r\n\r\nTerminusUI.prototype.refreshDBList = function(){\r\n\tvar self = this;\r\n\treturn this.client.connect();\r\n}\r\n\r\nTerminusUI.prototype.showServerMainPage = function(){\r\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showLoadURLPage = function(val){\r\n\tthis.viewer = new TerminusURLLoader(this, val);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDBMainPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDBPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showSchemaPage = function(durl){\r\n\tthis.viewer = new TerminusSchemaViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showQueryPage = function(query){\r\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showMappingPage = function(mapping){\r\n\tthis.viewer = new TerminusMappingViewer(this, mapping, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocumentPage = function(durl){\r\n    var opts = {};\r\n    opts.page_config = 'home';\r\n    this.viewer = new TerminusDocumentViewer(this, \"view\", opts);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\r\n\tconst promise = this.viewer.loadDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.showCreateDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\r\n\tconst promise = this.viewer.loadCreateDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.redrawMainPage = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.main);\r\n\tif(this.viewer){\r\n\t\tthis.main.appendChild(this.viewer.getAsDOM());\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showResult = function(response){\r\n\tthis.showMessage(response, \"success\");\r\n};\r\n\r\nTerminusUI.prototype.showError = function(response){\r\n\tthis.showMessage(response, \"error\");\r\n};\r\n\r\nTerminusUI.prototype.clearMessages = function(response){\r\n\tif(this.messages) TerminusClient.FrameHelper.removeChildren(this.messages);\r\n};\r\n\r\nTerminusUI.prototype.clearMainPage = function(){\r\n\tif(this.main) TerminusClient.FrameHelper.removeChildren(this.main);\r\n}\r\n\r\nTerminusUI.prototype.setMessageDOM = function(dom){\r\n\tthis.messages = dom;\r\n}\r\n\r\nTerminusUI.prototype.setbuttonControls = function(dom){\r\n\tthis.buttons = dom;\r\n}\r\n\r\nTerminusUI.prototype.setControllerDOM = function(dom){\r\n\tthis.controller = dom;\r\n}\r\n\r\nTerminusUI.prototype.setExplorerDOM = function(dom){\r\n\tthis.explorer = dom;\r\n}\r\n\r\nTerminusUI.prototype.setPluginsDOM = function(dom){\r\n\tthis.plugins = dom;\r\n}\r\n\r\nTerminusUI.prototype.setViewerDOM = function(dom){\r\n\tthis.main = dom;\r\n}\r\n\r\nTerminusUI.prototype.draw = function(comps, slocation){\r\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\r\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\r\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\r\n\tif(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\r\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\r\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\r\n\tif(this.plugins){\r\n\t\tthis.drawPlugins();\r\n\t}\r\n\tif(this.buttons){\r\n\t\tthis.toggleControl();\r\n\t}\r\n\tvar self = this;\r\n\tvar cdrawn = false;\r\n\tif(slocation && slocation.server){\r\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\r\n\t\t\treturn this.connect(slocation)\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tself.showLoadURLPage();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.showLoadURLPage();\r\n\t};\r\n}\r\n\r\n\r\n\r\nTerminusUI.prototype.redraw = function(msg){\r\n\tthis.clearMessages();\r\n\tif(this.controller){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.controller);\r\n\t\tthis.drawControls();\r\n\t}\r\n\tif(this.explorer){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.explorer);\r\n\t\t//this.drawExplorer();\r\n\t}\r\n\tif(this.viewer){\r\n\t\tthis.redrawMainPage();\r\n\t}\r\n\tif(msg) this.showMessage(msg);\r\n};\r\n\r\n\r\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\r\n    TerminusClient.FrameHelper.removeChildren(this.controller);\r\n    TerminusClient.FrameHelper.removeChildren(this.explorer);\r\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\r\n    widget.classList.add('terminus-dashboard-selected');\r\n}\r\n\r\nTerminusUI.prototype.toggleControl = function(){\r\n  var self = this;\r\n  this.buttons.client.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawControls();\r\n    self.showServerMainPage();\r\n  })\r\n  this.buttons.explorer.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawExplorer();\r\n  })\r\n}\r\n\r\nTerminusUI.prototype.drawControls = function(){\r\n\tthis.controls = [];\r\n\tthis.loadControls();\r\n\tfor(var i = 0; i<this.controls.length; i++){\r\n\t\tvar ncontrol = this.controls[i];\r\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\r\n\t\t\tthis.controller.appendChild(nd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawExplorer = function(){\r\n\tif(this.explorer){\r\n\t\tif(this.showControl(\"api_explorer\")){\r\n\t\t\tvar exp = new ApiExplorer(this);\r\n\t\t\tae = exp.getAsDOM();\r\n\t\t\tthis.explorer.appendChild(ae);\r\n\t\t\tthis.explorer.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.loadControls = function(){\r\n\tif(this.showControl('server')){\r\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\r\n\t\tif(sc) {\r\n\t\t\tthis.controls.push(sc);\r\n\t\t}\r\n\t\tif(this.db() && this.showControl(\"db\")){\r\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\r\n\t\t\tif(sc) this.controls.push(sc);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showControl = function(el){\r\n\tif(this.show_controls.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.showView = function(el){\r\n\tif(this.show_views.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.clearBusy = function(response){\r\n\tthis.clearMessages();\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\r\n}\r\n\r\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\r\n     var pd = document.createElement('div');\r\n     var pbc = document.createElement('div');\r\n     pbc.setAttribute('class', 'term-progress-bar-container');\r\n     pd.appendChild(pbc);\r\n\r\n     var pbsa = document.createElement('div');\r\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\r\n     pbc.appendChild(pbsa);\r\n     var pbia = document.createElement('span');\r\n     pbia.setAttribute('class', 'term-progress-bar-inner');\r\n     pbsa.appendChild(pbia);\r\n\r\n     bsyDom.appendChild(pd);\r\n}\r\n\r\nTerminusUI.prototype.showMessage = function(msg, type){\r\n\tif(this.messages){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tvar md = document.createElement('div');\r\n        switch(type){\r\n            case 'busy':\r\n                var msgHolder = document.createElement('div');\r\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\r\n                msgHolder.appendChild(document.createTextNode(msg));\r\n                md.appendChild(msgHolder);\r\n                this.getBusyLoader(md);\r\n            break;\r\n            case 'success':\r\n                md.setAttribute('class', 'terminus-show-msg-success');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n            case 'error':\r\n                md.setAttribute('class', 'terminus-show-msg-error');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n        }\r\n\t\tthis.messages.appendChild(md);\r\n\t}\r\n};\r\n\r\nTerminusUI.prototype.showViolations = function(vios, type){\r\n\tvar nvios = new TerminusViolations(vios, this);\r\n\tif(this.messages){\r\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showBusy = function(msg){\r\n\tthis.showMessage(msg, \"busy\");\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\r\n};\r\n\r\nTerminusUI.prototype.pseudoCapability = function(el){\r\n\tvar pseuds = [\"server\", \"db\", \"change-server\", \"api_explorer\", \"import_schema\", \"schema_format\"];\r\n\tif(pseuds.indexOf(el) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nTerminusUI.prototype.setOptions = function(opts){\r\n\tthis.show_controls = opts && opts.controls ? opts.controls :\r\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\r\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\r\n\t\t\t\"create_document\", \"get_document\", \"update_schema\",\r\n\t\t\t\"get_schema\", \"woql_select\"\r\n\t\t];\r\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\r\n\tif(opts.document){\r\n\t\tthis.document_options = opts.document;\r\n\t}\r\n\tif(opts.schema){\r\n\t\tthis.schema_options = opts.schema;\r\n\t}\r\n\tthis.piman = new TerminusPluginManager();\r\n\tvar self = this;\r\n\tthis.piman.init(opts.plugins, function(){\r\n\t\tvar pins = [\"gmaps\", \"quill\", \"select2\"];\r\n\t\tfor(var i = 0; i<pins.length; i++){\r\n\t\t\tif(self.piman.pluginAvailable(pins[i])){\r\n\t\t\t\tRenderingMap.addPlugin(pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.redraw();\r\n\t});\r\n\tif(opts.css && this.piman){\r\n\t\tthis.piman.loadPageCSS(opts.css);\r\n\t}\r\n\tthis.loadControls();\r\n}\r\n\r\nTerminusUI.prototype.pluginAvailable = function(p){\r\n\treturn this.piman.pluginAvailable(p);\r\n}\r\n\r\nTerminusUI.prototype.drawPlugins = function(){\r\n\tif(!this.piman) {\r\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\r\n\t\treturn false;\r\n\t}\r\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\r\n}\r\n\r\nTerminusUI.prototype.getDocViewerOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDocCreatorOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getClassFrameOptions = function(){\r\n\treturn this.viewdoc_options;\r\n}\r\n\r\nmodule.exports=TerminusUI\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\r\n */\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet apiNavConfig = {\r\n    mainNav: {\r\n        connect: {\r\n    \t\tnavText: 'Connect API',\r\n            action : 'connect',\r\n            icon   : 'link',\r\n            defaultSelected: true\r\n    \t},\r\n        database: {\r\n            navText: 'Database API',\r\n            action : 'create',\r\n            icon   : 'database'\r\n        },\r\n        schema: {\r\n            navText: 'Schema API',\r\n            action : 'schema',\r\n            icon   : 'cog'\r\n        },\r\n        document: {\r\n            navText: 'Document API',\r\n            action : 'document',\r\n            icon   : 'file'\r\n        },\r\n        query: {\r\n            navText: 'Query API',\r\n            action : 'query',\r\n            icon   : 'search'\r\n        }\r\n    },\r\n    subNav: {\r\n        database: {\r\n            createDatabase: {\r\n                navText: 'Create database',\r\n                action : 'create',\r\n                icon   : 'plus',\r\n                defaultSelected: true\r\n            },\r\n            deleteDatabase: {\r\n                navText: 'Delete database',\r\n                action : 'delete',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        schema: {\r\n            getSchema: {\r\n                navText: 'View Schema',\r\n                action : 'getSchema',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n            },\r\n            updateSchema: {\r\n                navText: 'Update Schema',\r\n                action : 'updateSchema',\r\n                icon   : 'arrow-up'\r\n            },\r\n            getClassFrames: {\r\n                navText: 'Get Class Frames',\r\n                action : 'getClassFrames',\r\n                icon   : 'share-alt'\r\n            }\r\n        },\r\n        document: {\r\n            viewDocument: {\r\n        \t\tnavText: 'View Document',\r\n                action : 'viewDocument',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n        \t},\r\n            createDocument: {\r\n                navText: 'Create Document',\r\n                action : 'createDocument',\r\n                icon   : 'plus'\r\n            },\r\n            updateDocument: {\r\n                navText: 'Update Document',\r\n                action : 'updateDocument',\r\n                icon   : 'arrow-up'\r\n            },\r\n            deleteDocument:{\r\n                navText: 'Delete Document',\r\n                action : 'deleteDocument',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        query: {\r\n            select: {\r\n                navText: 'Select',\r\n                action : 'select',\r\n                icon   : 'mouse-pointer',\r\n                defaultSelected: true\r\n            },\r\n            update: {\r\n                navText: 'Update',\r\n                action : 'update',\r\n                icon   : 'arrow-up'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction ApiExplorer(ui){\r\n    this.ui = ui;\r\n    this.viewer = ui.main;\r\n    this.client = new TerminusClient.WOQLClient();\r\n    this.client.use_fetch = true;\r\n    this.client.return_full_response = true;\r\n    this.pman = new TerminusPluginManager();\r\n}\r\n\r\n// Controller provides access to Api explorer functions\r\nApiExplorer.prototype.getAsDOM = function(){\r\n \tvar aec = document.createElement(\"div\");\r\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\r\n    if(this.ui){\r\n       this.getApiNav(aec, this.viewer); // nav\r\n       this.getApiExplorerDom('connect', this.viewer); // content dom\r\n    } // if this.ui\r\n    return aec;\r\n }\r\n\r\n/***** Api Nav bar *****/\r\n// Toggle selected nav bars\r\nApiExplorer.prototype.setSelectedNavMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    a.classList.add(\"terminus-selected\");\r\n}\r\n\r\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    nav.classList.add(\"terminus-selected\");\r\n    this.getApiExplorerDom(action, viewer);\r\n}\r\n\r\n// create nav bars\r\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.navOnSelect(navConfig.action, this, viewer);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(navConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// gets api nav bar\r\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\r\n    // list view of apis\r\n    var nav = document.createElement('div');\r\n    navDom.appendChild(nav);\r\n    // connect to server api\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul');\r\n    nav.appendChild(ul);\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.mainNav){\r\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\r\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    return navDom;\r\n} // getApiNav()\r\n\r\n/***** Api sub navs  *****/\r\n// get schema api explorer - nav bar, alert msg, headers ...\r\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\r\n    // clear of viewer\r\n    TerminusClient.FrameHelper.removeChildren(viewer);\r\n    // wrapper\r\n    var wrap = document.createElement('div');\r\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\r\n    viewer.appendChild(wrap);\r\n    var cont = document.createElement('div');\r\n    cont.setAttribute('class', 'container-fluid');\r\n    wrap.appendChild(cont);\r\n    var row = document.createElement('div');\r\n    row.setAttribute('class', 'row-fluid');\r\n    cont.appendChild(row);\r\n    var body = document.createElement('div');\r\n    body.setAttribute('class', 'terminus-module-body');\r\n    row.appendChild(body);\r\n    var api = document.createElement('div');\r\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\r\n    body.appendChild(api);\r\n    // body\r\n    var cont = document.createElement('div');\r\n    var self = this;\r\n    switch(view){\r\n        case 'connect':\r\n            var apiCont = self.getConnectExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'create':\r\n            var apiCont = self.getDatabaseExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'schema':\r\n            var apiCont = self.getSchemaApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'document':\r\n            var apiCont = self.getDocumentApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'query':\r\n            var apiCont = self.getQueryApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n    }// switch(api)\r\n    return wrap;\r\n} // getApiExplorerDom\r\n\r\n// on trigger of click event - change dom\r\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\r\n    TerminusClient.FrameHelper.removeChildren(body);\r\n    switch(curSubMenu){\r\n        case 'database':\r\n            var dom = this.getDatabaseDom(action, body);\r\n        break;\r\n        case 'schema':  // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'document': // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'query':\r\n            var dom = this.getQueryApiDom(action, body);\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Config');\r\n        break;\r\n    }\r\n    cont.appendChild(dom);\r\n}\r\n\r\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\r\n    UTILS.setSelectedSubMenu(subNav);\r\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\r\n}\r\n\r\n// create sub nav bars\r\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\r\n    // comment getclassframes for api explorer time being\r\n    if(subMenuConfig.action == 'getClassFrames') return;\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function() {\r\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(subMenuConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// get connect to server api calls - on click of connectAPI nav bar\r\nApiExplorer.prototype.getConnectExplorer = function(body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature('connect');\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get server url\r\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\r\n    //body.appendChild(form);\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.database){\r\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\r\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    // landing page\r\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDatabaseExplorer\r\n\r\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\r\nApiExplorer.prototype.getSchemaApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.schema){\r\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\r\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getSchemaApi\r\n\r\n// get document api calls - on click of DocumentAPI nav bar\r\nApiExplorer.prototype.getDocumentApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.document){\r\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\r\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDocumentApi\r\n\r\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\r\nApiExplorer.prototype.getQueryApi  = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.query){\r\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\r\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} //getQueryApi\r\n\r\n/***** Api Content view  *****/\r\n// get database dom\r\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature(mode);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get database id\r\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\r\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n//get create & delete db form\r\nApiExplorer.prototype.getServerForm = function(){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var inpLabel = document.createElement('label');\r\n  inpLabel.setAttribute('class', 'terminus-control-label');\r\n  inpLabel.setAttribute('for', 'basicinput');\r\n  inpLabel.innerHTML = 'Url:';\r\n  fd.appendChild(inpLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var inpId = document.createElement('input');\r\n  inpId.setAttribute('type', 'text');\r\n  inpId.setAttribute('id', 'basicinput');\r\n  inpId.setAttribute('class', 'terminus-input-text');\r\n  inpId.setAttribute('placeholder', 'URL : server_url');\r\n  if(this.val) inpId.value = this.val;\r\n  cd.appendChild(inpId);\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var keyLabel = document.createElement('label');\r\n  keyLabel.setAttribute('class', 'terminus-control-label');\r\n  keyLabel.setAttribute('for', 'basicinput');\r\n  keyLabel.innerHTML = 'Key:';\r\n  fd.appendChild(keyLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var key = document.createElement('input');\r\n  key.setAttribute('type', 'text');\r\n  key.setAttribute('id', 'basicinput');\r\n  key.setAttribute('class', 'span8 terminus-input-text');\r\n  key.setAttribute('placeholder', 'Key : key');\r\n  if(this.val) key.value = this.val;\r\n  cd.appendChild(key);\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  var gatherips = function(){\r\n    var input = {};\r\n    input.url = inpId.value;\r\n    input.key = key.value;\r\n    return input;\r\n  }\r\n  var resd = document.createElement('div');\r\n  form.appendChild(button);\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  button.addEventListener(\"click\", function(){\r\n    var buttonSelf = this;\r\n    //opts = {};\r\n    var input = gatherips();\r\n    self.client.connect(input.url, input.key)\r\n    .then(function(response){\r\n      TerminusClient.FrameHelper.removeChildren(resd);\r\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\r\n    });\r\n  }) // button click\r\n  return form;\r\n} // getServerForm()\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n  var body = document.createElement('div');\r\n  // list view of Databse tools\r\n  var ul = document.createElement('ul');\r\n  ul.setAttribute('class','terminus-ul-horizontal');\r\n  // loop over apiNavConfig\r\n  for (var key in apiNavConfig.subNav.database){\r\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\r\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n      }\r\n  } // for apiNavConfig\r\n  cont.appendChild(ul);\r\n  // landing page\r\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n  cont.appendChild(dom);\r\n  return cont;\r\n} // getDatabaseExplorer\r\n\r\n\r\n// get schema & document dom\r\nApiExplorer.prototype.getShowApiDom = function(action, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get input\r\n    switch(action){\r\n        case 'getSchema':\r\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'getClassFrames':\r\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'updateSchema':\r\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\r\n        break;\r\n        case 'viewDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'deleteDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'createDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'updateDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Call on form');\r\n        break;\r\n   }// switch(action)\r\n\r\n   return body;\r\n } // getShowApiDom()\r\n\r\n// get query api dom\r\nApiExplorer.prototype.getQueryApiDom = function(action, body){\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\r\n    return body;\r\n} // getQueryApiDom\r\n\r\n/*ApiExplorer.prototype.getClassFramesForm = function(){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\r\n    if(this.val) inpUrl.value = this.val;\r\n    cd.appendChild(inpUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url/ ID:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpDocUrl = document.createElement('input');\r\n    inpDocUrl.setAttribute('type', 'text');\r\n    inpDocUrl.setAttribute('id', 'basicinput');\r\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n    cd.appendChild(inpDocUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var optLabel = document.createElement('label');\r\n    optLabel.setAttribute('class', 'terminus-control-label');\r\n    optLabel.setAttribute('for', 'basicinput');\r\n    optLabel.innerHTML = 'Options:';\r\n    fd.appendChild(optLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var optInp = document.createElement('input');\r\n    optInp.setAttribute('type', 'text');\r\n    optInp.setAttribute('id', 'basicinput');\r\n    optInp.setAttribute('class', 'span8 terminus-input-text');\r\n    optInp.setAttribute('placeholder', 'options');\r\n    cd.appendChild(optInp);\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    var gatherips = function(){\r\n        var input = {};\r\n        input.url = inpUrl.value;\r\n        input.docUrl = inpDocUrl.value;\r\n        input.options = optInp.value;\r\n        return input;\r\n    }\r\n    var self = this;\r\n    button.addEventListener(\"click\", function(form){\r\n      var input = gatherips();\r\n      var buttonSelf = this;\r\n      opts = {};\r\n      opts.explorer = true;\r\n      self.client.getClassFrame(input.url, input.docUrl, opts)\r\n      .then(function(response){\r\n          var currForm = buttonSelf.parentNode;\r\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\r\n      });\r\n    }) // button click\r\n    form.appendChild(button);\r\n    return form;\r\n}   */\r\n\r\n// get form for all Apis\r\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\r\n    // form\r\n    var formDoc = document.createElement('form');\r\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var urlLabel = document.createElement('label');\r\n    urlLabel.setAttribute('class', 'terminus-control-label');\r\n    urlLabel.setAttribute('for', 'basicinput');\r\n    urlLabel.innerHTML = 'Url:';\r\n    fd.appendChild(urlLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\r\n    cd.appendChild(inpUrl);\r\n    // add extra form fields based on current api chosen\r\n    switch(curApi){\r\n        case 'getClassFrames':\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var docUrlLabel = document.createElement('label');\r\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\r\n            docUrlLabel.setAttribute('for', 'basicinput');\r\n            docUrlLabel.innerHTML = 'Url/ ID:';\r\n            fd.appendChild(docUrlLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpDocUrl = document.createElement('input');\r\n            inpDocUrl.setAttribute('type', 'text');\r\n            inpDocUrl.setAttribute('id', 'basicinput');\r\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n            cd.appendChild(inpDocUrl);\r\n        break;\r\n        case 'schema':\r\n            //encoding\r\n           /* var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var encLabel = document.createElement('label');\r\n            encLabel.setAttribute('class', 'terminus-control-label');\r\n            encLabel.setAttribute('for', 'basicinput');\r\n            encLabel.innerHTML = 'Encoding:';\r\n            fd.appendChild(encLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpEnc = document.createElement('select');\r\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\r\n            inpEnc.setAttribute('placeholder', 'turtle');\r\n            var optTurt = document.createElement('option');\r\n            optTurt.setAttribute('value', 'terminus:turtle');\r\n            optTurt.appendChild(document.createTextNode('turtle'));\r\n            inpEnc.appendChild(optTurt);\r\n            var optJld = document.createElement('option');\r\n            optJld.setAttribute('value', 'terminus:jsonld');\r\n            optJld.appendChild(document.createTextNode('jsonLD'));\r\n            inpEnc.appendChild(optJld);\r\n            cd.appendChild(inpEnc); */\r\n        break;\r\n    }\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var keyLabel = document.createElement('label');\r\n    keyLabel.setAttribute('class', 'terminus-control-label');\r\n    keyLabel.setAttribute('for', 'basicinput');\r\n    keyLabel.innerHTML = 'Key:';\r\n    fd.appendChild(keyLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpKey = document.createElement('input');\r\n    inpKey.setAttribute('type', 'text');\r\n    inpKey.setAttribute('id', 'basicinput');\r\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\r\n    inpKey.setAttribute('placeholder', 'Key');\r\n    cd.appendChild(inpKey);\r\n    if(!view){\r\n        // include text area only if call is type post\r\n        var fd = document.createElement('div');\r\n        fd.setAttribute('class', 'terminus-control-group');\r\n        formDoc.appendChild(fd);\r\n        var docLabel = document.createElement('label');\r\n        docLabel.setAttribute('class', 'terminus-control-label');\r\n        docLabel.setAttribute('for', 'basicinput');\r\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\r\n        docLabel.innerHTML = 'Document:';\r\n        fd.appendChild(docLabel);\r\n        var cd = document.createElement('div');\r\n        cd.setAttribute('class', 'terminus-controls');\r\n        fd.appendChild(cd);\r\n        var inpDoc = document.createElement('textarea');\r\n        cd.appendChild(inpDoc);\r\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\r\n        UTILS.stylizeEditor(this.ui, inpDoc, 'api-doc', 'javascript');\r\n    }\r\n    body.appendChild(formDoc);\r\n    // gather inputs\r\n    var inp ={};\r\n    inp.url = inpUrl;\r\n    inp.key = inpKey;\r\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\r\n    //if(curApi == 'schema') inp.enc = inpEnc;\r\n    if(!view) inp.doc = inpDoc;\r\n    var form = this.getApiSendButton(action, inp);\r\n    body.appendChild(form);\r\n}\r\n\r\n// define event listeners on send api of schema & documents\r\n\r\nApiExplorer.prototype.getApiForm = function(action, input){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  form.appendChild(button);\r\n  var resd = document.createElement('div');\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  switch(action){\r\n    case 'getSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        var buttonSelf = this;\r\n        self.client.getSchema(schurl, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        self.client.connectionConfig.connected_mode = false;\r\n        self.client.updateSchema(schurl, input.doc.value, opts)\r\n        .then(function(response){\r\n          var gtxtar = document.createElement('textarea');\r\n          gtxtar.setAttribute('readonly', true);\r\n          gtxtar.innerHTML = response;\r\n          var currForm = buttonSelf.parentNode;\r\n          currForm.appendChild(gtxtar);\r\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'viewDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      opts.format = 'turtle';\r\n      self.client.getDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'deleteDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      self.client.deleteDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'createDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        self.client.createDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts.editmode = 'replace';\r\n        opts.format = 'json';\r\n        self.client.updateDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n  } // switch(action)\r\n\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n\r\n  return form;\r\n} // getApiForm()\r\n\r\n\r\n// define event listeners on send api of schema & documents\r\nApiExplorer.prototype.getApiSendButton = function(action, input){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    form.appendChild(button);\r\n    var resd = document.createElement('div');\r\n    form.appendChild(resd);\r\n    var self = this;\r\n    switch(action){\r\n        case 'connect':\r\n            button.addEventListener(\"click\", function(){\r\n                self.client.connect(input.url.value, input.key.value)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n            }) // button click\r\n        break;\r\n        case 'create':\r\n            button.addEventListener(\"click\", function(form){\r\n              self.client.createDatabase(input.url.value, JSON.parse(input.doc.value), input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        case 'delete':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts ={}\r\n              self.client.deleteDatabase(input.url.value, input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break\r\n        case 'getSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var schurl = input.url.value;\r\n                self.client.getSchema(schurl, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'updateSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var payload = input.doc.value;\r\n                var schurl = input.url.value;\r\n                self.client.connectionConfig.connected_mode = false;\r\n                self.client.updateSchema(schurl, input.doc.value, opts)\r\n                //self.client.updateSchema(schurl, input.doc.value, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'getClassFrames':\r\n            button.addEventListener(\"click\", function(form){\r\n                var schurl = input.url.value;\r\n                opts = {};\r\n                opts.explorer = true;\r\n                self.client.getClassFrame(input.url, JSON.parse(input.docUrl.value), opts)\r\n                .then(function(response){\r\n                    var currForm = buttonSelf.parentNode;\r\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'viewDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.getDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t    TerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n        }) // button click\r\n        break;\r\n        case 'deleteDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.deleteDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n          }) // button click\r\n        break;\r\n        case 'createDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var payload = input.doc.value;\r\n              opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.createDocument(dcurl, JSON.parse(payload), opts)\r\n              .then(function(response){\r\n            \t   TerminusClient.FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n          }) // button click\r\n        break;\r\n        case 'updateDocument':\r\n          button.addEventListener(\"click\", function(){\r\n            var dcurl = input.url.value;\r\n            var payload = input.doc.value;\r\n            var buttonSelf = this;\r\n            opts = {};\r\n            opts['terminus:encoding'] = \"jsonld\";\r\n            opts['terminus:user_key'] = input.key.value;\r\n            self.client.updateDocument(dcurl, JSON.parse(payload), opts)\r\n            .then(function(response){\r\n            \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n            });\r\n          }) // button click\r\n        break;\r\n        case 'select':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts.key = input.key.value;\r\n                var doc = JSON.parse(input.doc.value);\r\n                self.client.select(input.url.value, doc, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'update':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              var doc = JSON.parse(input.doc.value);\r\n              self.client.update(input.url.value, doc, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        default:\r\n            console.log('Invalid Api call on button');\r\n        break;\r\n    } // switch(action)\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    return form;\r\n} // getApiSendButton()\r\n\r\n// get signature of api calls\r\nApiExplorer.prototype.getSignature = function(action){\r\n    var api = document.createElement('div');\r\n    // get header signature\r\n    var sg = document.createElement('button');\r\n    sg.appendChild(document.createTextNode('Click to read API Signature'));\r\n    sg.setAttribute('class', 'terminus-collapsible');\r\n    ic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n    sg.appendChild(ic);\r\n    api.appendChild(sg);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    var cl = document.createElement('div');\r\n    cl.setAttribute('class', 'terminus-collapsible-content content');\r\n    var sig = UTILS.getFunctionSignature(action);\r\n    var txt = document.createTextNode(sig.spec);\r\n    var pre = document.createElement('pre');\r\n    pre.setAttribute('class', 'terminus-api-signature-pre');\r\n    pre.appendChild(txt);\r\n    var txt =  document.createTextNode(sig.descr);\r\n    pre.appendChild(txt);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var txt = document.createTextNode(sig.result);\r\n    pre.appendChild(txt);\r\n    cl.appendChild(pre);\r\n    api.appendChild(cl);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    sg.addEventListener('click', function(){\r\n        UTILS.tolggleContent(ic, cl);\r\n    });\r\n    return api;\r\n} // getSignature()\r\n\r\n// displays signature only on click\r\nfunction tolggleSignatureContent(content){\r\n    if (content.style.display === \"block\")\r\n        content.style.display = \"none\";\r\n    else content.style.display = \"block\";\r\n}\r\n\r\nmodule.exports=ApiExplorer\r\n","\r\nconst CONST = require('./const');\r\nconst DispatchRequest = require('./dispatchRequest');\r\nconst ErrorMessage = require('./errorMessage');\r\nconst ConnectionCapabilities = require('./connectionCapabilities');\r\nconst ConnectionConfig = require('./connectionConfig');\r\nconst UTILS = require('./utils.js');\r\n\r\n/**\r\n * @file Javascript WOQL client object\r\n * @license Apache Version 2\r\n * @summary Simple Javascript Client for accessing the Terminus DB API\r\n */\r\n\r\n/**\r\n  * @param {Object} params\r\n  */\r\nfunction WOQLClient(params) {\r\n\t// current connection context variables\r\n\tconst key = params ? params.key : undefined;\r\n\tthis.use_fetch = false;\r\n\tthis.return_full_response = false;\r\n\tthis.connectionConfig = new ConnectionConfig(params);\r\n\tthis.connection = new ConnectionCapabilities(this.connectionConfig, key);\r\n}\r\n\r\nWOQLClient.CONST = CONST;\r\n\r\n/**\r\n * Connect to a Terminus server at the given URI with an API key\r\n * Stores the terminus:ServerCapability document returned\r\n * in the connection register which stores, the url, key, capabilities,\r\n * and database meta-data for the connected server\r\n *\r\n * If the curl argument is false or null,\r\n * this.connectionConfig.server will be used if present,\r\n * or the promise will be rejected.\r\n\r\n * @param  {string} curl Terminus server URI\r\n * @param  {string} API  key\r\n * @return {Promise}\r\n * @public\r\n */\r\nWOQLClient.prototype.connect = function (curl, key) {\r\n\tif (curl && !this.connectionConfig.setServer(curl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(curl, CONST.CONNECT))\r\n\t\t);\r\n\t}\r\n\tconst serverURL = this.connectionConfig.serverURL();\r\n\tif (key) {\r\n\t\tthis.connection.setClientKey(serverURL, key);\r\n\t}\r\n\t// unset the current server setting until successful connect\r\n\tthis.connectionConfig.server = false;\r\n\tconst self = this;\r\n\treturn this.dispatch(serverURL, CONST.CONNECT).then((response) => {\r\n\t\tself.connectionConfig.server = serverURL;\r\n\t\tself.connection.addConnection(serverURL, response);\r\n\t\treturn response;\r\n\t});\r\n};\r\n\r\n/**\r\n * Create a Terminus Database by posting\r\n * a terminus:Database document to the Terminus API\r\n *\r\n * The dburl argument can be\r\n *    1) a valid URL of a terminus database or\r\n *    2) a valid Terminus database id or\r\n *    3) can be omitted\r\n * \t\tin case 2) the current server will be used,\r\n * \t\tin case 3) the database id will be set from the @id field of the terminuse:Database document.\r\n *\r\n * The second (details) argument contains a terminus:Database document\r\n * with a mandatory rdfs:label field and an optional rdfs:comment field.\r\n * The third (key) argument contains an optional API key\r\n *\r\n * @param {string} dburl Terminus server URI or a TerminusID\r\n * @param {object} details\r\n * @param {string} key\r\n * @return {Promise}\r\n * @public\r\n */\r\nWOQLClient.prototype.createDatabase = function (dburl, details, key) {\r\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Create Database'))\r\n\t\t);\r\n\t}\r\n\tif (\r\n\t\tdetails\r\n    && details['@id']\r\n    && !this.connectionConfig.setDB(details['@id'], details['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(details['@id'], 'Create Database'))\r\n\t\t);\r\n\t}\r\n\tdetails = this.makeDocumentConsistentWithURL(details, this.connectionConfig.dbURL());\r\n\r\n\tconst opts = {};\r\n\tif (key) {\r\n\t\topts.key = key;\r\n\t}\r\n\tconst doc = this.addOptionsToDocument(details, opts);\r\n\treturn this.dispatch(this.connectionConfig.dbURL('create'), CONST.CREATE_DATABASE, doc);\r\n};\r\n\r\n/**\r\n * Delete a Database\r\n * @param {String} dburl it is a terminusDB Url or a terminusDB Id\r\n * @param {String} key an optional API key\r\n * @return {Promise}\r\n *\r\n * if dburl is omitted, the current server and database will be used\r\n */\r\nWOQLClient.prototype.deleteDatabase = function (dburl, key) {\r\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Delete Database'))\r\n\t\t);\r\n\t}\r\n\tconst opts = {};\r\n\r\n\tif (key) {\r\n\t\topts.key = key;\r\n\t}\r\n\r\n\tconst self = this;\r\n\treturn this.dispatch(`${this.connectionConfig.dbURL()}`, CONST.DELETE_DATABASE, opts).then(\r\n\t\t(response) => {\r\n\t\t\tself.connection.removeDB();\r\n\t\t\treturn response;\r\n\t\t}\r\n\t);\r\n};\r\n\r\n/**\r\n * Retrieves the schema of the specified database\r\n *\r\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\r\n * @param {object} opts is an options object\r\n * @return {Promise}\r\n *\r\n * opts.format is optional and defines which format is requested (*json / turtle)\r\n * opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.getSchema = function (schurl, opts) {\r\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Get Schema'))\r\n\t\t);\r\n\t}\r\n\t// consoleco.log('schemaURL', this.connectionConfig.schemaURL());\r\n\treturn this.dispatch(this.connectionConfig.schemaURL(), CONST.GET_SCHEMA, opts);\r\n};\r\n\r\n/**\r\n * Updates the Schema of the specified database\r\n *\r\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\r\n * @param {object} doc is a valid owl ontology in json-ld or turtle format\r\n * @param {object} opts is an options object\r\n * @return {Promise}\r\n *\r\n * if omitted the current server and database will be used\r\n * opts.format is used to specify which format is being used (*json / turtle)\r\n * opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.updateSchema = function (schurl, doc, opts) {\r\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Update Schema'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(doc, opts);\r\n\treturn this.dispatch(this.connectionConfig.schemaURL(), 'update_schema', doc);\r\n};\r\n\r\n/**\r\n * Creates a new document in the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus database (an id will be randomly assigned) or\r\n * 2) a valid URL or of a terminus document (the document will be given the passed URL) or\r\n * 3) a valid terminus document id (the current server and database will be used)\r\n * 4) can be omitted (the URL will be taken from the document if present)\r\n * The second argument (doc) is a valid document in json-ld\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.createDocument = function (docurl, doc, opts) {\r\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Create Document'))\r\n\t\t);\r\n\t} if (\r\n\t\tdoc\r\n    && doc['@id']\r\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Create Document'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(\r\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\r\n\t\topts\r\n\t);\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'create_document', doc);\r\n};\r\n\r\n/**\r\n * Retrieves a document from the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database\r\n * the second argument (opts) is an options json -\r\n * \t\topts.key is an optional API key\r\n * \t\topts.shape is frame | *document\r\n */\r\nWOQLClient.prototype.getDocument = function (docurl, opts) {\r\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Get Document'))\r\n\t\t);\r\n\t}\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'get_document', opts);\r\n};\r\n\r\n/**\r\n * Updates a document in the specified database with a new version\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database or\r\n * 3) omitted in which case the id will be taken from the document @id field\r\n * the second argument (doc) is a document in json-ld format\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.updateDocument = function (docurl, doc, opts) {\r\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Update Document'))\r\n\t\t);\r\n\t}\r\n\tif (doc && doc['@id']\r\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Update Document'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(\r\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\r\n\t\topts\r\n\t);\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'update_document', doc);\r\n};\r\n\r\n/**\r\n * Deletes a document from the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database\r\n * 3) omitted - the current document will be used\r\n * the second argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.deleteDocument = function (docurl, opts) {\r\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Delete Document'))\r\n\t\t);\r\n\t}\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'delete_document', opts);\r\n};\r\n\r\n/**\r\n * Executes a read-only WOQL query on the specified database and returns the results\r\n *\r\n * @param {string} qurl TerminusDB server URL or omitted (the current DB will be used)\r\n * @param {string} woql is a \"woql query select statement\"\r\n * @param {object} opts it can contents the API key (opts.key)\r\n *\r\n */\r\nWOQLClient.prototype.select = function (qurl, woql, opts) {\r\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Select'))\r\n\t\t);\r\n\t}\r\n\tlet q = { 'terminus:query': JSON.stringify(woql) };\r\n\tq = this.addOptionsToWOQL(q, opts);\r\n\treturn this.dispatch(this.connectionConfig.queryURL(), CONST.WOQL_SELECT, q);\r\n};\r\n\r\n/**\r\n * Executes a WOQL query on the specified database which updates the state and returns the results\r\n *\r\n * The first (qurl) argument can be\r\n * 1) a valid URL of a terminus database or\r\n * 2) omitted - the current database will be used\r\n * the second argument (woql) is a woql select statement encoded as a string\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.update = function (qurl, woql, opts) {\r\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Update'))\r\n\t\t);\r\n\t}\r\n\twoql = this.addOptionsToWOQL(woql, opts);\r\n\treturn this.dispatch(this.connectionConfig.queryURL(), 'woql_update', woql);\r\n};\r\n\r\n/**\r\n * Retrieves a WOQL query on the specified database which updates the state and returns the results\r\n *\r\n * The first (cfurl) argument can be\r\n * 1) a valid URL of a terminus database or\r\n * 2) omitted - the current database will be used\r\n * the second argument (cls) is the URL / ID of a document class that exists in the database schema\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.getClassFrame = function (cfurl, cls, opts) {\r\n\tif (cfurl && !this.connectionConfig.setClassFrameURL(cfurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(cfurl, 'Get Class Frame'))\r\n\t\t);\r\n\t}\r\n\tif (!opts) opts = {};\r\n\topts['terminus:class'] = cls;\r\n\treturn this.dispatch(this.connectionConfig.frameURL(), 'class_frame', opts);\r\n};\r\n\r\n/*\r\n * Utility functions for adding standard fields to API arguments\r\n */\r\nWOQLClient.prototype.addOptionsToWOQL = function (woql, opts) {\r\n\tif (opts && opts.key) {\r\n\t\twoql.key = opts.key;\r\n\t}\r\n\treturn woql;\r\n};\r\n\r\nWOQLClient.prototype.addOptionsToDocument = function (doc, opts) {\r\n\tconst pdoc = {};\r\n\tpdoc['@context'] = doc['@context'];\r\n\tif (pdoc['@context'] && doc['@id']) { // add blank node prefix as document base url\r\n\t\tpdoc['@context']._ = `${doc['@id']}/`;\r\n\t}\r\n\tif (opts && opts['terminus:encoding'] && opts['terminus:encoding'] === 'terminus:turtle') {\r\n\t\tpdoc['terminus:turtle'] = doc;\r\n\t\tpdoc['terminus:schema'] = this.connectionConfig.schemaURL();\r\n\t\tdelete pdoc['terminus:turtle']['@context'];\r\n\t} else {\r\n\t\tpdoc['terminus:document'] = doc;\r\n\t\tdelete pdoc['terminus:document']['@context'];\r\n\t}\r\n\tpdoc['@type'] = 'terminus:APIUpdate';\r\n\tif (opts && opts['terminus:user_key']) {\r\n\t\tpdoc['terminus:user_key'] = opts['terminus:user_key'];\r\n\t}\r\n\tif (opts && opts.key) {\r\n\t\tpdoc['terminus:user_key'] = opts.key;\r\n\t}\r\n\treturn pdoc;\r\n};\r\n\r\nWOQLClient.prototype.addKeyToPayload = function (payload, url) {\r\n\tif (typeof payload !== 'object')payload = {};\r\n\tif (payload.key) {\r\n\t\tpayload['terminus:user_key'] = payload.key;\r\n\t\tdelete payload.key;\r\n\t} else if (this.connection.getClientKey()) {\r\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey();\r\n\t} else if (this.connection.getClientKey(url)) {\r\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey(url);\r\n\t}\r\n\treturn payload;\r\n};\r\n\r\nWOQLClient.prototype.makeDocumentConsistentWithURL = function (doc, dburl) {\r\n\tdoc['@id'] = dburl;\r\n\treturn doc;\r\n};\r\n\r\nWOQLClient.prototype.dispatch = function (url, action, payload) {\r\n\tif (this.connectionConfig.includeKey()) {\r\n\t\tpayload = this.addKeyToPayload(payload, url);\r\n\t}\r\n\tif (this.use_fetch) {\r\n\t\treturn this.dispatchFetch(url, action, payload);\r\n\t}\r\n\treturn DispatchRequest(url, action, payload);\r\n};\r\n\r\n\r\nWOQLClient.prototype.dispatchFetch = function (url, action, payload) {\r\n\tconst api = {\r\n\t\tmode: 'cors', // no-cors, cors, *same-origin\r\n\t\tredirect: 'follow', // manual, *follow, error\r\n\t\treferrer: 'client', // no-referrer, *client\r\n\t};\r\n\tlet hdrs = {};\r\n\tif (this.connectionConfig.platformEndpoint()) {\r\n\t\tapi.credentials = 'include'; // include, *same-origin, omit\r\n\t}\r\n\tif (payload && payload['terminus:user_key']) {\r\n\t\thdrs = { Authorization: `Basic ${btoa(`:${payload['terminus:user_key']}`)}` };\r\n\t\tdelete (payload['terminus:user_key']);\r\n\t}\r\n\t// read only API calls - use GET\r\n\tswitch (action) {\r\n\tcase CONST.DELETE_DATABASE:\r\n\tcase CONST.DELETE_DOCUMENT:\r\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\r\n\t\tapi.method = 'DELETE';\r\n\t\tapi.cache = 'no-cache';\r\n\t\tbreak;\r\n\tcase CONST.CREATE_DATABASE:\r\n\tcase CONST.UPDATE_SCHEMA:\r\n\tcase CONST.CREATE_DOCUMENT:\r\n\tcase CONST.UPDATE_DOCUMENT:\r\n\tcase CONST.WOQL_UPDATE:\r\n\t\tapi.method = 'POST';\r\n\t\tapi.cache = 'no-cache';\r\n\t\thdrs['Content-Type'] = 'application/json';\r\n\t\tapi.body = JSON.stringify(payload);\r\n\t\tbreak;\r\n\tcase CONST.GET_SCHEMA:\r\n\tcase CONST.CONNECT:\r\n\tcase CONST.CLASS_FRAME:\r\n\tcase CONST.WOQL_SELECT:\r\n\tcase CONST.GET_DOCUMENT:\r\n\tdefault:\r\n\t\tapi.method = 'GET';\r\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\r\n\t}\r\n\tconst self = this;\r\n\tif (Object.keys(hdrs).length > 0) {\r\n\t\tapi.headers = new Headers(hdrs);\r\n\t}\r\n\treturn fetch(url, api).then((response) => {\r\n\t\tif (self.return_full_response) return response;\r\n\t\tif (response.ok) {\r\n\t\t\treturn response.json();\r\n\t\t}\r\n\t\tself.error = self.parseAPIError(response);\r\n\t\treturn Promise.reject(new Error(self.getAPIErrorMessage(url, api, self.error)));\r\n\t});\r\n};\r\n\r\nmodule.exports = WOQLClient;\r\n","const axios = require('axios');\r\nconst UTILS = require('./utils.js');\r\nconst CONST = require('./const.js');\r\nconst ErrorMessage = require('./errorMessage');\r\n/*\r\nAccess-Control-Allow-Credentials   true\r\nAccess-Control-Allow-Headers  X-PINGOTHER, Content-Type\r\nAccess-Control-Allow-Methods GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS\r\nAccess-Control-Allow-Origin: http://localhost:3000 // WILD CARD WILL NOT WORK WHEN POSTING\r\n*/\r\n\r\nfunction btoaImplementation(str) {\r\n\ttry {\r\n\t\treturn btoa(str);\r\n\t} catch (err) {\r\n\t\t// console.log('in buffer')\r\n\t\treturn Buffer.from(str).toString('base64');\r\n\t}\r\n}\r\n\r\nfunction DispatchRequest(url, action, payload) {\r\n\tconst options = {\r\n\t\tmode: 'cors', // no-cors, cors, *same-origin\r\n\t\tredirect: 'follow', // manual, *follow, error\r\n\t\treferrer: 'client',\r\n\t\t// url:url,\r\n\t\t// no-referrer, *client\r\n\t};\r\n\tif (payload && payload['terminus:user_key']) {\r\n\t\toptions.headers = { Authorization: `Basic ${btoaImplementation(`:${payload['terminus:user_key']}`)}` };\r\n\t\tdelete (payload['terminus:user_key']);\r\n\t}\r\n\r\n\tswitch (action) {\r\n\tcase CONST.DELETE_DATABASE:\r\n\tcase CONST.DELETE_DOCUMENT:\r\n\t\tif (payload) {\r\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\r\n\t\t\tif (ext) url += `?${ext}`;\r\n\t\t}\r\n\t\treturn axios.delete(url, options)\r\n\t\t\t.then(response => response.data)\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\r\n\t\t\t});\r\n\tcase CONST.CREATE_DATABASE:\r\n\tcase CONST.UPDATE_SCHEMA:\r\n\tcase CONST.CREATE_DOCUMENT:\r\n\tcase CONST.UPDATE_DOCUMENT:\r\n\tcase CONST.WOQL_UPDATE:\r\n\t\toptions.headers = options.headers ? options.headers : {};\r\n\t\toptions.headers['Content-Type'] = 'application/json';\r\n\t\treturn axios.post(url, JSON.stringify(payload), options)\r\n\t\t\t.then(response => response.data)\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconst e = new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\r\n\t\t\t\tif (err.response && err.response.data) e.data = err.response.data;\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\tcase CONST.GET_SCHEMA:\r\n\tcase CONST.CONNECT:\r\n\tcase CONST.CLASS_FRAME:\r\n\tcase CONST.WOQL_SELECT:\r\n\tcase CONST.GET_DOCUMENT:\r\n\tdefault:\r\n\t\tif (payload) {\r\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\r\n\t\t\tif (ext) url += `?${ext}`;\r\n\t\t}\r\n\t\treturn axios.get(url, options)\r\n\t\t\t.then((response => response.data))\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = DispatchRequest;\r\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = require('./lib/axios');","'use strict';\n\nvar utils = require('./utils');\nvar bind = require('./helpers/bind');\nvar Axios = require('./core/Axios');\nvar mergeConfig = require('./core/mergeConfig');\nvar defaults = require('./defaults');\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = require('./cancel/Cancel');\naxios.CancelToken = require('./cancel/CancelToken');\naxios.isCancel = require('./cancel/isCancel');\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = require('./helpers/spread');\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\nmodule.exports = function isBuffer (obj) {\n  return obj != null && obj.constructor != null &&\n    typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n","'use strict';\n\nvar utils = require('./../utils');\nvar buildURL = require('../helpers/buildURL');\nvar InterceptorManager = require('./InterceptorManager');\nvar dispatchRequest = require('./dispatchRequest');\nvar mergeConfig = require('./mergeConfig');\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = arguments[1] || {};\n    config.url = arguments[0];\n  } else {\n    config = config || {};\n  }\n\n  config = mergeConfig(this.defaults, config);\n  config.method = config.method ? config.method.toLowerCase() : 'get';\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\nAxios.prototype.getUri = function getUri(config) {\n  config = mergeConfig(this.defaults, config);\n  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\\?/, '');\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n","'use strict';\n\nvar utils = require('./../utils');\nvar transformData = require('./transformData');\nvar isCancel = require('../cancel/isCancel');\nvar defaults = require('../defaults');\nvar isAbsoluteURL = require('./../helpers/isAbsoluteURL');\nvar combineURLs = require('./../helpers/combineURLs');\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Support baseURL config\n  if (config.baseURL && !isAbsoluteURL(config.url)) {\n    config.url = combineURLs(config.baseURL, config.url);\n  }\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers || {}\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n","'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n","'use strict';\n\nvar createError = require('./createError');\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  if (!validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n","'use strict';\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n\n  error.request = request;\n  error.response = response;\n  error.isAxiosError = true;\n\n  error.toJSON = function() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: this.config,\n      code: this.code\n    };\n  };\n  return error;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n    (function standardBrowserEnv() {\n      var msie = /(msie|trident)/i.test(navigator.userAgent);\n      var urlParsingNode = document.createElement('a');\n      var originURL;\n\n      /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n      function resolveURL(url) {\n        var href = url;\n\n        if (msie) {\n        // IE needs attribute set twice to normalize properties\n          urlParsingNode.setAttribute('href', href);\n          href = urlParsingNode.href;\n        }\n\n        urlParsingNode.setAttribute('href', href);\n\n        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n        return {\n          href: urlParsingNode.href,\n          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n          host: urlParsingNode.host,\n          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n          hostname: urlParsingNode.hostname,\n          port: urlParsingNode.port,\n          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n            urlParsingNode.pathname :\n            '/' + urlParsingNode.pathname\n        };\n      }\n\n      originURL = resolveURL(window.location.href);\n\n      /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n      return function isURLSameOrigin(requestURL) {\n        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n        return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n      };\n    })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return function isURLSameOrigin() {\n        return true;\n      };\n    })()\n);\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n    (function standardBrowserEnv() {\n      return {\n        write: function write(name, value, expires, path, domain, secure) {\n          var cookie = [];\n          cookie.push(name + '=' + encodeURIComponent(value));\n\n          if (utils.isNumber(expires)) {\n            cookie.push('expires=' + new Date(expires).toGMTString());\n          }\n\n          if (utils.isString(path)) {\n            cookie.push('path=' + path);\n          }\n\n          if (utils.isString(domain)) {\n            cookie.push('domain=' + domain);\n          }\n\n          if (secure === true) {\n            cookie.push('secure');\n          }\n\n          document.cookie = cookie.join('; ');\n        },\n\n        read: function read(name) {\n          var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n          return (match ? decodeURIComponent(match[3]) : null);\n        },\n\n        remove: function remove(name) {\n          this.write(name, '', Date.now() - 86400000);\n        }\n      };\n    })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return {\n        write: function write() {},\n        read: function read() { return null; },\n        remove: function remove() {}\n      };\n    })()\n);\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n","'use strict';\n\nvar Cancel = require('./Cancel');\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n","/**\r\n * Represents a frame for programmatic access to object frame, anywhere within a document\r\n * Recursive data structure where this.children contains an indexed array of object frames\r\n * and this.dataframes contains a property indexed array of data frames\r\n * Every object frame carries a reference to its classframe\r\n * This gives us instructions as to how to create new frames according to the schema\r\n * After that it's turtles all the way down.\r\n * @param cls - ID of the class (URL)\r\n * @param classframe - an array of frames representing a class\r\n * @param archetypes list of class frames\r\n * @param parent parent object\r\n * @returns\r\n */\r\nconst FrameHelper = require('./frameHelper');\r\nconst FramePattern = require('./framePattern');\r\n\r\nfunction ObjectFrame(cls, dataframes, classframes, parent, parentframe) {\r\n\t// the class of the frame - mandatory\r\n\tthis.empty();\r\n\tthis.cls = cls;\r\n\r\n\t// array of frames representing the full class frame\r\n\t// (optional - required to be able to safely add missing properties)\r\n\tif (classframes && typeof classframes === 'object') {\r\n\t\tthis.loadClassFrames(classframes);\r\n\t}\r\n\tif (dataframes && typeof dataframes === 'object') {\r\n\t\tthis.originalFrames = dataframes;\r\n\t\tthis.loadDataFrames(dataframes);\r\n\t} else {\r\n\t\tthis.originalFrames = false;\r\n\t}\r\n\t// parent object frame\r\n\tthis.parent = parent;\r\n\t// original frame used by parent to create me\r\n\tthis.parentframe = parentframe;\r\n\t// set to true if this is a newly created document\r\n\tthis.newDoc = false;\r\n}\r\n\r\n/**\r\n * Loads class frames for the object's class - the instructions about how to put an object together\r\n */\r\nObjectFrame.prototype.loadClassFrames = function (classframes) {\r\n\tfor (let j = 0; j < classframes.length; j += 1) {\r\n\t\tif (classframes[j]['@context']) this.jsonld_context = classframes[j]['@context'];\r\n\r\n\t\tconst cf = new ClassFrame(classframes[j]);\r\n\t\tif (cf.isValid()) {\r\n\t\t\tif (typeof this.classframes[classframes[j].property] === 'undefined') {\r\n\t\t\t\tthis.classframes[classframes[j].property] = [];\r\n\t\t\t}\r\n\t\t\tthis.classframes[classframes[j].property] = cf;\r\n\t\t\tif (cf.isObject() && this.properties[classframes[j].property]) {\r\n\t\t\t\tfor (let i = 0; i < this.properties[classframes[j].property].values.length; i += 1) {\r\n\t\t\t\t\tthis.properties[classframes[j].property].values[i].loadClassFrames(classframes[j].frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/**\r\n * Does this object have a schema loaded?\r\n */\r\nObjectFrame.prototype.hasSchema = function () {\r\n\treturn !FrameHelper.empty(this.classframes);\r\n};\r\n\r\n/*\r\n * Loads an array of data frames into the object's internal index\r\n * {property: [frames]}\r\n */\r\nObjectFrame.prototype.loadDataFrames = function (frames) {\r\n\tif (typeof frames !== 'object' || !frames.length) return undefined;\r\n\tif (!this.originalFrames) this.originalFrames = frames;\r\n\tif (!this.subjid && frames[0].domainValue) this.subjid = frames[0].domainValue;\r\n\tfor (let i = 0; i < frames.length; i += 1) {\r\n\t\tif (frames[i]['@context']) this.jsonld_context = frames[i]['@context'];\r\n\t\tlet cframe = this.getPropertyClassFrame(frames[i].property, frames[i]);\r\n\t\tif (cframe.isClassChoice()) {\r\n\t\t\tcframe = cframe.getChosenClassFrame(frames[i].range);\r\n\t\t\tif (!cframe) {\r\n\t\t\t\tconsole.log(`no choice frame ${frames[i].range}`);\r\n\t\t\t}\r\n\t\t} else if (cframe.isLogic()) {\r\n\t\t\tcframe = cframe.getChosenFrame(frames[i]);\r\n\t\t}\r\n\t\tif(cframe){\r\n\t\t\tif (typeof this.properties[frames[i].property] === 'undefined') {\r\n\t\t\t\tthis.properties[frames[i].property] = new PropertyFrame(frames[i].property, cframe, this);\r\n\t\t\t}\r\n\t\t\tthis.properties[frames[i].property].addFrame(frames[i])\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Serialises the javascript object as an array of frames\r\n */\r\nObjectFrame.prototype.getAsFrame = function (prop, parent) {\r\n\tif (this.parentframe) return this.parentframe;\r\n\tconst ff = { type: 'objectProperty', property: prop };\r\n\tff.range = this.cls;\r\n\tff.domain = parent.cls;\r\n\tff.domainValue = parent.subjid;\r\n\tff.frame = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tff.frame = ff.frame.concat(ff.frame, this.properties[prop].getAsFrames())\r\n\t}\r\n\treturn ff;\r\n};\r\n\r\nObjectFrame.prototype.isnew = function () {\r\n\treturn this.newDoc;\r\n};\r\n\r\n/**\r\n * Cleans out object and sets everything empty\r\n */\r\nObjectFrame.prototype.empty = function () {\r\n\t// all indexed by property\r\n\tthis.properties = {};\r\n\tthis.restrictions = {};\r\n\tthis.children = {};\r\n\tthis.subjid = false;\r\n\tthis.cls = false;\r\n};\r\n\r\n/*\r\n * Resets object state to original state\r\n */\r\nObjectFrame.prototype.reset = function (prop) {\r\n\tif (prop) {\r\n\t\tconst props = [];\r\n\t\tfor (let i = 0; i < this.originalFrames.length; i += 1) {\r\n\t\t\tif (this.originalFrames[i].property === prop) {\r\n\t\t\t\tprops.push(this.originalFrames[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.properties[prop]) this.properties[prop] = [];\r\n\t\tthis.loadDataFrames(props);\r\n\t} else {\r\n\t\tthis.restrictions = {};\r\n\t\tthis.properties = {};\r\n\t\tthis.loadDataFrames(this.originalFrames);\r\n\t}\r\n};\r\n\r\n/*\r\n * Clears out any specific information from a tree\r\n */\r\nObjectFrame.prototype.clear = function () {\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.properties[prop].clear();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Filters the frame and its children\r\n */\r\nObjectFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\tvar hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\tif(hits.length || cascading){\r\n\t\tfor (const prop of Object.keys(this.properties)) {\r\n\t\t\tthis.properties[prop].filter(rules, onmatch, options);\r\n\t\t}\t\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n\r\n\r\n/**\r\n * If a class frame is present, it is returned for the given property\r\n * If no class frame is present and an instance frame is passed in the\r\n * this enables make it up as you go along editing\r\n * second argument a class frame will be created from the instance frame.\r\n */\r\nObjectFrame.prototype.getPropertyClassFrame = function (prop, instance) {\r\n\tif (this.classframes && typeof this.classframes === 'object' && typeof this.classframes[prop] === 'object') {\r\n\t\treturn this.classframes[prop];\r\n\t}\r\n\tif (instance) {\r\n\t\tconst cf = new ClassFrame(instance);\r\n\t\treturn cf;\r\n\t}\r\n\tif(this.properties[prop]){\r\n\t\treturn new ClassFrame(this.properties[prop].values[0]);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/*\r\n * Returns a list of properties - type can be filled|missing|all\r\n */\r\nObjectFrame.prototype.properties = function (type) {\r\n\tif(type == \"filled\"){\r\n\t\treturn Object.keys(this.properties);\r\n\t}\r\n\tif(type == \"missing\"){\r\n\t\tvar filled = Object.keys(this.properties);\r\n\t\tvar all = Object.keys(this.classframes);\r\n\t\tvar missing = [];\r\n\t\tfor(var i = 0; i<all.length; i++){\r\n\t\t\tif(filled.indexOf(all[i]) == -1 && missing.indexOf(all[i]) ==-1){\r\n\t\t\t\tmissing.push(all[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn missing;\r\n\t}\r\n\treturn Object.keys(this.classframes);\r\n}\r\n\r\n/**\r\n * Missing properties are those that are present in the classframe,\r\n * but not instantiated in the current object frame\r\n * for this to work we need to load the frame with the associated classframe\r\n */\r\nObjectFrame.prototype.getMissingPropertyList = function () {\r\n\tvar missing = this.properties(\"missing\");\r\n\tconst nmissing = [];\r\n\tfor(var i = 0; i<missing.length; i++){\r\n\t\tconst cframe = this.getPropertyClassFrame(missing[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: missing[i]};\r\n\t\tnmissing.push(newb);\r\n\t}\r\n\treturn nmissing;\r\n};\r\n\r\n/**\r\n * List of properties that are filled in the object\r\n */\r\nObjectFrame.prototype.getFilledPropertyList = function () {\r\n\tvar props = this.properties(\"filled\");\r\n\tconst filled = [];\r\n\tfor(var i = 0; i<props.length; i++){\r\n\t\tconst cframe = this.getPropertyClassFrame(props[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: props[i]};\r\n\t\tfilled.push(newb);\r\n\t}\r\n\treturn filled;\r\n};\r\n\r\n/*\r\n * Fills the object frame from the schema - adding all the necessary property frames, etc to make it complete\r\n */\r\nObjectFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (newid) this.subjid = newid;\r\n\tnewid = (newid ? newid : FrameHelper.genBNID());\r\n\tlet properties = {};\r\n\tfor (const prop of Object.keys(this.classframes)) {\r\n\t\tconst pf = this.getPropertyClassFrame(prop);\r\n\t\tproperties[prop] = new PropertyFrame(prop, pf);\r\n\t\tproperties[prop].fillFromSchema(newid);\r\n\t}\r\n\tthis.properties = properties;\r\n\tthis.originalFrames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.originalFrames.push(this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Clones an object frame to be a copy of the current frame\r\n */\r\nObjectFrame.prototype.clone = function (newid) {\r\n\tconst properties = {};\r\n\tconst cloned = new ObjectFrame(this.cls, false, false, this.parent);\r\n\tcloned.classframes = this.classframes;\r\n\tcloned.subjid = newid;\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tproperties[prop] = this.properties[prop].clone();\r\n\t}\r\n\tcloned.properties = properties;\r\n\treturn cloned;\r\n};\r\n\r\n\r\n/**\r\n * Returns a child frame with a particular id\r\n * If the second parameter is included, it will only look in that specific property\r\n * Otherwise searches all properties for the child\r\n */\r\nObjectFrame.prototype.getChild = function (childid, prop) {\r\n\tvar pframe = this.getProperty(prop);\r\n\tfor(var i = 0; i<pframe.values.length; pframe++){\r\n\t\tif(pframe.values[i].isObject() && pframe.values[i].subject === childid) return pframe.values[i];\r\n\t}\r\n\tif (!prop) {\r\n\t\tfor (const key of Object.keys(this.properties)) {\r\n\t\t\tfor (let i = 0; i < this.properties[key].values.length; i += 1) {\r\n\t\t\t\tif (this.properties[key].values[i].subject() === childid) return this.properties[key].values[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.addProperty = function (prop, cls) {\r\n\tconst cframe = this.getPropertyClassFrame(prop);\r\n\tconst nprop = new PropertyFrame(prop, cframe);\r\n\tif (nprop.isData()) {\r\n\t\tconst df = cframe.copy();\r\n\t\tdf.set('');\r\n\t}\r\n\tif (cframe.isObject()) {\r\n\t\tif (!cframe.isClassChoice()) {\r\n\t\t\tconst df = cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t}\r\n\t\tif (cls) {\r\n\t\t\tconst df = cframe.createEmptyChoice(cls, FrameHelper.genBNID());\r\n\t\t}\r\n\t\tconst clss = cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t}\r\n\t}\r\n\tif(typeof this.properties[prop] == \"undefined\"){\r\n\t\tthis.properties[prop] = [];\r\n\t}\r\n\tthis.properties[prop].push(df);\r\n\treturn df;\r\n};\r\n\r\nObjectFrame.prototype.addPropertyValue = function (prop, value) {\r\n\tconst pframe = this.properties[prop];\r\n\treturn pframe.addValue(value);\r\n};\r\n\r\nObjectFrame.prototype.removeProperty = function (prop) {\r\n\tif (typeof this.properties[prop] !== 'undefined') {\r\n\t\tdelete (this.properties[prop]);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.removePropertyValue = function (prop, value, index) {\r\n\tconst pframe = this.properties[prop];\r\n\tpframe.removeValue(value, index);\r\n\tif(pframe.values.length == 0){\r\n\t\tthis.removeProperty(prop);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.error = function (msg) {\r\n\tconsole.error(msg);\r\n};\r\n\r\n\r\nObjectFrame.prototype.subject = function(){\r\n\treturn this.subjid;\r\n}\r\n\r\nObjectFrame.prototype.get = ObjectFrame.prototype.subject;\r\n\r\nObjectFrame.prototype.isObject = function () { return true; };\r\nObjectFrame.prototype.isProperty = function () { return false; };\r\nObjectFrame.prototype.isData = function () { return false; };\r\n\r\n\r\nObjectFrame.prototype.subjectClass = function(){\r\n\treturn this.cls;\r\n}\r\n\r\nObjectFrame.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\nObjectFrame.prototype.getProperty = function(prop){\r\n\treturn this.properties[prop];\r\n}\r\n\r\nObjectFrame.prototype.first = function(prop){\r\n\tif(this.properties && this.properties[prop]){\r\n\t\treturn this.properties[prop].first();\r\n\t}\r\n}\r\n\r\nObjectFrame.prototype.property = function(prop){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectFrame.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectFrame.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectFrame.prototype.renderProperties = function(){\r\n\tvar props = this.sortProperties();\r\n\tvar nprops = [];\r\n\tfor(var i = 0; i<props.length; i++){\r\n\t\tif(this.properties[props[i]].render){\r\n\t\t\tvar rend = this.properties[props[i]].render(this.properties[props[i]]);\r\n\t\t\tif(rend) nprops.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn nprops;\r\n}\r\n\r\nObjectFrame.prototype.sortProperties = function(){\r\n\tconst unsorted = Object.keys(this.properties);\r\n\tif(this.compare){\r\n\t\treturn unsorted.sort((a, b) => {\r\n\t\t\treturn this.compare(a, b, this)\r\n\t\t});\r\n\t}\r\n\treturn unsorted.sort((a, b) => {\r\n\t\treturn this.standardCompare(a, b, this);\r\n\t})\r\n}\r\n\r\n/*\r\n * Label first, then datatype properties, then object properties\r\n */\r\nObjectFrame.prototype.standardCompare = function(a, b, doc){\r\n\tif(a == \"rdfs:label\") return -1;\r\n\tif(b == \"rdfs:label\") return 1;\r\n\tif(a == \"rdfs:comment\") return -1;\r\n\tif(b == \"rdfs:comment\") return 1;\r\n\tif(doc.properties[a].isData() && doc.properties[b].isObject() ) return -1;\r\n\tif(doc.properties[b].isData() && doc.properties[a].isObject() ) return 1;\r\n\treturn 0;\r\n}\r\n\r\n\r\nfunction PropertyFrame(property, cframe, parent){\r\n\tthis.predicate = property;\r\n\tthis.cframe = cframe;\r\n\tthis.parent = parent;\r\n\tthis.values = [];\r\n}\r\n\r\nPropertyFrame.prototype.addFrame = function (frame) {\r\n\tif(this.cframe.isData()){\r\n\t\tvar df = new DataFrame(frame, this);\r\n\t\tthis.values.push(df);\r\n\t}\r\n\telse {\r\n\t\tconst kid = new ObjectFrame(this.range(), cframe.frame, frame.frame, this, frame);\r\n\t\tthis.values.push(kid);\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.fillFromSchema = function(newid){\r\n\tif (this.isData() || (this.isObject() && !this.isClassChoice())) {\r\n\t\tif (this.hasRestriction() && this.restriction.min) {\r\n\t\t\tvalues = [];\r\n\t\t\tfor (let i = 0; i < this.restriction.min; i += 1) {\r\n\t\t\t\tvalues.push(this.createEmpty(newid));\r\n\t\t\t}\r\n\t\t} \r\n\t\telse {\r\n\t\t\tvalues = [this.createEmpty(newid)];\r\n\t\t}\r\n\t} \r\n\telse if (this.isClassChoice()) {\r\n\t\tconst clss = this.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst empty = this.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\tvalues = [empty];\r\n\t\t}\r\n\t}\r\n\tthis.values = values;\r\n}\r\n\r\nPropertyFrame.prototype.isData = function(){\r\n\treturn this.cframe.isData();\r\n}\r\n\r\nPropertyFrame.prototype.isObject = function () { \r\n\treturn this.cframe.isObject() \r\n};\r\n\r\nPropertyFrame.prototype.isProperty = function () { \r\n\treturn true; \r\n};\r\n\r\nPropertyFrame.prototype.property = function(){\r\n\treturn this.predicate;\r\n}\r\n\r\nPropertyFrame.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n\treturn extracts;\r\n}\r\n\r\nPropertyFrame.prototype.subject = function(){\r\n\treturn (this.parent ? this.parent.subject() : false);\r\n}\r\nPropertyFrame.prototype.subjectClass = function(){\r\n\treturn (this.parent ? this.parent.subjectClass() : false);\r\n}\r\nPropertyFrame.prototype.depth = function(){\r\n\treturn (this.parent ? this.parent.depth() : false);\r\n}\r\nPropertyFrame.prototype.updated = function(){ \r\n\treturn (this.parent ? this.parent.childUpdated() : false);\r\n}\r\nPropertyFrame.prototype.range = function(){\t\r\n\treturn (this.cframe ? this.cframe.range : \"\");\r\n}\r\nPropertyFrame.prototype.getLabel = function(){ return (\r\n\t\tthis.cframe ? this.cframe.getLabel() : \"\" );\r\n}\r\nPropertyFrame.prototype.getComment = function(){ \r\n\treturn (this.cframe ? this.cframe.getComment() : false);\r\n}\r\nPropertyFrame.prototype.hasCardinalityRestriction = function(){\r\n\treturn (this.cframe ? this.cframe.hasRestriction() : false);\r\n}\r\nPropertyFrame.prototype.getRestriction = function(){\r\n\treturn (this.cframe ? this.cframe.restriction : false);\r\n}\r\nPropertyFrame.prototype.isClassChoice = function(){\t\r\n\treturn (this.cframe ? this.cframe.isClassChoice() : false);\r\n}\r\n\r\nPropertyFrame.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.removePropertyValue(this.property(), value, index);\r\n}\r\n\r\nPropertyFrame.prototype.get = function(){\r\n\tvar gets = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tgets.push(this.values[i].get());\r\n\t}\r\n\treturn get;\r\n}\r\n\r\n\r\nPropertyFrame.prototype.clear = function(){\r\n\talert(\"need clear\");\r\n}\r\nPropertyFrame.prototype.clone = function(){\r\n\talert(\"need clone\");\r\n}\r\n\r\nPropertyFrame.prototype.getAsFrames = function(){\r\n\talert(\"need gaf\");\r\n}\r\n\r\nPropertyFrame.prototype.createEmpty = function(){\r\n\talert(\"creatempty\");\r\n}\r\n\r\nPropertyFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\tvar hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\tif(hits.length || cascading){\r\n\t\tfor (var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].filter(rules, onmatch, options);\r\n\t\t}\t\r\n\t}\r\n\treturn this;\t\r\n}\r\n\r\n/*\r\n * Shorthand functions to make it easier to access the underlying data\r\n */\r\n\r\nPropertyFrame.prototype.first = function(){\r\n\tif(this.values && this.values[0]){\r\n\t\treturn this.values[0].get();\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.renderValues = function(){\r\n\tvar sortedVals = this.sortValues();\r\n\tvar vals = [];\r\n\tfor(var i = 0; i<sortedVals.length; i++){\r\n\t\tif(sortedVals[i].render){\r\n\t\t\tvar rend = sortedVals[i].render(sortedVals[i]);\r\n\t\t\tif(rend) vals.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n}\r\n\r\nPropertyFrame.prototype.sortValues = function(){\r\n\tif(this.compare){\r\n\t\treturn this.values.sort((a, b) => {\r\n\t\t\treturn this.compare(a, b, this)\r\n\t\t});\r\n\t}\r\n\treturn this.values;\r\n}\r\n\r\nfunction DataFrame(frame, parent) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nDataFrame.prototype.load = function (frame) {\r\n\tif (typeof frame !== 'object') {\r\n\t\tthis.error('No frame passed to load');\r\n\t\treturn;\r\n\t}\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = frame.type;\r\n\tthis.predicate = frame.property;\r\n\tthis.range = frame.range;\r\n\tthis.rangeValue = frame.rangeValue;\r\n\tthis.domain = frame.domain;\r\n\tthis.domainValue = frame.domainValue;\r\n\tthis.frame = frame.frame;\r\n\tthis.label = frame.label;\r\n\tthis.comment = frame.comment;\r\n\tconst { restriction } = frame;\r\n\tthis.restriction = false;\r\n\tif (restriction && typeof restriction === 'object') {\r\n\t\tthis.restriction = new Restriction(restriction);\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.filter = function (rules, onmatch) {\r\n\tFramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\treturn this;\t\r\n}\r\n\r\nDataFrame.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.get(), this.index);\r\n}\r\n\r\nDataFrame.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nDataFrame.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\t//this.redraw();\r\n}\r\n\r\nDataFrame.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.get());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n}\r\n\r\n\r\nDataFrame.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nDataFrame.prototype.property = function(){ return (this.parent ? this.parent.property() : false);};\r\nDataFrame.prototype.subject = function(){ return (this.parent ? this.parent.subject() : false);};\r\nDataFrame.prototype.subjectClass = function(){ return (this.parent ? this.parent.subjectClass() : false);};\r\nDataFrame.prototype.range = function(){\treturn (this.frame ? this.frame.range : false);};\r\n\r\nDataFrame.prototype.isValidType = function (dt) {\r\n\tconst vtypes = ['datatypeProperty', 'objectProperty', 'restriction '];\r\n\tif (vtypes.indexOf(dt) === -1) return false;\r\n\treturn true;\r\n};\r\n\r\n\r\nDataFrame.prototype.getAsFrame = function () {\r\n\t const ff = { type: this.type, property: this.property() };\r\n\t if (this.range) ff.range = this.range;\r\n\t if (this.rangeValue) ff.rangeValue = this.rangeValue;\r\n\t if (this.domain) ff.domain = this.domain;\r\n\t if (this.domainValue) ff.domainValue = this.domainValue;\r\n\t if (this.frame) ff.frame = this.frame;\r\n\t if (this.label) ff.label = this.label;\r\n\t if (this.comment) ff.comment = this.comment;\r\n\t return ff;\r\n};\r\n\r\nDataFrame.prototype.hasRestriction = function () {\r\n\t if (this.restriction) {\r\n\t\t return this.restriction.hasCardRestriction();\r\n\t }\r\n\t return false;\r\n};\r\n\r\nDataFrame.prototype.copy = function (newid) {\r\n\tconst copy = new DataFrame(this, this.parent);\r\n\tif (newid) copy.domainValue = newid;\r\n\treturn copy;\r\n};\r\n\r\nDataFrame.prototype.getLabel = function () {\r\n\tlet lab = '';\r\n\tif (this.label && typeof this.label === 'object') lab = this.label['@value'];\r\n\tif (this.label && typeof this.label === 'string') lab = this.label;\r\n\t// always return something\r\n\tif (!lab && this.property()) lab = FrameHelper.labelFromURL(this.property());\r\n\tif (!lab) lab = FrameHelper.labelFromURL(this.cls);\r\n\treturn lab;\r\n};\r\n\r\nDataFrame.prototype.getType = function () {\r\n\tif (this.range) return this.range;\r\n\tif (this.rangeValue && this.rangeValue.type) return this.rangeValue.type;\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.getLabel = DataFrame.prototype.getLabel;\r\n\r\nDataFrame.prototype.getComment = function () {\r\n\tlet comment = '';\r\n\tif (this.comment && typeof this.comment === 'object') comment = this.comment['@value'];\r\n\tif (this.comment && typeof this.comment === 'string') comment = this.comment;\r\n\treturn comment;\r\n};\r\n\r\nObjectFrame.prototype.getComment = DataFrame.prototype.getComment;\r\n\r\n\r\nDataFrame.prototype.error = function (msg) {\r\n\tif (msg)\tthis.err = msg;\r\n\treturn this.err;\r\n};\r\n\r\nDataFrame.prototype.isValid = function () {\r\n\tif (!(this.type && this.isValidType(this.type))) {\r\n\t\tthis.error(`Missing or Illegal Frame Type ${this.type}`);\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.predicate)) {\r\n\t\tthis.error('Missing Frame Property');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.domain)) {\r\n\t\tthis.error('Missing Frame Domain');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.range)) {\r\n\t\tthis.error('Missing Frame Range');\r\n\t\treturn false;\r\n\t}\r\n\tif (this.isObjectProperty() && !(this.frame && typeof this.frame === 'object')) {\r\n\t\tthis.error('Missing Object Frame');\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nDataFrame.prototype.isObjectProperty = function () {\r\n\treturn this.type === 'objectProperty';\r\n};\r\n\r\nDataFrame.prototype.isDatatypeProperty = function () {\r\n\treturn this.type === 'datatypeProperty';\r\n};\r\n\r\nDataFrame.prototype.isLogic = function () {\r\n\tif (this.type === 'and' || this.type === 'or' || this.type === 'xor') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.isRestriction = function () {\r\n\treturn this.type === 'restriction';\r\n};\r\n\r\nDataFrame.prototype.ftype = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isDatatypeProperty()) return 'data';\r\n\tif (this.isChoice()) return 'oneOf';\r\n\tif (this.isObject()) return 'object';\r\n\tif (this.isLogic()) return 'logic';\r\n\tif (this.isClassChoice()) return 'class_choice';\r\n\treturn undefined;\r\n};\r\n\r\n\r\nDataFrame.prototype.isClassChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'class_choice');\r\n};\r\n\r\nDataFrame.prototype.isString = function () {\r\n\tif (this.range === FrameHelper.getStdURL('xsd', 'string')) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getChoiceOptions = function () {\r\n\tconst opts = [];\r\n\tfor (let i = 0; i < this.frame.elements.length; i += 1) {\r\n\t\tconst option = {};\r\n\t\tif (this.frame.elements[i].label) {\r\n\t\t\toption.label = this.frame.elements[i].label['@value'];\r\n\t\t} else {\r\n\t\t\toption.label = FrameHelper.labelFromURL(this.frame.elements[i].class);\r\n\t\t}\r\n\t\toption.value = this.frame.elements[i].class;\r\n\t\topts.push(option);\r\n\t}\r\n\treturn opts;\r\n};\r\n\r\nDataFrame.prototype.lang = function () {\r\n\treturn 'en';\r\n};\r\n\r\nDataFrame.prototype.isChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'oneOf');\r\n};\r\n\r\nDataFrame.prototype.isDocument = function () {\r\n\treturn (this.frame && this.frame.type === 'document');\r\n};\r\n\r\nDataFrame.prototype.isData = function () {\r\n\treturn (this.isDocument() || this.isChoice() || this.isDatatypeProperty());\r\n};\r\n\r\nDataFrame.prototype.isObject = function () {\r\n\treturn (this.isObjectProperty() && this.frame && !(this.isChoice() || this.isDocument()));\r\n};\r\n\r\nDataFrame.prototype.isProperty = function () {\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getTypeShorthand = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isChoice()) return 'choice';\r\n\tconst sh = FrameHelper.getShorthand(this.getType());\r\n\treturn (sh || this.getType());\r\n};\r\n\r\nDataFrame.prototype.get = function () {\r\n\tif (this.contents) {\r\n\t\treturn this.contents;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue && typeof this.rangeValue['@value'] !== 'undefined') {\r\n\t\treturn this.rangeValue['@value'];\r\n\t}\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\treturn this.frame.domainValue;\r\n\t}\r\n\treturn '';\r\n};\r\n\r\nDataFrame.prototype.set = function (value, normalizer) {\r\n\tif (normalizer) value = normalizer(value, this);\r\n\tthis.contents = value;\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\tthis.frame.domainValue = value;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue) {\r\n\t\tthis.rangeValue['@value'] = value;\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.clear = function () {\r\n\tif (this.isDocument() || this.isChoice() || this.isDatatypeProperty()) {\r\n\t\tthis.set('');\r\n\t}\r\n};\r\n\r\n/*\r\n * Class frames represent the archetypal version of a property frame as returned by the class frame api\r\n */\r\nfunction ClassFrame(frame, parent) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\tthis.children = {};\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nClassFrame.prototype = DataFrame.prototype;\r\n\r\nClassFrame.prototype.loadFromObjectFrame = function (par, child) {\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = 'objectProperty';\r\n\tthis.predicate = par.property;\r\n\tthis.range = par.range;\r\n\tthis.rangeValue = child.subjid;\r\n\tthis.domain = par.cls;\r\n\tthis.domainValue = par.subjid;\r\n\tthis.label = par.getLabel();\r\n\tthis.comment = par.getComment();\r\n\tthis.restriction = par.restriction;\r\n};\r\n\r\nClassFrame.prototype.createEmptyChoice = function (cls, newid) {\r\n\tconst cf = this.getChosenClassFrames(cls);\r\n\tconst objframe = new ObjectFrame(cls);\r\n\tif (newid) objframe.subjid = newid;\r\n\tobjframe.loadClassFrames(cf);\r\n\tconst fframe = objframe.fillFromSchema();\r\n\treturn fframe;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrames = function (chosen) {\r\n\tlet nc = [];\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\tif (chosen === this.frame.operands[i][j].domain) {\r\n\t\t\t\tnc = nc.concat(this.frame.operands[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nc;\r\n};\r\n\r\nClassFrame.prototype.createEmpty = function (newid) {\r\n\tif (this.isObject()) {\r\n\t\tconst objframe = new ObjectFrame(this.range);\r\n\t\tif (newid) objframe.subjid = newid;\r\n\t\tobjframe.loadClassFrames(this.frame);\r\n\t\tconst fframe = objframe.fillFromSchema();\r\n\t\treturn fframe;\r\n\t}\r\n\tif (this.isData()) {\r\n\t\tconst dataframe = this.copy();\r\n\t\tdataframe.set('');\r\n\t\treturn dataframe;\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.cloneDataFrame = function (newid, other) {\r\n\treturn other;\r\n};\r\n\r\nClassFrame.prototype.clone = function (newid, other) {\r\n\tif (this.isObject()) {\r\n\t\tconsole.log('cannot clone class frame');\r\n\t} else if (this.isData()) {\r\n\t\treturn this.cloneDataFrame(newid, other);\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.getClassChoices = function () {\r\n\tconst choices = [];\r\n\tif (this.frame.operands) {\r\n\t\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\t\tconst domcls = this.frame.operands[i][j].domain;\r\n\t\t\t\tif (domcls && choices.indexOf(domcls) === -1) {\r\n\t\t\t\t\tchoices.push(domcls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrame = function (chosen) {\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tconst operand = this.frame.operands[i];\r\n\t\tif (operand.length) {\r\n\t\t\tfor (let j = 0; j < operand.length; j += 1) {\r\n\t\t\t\tif (operand[j] && (chosen === operand[j].domain)) {\r\n\t\t\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\t\t\treturn cf;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (operand.range && chosen === operand.range) {\r\n\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\treturn cf;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nClassFrame.prototype.getChosenFrame = function (dataframe) {\r\n\treturn dataframe;\r\n};\r\n\r\n\r\nfunction Restriction(restriction) {\r\n\tthis.min = 0;\r\n\tthis.max = 0;\r\n\tif (restriction) this.loadRestriction(restriction);\r\n}\r\n\r\nRestriction.prototype.hasCardRestriction = function () {\r\n\tif (this.min === 0 && this.max === 0) return false;\r\n\treturn true;\r\n};\r\n\r\nRestriction.prototype.loadRestriction = function (restriction) {\r\n\tif (typeof restriction.cardinality !== 'undefined') {\r\n\t\tthis.max = restriction.cardinality;\r\n\t\tthis.min = restriction.cardinality;\r\n\t} else if (typeof restriction.maxCardinality !== 'undefined') {\r\n\t\tthis.max = restriction.maxCardinality;\r\n\t} else if (typeof restriction.minCardinality !== 'undefined') {\r\n\t\tthis.min = restriction.minCardinality;\r\n\t} else if (typeof restriction.type !== 'undefined' && restriction.type === 'and' && typeof restriction.operands === 'object') {\r\n\t\tfor (let i = 0; i < restriction.operands.length; i += 1) {\r\n\t\t\tconst nrest = new Restriction(restriction.operands[i]);\r\n\t\t\tif (this.max === 0 && nrest.max > 0) this.max = nrest.max;\r\n\t\t\telse if (this.max > 0 && nrest.max > 0 && nrest.max < this.max) this.max = nrest.max;\r\n\t\t\tif (this.min === 0 && nrest.min > 0) this.min = nrest.min;\r\n\t\t\telse if (this.min > 0 && nrest.min > 0 && nrest.min > this.min) this.min = nrest.min;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nmodule.exports = ObjectFrame;\r\n","/**\r\n * The WOQL object is a wrapper around the WOQL query object\r\n * Syntactic sugar to allow you to write WOQL.triple()... instead of new WOQLQuery().triple()\r\n * Every function matches one of the public api functions of the woql query object\r\n */\r\nconst FramePattern = require('./framePattern');\r\nconst FrameHelper = require('./frameHelper');\r\n\r\nconst WOQL = {};\r\nWOQL.when = function(Query, Update){ return new WOQLQuery().when(Query, Update);}\r\nWOQL.opt = function(query){ return new WOQLQuery().opt(query); }\r\nWOQL.from = function(dburl, query){ return new WOQLQuery().from(dburl, query); }\r\nWOQL.limit = function(limit, query){ return new WOQLQuery().limit(limit, query); }\r\nWOQL.select = function(...list){ return new WOQLQuery().select(...list); }\r\nWOQL.or = function(...queries){\treturn new WOQLQuery().or(...queries); }\r\nWOQL.and = function(...queries){ return new WOQLQuery().and(...queries); }\r\nWOQL.not = function(query){ return new WOQLQuery().not(query); }\r\nWOQL.triple = function(a, b, c){ return new WOQLQuery().triple(a, b, c); }\r\nWOQL.quad = function(a, b, c, d){ return new WOQLQuery().quad(a, b, c, d); }\r\nWOQL.eq = function(a, b){ return new WOQLQuery().eq(a, b);}\r\nWOQL.sub = function(a, b){ return new WOQLQuery().sub(a, b); }\r\nWOQL.isa = function(a, b){\treturn new WOQLQuery().isa(a, b);\t}\r\nWOQL.trim = function(a, b){\treturn new WOQLQuery().trim(a, b);\t}\r\nWOQL.delete = function(JSON_or_IRI){ return new WOQLQuery().delete(JSON_or_IRI);\t}\r\nWOQL.minus_triple = function( S, P, O ){ return new WOQLQuery().minus_triple (S, P, O);\t}\r\nWOQL.plus_triple = function( S, P, O ){ return new WOQLQuery().plus_triple (S, P, O); }\r\nWOQL.minus_quad = function( S, P, O, G ){ return new WOQLQuery().minus_triple (S, P, O, G); }\r\nWOQL.plus_quad = function( S, P, O, G ){ \treturn new WOQLQuery().plus_triple (S, P, O, G);}\r\nWOQL.eval = function(arith, v){\treturn new WOQLQuery().eval(arith, v);}\r\nWOQL.plus = function(...args){\treturn new WOQLQuery().plus(...args);}\r\nWOQL.minus = function(...args){\treturn new WOQLQuery().minus(...args); }\r\nWOQL.times = function(...args){\treturn new WOQLQuery().times(...args); }\r\nWOQL.divide = function(...args){ return new WOQLQuery().divide(...args); }\r\nWOQL.exp = function(a, b){\treturn new WOQLQuery().exp(a, b); }\r\nWOQL.json = function(json){\treturn new WOQLQuery().json(json); }\r\nWOQL.rule = function(){\treturn new FramePattern.FrameRule() }\r\n\r\n\r\nfunction WOQLQuery(query, results){\r\n\tthis.query = (query ? query : {});\r\n\tthis.cursor = this.query;\r\n\tthis.results = (results ? results : false);\r\n\tthis.chain_ended = false;\r\n\tthis.contains_update = false;\r\n\t//operators which preserve global paging\r\n\tthis.paging_transitive_properties = ['select', 'from', 'start', 'when', 'opt', 'limit'];\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Control Functions\r\n */\r\n\r\n/**\r\n * Advances internal cursor to support chaining of calls: limit(50).start(50). rather than (limit, [50, (start, [50, (lisp-style (encapsulation)))))\r\n */\r\nWOQLQuery.prototype.advanceCursor = function(action, value){\r\n\tthis.cursor[action] = [value];\r\n\tthis.cursor[action][1] = {};\r\n\tthis.cursor = this.cursor[action][1];\r\n}\r\n\r\n/**\r\n * Called to indicate that this is the last call that is chainable - for example triple pattern matching..\r\n *\r\n */\r\nWOQLQuery.prototype.last = function(){\r\n\tthis.chain_ended = true;\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.isPaged = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"limit\") return true;\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\treturn this.isPaged(q[prop][q[prop].length-1])\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.getPagingProperty = function(pageprop, q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == pageprop) return q[prop][0];\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar val = this.getPagingProperty(pageprop, q[prop][q[prop].length-1]);\r\n\t\t\tif(typeof val != \"undefined\"){\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPagingProperty = function(pageprop, val, q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == pageprop) {\r\n\t\t\tq[prop][0] = val;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tthis.setPagingProperty(pageprop, val, q[prop][q[prop].length-1]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.addStart = function(val, q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == limit) {\r\n\t\t\tvar nval = { \"start\": [0, q[prop][1]]}\r\n\t\t\tq[prop][1] = nval;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tthis.addStart(val, q[prop][q[prop].length-1]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.getContext = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"@context\") return q[prop];\r\n\t\tif(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar nq = q[prop][1];\r\n\t\t\tvar nc = this.getContext(nq);\r\n\t\t\tif(nc) return nc;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.nspaces = function(n){\r\n\tlet spaces = \"\";\r\n\tfor(var i = 0; i<n; i++){\r\n\t\tspaces += \" \";\r\n\t}\r\n\treturn spaces;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.prettyPrint = function(indent, show_context, q){\r\n\tq = (q ? q : this.query);\r\n\tvar str = \"\";\r\n\tfor(var key in q){\r\n\t\tif(key == \"@context\"){\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\tstr += key;\r\n\t\t\tvar val = q[key];\r\n\t\t\tif(key == \"and\" || key == \"or\"){\r\n\t\t\t\tvar clauses = []\r\n\t\t\t\tfor(var i = 0; i<val.length; i++){\r\n\t\t\t\t\tvar nxt = this.prettyPrint(indent+4, show_context, val[i]);\r\n\t\t\t\t\tclauses.push(nxt)\r\n\t\t\t\t}\r\n\t\t\t\tstr += \"(\\n\" + this.nspaces(indent) + \"WOQL.\" + clauses.join(\",\\n\"+ this.nspaces(indent) + \"WOQL.\") + \"\\n\" + \")\";\r\n\r\n\t\t\t}\r\n\t\t\telse if(typeof val[val.length-1] == \"object\" ){\r\n\t\t\t\tvar nvals = []\r\n\t\t\t\tfor(var i = 0; i<val.length-1; i++){\r\n\t\t\t\t\tif(key == \"limit\" || key == \"start\"){\r\n\t\t\t\t\t\tnvals.push(val[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tnvals.push('\"'+val[i]+'\"');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(nvals.length){\r\n\t\t\t\t\tstr += \"(\" + nvals.join(\",\");\r\n\t\t\t\t\tif(key == \"from\") str += \")\\n.\";\r\n\t\t\t\t\telse str +=\").\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tstr += \"().\";\r\n\t\t\t\t}\r\n\t\t\t\tstr += this.prettyPrint(indent, show_context, val[val.length-1]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstr += '(\"' + val.join('\", \"') + '\")';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLQuery.prototype.setLimit = function(limit){\r\n\treturn this.setPagingProperty(\"limit\", limit);\r\n}\r\n\r\nWOQLQuery.prototype.getLimit = function(){\r\n\treturn this.getPagingProperty(\"limit\");\r\n}\r\n\r\nWOQLQuery.prototype.getPage = function(){\r\n\tif(this.isPaged()){\r\n\t\tvar psize = this.getLimit();\r\n\t\tif(this.hasStart()){\r\n\t\t\tvar s = this.getStart();\r\n\t\t\treturn (parseInt(s / psize) + 1);\r\n\t\t}\r\n\t\telse return 1;\r\n\t}\r\n\telse return false;\r\n}\r\n\r\nWOQLQuery.prototype.setPage = function(pagenum){\r\n\tvar pstart = (this.getLimit() * (pagenum - 1));\r\n\tif(this.hasStart()){\r\n\t\tthis.setStart(pstart);\r\n\t}\r\n\telse {\r\n\t\tthis.addStart(pstart);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.hasStart = function(){\r\n\treturn (typeof this.getPagingProperty(\"start\") != \"undefined\");\r\n}\r\n\r\nWOQLQuery.prototype.getStart = function(){\r\n\treturn this.getPagingProperty(\"start\");\r\n}\r\n\r\nWOQLQuery.prototype.nextPage = function(){\r\n\treturn this.setPage(this.getPage() + 1);\r\n}\r\n\r\nWOQLQuery.prototype.firstPage = function(){\r\n\treturn this.setPage(1);\r\n}\r\n\r\nWOQLQuery.prototype.previousPage = function(){\r\n\tconst npage = this.getPage() - 1;\r\n\tif(npage > 0) this.setPage(npage);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.hasSelect = function(){\r\n\treturn this.getPagingProperty(\"select\");\r\n}\r\n\r\nWOQLQuery.prototype.getSelectVariables = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"select\") {\r\n\t\t\tvar vars = q[prop].slice(0, q[prop].length - 1);\r\n\t\t\treturn vars;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar val = this.getSelectVariables(q[prop][q[prop].length-1]);\r\n\t\t\tif(typeof val != \"undefined\"){\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nWOQLQuery.prototype.setStart = function(start){\r\n\treturn this.setPagingProperty(\"start\", start);\r\n}\r\n\r\nWOQLQuery.prototype.setPageSize = function(size){\r\n\tthis.setPagingProperty(\"limit\", size);\r\n\tif(this.hasStart()){\r\n\t\tthis.setStart(0);\r\n\t}\r\n\telse {\r\n\t\tthis.addStart(0);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Called to indicate an update that is the last chainable element in a query\r\n */\r\nWOQLQuery.prototype.lastUpdate = function(){\r\n\tthis.last();\r\n\tthis.contains_update = true;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * JSON context specifying prefixes\r\n */\r\nWOQLQuery.prototype.context = function(Context){\r\n\tthis.cursor[\"@context\"] = Context;\r\n}\r\n\r\nWOQLQuery.prototype.defaultContext = function(DB_IRI){\r\n\tlet def = {}\r\n\tfor(var pref in FrameHelper.standard_urls){\r\n\t\tdef[pref] = FrameHelper.standard_urls[pref];\r\n\t}\r\n\tdef.scm = DB_IRI + \"/schema#\"\r\n\tdef.doc = DB_IRI + \"/document/\"\r\n\tdef.db = DB_IRI + \"/\";\r\n\treturn def;\r\n}\r\n\r\n\r\n/**\r\n * Executes the query using the passed client to connect to a server\r\n */\r\nWOQLQuery.prototype.execute = function(client){\r\n\tif(!this.query[\"@context\"]){\r\n\t\tthis.query[\"@context\"] = this.defaultContext(client.connectionConfig.dbURL());\r\n\t\tvar json = this.json();\r\n\t}\r\n\telse {\r\n\t\tvar json = this.json();\r\n\t}\r\n\tif(this.contains_update){\r\n\t\treturn client.update(false, json);\r\n\t}\r\n\telse {\r\n\t\treturn client.select(false, json);\r\n\t}\r\n}\r\n\r\n/*\r\n * json version of query for passing to api\r\n */\r\nWOQLQuery.prototype.json = function(json){\r\n\tif(json){\r\n\t\tthis.query = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.query;\r\n}\r\n\r\n/*\r\n * Functions which take a query as an argument advance the cursor to make the chaining of queries fall\r\n * into the corrent place in the encompassing json\r\n */\r\nWOQLQuery.prototype.when = function(Query, Update){\r\n\tthis.advanceCursor(\"when\", Query);\r\n\tif(Update){\r\n\t\tthis.cursor = Update.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.opt = function(query){\r\n\tif(query){\r\n\t\tthis.cursor[\"opt\"] = [query];\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['opt'] = [{}];\r\n\t\tthis.cursor = this.cursor[\"opt\"][0];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.from = function(dburl, query){\r\n\tthis.advanceCursor(\"from\", dburl);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.limit = function(limit, query){\r\n\tthis.advanceCursor(\"limit\", limit);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.start = function(start, query){\r\n\tthis.advanceCursor(\"start\", start);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.select = function(...list){\r\n\tthis.cursor[\"select\"] = list;\r\n\tvar index = list.length;\r\n\tif(typeof this.cursor['select'][index-1] == \"object\"){\r\n\t\tthis.cursor['select'][index-1] = this.cursor['select'][index-1].json();\r\n\t}\r\n\telse {\r\n\t\tthis.cursor[\"select\"][index] = {};\r\n\t\tthis.cursor = this.cursor[\"select\"][index];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.and = function(...queries){\r\n\tthis.cursor[\"and\"] = [];\r\n\tfor(var i = 0; i<queries.length; i++){\r\n\t\tif(queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor['and'].push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.or = function(queries){\r\n\tthis.cursor[\"or\"] = [];\r\n\tfor(var i = 0; i<queries.length; i++){\r\n\t\tif(queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor['or'].push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.not = function(query){\r\n\tif(query){\r\n\t\tif(query.contains_update) this.contains_update = true;\r\n\t\tthis.cursor[\"not\"] = [query.json()];\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['not'] = [{}];\r\n\t\tthis.cursor = this.cursor[\"not\"][0];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.triple = function(a, b, c){\r\n\tthis.cursor[\"triple\"] = [a,b,c];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.quad = function(a, b, c, g){\r\n\tthis.cursor[\"quad\"] = [a,b,c,g];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.eq = function(a, b){\r\n\tthis.cursor[\"eq\"] = [a,b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.sub = function(a, b){\r\n\tthis.cursor[\"sub\"] = [a,b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.isa = function(a, b){\r\n\tthis.cursor[\"isa\"] = [a,b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.trim = function(a, b){\r\n\tthis.cursor['trim'] = [a, b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.eval = function(arith, v){\r\n\tthis.cursor['eval'] = [arith, v];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.plus = function(...args){\r\n\tthis.cursor['plus'] = args;\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.minus = function(...args){\r\n\tthis.cursor['minus'] = args;\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.times = function(...args){\r\n\tthis.cursor['times'] = args;\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.divide = function(...args){\r\n\tthis.cursor['divide'] = args;\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.exp = function(a, b){\r\n\tthis.cursor['exp'] = [a, b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.delete = function(JSON_or_IRI){\r\n\tthis.cursor['delete'] = [JSON_or_IRI];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\nWOQLQuery.prototype.minus_triple = function( Subject, Predicate, Object_or_Literal ){\r\n\tthis.cursor['minus_triple'] = [ Subject, Predicate, Object_or_Literal ];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\nWOQLQuery.prototype.plus_triple = function( Subject, Predicate, Object_or_Literal ){\r\n\tthis.cursor['plus_triple'] = [ Subject, Predicate, Object_or_Literal ];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\nWOQLQuery.prototype.minus_quad = function( Subject, Predicate, Object_or_Literal, Graph ){\r\n\tthis.cursor['minus_quad'] = [ Subject, Predicate, Object_or_Literal, Graph ];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\nWOQLQuery.prototype.plus_quad = function( Subject, Predicate, Object_or_Literal, Graph){\r\n\tthis.cursor['plus_quad'] = [ Subject, Predicate, Object_or_Literal, Graph ];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\nWOQLQuery.prototype.update = function(json){\r\n\tthis.cursor['update'] = [ json ];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\n/*\r\n * higher level composite queries\r\n */\r\n\r\nWOQLQuery.prototype.abstract = function(varname){\r\n\tvarname = (varname ? varname : \"v:\".FrameHelper.genBNID());\r\n\treturn this.quad(varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\");\r\n}\r\n\r\nWOQLQuery.prototype.getEverything = function(GraphIRI){\r\n\tif(GraphIRI){\r\n\t\treturn this.quad(\"v:Subject\", \"v:Predicate\", \"v:Object\", GraphIRI);\r\n\t}\r\n\telse {\r\n\t\treturn this.triple(\"v:Subject\", \"v:Predicate\", \"v:Object\");\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.getAllDocuments = function(){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Document\", \"rdf:type\", \"v:Type\"),\r\n\t\tWOQL.sub(\"v:Type\", \"tcs:Document\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.documentMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:ID\", \"rdf:type\", \"v:Class\"),\r\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\r\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:label\", \"v:Label\"),\r\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:comment\", \"v:Comment\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Type_Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.propertyMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.or(\r\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:DatatypeProperty\", \"db:schema\"),\r\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:ObjectProperty\", \"db:schema\")\r\n\t\t),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.elementMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.classMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfClass = function(chosen){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Document\", \"rdf:type\", chosen),\r\n\t\tWOQL.opt().triple(\"v:Document\", \"v:Property\", \"v:Value\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfProperty = function(chosen){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Document\", chosen, \"v:Value\"),\r\n\t\tWOQL.opt().triple(\"v:Document\", \"rdfs:label\", \"v:Label\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.documentProperties = function(id){\r\n\treturn this.and(\r\n\t\tWOQL.triple(id, \"v:Property\", \"v:Property_Value\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url){\r\n\treturn this.and(\r\n\t\tWOQL.triple(url, \"rdf:type\", \"v:InstanceType\"),\r\n\t\tWOQL.opt().triple(url, \"rdfs:label\", \"v:InstanceLabel\"),\r\n\t\tWOQL.opt().triple(url, \"rdfs:comment\", \"v:InstanceComment\"),\r\n\t\tWOQL.opt().quad(\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.simpleGraphQuery = function(){\r\n\treturn this.and(\r\n\t    WOQL.triple(\"v:Source\", \"v:Edge\", \"v:Target\"),\r\n\t    WOQL.isa(\"v:Source\", \"v:Source_Class\"),\r\n\t    WOQL.sub(\"v:Source_Class\", \"tcs:Document\"),\r\n\t    WOQL.isa(\"v:Target\", \"v:Target_Class\"),\r\n\t    WOQL.sub(\"v:Target_Class\", \"tcs:Document\"),\r\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:label\", \"v:Source_Label\"),\r\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:comment\", \"v:Source_Comment\"),\r\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:label\", \"v:Source_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:comment\", \"v:Source_Type_Comment\", \"db:schema\"),\r\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:label\", \"v:Target_Label\"),\r\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:comment\", \"v:Target_Comment\"),\r\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:label\", \"v:Target_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:comment\", \"v:Target_Type_Comment\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:label\", \"v:Edge_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:comment\", \"v:Edge_Type_Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nmodule.exports = WOQL ;\r\n","const FrameHelper = require(\"./frameHelper\");\r\n\r\nfunction WOQLResult(results, query, config){\r\n\tthis.bindings = results.bindings;\r\n\tthis.query = query;\r\n\tthis.cursor = 0;\r\n\tif(!(config && config.no_compress)){\r\n\t\tvar context = (config && config.context ? config.context : false);\r\n\t\tthis.compress(context);\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.compress = function(context){\r\n\tcontext = (context ? context : this.query.getContext());\r\n\tfor(var i = 0; i<this.bindings.length; i++){\r\n\t\tfor (const prop of Object.keys(this.bindings[i])) {\r\n\t\t\tconst nprop = FrameHelper.shorten(prop, context);\r\n\t\t\tconst nval = ((typeof this.bindings[i][prop] == \"string\") \r\n\t\t\t\t? FrameHelper.shorten(this.bindings[i][prop], context) \r\n\t\t\t\t: this.bindings[i][prop]\t\r\n\t\t\t);\r\n\t\t\tdelete(this.bindings[i][prop]);\r\n\t\t\tthis.bindings[i][nprop] = nval;\r\n\t\t}\t\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.first = function(){\r\n\tthis.cursor = 0;\r\n\treturn this.bindings[0];\r\n}\r\n\r\nWOQLResult.prototype.last = function(){\r\n\tthis.curor = this.bindings.length-1;\r\n\treturn this.bindings[this.bindings.length-1];\r\n}\r\n\r\nWOQLResult.prototype.next = function(){\r\n\tthis.cursor++;\r\n\treturn this.bindings[this.cursor];\t\r\n}\r\n\r\nWOQLResult.prototype.prev = function(){\r\n\tif(this.cursor > 0){\r\n\t\tthis.cursor--;\r\n\t\treturn this.bindings[this.cursor];\t\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.compareValues = function(a, b, asc_or_desc){\r\n\tif(a['@value'] && b['@value']){\r\n\t\ta = a['@value'];\r\n\t\tb = b['@value'];\r\n\t}\r\n\tif(a > b ) {\r\n\t\treturn (asc_or_desc && asc_or_desc == \"asc\" ? 1 : -1);\r\n\t}\r\n\tif(b > a) {\r\n\t\treturn (asc_or_desc && asc_or_desc == \"asc\" ? -1 : 1);\r\n\t}\r\n}\r\n\r\n\r\nWOQLResult.prototype.sort = function(key, asc_or_desc){\r\n\tthis.bindings.sort((a, b) => {\r\n\t\treturn this.compareValues(a[key], b[key], asc_or_desc);\r\n\t});\r\n}\r\n\r\nWOQLResult.prototype.getVariableList = function(){\r\n\tif(this.bindings && this.bindings[0]){\r\n\t\treturn Object.keys(this.bindings[0]);\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\treturn (this.bindings && this.bindings.count());\r\n}\r\n\r\nWOQLResult.prototype.getBindings = function(){\r\n\treturn this.bindings;\r\n}\r\n\r\nmodule.exports = WOQLResult;","function Codemirror(text, format, config){\r\n  this.textdom = text;\r\n  this.mode = format;\r\n  this.darkMode = config.darkMode;\r\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\r\n}\r\n\r\n/*\r\ntxtar    : editor is attached to textar\r\nmode     : format for highlighting, ex: json, html etc.\r\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\r\nCodemirror.prototype.colorizeTextArea = function(mode){\r\n    //initize auto complete\r\n    /*CodeMirror.commands.autocomplete = function(cm) {\r\n    cm.showHint({hint: CodeMirror.hint.anyword});\r\n    }*/\r\n\r\n    // initialise code editor on text area\r\n    var editor = CodeMirror.fromTextArea(this.textdom, {\r\n        mode                : this.mode,\r\n        firstLineNumber     : 1,\r\n        lineNumbers         : true,\r\n        styleActiveLine     : true,\r\n        lineWrapping        : true,\r\n        smartIndent         : true,\r\n        indentWithTabs      : true,\r\n        newlineAndIndent    : true,\r\n        autoCloseBrackets   : true,\r\n        matchBrackets       : {afterCursor: true},\r\n        extraKeys           : {\"Ctrl-F\": \"find\", \"Tab\": \"autocomplete\" },\r\n        refresh             : true\r\n    });\r\n\r\n    this.setCodemirrorSize(editor, mode);\r\n    editor.defaultCharWidth('20px');\r\n    if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\r\n    else editor.setOption(\"theme\", 'neo');\r\n\r\n    return editor;\r\n} // colorizeTextArea()\r\n\r\n/*\r\n  set editor size according to screens\r\n  editor : code mirror editor Object\r\n  mode   : editor being viewed from schema/ doc/ query page*/\r\nCodemirror.prototype.setCodemirrorSize = function(editor, mode){\r\n  switch(mode){\r\n    case 'query':\r\n      editor.setSize('800', '400');\r\n    break;\r\n    case 'schema':\r\n      editor.setSize('auto', '1550');\r\n    break;\r\n    case 'document':\r\n     editor.setSize('765', '500');\r\n    break;\r\n    case 'api-doc':\r\n        editor.setSize('800', '500');\r\n    break;\r\n    case 'doc-json':\r\n        editor.setSize('1410', 'auto');\r\n    break;\r\n    case 'doc-json-create':\r\n        editor.setSize('1410', '500');\r\n    break;\r\n  } // switch(mode)\r\n} // setCodemirrorSize()\r\n\r\n// updateTextArea(): highlights new changes on editor\r\nCodemirror.prototype.updateTextArea = function(editor){\r\n  editor.save();\r\n  setTimeout(function() {\r\n      editor.refresh();\r\n  },1);\r\n  // save changes of code mirror editor\r\n  editor.on('change', function(){\r\n    editor.save();\r\n  });\r\n} //updateTextArea()\r\n\r\n/*\r\ncolorizePre() to colorise pre tags (read only mode)\r\ntext (string)    : The document to run through the highlighter.\r\nmode (mode spec) : format to highlight color\r\noutput (DOM node): The tokens will be converted to spans as in an editor,\r\n                   and inserted into the node (through innerHTML).*/\r\nCodemirror.prototype.colorizePre = function(){\r\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\r\n  if(this.darkMode)\r\n      var theme = 'cm-s-erlang-dark';\r\n  else var theme = 'cm-s-neo';\r\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\r\n  return this.textdom;\r\n} // colorizePre()\r\n\r\nCodemirror.prototype.jsonldCheck = function(format){\r\n  if(format == 'jsonld') return true;\r\n}\r\n\r\nmodule.exports=Codemirror\r\n","/**\r\n * object renderer binds to object frame - provides filters, sorts and manipulations of underlying object frame\r\n * and coordinates viewer to draw updates\r\n\r\n * Object Renderer - provides sorting / filtering / state management of objects\r\n * @param obj ObjectFrame object - contains underlying data and frame structure\r\n * @param parent PropertyRenderer - property that owns this object (if any)\r\n * @param options options json\r\n * @returns\r\n */\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst ValueRenderer = require('./ValueRenderer');\r\nconst ObjectViewer = require('./ObjectViewer');\r\nconst PropertyViewer = require('./PropertyViewer');\r\nconst HTMLDataViewer = require('./DataViewer');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\nfunction PropertyRenderer(prop, parent, options){\r\n\tthis.predicate = prop;\r\n\tthis.parent = parent;\r\n\tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n\tthis.originalValues = false;\r\n\tthis.changed = false;\r\n\tthis.values = [];\r\n\tthis.renderer_type = \"property\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nPropertyRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForChild = function(){\r\n\tvar opts = {};\r\n\tif(this.options.features){ opts.features = this.options.features };\r\n\tif(this.options.controls){ opts.controls = this.options.controls};\r\n\treturn this.options;\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForValue = function(df, index){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForObject = function(objframe){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.render = function(viewer){\r\n \tthis.buildValueRenderers();\r\n \tif(this.cframe && this.cframe.property){\r\n \t\tthis.viewer = (viewer ? viewer : this.getViewerForProperty());\r\n \t\tfor(var i = 0; i<this.values.length; i++){\r\n \t\t\tvar renderedval = this.values[i].render();\r\n \t\t\tif(renderedval && this.showFeature(\"body\")) this.viewer.addRenderedValue(renderedval);\r\n \t\t}\r\n \t\treturn this.viewer.render();\r\n \t}\r\n}\r\n\r\n/*\r\n * Creates the array of object renderer or value renderer objects corresponding to the property values.\r\n */\r\nPropertyRenderer.prototype.buildValueRenderers = function(){\r\n \tvar adorig = (this.originalValues === false ? true : false);\r\n \tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n \tif(!this.cframe){\r\n \t\tconsole.error(\"No frame for \" + this.property() + \" id: \" + this.subject());\r\n \t\treturn false;\r\n \t}\r\n \tif(this.cframe && this.cframe.isData()){\r\n \t\tvar dataframes = this.getDataFramesToRender();\r\n \t\tif(dataframes.length == 0){\r\n \t\t\talert(this.predicate);\r\n \t\t}\r\n \t\tvar vals = [];\r\n \t\tfor(var i = this.values.length; i<dataframes.length; i++){\r\n \t\t\tvar vr = new ValueRenderer(dataframes[i], i, this, this.getOptionsForValue(dataframes[i], i));\r\n \t\t\tthis.values.push(vr);\r\n \t\t\tvals.push(vr.value());\r\n \t\t}\r\n \t\tif(adorig) this.originalValues = vals;\r\n \t}\r\n \telse {\r\n \t\tif(adorig) this.originalValues = [];\r\n \t\tvar kids = this.getChildrenToRender();\r\n \t\tif(kids && kids.length){\r\n \t\t\tfor(var i = this.values.length; i<kids.length; i++){\r\n \t\t\t\tvar kidf = new ObjectRenderer(kids[i], this, this.getOptionsForObject(kids[i]));\r\n \t\t\t\tif(adorig) this.originalValues.push(kidf.subject());\r\n \t\t\t\tthis.values.push(kidf);\r\n \t\t\t}\r\n \t\t}\r\n \t}\r\n}\r\n\r\n/*\r\n * Returns the array of values that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getDataFramesToRender = function(options){\r\n \tvar allvals = this.parent.objframe.getDataFrames(this.property());\r\n \treturn allvals;\r\n}\r\n\r\n/*\r\n * Returns the array of child / objects that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getChildrenToRender = function(options){\r\n \tif(TerminusClient.FrameHelper.viewIncludesChildren(this.view, \"property\")){\r\n \t\tvar allkids = this.parent.objframe.getChildren(this.property());\r\n \t}\r\n \telse {\r\n \t\tvar allkids = [];\r\n \t}\r\n \treturn allkids;\r\n}\r\n\r\nPropertyRenderer.prototype.redraw = function(){\r\n \tthis.viewer.clear();\r\n \tthis.render(this.viewer, \"x\");\r\n \t//alert(this.values.length);\r\n}\r\n\r\nPropertyRenderer.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n \tif(this.cframe.isData()){\r\n \t\treturn extracts;\r\n \t}\r\n \telse {\r\n \t\treturn extracts;\r\n \t\tvar extr = {};\r\n \t\tfor(var i = 0; i<extracts.length; i++){\r\n \t\t\tfor(var subjid in extracts[i]){\r\n \t\t\t\textr[subjid] = extracts[i][subjid];\r\n \t\t\t}\r\n \t\t}\r\n \t\treturn extr;\r\n \t}\r\n}\r\n\r\n/*\r\n * simple wrapper functions\r\n */\r\nPropertyRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\nPropertyRenderer.prototype.property = function(){return this.predicate;}\r\nPropertyRenderer.prototype.subject = function(){return (this.parent ? this.parent.subject() : false);};\r\nPropertyRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nPropertyRenderer.prototype.subjectClass = function(){return (this.parent ? this.parent.subjectClass() : false);};\r\nPropertyRenderer.prototype.updated = function(){ return (this.parent ? this.parent.childUpdated() : false);};\r\nPropertyRenderer.prototype.range = function(){\treturn (this.cframe ? this.cframe.range : \"\");};\r\nPropertyRenderer.prototype.getLabel = function(){ return (this.cframe ? this.cframe.getLabel() : \"\" );};\r\nPropertyRenderer.prototype.getComment = function(){ return (this.cframe ? this.cframe.getComment() : false);}\r\nPropertyRenderer.prototype.load = function(link){ return (this.parent ? this.parent.load(link) : false);}\r\nPropertyRenderer.prototype.hasCardinalityRestriction = function(){return (this.cframe ? this.cframe.hasRestriction() : false);};\r\nPropertyRenderer.prototype.getRestriction = function(){return (this.cframe ? this.cframe.restriction : false);};\r\nPropertyRenderer.prototype.isClassChoice = function(){\treturn (this.cframe ? this.cframe.isClassChoice() : false);};\r\nPropertyRenderer.prototype.currentFacet = function(){\treturn this.facet;} ;\r\nPropertyRenderer.prototype.save = function(){ return (this.parent ? this.parent.save() : false);};\r\n\r\nPropertyRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableClassChoices = function(){\r\n\tif(this.cframe){\r\n\t\tvar cf = this.cframe.getClassChoices();\r\n\t\tif(this.parent){\r\n\t\t\tvar choices = [];\r\n\t\t\tfor(var i = 0; i < cf.length; i++){\r\n\t\t\t\tvar clsmeta = this.parent.getClassMeta(cf[i]);\r\n\t\t\t\tvar lab = (clsmeta ? HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clsmeta) : false);\r\n\t\t\t\tvar lab = (lab ? lab : TerminusClient.FrameHelper.labelFromURL(cf[i]));\r\n\t\t\t\tchoices.push({value: cf[i], label: lab});\r\n\t\t\t}\r\n\t\t\treturn choices;\r\n\t\t}\r\n\t\treturn cf;\r\n\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n\r\nPropertyRenderer.prototype.delete = function(){\r\n\tvar prop = this.predicate;\r\n\tif(prop){\r\n\t\tthis.reset();\r\n\t\tthis.parent.deleteProperty(prop);\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nPropertyRenderer.prototype.add = function(view){\r\n\tthis.parent.addProperty(this.property(), view);\r\n\tthis.updated();\r\n\tif(view) {\r\n\t\tthis.values[this.values.length-1].setMode(view);\r\n\t\tthis.values[this.values.length-1].setNew();\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.goToValue = function(index){\r\n\tthis.viewer.goTo(this.subject(), this.property(), index);\r\n}\r\n\r\nPropertyRenderer.prototype.addClass = function(cls){\r\n\tthis.parent.addPropertyClass(this.property(), cls);\r\n\tthis.updated();\r\n\tvar newb = this.values[this.values.length-1];\r\n\tif(newb){\r\n\t\tnewb.setNew();\r\n\t\tnewb.setMode(\"edit\");\r\n\t}\r\n\tthis.redraw();\r\n\tif(newb) this.viewer.goTo(newb.subject());\r\n}\r\n\r\nPropertyRenderer.prototype.reset = function(){\r\n\tthis.parent.objframe.reset(this.predicate);\r\n\tif(this.cframe && this.cframe.isData()){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t\tthis.values = [];\r\n\t}\r\n\telse {\r\n\t\tvar nvals = [];\r\n\t\tfor(var i = 0; i<this.originalValues.length; i++){\r\n\t\t\tfor(var j = 0; j<this.values.length; j++){\r\n\t\t\t\tthis.values[j].reset();\r\n\t\t\t\tif(this.values[j].subject() == this.originalValues[i]){\r\n\t\t\t\t\tnvals.push(this.values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.values = nvals;\r\n\t}\r\n\tthis.redraw();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nPropertyRenderer.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.objframe.removePropertyValue(this.property(), value, index);\r\n\tvar nvals = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(typeof index == \"undefined\"){\r\n\t\t\tif(this.values[i].subject() == value){\r\n\t\t\t\tthis.values[i].reset();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnvals.push(this.values[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(i != index){\r\n\t\t\tthis.values[i].index = nvals.length;\r\n\t\t\tnvals.push(this.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t}\r\n\tthis.values = nvals;\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.addPropertyValue = function(value){\r\n\tthis.updated();\r\n\treturn this.parent.objframe.addPropertyValue(this.property(), value);\r\n}\r\n\r\n/*\r\n * Checks to see if an action (add, clone, delete) which affects the cardinality of the property is allowed by cardinality rules.\r\n */\r\nPropertyRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyRenderer.prototype.isNew = function(){\r\n\tif(this.new_property){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\nPropertyRenderer.prototype.setNew = function(){\r\n\tthis.new_property = true;\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.isUpdated = function(){\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\n\r\n/**\r\n * Sets mode of viewer to either \"view\" or \"edit\"\r\n */\r\nPropertyRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tthis.values[i].setMode(mode);\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\n/*\r\n * Jump to property value\r\n */\r\nPropertyRenderer.prototype.getViewableValues = function(){\r\n\tvar viewables = [];\r\n\tif(this.cframe && this.cframe.isData())\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvar sum = this.values[i].getSummary();\r\n\t\tvar lab = sum.long;\r\n\t\tviewables.push({label: lab, value: i});\r\n\t}\r\n\treturn viewables;\r\n}\r\n\r\nPropertyRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nPropertyRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.parentFacetChange = function(facet){\r\n\tif(facet == 'page'){\r\n\t\tif(!(this.facet == \"page\" || this.facet == \"multiline\")){\r\n\t\t\tthis.setFacet('multiline');\r\n\t\t}\r\n\t}\r\n\tif(facet == 'line'){\r\n\t\tthis.setFacet(\"label\");\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tmultiline: {\r\n\t\t\tlabel: \"Multiple Lines\", value: \"multiline\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n\tvar facets = [];\r\n\tfacets.push({label: \"Full Page\", value: \"page\"});\r\n\tfacets.push({label: \"Multiple Lines\", value: \"multiline\"});\r\n\tfacets.push({label: \"Single Line\", value: \"line\"});\r\n\tfacets.push({label: \"Summary\", value: \"summary\"});\r\n\tfacets.push({label: \"Label\", value: \"label\"});\r\n\tfacets.push({label: \"Snippet\", value: \"icon\"});\r\n\treturn facets;\r\n}\r\n\r\nPropertyRenderer.prototype.getContentOrientation = function(facet){\r\n\tif(this.currentFacet() == \"page\" || this.containsPage()){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\" || this.currentFacet() == \"multiline\" || this.currentFacet() == \"summary\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.cframe && this.cframe.isObject()){\r\n\t\treturn \"page\";\r\n\t}\r\n\treturn \"multiline\";\r\n}\r\n\r\n/*\r\n * Viewers for specific properties\r\n */\r\n\r\nPropertyRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nPropertyRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nPropertyRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableViewers = function(){\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailablePropertyViewers(this);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailablePropertyEditors(this);\r\n}\r\n\r\nPropertyRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nPropertyRenderer.prototype.containsPage = function(){\r\n\t//collapsed facets do not show their values\r\n\tif(this.currentFacet() == \"icon\" || this.currentFacet() == \"label\") return false;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i].facet == \"page\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.getViewerForProperty = function(ptype){\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n\t}\r\n\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n}\r\n\r\nPropertyRenderer.prototype.getPropertyHeaderViewer = function(){\r\n\treturn new PropertyViewer.HTMLPropertyHeaderViewer();\r\n}\r\n\r\nPropertyRenderer.prototype.getSummary = function(){\r\n\tvar status = \"ok\";\r\n\tif(this.isNew()) status = \"new\";\r\n\telse if(this.isUpdated()) status = \"updated\";\r\n\tvar ret = {\r\n\t\tstatus: status,\r\n\t\tvalcount: this.values.length\r\n\t};\r\n\tret.long = ((ret.valcount != 1) ? \"(\" + ret.valcount + \") \" : \"\");\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvsum = this.values[i].getSummary();\r\n\t\tret.long += vsum.long;\r\n\t\tif(i < this.values.length-1) ret.long += \", \";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nPropertyRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nPropertyRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\nfunction ObjectRenderer(obj, parent, options){\r\n\tthis.objframe = obj;\r\n\tthis.parent = parent;\r\n\tthis.properties = {};\r\n\tthis.originalProperties = false;\r\n\tthis.newProperties = [];\r\n\tthis.renderer_type = \"object\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\n//options has to include mode, viewer, facet, controls, features, hide_disabled_controls\r\n\r\nObjectRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nObjectRenderer.prototype.getOptionsForProperty = function(prop){\r\n\treturn this.options;\r\n}\r\n\r\nObjectRenderer.prototype.render = function(viewer){\r\n\tthis.buildPropertyRenderers();\r\n\tthis.viewer = (viewer ? viewer: this.getViewerForObject());\r\n\tfor(var prop in this.properties){\r\n\t\tvar renderedprop = this.properties[prop].render();\r\n\t\tif(renderedprop && this.showFeature(\"body\")) this.viewer.addRenderedProperty(prop, renderedprop);\r\n\t}\r\n\treturn this.viewer.render(this.view);\r\n}\r\n\r\nObjectRenderer.prototype.buildPropertyRenderers = function(){\r\n\tvar props = this.getPropertiesToRender();\r\n\tif(this.originalProperties === false) this.originalProperties = props;\r\n\tvar renders = {};\r\n\tfor(var j = 0; j<props.length; j++){\r\n\t\tif(typeof this.properties[props[j]] == \"undefined\"){\r\n\t\t\trenders[props[j]] = new PropertyRenderer(props[j], this, this.getOptionsForProperty(props[j]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenders[props[j]] = this.properties[props[j]];\r\n\t\t}\r\n\t\tif(this.newProperties.indexOf(props[j]) != -1) {\r\n\t\t\trenders[props[j]].setNew();\r\n\t\t\trenders[props[j]].mode = \"edit\";\r\n\t\t}\r\n\t}\r\n\tthis.properties = renders;\r\n}\r\n\r\nObjectRenderer.prototype.subject = function(){\r\n\tif(this.objframe) return this.objframe.subjid;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.subjectClass = function(){\r\n\tif(this.objframe) return this.objframe.cls;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableViewers = function(){\r\n\t//if(this.mode == \"view\"){\r\n\t//\treturn RenderingMap.getAvailableObjectViewers(this);\r\n\t//}\r\n\t//return RenderingMap.getAvailableObjectEditors(this);\r\n\treturn [\"html\", \"json\"];\r\n}\r\n\r\nObjectRenderer.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.property = function(){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent && this.parent.parent.objframe){\r\n\t\treturn this.parent.parent.objframe;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.load = function(link){\r\n\tvar self = this;\r\n\tif(this.controller){\r\n\t\tthis.controller.ui.showDocument(link);\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.load(link);\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.copy = function(nkid){\r\n\tnkid = (nkid ? nkid : this.objframe);\r\n\tvar other = new ObjectRenderer(nkid, this.parent, this.options);\r\n\treturn other;\r\n}\r\n\r\nObjectRenderer.prototype.clone = function(){\r\n\tif(this.root()){\r\n\t\tthis.objframe = this.objframe.clone(\"_:\");\r\n\t\tthis.objframe.newDoc = true;\r\n\t\tthis.setMode(\"edit\");\r\n\t}\r\n\telse {\r\n\t\tvar nkid = this.objframe.clone(TerminusClient.FrameHelper.genBNID());\r\n\t\tvar parentobj = this.parentObject();\r\n\t\tvar prop = this.property();\r\n\t\tif(parentobj && prop){\r\n\t\t\tif(typeof parentobj.children[prop] == \"undefined\"){\r\n\t\t\t\tparentobj.children[prop] = [];\r\n\t\t\t}\r\n\t\t\tparentobj.children[prop].push(nkid);\r\n\t\t\tvar newrend = this.copy(nkid);\r\n\t\t\tthis.parent.values.push(newrend);\r\n\t\t}\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nObjectRenderer.prototype.save = function(){\r\n\tif(this.controller){\r\n\t\tif(this.isNewDocument()){\r\n\t\t\tvar demandid = this.inputID();\r\n\t\t\tif(demandid == \"_:\") demandid = \"\";\r\n            var extr = this.extract();\r\n\t\t\tthis.controller.createDocument(demandid, extr);\r\n\t\t}\r\n\t\telse {\r\n            var extr = this.extract();\r\n\t\t\tthis.controller.updateDocument(extr);\r\n\t\t}\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.delete = function(){\r\n\tvar dval = this.subject();\r\n\tif(this.controller && this.root()){\r\n\t\tif(!this.isNewDocument()){\r\n\t\t\tthis.controller.deleteDocument(dval);\r\n\t\t}\r\n\t\tthis.nukeViewer();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent){\r\n\t\t\tthis.parent.deletePropertyValue(dval);\r\n\t\t\tthis.parent.redraw();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.reset = function(){\r\n\tthis.objframe.reset();\r\n\tvar nprops = {};\r\n\tfor(var i = 0; i<this.originalProperties.length; i++){\r\n\t\tvar prop = this.originalProperties[i];\r\n\t\tif(typeof this.properties[prop] == \"object\"){\r\n\t\t\tthis.properties[prop].reset();\r\n\t\t\tnprops[prop] = this.properties[prop];\r\n\t\t}\r\n\t}\r\n\tthis.properties = nprops;\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.deleteProperty = function(prop){\r\n\tthis.objframe.removeProperty(prop);\r\n\tdelete(this.properties[prop]);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.addProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.addNewProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.newProperties.push(prop);\r\n\tthis.redraw();\r\n\tthis.goToProperty(prop);\r\n}\r\n\r\nObjectRenderer.prototype.addPropertyClass = function(prop, cls){\r\n\tthis.objframe.addProperty(prop, cls);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.changeClass = function(cls){\r\n\tif(this.parent){\r\n\t\tthis.parent.addClass(cls);\r\n\t\tthis.parent.deletePropertyValue(this.subject());\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getClassMeta = function(cls){\r\n\tvar ctl = this.getController();\r\n\tif(ctl && ctl.classmeta && ctl.classmeta[cls]){\r\n\t\treturn ctl.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getController = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller;\r\n\t}\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getClient = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller.getClient();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent && this.parent.parent){\r\n\t\t\treturn(this.parent.parent.getClient())\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.inputID = function(){\r\n\tif(this.idDOM){\r\n\t\treturn this.idDOM.value;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isNew = function(){\r\n\tif(this.new_object){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.isPartOfNewDocument()){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.parent) return this.parent.isNew();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setNew = function(){\r\n\tthis.new_object = true;\r\n}\r\n\r\nObjectRenderer.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalProperties[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\r\n\t}\r\n\tif(i != this.originalProperties.length) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\nObjectRenderer.prototype.updated = ObjectRenderer.prototype.childUpdated;\r\n\r\nObjectRenderer.prototype.isNewDocument = function(){\r\n\tif(this.root() && this.objframe.isnew()) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isPartOfNewDocument = function(){\r\n\tif(this.isNewDocument()) return true;\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.isPartOfNewDocument();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var prop in this.properties){\r\n\t\t\tthis.properties[prop].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tif(this.parent){\r\n\t\tthis.parent.redraw();\r\n\t}\r\n\telse {\r\n\t\tthis.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.keys(this.facets);\r\n}\r\n\r\nObjectRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacet = function(){\r\n\tif(!this.parent) return \"page\";\r\n\tvar pfacet = this.parent.currentFacet();\r\n\tif(pfacet == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(pfacet == \"multiline\") return \"line\";\r\n\tif(pfacet == \"line\") return \"summary\";\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"line\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"summary\");\r\n}\r\n\r\nObjectRenderer.prototype.getContentOrientation = function(){\r\n\tif(this.currentFacet() == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.getLabel = function(){\r\n\tfor(var prop in this.properties){\r\n\t\tif(TerminusClient.FrameHelper.getShorthand(prop) == \"rdfs:label\" || prop == \"rdfs:label\"){\r\n\t\t\tvar prend = this.properties[prop];\r\n\t\t\tvar vrend = prend.values[0];\r\n\t\t\tif(vrend){\r\n\t\t\t\tvar sum = vrend.getSummary();\r\n\t\t\t\tif(sum.long != \"empty\") return sum.long;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar s = this.subject();\r\n\tif(s && s.substring(0, 2) == \"_:\"){\r\n\t\tvar ty = this.subjectClass();\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(ty);\r\n\t\tif(!sh) sh = ty;\r\n\t\tvar b = sh.split(\":\");\r\n\t\tif(b.length > 1){\r\n\t\t\treturn \"New \" + b[1];\r\n\t\t}\r\n\t\treturn \"New Object\";\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\r\n}\r\n\r\nObjectRenderer.prototype.getObjectHeaderViewer = function(){\r\n\treturn this.header_viewer;\r\n}\r\n\r\nObjectRenderer.prototype.getViewerForObject = function(format){\r\n\tif(format == \"json\"){\r\n\t\treturn new ObjectViewer.JSONObjectViewer(this);\r\n\t}\r\n\treturn new ObjectViewer.HTMLObjectViewer(this);\r\n}\r\n\r\nObjectRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nObjectRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nObjectRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(this.isNewDocument() && which == \"clone\") return false;\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\tif (fets.indexOf(which) != -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.goToProperty = function(prop){\r\n\tthis.viewer.goTo(this.subject(), prop);\r\n}\r\n\r\nObjectRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var prop in this.properties){\r\n\t\tthis.properties[prop].setMode(mode);\r\n\t}\r\n\tthis.viewer.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\n\r\n\r\nObjectRenderer.prototype.setViewer = function(viewer){\r\n\tvar nviewer = this.getViewerForObject(viewer);\r\n\tif(nviewer){\r\n\t\tthis.viewerType = viewer;\r\n\t\tthis.viewer = nviewer;\r\n\t\tthis.viewer.redraw();\r\n\t}\r\n}\r\n\r\n\r\nObjectRenderer.prototype.setView = function(view){\r\n\tvar views = {\r\n\t\t\"full\": {\r\n\r\n\t\t},\r\n\t\t\"hidden\": {\r\n\r\n\t\t}\r\n\t};\r\n\tthis.view = view;\r\n\tthis.viewer.redraw();\r\n}\r\n\r\n\r\nObjectRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nObjectRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nObjectRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nObjectRenderer.prototype.getViewableProperties = function(){\r\n\treturn this.objframe.getFilledPropertyList();\r\n}\r\n\r\nObjectRenderer.prototype.getAddableProperties = function(){\r\n\tvar props = this.objframe.getMissingPropertyList();\r\n\treturn props;\r\n}\r\n\r\nObjectRenderer.prototype.getPropertiesToRender = function(options){\r\n\tvar sort = this.standardSort;\r\n\tvar filter = function(){return true};\r\n\tif(options && options.map && options.map.patterns){\r\n\t\t/*for(var i = 0; i<options.map.patterns.length; i++){\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"sort\"}, options.map.patterns[i])){\r\n\t\t\t\tsort = options.map.patterns[i].sort;\r\n\t\t\t}\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"filter\"}, options.map.patterns[i])){\r\n\t\t\t\tfilter = options.map.patterns[i].filter;\r\n\t\t\t}\r\n\t\t}*/\r\n\t}\r\n\treturn sort(this.objframe, filter);\r\n}\r\n\r\nObjectRenderer.prototype.standardSort = function(objframe, filter){\r\n\tvar sorted = [];\r\n\tvar rdft = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\");\r\n\tif(objframe.dataframes[rdft] && filter(objframe, rdft, objframe.dataframes[rdft])){\r\n\t\tsorted.push(rdft);\r\n\t}\r\n\tvar rdfc = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"comment\");\r\n\tif(objframe.dataframes[rdfc]){\r\n\t\tsorted.push(rdfc);\r\n\t}\r\n\tfor(var prop in objframe.dataframes){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\tfor(var prop in objframe.children){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\treturn sorted;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\nObjectRenderer.prototype.extractLDO = function(extracts){\r\n\textracts[\"rdf:type\"] = this.objframe.cls;\r\n\tvar full = {};\r\n\tfull[this.subject()] = extracts;\r\n\treturn full;\r\n}\r\n\r\nObjectRenderer.prototype.extractJSONLD = function(extracts){\r\n\textracts[\"@type\"] = this.objframe.cls;\r\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\r\n\tif(this.objframe.jsonld_context) extracts['@context'] = this.objframe.jsonld_context;\r\n\treturn extracts;\r\n}\r\n\r\nObjectRenderer.prototype.extract = function(){\r\n\tvar extracts = {};\r\n\tfor(var i in this.properties){\r\n\t\tvar extracted = this.properties[i].extract();\r\n\t\tif(!TerminusClient.FrameHelper.empty(extracted)){\r\n\t\t\textracts[i] = extracted;\r\n\t\t}\r\n\t}\r\n\tif(TerminusClient.FrameHelper.empty(extracts) && this.parent){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar ext = this.extractJSONLD(extracts);\r\n\t\treturn ext;\r\n\t\t//return this.extractLDO(extracts);\r\n\t}\r\n}\r\n\r\nmodule.exports={ObjectRenderer,PropertyRenderer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLStringEditor(options){\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.options = options; \r\n}\r\n\r\nHTMLStringEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar big = ((this.options && typeof this.options.big != \"undefined\") ? this.options.big : this.isBigType(ty, value));\r\n\tif(big){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\r\n\t}\r\n\telse {\r\n\t\tvar size = ((this.options && typeof this.options.size != \"undefined\") ? this.options.size : this.getTypeSize(ty, value));\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.setAttribute('type', \"text\");\r\n\t\tinput.setAttribute('size', size);\r\n\t}\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"input\", function(){\r\n\t\trenderer.set(this.value);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nHTMLStringEditor.prototype.isBigType = function(ty, value){\r\n\tif(value && value.length && value.length > 100) return true;\r\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\r\n\tif(longs.indexOf(ty) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\r\n\tif(value && value.length && value.length > 40) return 80;\r\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\r\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \r\n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \r\n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\r\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\r\n\tif(bigs.indexOf(ty) != -1) return 80;\r\n\tif(smalls.indexOf(ty) != -1) return 16;\r\n\tif(tinys.indexOf(ty) != -1) return 8;\r\n\treturn 32;\r\n}\r\n\r\nmodule.exports={HTMLStringEditor}\r\n\r\n\r\n","function HTMLBooleanViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tif(value){\r\n\t\tvar vallab = document.createTextNode(value);\r\n\t\tinput.appendChild(vallab);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanViewer}\r\n\r\n","function HTMLBooleanEditor(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute('type', \"checkbox\");\r\n\tif(value){\r\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\r\n\t}\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tif(value){\r\n\t\t\trenderer.set(\"\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.set(\"true\");\r\n\t\t}\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanEditor}\r\n\r\n","function HTMLChoiceViewer(options){};\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nHTMLChoiceViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar els = renderer.frame.frame.elements;\r\n\t\tfor(var i = 0; i<els.length; i++){\r\n\t\t\tif(els[i].class == value){\r\n\t\t\t\tif(els[i].label && els[i].label[\"@value\"]){\r\n\t\t\t\t\tvar lab = els[i].label[\"@value\"];\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(value);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tinput.appendChild(document.createTextNode(lab));\r\n\t\t\t\tcontinue;\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLChoiceViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLChoiceEditor(options){};\r\n\r\nHTMLChoiceEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar optInput = document.createElement(\"select\");\r\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\r\n\tvar foptions = renderer.frame.getChoiceOptions();\r\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\r\n\tvar callback = function(val){\r\n\t\trenderer.set(val);\r\n\t}\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\r\n\treturn sel;\r\n}\r\n\r\nmodule.exports={HTMLChoiceEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLCoordinateViewer(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\trenderer.badData(ty + \" failed to parse as json\", e.toString());\r\n\t\tvar parsed = false;\r\n\t\tvalue = false;\r\n\t}\r\n\tif(value){\r\n\t\tif(ty == \"xdd:coordinate\"){\r\n\t\t\tparsed = [parsed];\r\n\t\t}\r\n\t\tfor(var i = 0; i < parsed.length; i++){\r\n\t\t\tvar lldom = document.createElement(\"span\");\r\n\t\t\tlldom.setAttribute(\"class\", \"latlong\");\r\n\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" \" + \" \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" \" ));\r\n\t\t\tinput.appendChild(lldom);\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateViewer}\r\n\r\n","function HTMLCoordinateEditor(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\r\n\tvar latdom = document.createElement(\"input\");\r\n\tlatdom.setAttribute(\"type\", \"text\");\r\n\tlatdom.value = lat;\r\n\tvar longdom = document.createElement(\"input\");\r\n\tlongdom.setAttribute(\"type\", \"text\");\r\n\tlongdom.value = long;\r\n\tlatdom.addEventListener(\"change\", change);\r\n\tlongdom.addEventListener(\"change\", change);\r\n\treturn [latdom, longdom];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\r\n\tvar lldom = document.createElement(\"span\");\r\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\r\n\tvar firstcol = document.createElement(\"span\");\r\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\r\n\tlldom.appendChild(firstcol);\r\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\r\n\t\tvar delbut = document.createElement(\"button\");\r\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\r\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\r\n\t\tdelbut.addEventListener(\"click\", function(){\r\n\t\t\tlong.value = \"\";\r\n\t\t\tlat.value = \"\";\r\n\t\t\tparent.removeChild(lldom);\r\n\t\t});\r\n\t\tfirstcol.appendChild(delbut);\r\n\t}\r\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\tlldom.appendChild(lat);\r\n\tlldom.appendChild(document.createTextNode(\" \" + \" \"));\r\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\r\n\tlldom.appendChild(long);\r\n\tlldom.appendChild(document.createTextNode(\"  \" ));\r\n\treturn lldom;\r\n}\r\n\r\n\r\nHTMLCoordinateEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = renderer.frame.getTypeShorthand();\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\trenderer.badData(ty + \" failed to parse as json\", e.toString());\r\n\t\tvar parsed = false;\r\n\t\tvalue = false;\r\n\t}\r\n\tvar self = this;\r\n\tvar updateValueFromForm = function(){\r\n\t\tvar vals = [];\r\n\t\tfor(var i = 0; i<self.inputs.length; i++){\r\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\r\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\r\n\t\t\t\tvals.push(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(vals.length == 0){\r\n\t\t\trenderer.set(\"\");\r\n\t\t}\r\n\t\telse if(ty == \"xdd:coordinate\"){\r\n\t\t\trenderer.set(vals[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar op = \"[\";\r\n\t\t\tfor(var i = 0; i<vals.length; i++){\r\n\t\t\t\top += vals[i];\r\n\t\t\t\tif(i+1 < vals.length) op += \",\";\r\n\t\t\t}\r\n\t\t\top += \"]\";\r\n\t\t\trenderer.set(op);\r\n\t\t}\r\n\t};\r\n\tif(!parsed){\r\n\t\tif(ty == \"xdd:coordinate\") parsed = [\"\",\"\"];\r\n\t\telse {\r\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\r\n\t\t\tif(ty == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\r\n\t\t}\r\n\t}\r\n\tif(ty == \"xdd:coordinate\"){\r\n\t\tparsed = [parsed];\r\n\t}\r\n\tfor(var i = 0; i < parsed.length; i++){\r\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\r\n\t}\r\n\tvar lldoms = document.createElement(\"span\");\r\n\tfor(var i = 0; i < this.inputs.length; i++){\r\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], ty, i, lldoms);\r\n\t\tlldoms.appendChild(lldom);\r\n\t}\r\n\tinput.appendChild(lldoms);\r\n\tvar self = this;\r\n\tif(ty != \"xdd:coordinate\"){\r\n\t\tvar butspan = document.createElement(\"span\");\r\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\r\n\t\tvar addbut = document.createElement(\"button\");\r\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\r\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\r\n\t\taddbut.addEventListener(\"click\", function(){\r\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\r\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], ty, self.inputs.length, lldoms);\r\n\t\t\tlldoms.appendChild(lldom);\r\n\t\t\tself.inputs.push(ipdoms);\r\n\t\t});\r\n\t\tbutspan.appendChild(addbut);\r\n\t\tinput.appendChild(butspan);\t\t\t\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateViewer(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar parsed = TerminusClient.FrameHelper.parseDate(ty, value);\r\n\t\tvar datepart = this.getDateComponentDOM(parsed);\r\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\r\n\t\tif(timepart) input.appendChild(timepart);\r\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\t\tif(datepart) input.appendChild(datepart);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\r\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\r\n\tif(hdom){\r\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\r\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\r\n\t}\r\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\r\n\t\tvar mlab = (parsed.minute < 10 ? parsed.minute : parsed.minute);\r\n\t\tmdom.appendChild(document.createTextNode(mlab));\r\n\t}\r\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(sdom){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\r\n\t\tvar slab = (parsed.second < 10 ? parsed.second : parsed.second);\r\n\t\tsdom.appendChild(document.createTextNode(slab));\r\n\t}\r\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\r\n\tif(tz){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\r\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\r\n\t}\r\n\tif(hdom || mdom || sdom || tz){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\r\n\t\tif(hdom) dadom.appendChild(hdom); \r\n\t\tif(mdom) {\r\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(sdom) {\r\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t}\r\n\t\tif(tz){\r\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\r\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\r\n\tif(ydom){\r\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\r\n\t\tydom.appendChild(document.createTextNode(parsed.year));\r\n\t}\r\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\r\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\r\n\t}\r\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\r\n\tif(ddom){\r\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\r\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\r\n\t}\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateViewer}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateEditor(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tthis.parsed = TerminusClient.FrameHelper.parseDate(ty, value);\r\n\t}\r\n\telse this.parsed = {};\r\n\tvar datepart = this.getDateComponentDOM(this.parsed, ty, renderer);\r\n\tvar timepart = this.getTimeComponentDOM(this.parsed, ty, renderer);\r\n\tif(timepart) input.appendChild(timepart);\r\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\tif(datepart) input.appendChild(datepart);\r\n\treturn input;\r\n}\r\n\r\nHTMLDateEditor.prototype.set = function(part, val, renderer, ty){\r\n\tthis.parsed[part] = val;\r\n\tvar xsd = TerminusClient.FrameHelper.xsdFromParsed(this.parsed, ty);\r\n\tif(xsd){\r\n\t\trenderer.set(xsd);\r\n\t}\r\n}\r\n\r\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, renderer){\r\n\tif([\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:time\"].indexOf(ty) == -1){\r\n\t\treturn false;\r\n\t}\r\n\tvar self = this;\r\n\tvar hdom = document.createElement(\"input\");\r\n\thdom.setAttribute(\"class\", \"terminus-hour-input terminus-hour-\"+ty);\r\n\thdom.setAttribute(\"size\", 2);\r\n\thdom.setAttribute(\"placeholder\", \"HH\");\r\n\thdom.value = (parsed.hour ? parsed.hour : \"\");\r\n\thdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"hour\", this.value, renderer, ty);\r\n\t});\r\n\tvar mdom = document.createElement(\"input\");\r\n\tmdom.setAttribute(\"class\", \"terminus-minute-input terminus-minute-\"+ty);\r\n\tmdom.setAttribute(\"size\", 2);\r\n\tmdom.setAttribute(\"placeholder\", \"MM\");\r\n\tmdom.value = (parsed.minute ? parsed.minute: \"\");\r\n\tmdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"minute\", this.value, renderer, ty);\r\n\t});\r\n\tvar sdom = document.createElement(\"input\");\r\n\tsdom.setAttribute(\"class\", \"terminus-second-input terminus-second-\"+ty);\r\n\tsdom.setAttribute(\"size\", 8);\r\n\tsdom.setAttribute(\"placeholder\", \"SS.sss...\");\r\n\tsdom.value = (parsed.second ? parsed.second: \"\");\r\n\tsdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"second\", this.value, renderer, ty);\r\n\t})\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.appendChild(hdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(mdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(sdom);\r\n\treturn tdom;\r\n}\r\n\r\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, renderer){\r\n\tvar self = this;\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\r\n\t\tvar ydom = document.createElement(\"input\");\r\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\r\n\t\tydom.setAttribute(\"size\", 6);\r\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\r\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\r\n\t\tydom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"year\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar mdom = document.createElement(\"select\");\r\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\r\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\r\n\t\t\tvar opdom = document.createElement(\"option\");\r\n\t\t\topdom.value = i+1;\r\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\r\n\t\t\tif(parsed.month && parsed.month == i+1){\r\n\t\t\t\topdom.selected = true;\r\n\t\t\t}\r\n\t\t\tmdom.appendChild(opdom);\r\n\t\t}\r\n\t\tmdom.addEventListener(\"change\", function(){\r\n\t\t\tself.set(\"month\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\t\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar ddom = document.createElement(\"input\");\r\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\r\n\t\tddom.setAttribute(\"size\", 2);\r\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\r\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\r\n\t\tddom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"day\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\t\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateEditor}","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLEntityViewer(options){}\r\nHTMLEntityViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar value = TerminusClient.FrameHelper.unshorten(value);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tvar self = this;\r\n\tif(this.holder){\r\n\t\treturn this.holder;\r\n\t}\r\n\tif(value){\r\n\t\tvar dom = this.getEntityViewHTML(value, renderer, dataviewer);\t\t\r\n\t\tholder.appendChild(dom);\r\n\t}\r\n\treturn holder;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, renderer, dataviewer){\r\n\tvar span = document.createElement(\"span\");\r\n\tvar self = this;\r\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\r\n\tspan.appendChild(dataviewer.internalLink(value));\r\n\tif(controller = renderer.getController()){\r\n\t\tcontroller.getInstanceMeta(value).then(function(response){\r\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\r\n\t\t\tif(lab){ \r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\t\tspan.appendChild(lab);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\r\n\tvar nspan = document.createElement(\"span\");\r\n\tif(response && (il = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceLabel\", response))){\r\n\t\tnspan.appendChild(dv.internalLink(url, il));\r\n\t\tvar rt = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceType\", response);\r\n\t\tvar tit = url + \" Type: \" + rt;\r\n\t\tvar ic = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceComment\", response);\r\n\t\tif(typeof ic == \"object\" && ic[\"@value\"]){\r\n\t\t\ttit += \" \" + ic[\"@value\"];\r\n\t\t}\r\n\t\tnspan.setAttribute(\"title\", tit);\r\n\t\treturn nspan;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\r\nHTMLEntityEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tinput.setAttribute(\"type\", \"text\");\r\n\tinput.setAttribute('size', 80);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tvar url = this.value;\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\r\n\t\t\turl = \"doc:\" + url;\r\n\t\t}\r\n\t\trenderer.set(url);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLEntityEditor}","const TerminusClient = require('@terminusdb/terminus-client');\r\nfunction HTMLImageViewer(options){}\r\nHTMLImageViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar img = document.createElement(\"a\");\r\n\t\timg.setAttribute('src', value);\r\n\t\tinput.appendChild(img);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLImageViewer}\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageEditor(options){}\r\nHTMLImageEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tif(ty == \"xsd:base64Binary\"){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\r\n\t\tinput.value = value;\r\n\t\tinput.addEventListener(\"change\", function(){\r\n\t\t\trenderer.set(this.value);\r\n\t\t});\r\n\t\treturn input;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLLinkViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('size', 80);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar a = document.createElement(\"a\");\r\n\t\ta.setAttribute('href', value);\r\n\t\ta.appendChild(document.createTextNode(value));\r\n\t\tinput.appendChild(a);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLLinkViewer}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nfunction HTMLNumberViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n}\r\n\r\nHTMLNumberViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tif(value === 0) value = \"0\";\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(value) : value);\r\n\tinput.appendChild(document.createTextNode(value));\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLNumberViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\r\n\tvar x = (this.useCommas(renderer) ? TerminusClient.FrameHelper.numberWithCommas(vals[0]) : vals[0]);\r\n\tvar tnode = document.createTextNode(x);\r\n\trvals.appendChild(tnode);\r\n\td.appendChild(rvals);\t\r\n\tif(vals.length == 2){\r\n\t\td.appendChild(getRangeSymbolDOM());\r\n\t\tvar x2 = (this.useCommas(renderer) ? TerminusClient.FrameHelper.numberWithCommas(vals[1]) : vals[1]);\r\n\t\tvar t2node = document.createTextNode(x2);\r\n\t\tsvals.appendChild(t2node);\r\n\t\td.appendChild(svals);\t\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nHTMLRangeViewer.prototype.useCommas = function(renderer){\r\n\tif([\"xdd:gYearRange\", \"xdd:dateRange\"].indexOf(renderer.frame.getTypeShorthand()) != -1) return false;\r\n\treturn this.commas;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeEditor(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\r\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\r\n\tvar firstip = document.createElement(\"input\");\r\n\tfirstip.setAttribute('type', \"text\");\r\n\tfirstip.setAttribute('size', 16);\r\n\tif(data1){\r\n\t\tfirstip.value = data1;\r\n\t}\r\n\tvar secondip = document.createElement(\"input\");\r\n\tsecondip.setAttribute('type', \"text\");\r\n\tsecondip.setAttribute('size', 16);\r\n\tif(data2){\r\n\t\tthis.showing_range = true;\r\n\t\tsecondip.value = data2;\r\n\t}\r\n\trvals.appendChild(firstip);\r\n\td.appendChild(rvals);\t\r\n\tif(this.showing_range){\r\n\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\tsvals.appendChild(secondip);\r\n\t}\r\n\td.appendChild(svals);\t\r\n\tvar but = document.createElement(\"button\");\r\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\r\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\tbut.appendChild(document.createTextNode(txt));\r\n\td.appendChild(but);\t\r\n\tvar self = this;\r\n\tbut.addEventListener(\"click\", function(){\r\n\t\tif(self.showing_range){\r\n\t\t\tself.showing_range = false;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(svals);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showing_range = true;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\t\tsvals.appendChild(secondip);\r\n\t\t}\r\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\t\tbut.innerText = txt;\r\n\t\tchangeHandler();\r\n\t});\r\n\tvar changeHandler = function(){\r\n\t\tif(self.showing_range && secondip.value){\r\n\t\t\tif(firstip.value) renderer.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\r\n\t\t\telse renderer.set(secondip.value);\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.set(firstip.value);\r\n\t\t}\r\n\t}\r\n\tfirstip.addEventListener(\"change\", changeHandler);\r\n\tsecondip.addEventListener(\"change\", changeHandler);\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeEditor}\r\n","function SantizedHTMLViewer(options){\r\n\tthis.css = ((options && options.css) ? \"literal-value \" + options.css : \"literal-value\");\r\n}\r\n\r\nSantizedHTMLViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar val = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', val);\r\n\tinput.innerHTML = val;\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={SantizedHTMLViewer}\r\n","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction GoogleMapEditor(options){}\r\n\r\nGoogleMapEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\tvar mapcontainer = document.createElement(\"div\");\r\n\tmapcontainer.setAttribute('class', \"gmap-window gmap-editor\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tvar map = ghelper.initMap(mapcontainer, renderer, value, ty);\r\n    if(ty == \"xdd:coordinate\"){\r\n\t    google.maps.event.addListener(map, 'click', function(event) {\r\n\t    \tvar position = event.latLng;\r\n\t    \tvar coo = \"[\" + position.lat() + \",\" + position.lng() + \"]\";\r\n\t    \trenderer.set(coo);\r\n\t        ghelper.clearMarkers();\r\n\t        var init = {\r\n\t    \t\tposition: position, \r\n\t    \t\tmap: map\r\n\t    \t}\r\n\t    \tvar marker = new google.maps.Marker(init);\r\n\t    \tghelper.markers.push(marker);\r\n\t  \t});\r\n\t}\r\n    else {\r\n    \tgoogle.maps.event.addListener(map, 'click', function(event) {\r\n        \tvar path = ghelper.polyline.getPath();\r\n        \tpath.push(event.latLng);\r\n      \t    var position = event.latLng;\r\n      \t    ghelper.addMarker(position, map, renderer, '#' + path.getLength(), ty);\r\n      \t});\r\n    }\r\n    return mapcontainer;\r\n}\r\n\r\nmodule.exports={GoogleMapEditor};","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction GoogleMapViewer(options){}\r\n\r\nGoogleMapViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\t\tvar map = document.createElement(\"div\");\r\n\tmap.setAttribute('class', \"gmap-window gmap-viewer\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tghelper.initMap(map, renderer, value, ty);\t\t\r\n    return map;\r\n}\r\n\r\nmodule.exports={GoogleMapViewer};","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLMarkupEditor(options){}\r\nHTMLMarkupEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar input = document.createElement(\"div\");\r\n\tinput.setAttribute('class', \"html-wysiwyg\");\r\n\tvar inner = document.createElement(\"span\");\r\n\tinner.setAttribute('class', \"html-literal literal-value\");\r\n\tinner.innerHTML=value;\r\n\tinput.appendChild(inner);\r\n\tif(typeof Quill != \"undefined\"){\r\n\t\tvar quill = new Quill(inner, { theme: 'snow' });\r\n\t\tquill.on(\"text-change\", function(){\r\n\t\t\trenderer.set(quill.root.innerHTML);\r\n\t\t});\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLMarkupEditor}","function S2EntityEditor(options){}\r\n\r\nS2EntityEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar cls = renderer.frame.range;\r\n\tvar cback = renderer.set;\r\n\tvar ctl = renderer.getController();\r\n\tvar d2ch = new TerminusDocumentChooser(ctl.ui, cls, value);\r\n\td2ch.change = function(val){\r\n\t\trenderer.set(val);\r\n\t}\r\n\td2ch.view = \"label\";\r\n\tvar d2dom = d2ch.getAsDOM();\r\n\treturn d2dom;\r\n}\r\n\r\n\r\nmodule.exports={S2EntityEditor}","const HTMLPropertyViewer = require('./PropertyViewer');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst HTMLDataViewer = require('./DataViewer');\r\n\r\nfunction ValueRenderer(dataframe, index, parent, options){\r\n\tthis.frame = dataframe;\r\n\tthis.index = index;\r\n\tthis.parent = parent;\r\n\tthis.originalValue = this.value();\r\n\tthis.renderer_type = \"value\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nValueRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nValueRenderer.prototype.property = function(){ return (this.parent ? this.parent.property() : false);};\r\nValueRenderer.prototype.subject = function(){ return (this.parent ? this.parent.subject() : false);};\r\nValueRenderer.prototype.subjectClass = function(){ return (this.parent ? this.parent.subjectClass() : false);};\r\nValueRenderer.prototype.type = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.range = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.value = function(){\treturn (this.frame ? this.frame.get() : false);};\r\nValueRenderer.prototype.isDocument = function(){\treturn (this.frame ? this.frame.isDocument() : false);};\r\nValueRenderer.prototype.currentViewer = function(){\treturn this.viewerType;}\r\n\r\nValueRenderer.prototype.copy = function(nf){\r\n\tvar nvr = new ValueRenderer(nf, false, this.parent, this.options);\r\n\tnvr.mode = this.mode;\r\n\tnvr.view = this.view;\r\n\treturn nvr;\r\n}\r\n\r\nValueRenderer.prototype.setFacet = function(facet){\r\n\tthis.facet = facet;\r\n\tthis.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"line\");\r\n\tif(pfacet == \"line\") this.setFacet(\"inline\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"icon\");\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.parent.currentFacet() == \"page\" || this.parent.currentFacet() == \"multiline\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"inline\";\r\n}\r\n\r\nValueRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tinline: {\r\n\t\t\tlabel: \"Inline\", value: \"inline\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"body\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nValueRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nValueRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nValueRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nValueRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tthis.options.mode = mode;\r\n\tthis.viewerType = false;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.options.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getAPIURL = function(a, b){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\tvar apiurl = client.dbURL() + a + \"/\" + b;\r\n\t\t\treturn apiurl;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getClient = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getClient();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getController = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.DBURL = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.dbURL();\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getEntityReference = function(url, cls, entities, opts){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.getEntityReference(url, cls, entities, opts);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.badData = function(bd){\r\n\talert(\"bad data \" + bd);\r\n}\r\n\r\nValueRenderer.prototype.setNew = function(){\r\n\tthis.new_value = true;\r\n}\r\n\r\nValueRenderer.prototype.isNew = function(){\r\n\tif(this.new_value){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\n\r\nValueRenderer.prototype.isUpdated = function(){\r\n\tif(this.frame.get() != this.originalValue){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\telse if(this.isUpdated()) ret.status = \"updated\";\r\n\tvar val = this.frame.get();\r\n\tif(val){\r\n\t\tif(val.length && val.length > this.text_summary_length){\r\n\t\t\tret.long = val.substring(0, this.text_summary_length) + \"...\" + \" (\" + val.length + \" characters)\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret.long = val;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tret.long = \"empty\";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nValueRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nValueRenderer.prototype.set = function(v){\r\n\tthis.frame.set(v);\r\n\tthis.viewer.redrawHeader();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nValueRenderer.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.value(), this.index);\r\n\tthis.parent.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.load = function(link){\r\n\tthis.parent.load(link);\r\n}\r\n\r\nValueRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nValueRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nValueRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nValueRenderer.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.value());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n\tthis.parent.goToValue(this.parent.values.length-1);\r\n}\r\n\r\nValueRenderer.prototype.getViewerForValue = function(){\r\n\treturn new HTMLDataViewer.HTMLDataViewer(this);\r\n}\r\n\r\nValueRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nValueRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\n\r\nValueRenderer.prototype.render = function(viewer){\r\n\tthis.viewer = (viewer ? viewer : this.getViewerForValue());\r\n\treturn this.viewer.render();\r\n}\r\n\r\nValueRenderer.prototype.extract = function(){\r\n\tvar val = this.value();\r\n\tif(val !== \"\" && val !== false){\r\n\t\tif(this.frame.isDatatypeProperty()){\r\n\t\t\tvar objlit = { \"@value\": this.value()}\r\n\t\t\t//var objlit = { data: this.value()}\r\n\t\t\tif(this.frame.isString()) objlit[\"@language\"] = this.frame.lang();\r\n\t\t\telse objlit[\"@type\"] = this.type();\r\n\t\t\treturn objlit;\r\n\t\t}\r\n\t\telse if(this.frame.isChoice() || this.frame.isDocument()){\r\n\t\t\treturn {\"@id\": val}\r\n\t\t}\r\n\t}\r\n\telse return val;\r\n}\r\n\r\nValueRenderer.prototype.getValueHeaderViewer = function(){\r\n\treturn new HTMLDataViewer.HTMLDataHeaderViewer();\r\n}\r\n\r\nValueRenderer.prototype.getDataValueViewer = function(){\r\n\tif(!this.viewerType) {\r\n\t\tthis.viewerType = this.getViewerForDataValue();\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewer(this.viewerType, this.viewerOptions);\r\n}\r\n\r\nValueRenderer.prototype.getAvailableViewers = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailableDataViewers(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailableDataEditors(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.setViewer = function(viewer){\r\n\tthis.viewerType = viewer;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getViewerForDataValue = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getEditorForDataFrame(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewerForDataFrame(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\n\r\n\r\n\r\n\r\nmodule.exports=ValueRenderer\r\n","function TerminusViolations(vios, ui){\r\n\tthis.ui = ui;\r\n\tthis.vios = [];\r\n\tvar nvios = [];\r\n\tfor(var i = 0; i<vios.length; i++){\r\n\t\tfor(var j = 0; j<nvios.length; j++){\r\n\t\t\tif(JSON.stringify(vios[i]) == JSON.stringify(nvios[j])) continue;\r\n\t\t}\r\n\t\tnvios.push(vios[i]);\r\n\t}\r\n\tfor(var i = 0; i<nvios.length; i++){\r\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\r\n\t}\r\n}\r\n\r\nTerminusViolations.prototype.getAsDOM = function(context_msg){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violations terminus-show-msg-vio\");\r\n\tvar vioHeading = document.createElement(\"div\");\r\n\tvioHeading.setAttribute('class', 'terminus-violations-heading');\r\n\tvdom.appendChild(vioHeading);\r\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\r\n\tif(context_msg) msg += \" \" + context_msg;\r\n\tvioHeading.appendChild(document.createTextNode(msg));\r\n\tfor(var i = 0; i<this.vios.length; i++){\r\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Class for displaying violation reports as HTML\r\n */\r\nfunction TerminusViolation(vio, ui){\r\n\tthis.ui = ui;\r\n\tthis.vio = vio;\r\n}\r\n\r\nTerminusViolation.prototype.getAsDOM = function(){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\r\n\tif(this.vio['@type']){\r\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\r\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\r\n\t}\r\n\tfor(var prop in this.vio){\r\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\r\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\r\n\t\t}\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\r\n\tvar pdom = document.createElement(\"div\");\r\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\r\n\tvar ldom = document.createElement(\"span\");\r\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\r\n\tldom.appendChild(document.createTextNode(prop));\r\n\tvar vdom = document.createElement(\"span\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\r\n\tvdom.appendChild(document.createTextNode(val[\"@value\"]));\r\n\tpdom.appendChild(ldom);\r\n\tpdom.appendChild(vdom);\r\n\treturn pdom;\r\n}\r\n\r\nmodule.exports=TerminusViolations\r\n","/*const WOQLQuery = require('../query/WOQLQuery'); */\r\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst WOQLTextboxGenerator = require('../query/WOQLTextboxGenerator');\r\nconst TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusQueryViewer(ui, options){\r\n\tthis.ui = ui;\r\n\tthis.options = options;\r\n\tthis.meta = {};\r\n\tthis.init();\r\n\tthis.generator = false;\r\n\tthis.result = false;\r\n\tvar y = new TerminusClient.WOQLResult();\r\n\t//this.wquery = TerminusClient.WOQL;\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.gentype = (options && options.generator ? options.generator : \"textbox\");\r\n\tthis.generators = {\r\n\t\t\"textbox\" : { label: \"Simple Text Box\", value: \"textbox\"},\r\n\t}\r\n\tthis.loadGenerator();\r\n}\r\n\r\nTerminusQueryViewer.prototype.hasGeneratorOptions = function(){\r\n\treturn false;\r\n\tvar yup = false;\r\n\tfor(var gen in this.generators){\r\n\t\tif(yup) return true;\r\n\t\telse yup = true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusQueryViewer.prototype.changeGenerator = function(ng){\r\n\tif(this.gentype != ng){\r\n\t\tthis.gentype = ng;\r\n\t\tthis.loadGenerator();\r\n\t\tthis.redrawGenerator();\r\n\t}\r\n}\r\nTerminusQueryViewer.prototype.redrawGenerator = function(q){\r\n\tTerminusClient.FrameHelper.removeChildren(this.inputDOM);\r\n\tthis.inputDOM.appendChild(this.getQueryButtonsDOM(q));\r\n}\r\n\r\nTerminusQueryViewer.prototype.loadGenerator = function(){\r\n\tvar self = this;\r\n\tvar nquery = function(q, settings){\r\n\t\tself.query(q, settings)\r\n\t}\r\n\tif(this.gentype == \"textbox\"){\r\n\t\tthis.generator = new WOQLTextboxGenerator(nquery, this, this.ui);\r\n\t}\r\n}\r\n\r\nTerminusQueryViewer.prototype.init = function(){\r\n\t//var wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar wq = TerminusClient.WOQL\r\n\t\t\t\t.limit(20)\r\n\t\t\t\t.start(0)\r\n\t\t\t\t.elementMetadata();\r\n\tvar self = this;\r\n\tself.meta = {};\r\n\t//wq.execute(woql).then(function(wresult){\r\n\twq.execute(this.ui.client).then(function(wresult){\r\n\t\tvar wqlR = new WOQLResultsViewer.WOQLResult(wresult, null ,null, self.ui);\r\n\t\tif(wqlR.hasBindings(wresult)){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar el = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", wresult.bindings[i]);\r\n\t\t\t\tif(el && typeof self.meta[el] == \"undefined\"){\r\n\t\t\t\t\tself.meta[el] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.error(e);\r\n\t});\r\n}\r\n\r\nTerminusQueryViewer.prototype.query = function(val, settings, tab){\r\n\tvar self = this;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tval.execute(this.ui.client)\r\n\t.then(function(result){\r\n\t\t//TerminusClient.WOQLResult(results, query, config){\r\n\t\tvar wqRes = new TerminusClient.WOQLResult(result, val);\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, self.wquery, self.options, settings, true);\r\n\t\tvar nd = self.result.getAsDOM(self.resultDOM, true);\r\n\t\tif(nd){\r\n\t\t\t self.resultDOM.appendChild(nd);\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tself.ui.showError(err);\r\n\t});\r\n}\r\n\r\nTerminusQueryViewer.prototype.getResultViewDom = function(){\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\r\n}\r\n\r\nTerminusQueryViewer.prototype.getAsDOM = function(q){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-page\");\r\n\tif(this.hasGeneratorOptions()){\r\n\t\tqbox.appendChild(this.getQueryCreatorChoiceDOM(q));\r\n\t}\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results terminus-query-section\");\r\n\r\n\tvar qtHolder = document.createElement('span');\r\n\tqtHolder.setAttribute('style', 'display: flex;');\r\n\r\n\tthis.qTextBox = this.getQueryTextAreaDOM(q, qtHolder);\r\n\tthis.buttonsDOM = document.createElement(\"span\");\r\n\tthis.buttonsDOM.setAttribute(\"class\", \"terminus-query-input\");\r\n\tthis.buttonsDOM.appendChild(this.getQueryButtonsDOM(q, this.qTextBox));\r\n\r\n\tqtHolder.appendChild(this.buttonsDOM);\r\n\r\n\tqbox.appendChild(qtHolder);\r\n\tqbox.appendChild(this.resultDOM);\r\n\treturn qbox;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryCreatorChoiceDOM = function(){\r\n\tvar qcc = document.createElement(\"select\");\r\n\tqcc.setAttribute(\"class\", \"terminus-query-generator-selector\");\r\n\tfor(var c in this.generators){\r\n\t\tvar gen = this.generators[c];\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = (gen.value ? gen.value : c);\r\n\t\tvar lab = (gen.label ? gen.label : c);\r\n\t\topt.appendChild(document.createTextNode(lab));\r\n\t\tqcc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tqcc.addEventListener(\"change\", function(){\r\n\t\tself.changeGenerator(this.value);\r\n\t});\r\n\treturn qcc;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryButtonsDOM = function(q, qip){\r\n\treturn this.generator.getAsDOM(q, qip);\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryTextAreaDOM = function(q, box){\r\n\treturn this.generator.getQueryTextAreaDOM(q, box);\r\n}\r\n\r\nmodule.exports=TerminusQueryViewer\r\n","const TerminusClassChooser = require('../client/TerminusClassChooser');\r\nconst TerminusPropertyChooser = require('../client/TerminusPropertyChooser');\r\nconst TerminusDocumentChooser = require('../client/TerminusDocumentChooser');\r\nconst UTILS= require('../Utils')\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLTextboxGenerator(tq, qman, ui){\r\n\tthis.query = tq;\r\n\tthis.wquery = qman.wquery;\r\n\tthis.ui = ui;\r\n\t// default datatable settings if datatable plug in available\r\n\tthis.datatable = {};\r\n\tthis.datatable.pageLength = 25;\r\n\tthis.datatable.start = 0;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.gatherDatatableSettings = function(txtArea, queryName){\r\n\tthis.datatable.qTextDom =  txtArea;\r\n\tthis.datatable.query =  queryName;\r\n\tthis.datatable.chosenValue = null;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryButtonGroups = function(qbox){\r\n\tvar row = document.createElement('div');\r\n\trow.setAttribute('class', 'terminus-query-group-row');\r\n\tqbox.appendChild(row);\r\n\treturn row;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.qGroupQueries = function(qrow, header, descr){\r\n\tvar g = document.createElement('button');\r\n\tvar self = this;\r\n\tg.addEventListener('click', function(e){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(header == 'Data Queries'){ // to ensure click event is not on button but on select instead so no need to hide\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'SELECT')) return;\r\n\t\t}\r\n\t\telse if(header == 'Document Queries'){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'INPUT')) return;\r\n\t\t}\r\n\t\tfor(var i=0; i<this.children.length ; i++){\r\n\t\t\tUTILS.toggleVisibility(this.children[i]);\r\n\t\t}\r\n\t\tvar qeb = document.getElementsByClassName('query-example-buttons');\r\n\t\tfor(var i=0; i<qeb.length ; i++){\r\n\t\t\tif(this != qeb[i]){\r\n\t\t\t\tfor(var j=0; j<qeb[i].children.length ; j++){\r\n\t\t\t\t\tif(qeb[i].children[j].classList.contains('terminus-display')){\r\n\t\t\t\t\t\tqeb[i].children[j].classList.remove('terminus-display');\r\n\t\t\t\t\t\tqeb[i].children[j].classList.add('terminus-hide');\r\n\t\t\t\t    }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\tg.setAttribute('class', 'terminus-group-box terminus-pointer query-example-buttons');\r\n\r\n\tvar cd = document.createElement('div');\r\n\tcd.setAttribute('class', 'terminus-group');\r\n\tg.appendChild(cd);\r\n\r\n\tvar ch = document.createElement('div');\r\n\tch.setAttribute('class', 'terminus-group-header');\r\n\tcd.appendChild(ch);\r\n\r\n\tvar d = document.createElement('div');\r\n\td.setAttribute('class', 'terminus-query-block-headers')\r\n\td.appendChild(document.createTextNode(header));\r\n\tch.appendChild(d);\r\n\tic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-hand-pointer-float fa fa-hand-pointer');\r\n\td.appendChild(ic);\r\n\r\n\tvar t = document.createElement('h5');\r\n\tt.setAttribute('class', 'terminus-group-sub-title terminus-hide');\r\n\tt.appendChild(document.createTextNode(descr));\r\n\tg.appendChild(t);\r\n\r\n\tqrow.appendChild(g);\r\n\r\n\treturn g;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.setDatatableSettings = function(query){\r\n\tif(query.limit){\r\n\t\tthis.datatable.pageLength = query.limit[0];\r\n\t\tthis.datatable.start = query.limit[1].start[0];\r\n\t}\r\n\t/*\r\n\tvar newQuery = query.replace(/\\s/g,'');  // remove spaces\r\n\tvar searchStr = 'limit(';\r\n\tif(newQuery.indexOf(searchStr) !== -1){\r\n\t\tvar remString = newQuery.substring(searchStr.length, newQuery.length);\r\n\t\tvar limit = remString.substr(0, remString.indexOf(','));\r\n\t\tthis.datatable.pageLength = limit;\r\n\t\tthis.datatable.start = 0;\r\n\t}*/\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryFormatSelect = function(){\r\n\tvar fsel = document.createElement('select');\r\n\tfsel.setAttribute('class', 'terminus-doc-config');\r\n\tvar owoql = document.createElement('option');\r\n\towoql.setAttribute('value', 'frame');\r\n\towoql.appendChild(document.createTextNode('WOQL'));\r\n\tfsel.appendChild(owoql);\r\n\tvar ojson = document.createElement('option');\r\n\tojson.setAttribute('value', 'jsonld');\r\n\tojson.appendChild(document.createTextNode('JSON-LD'));\r\n\tfsel.appendChild(ojson);\r\n\tvar self = this;\r\n\tfsel.addEventListener('change', function(){\r\n\t\tself.queryMode = this.value;\r\n\t})\r\n\treturn fsel;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryTextAreaDOM = function(q, box){\r\n\tvar qbox = document.createElement(\"span\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input terminus-query-section\");\r\n\r\n\tvar head = document.createElement('span');\r\n\thead.setAttribute('class', 'terminus-display-flex');\r\n\tvar eqh = document.createElement(\"H3\");\r\n\teqh.appendChild(document.createTextNode(\"Enter Query in format\"));\r\n\teqh.setAttribute('class', 'terminus-full-css-margin-top terminus-query-head');\r\n\thead.appendChild(eqh);\r\n\tvar fmt = this.getQueryFormatSelect();\r\n\thead.appendChild(fmt);\r\n\tqbox.appendChild(head);\r\n\r\n\tvar qip = document.createElement(\"textarea\");\r\n\tqip.setAttribute(\"class\", \"terminus-query-box\");\r\n\tqip.setAttribute(\"placeholder\", \"Enter new query or load queries from example buttons provided below ...\");\r\n\tqip.setAttribute(\"style\", \"min-width: 400px; min-height: 60px;\");\r\n\tif(q) qip.value = JSON.stringify(q,undefined, 2);\r\n\tqbox.appendChild(qip);\r\n\tUTILS.stylizeEditor(this.ui, qip, 'query', 'javascript');\r\n\tvar self = this;\r\n\tvar qbut = document.createElement(\"button\");\r\n\tqbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\")\r\n\tqbut.appendChild(document.createTextNode(\"Send Query\"));\r\n\tqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\ttry {\r\n\t\t\tvar qval = JSON.parse(qip.value);\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\t// pass current Example query scope while editing the text editor\r\n\t\t\t\tself.gatherDatatableSettings(qip, self.datatable.query);\r\n\t\t\t\tself.setDatatableSettings(qval);\r\n\t\t\t\tself.query(qval, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qval);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"Failed to parse Query \" + e.toString());\r\n\t\t}\r\n\t})\r\n\tqbox.appendChild(qbut);\r\n\tbox.appendChild(qbox);\r\n\treturn qip;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getAsDOM = function(q, qip){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\r\n\tvar qbuts = document.createElement(\"div\");\r\n\tqbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\t//qbuts.appendChild(qbut);\r\n\tqbox.appendChild(qbuts);\r\n\tvar qexs = document.createElement(\"div\");\r\n\tqexs.setAttribute(\"class\", \"terminus-query-examples terminus-db-list-title\");\r\n\tvar qh = document.createElement(\"H3\");\r\n\tqh.appendChild(document.createTextNode(\"Saved Queries\"));\r\n\tqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\r\n\tqexs.appendChild(qh);\r\n\r\n\tvar qrow = this.getQueryButtonGroups(qexs);\r\n\tqexs.appendChild(qrow);\r\n\r\n\t/* grouping class queries */\r\n\tvar qcGroup = this.qGroupQueries(qrow, 'Schema Queries', '');\r\n\r\n\tvar nqbut = document.createElement(\"button\");\r\n\tnqbut.appendChild(document.createTextNode(\"Show All Classes\"));\r\n\tnqbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tnqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qval = self.wquery.getClassMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qval,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Classes');\r\n\t\t\tself.query(qval, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qval);\r\n\t})\r\n\r\n\tvar aqbut = document.createElement(\"button\");\r\n\taqbut.appendChild(document.createTextNode(\"Show Document Classes\"));\r\n\taqbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\taqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getClassMetaDataQuery(self.wquery.getConcreteDocumentClassPattern(\"v:Element\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Classes');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\tvar ebut = document.createElement(\"button\");\r\n\tebut.appendChild(document.createTextNode(\"Show All Schema Elements\"));\r\n\tebut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tvar self = this;\r\n\tebut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qval = TerminusClient.WOQL.limit(20)\r\n\t\t\t\t\t.start(0)\r\n\t\t\t\t\t.elementMetadata();//.prettyPrint();\r\n\r\n\t\t\t\t//\tfunction(indent, show_context, q){\r\n\r\n\t\t//var qval = self.wquery.getElementMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qval.prettyPrint(),undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Schema_Elements');\r\n\t\t\tself.query(qval, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qval);\r\n\t})\r\n\tvar dbut = document.createElement(\"button\");\r\n\tdbut.appendChild(document.createTextNode(\"Show All Documents\"));\r\n\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tdbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getAllDocumentQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Documents');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\tvar pbut = document.createElement(\"button\");\r\n\tpbut.appendChild(document.createTextNode(\"Show All Data\"));\r\n\tpbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tpbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getEverythingQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Data');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\tvar prbut = document.createElement(\"button\");\r\n\tprbut.appendChild(document.createTextNode(\"Show All Properties\"));\r\n\tprbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tprbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getPropertyListQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Properties');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\t/* grouping data queries */\r\n\tvar qdGroup = this.qGroupQueries(qrow, 'Data Queries', '');\r\n\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"Show data of type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(new_class){\r\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\t\tvar qvalue = self.wquery.getDataOfChosenClassQuery(new_class, self.datatable.pageLength, self.datatable.start);\r\n\t\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Data_Class');\r\n\t\t\t\tself.datatable.chosenValue = new_class; // set chosen val from drop down\r\n\t\t\t\tself.query(qvalue, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qvalue);\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-query-select');\r\n\r\n\tvar termpc = new TerminusPropertyChooser(this.ui);\r\n\ttermpc.empty_choice = \"Show property data\";\r\n\tvar self = this;\r\n\ttermpc.change = function(new_property){\r\n\t\tif(new_property){\r\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\t\tvar qvalue = self.wquery.getDataOfChosenPropertyQuery(new_property, self.datatable.pageLength, self.datatable.start);\r\n\t\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Property_Class');\r\n\t\t\t\tself.datatable.chosenValue = new_property; // set chosen val from drop down\r\n\t\t\t\tself.query(qvalue, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qvalue);\r\n\t\t}\r\n\t}\r\n\r\n\t/* grouping document queries */\r\n\tvar qdocGroup = this.qGroupQueries(qrow, 'Document Queries', '');\r\n\r\n\tvar pdom = termpc.getAsDOM();\r\n\r\n\tvar docch = new TerminusDocumentChooser(this.ui);\r\n\tdocch.change = function(val){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getDocumentQuery(val, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Info_by_Id');\r\n\t\t\tself.datatable.chosenValue = val;\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t}\r\n\tvar docdom = docch.getAsDOM('terminus-query-select');\r\n\r\n\tvar d2ch = new TerminusDocumentChooser(this.ui, TerminusClient.FrameHelper.unshorten(\"tcs:Document\"));\r\n\td2ch.view = \"label\";\r\n\td2ch.change = docch.change;\r\n\tvar d2dom = d2ch.getAsDOM('terminus-query-select');\r\n\tvar p = document.createElement(\"p\");\r\n\tp.appendChild(d2dom);\r\n\r\n\t/* class queries */\r\n\tvar clGroup = document.createElement('div');\r\n\tclGroup.setAttribute('class', 'terminus-hide ');\r\n\tclGroup.appendChild(ebut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(nqbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(aqbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(prbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tqcGroup.appendChild(clGroup);\r\n\r\n\tqbox.appendChild(qexs);\r\n\r\n\t/* data queries */\r\n\tvar dtGroup = document.createElement('div');\r\n\tdtGroup.setAttribute('class', 'terminus-hide');\r\n\tdtGroup.appendChild(tcdom);\r\n\tdtGroup.appendChild(pdom);\r\n\r\n\tvar br = document.createElement('BR');\r\n\tdtGroup.appendChild(br);\r\n\tdtGroup.appendChild(pbut);\r\n\tqdGroup.appendChild(dtGroup);\r\n\r\n\r\n\t/* document queries */\r\n\tvar docGroup = document.createElement('div');\r\n\tdocGroup.setAttribute('class', 'terminus-hide');\r\n\tdocGroup.appendChild(docdom);\r\n\tdocGroup.appendChild(dbut);\r\n\t//docGroup.appendChild(p);\r\n\tqdocGroup.appendChild(docGroup);\r\n\r\n\treturn qbox;\r\n}\r\n\r\nmodule.exports=WOQLTextboxGenerator\r\n","/*\r\n * Utility Property which runs a query against the schema and presents the returned Propertyes as a drop-down / Property filter list\r\n */\r\nconst WOQLQuery = require('../query/WOQLQuery');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nTerminusPropertyChooser = function(ui, filter){\r\n\tthis.ui = ui;\r\n\tthis.choice = false;\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify Property chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getAsDOM = function(){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"Class\", \"terminus-Class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"Class\", \" terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tif(this.value != this.choice){\r\n\t\t\tthis.choice = this.value;\r\n\t\t\tself.change(this.value);\r\n\t\t}\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = new WOQLQuery(this.ui.client, false, this.ui);\r\n\tvar woql = wq.getPropertyListQuery(this.filter);\r\n\tvar self = this;\r\n\twq.execute(woql)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tccsel.appendChild(opts[i]);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(this.empty_choice){\r\n\t\tvar opt1 = document.createElement(\"option\");\r\n\t\topt1.setAttribute(\"Class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\topt1.value = \"\";\r\n\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\tchoices.push(opt1);\r\n\t}\r\n\tvar labopt = document.createElement(\"option\");\r\n\tlabopt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\tlabopt.value = \"rdfs:label\";\r\n\tlabopt.appendChild(document.createTextNode(\"Label\"));\r\n\tchoices.push(labopt);\r\n\r\n\tvar comopt = document.createElement(\"option\");\r\n\tcomopt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\tcomopt.value = \"rdfs:comment\";\r\n\tcomopt.appendChild(document.createTextNode(\"Comment\"));\r\n\tchoices.push(comopt);\r\n\r\n\tif(clist.bindings){\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar cprop = HTMLFrameHelper.getVariableValueFromBinding(\"Property\", clist.bindings[i]);\r\n\t\t\tif(cprop && added.indexOf(cprop) == -1){\r\n\t\t\t\tadded.push(cprop);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = cprop;\r\n\t\t\t\tvar lab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(cprop);\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\n\r\n\r\nmodule.exports=TerminusPropertyChooser\r\n","function TerminusMappingViewer(ui, mode){\r\n\tthis.ui = ui;\r\n\tthis.mode = (mode ? mode : \"data\");\r\n}\r\n\r\nTerminusMappingViewer.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-mapping-page terminus-page\");\r\n\tvar tsel = document.createElement(\"select\");\r\n\tvar o1 = document.createElement(\"option\");\r\n\to1.value = \"data\";\r\n\to1.appendChild(document.createTextNode(\"Data Map\"))\r\n\ttsel.appendChild(o1);\r\n\tvar o2 = document.createElement(\"option\");\r\n\to2.value = \"model\";\r\n\to2.appendChild(document.createTextNode(\"Model Map\"))\r\n\ttsel.appendChild(o2);\r\n\tvar ff = this.getFormFieldDOM(\"Map Type\");\r\n\tff.appendChild(tsel);\r\n\tscd.appendChild(ff);\r\n\tvar source = this.getFormField(scd, \"Map Source\");\r\n\tvar target = this.getFormField(scd, \"Map Target\");\r\n\tvar queries = this.getFormField(scd, \"Queries\");\r\n\tvar options = this.getFormField(scd, \"Options\");\r\n\t\r\n\tvar mdom = this.getFormFieldDOM(\"Existing Mapping\");\r\n\tvar mapping = document.createElement(\"input\");\r\n\tmapping.setAttribute(\"type\", \"text\");\r\n\tmapping.setAttribute(\"size\", 80);\r\n\tmdom.appendChild(mapping);\r\n\tscd.appendChild(mdom);\r\n\t\r\n\tvar submit = document.createElement(\"button\");\r\n\tsubmit.setAttribute(\"class\", \"terminus-btn terminus-control-button\");\r\n\tsubmit.appendChild(document.createTextNode(\"Execute Mapping\"));\r\n\tvar self = this;\r\n\tsubmit.addEventListener(\"click\", function(){\r\n\t\tvar jsonip = {\r\n\t\t\tmap_source: JSON.parse(source.value),\r\n\t\t};\r\n\t\tif(tsel.value == \"data\"){\r\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:DataMap\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:ModelMap\";\t\t\t\r\n\t\t}\r\n\t\tif(target.value) jsonip.map_target = target.value;\r\n\t\tif(queries.value) jsonip.queries = queries.value;\r\n\t\tif(options.value) jsonip.options = options.value;\r\n\t\tif(mapping.value) jsonip.mapping = mapping.value;\r\n\t\tself.ui.client.update(false, jsonip);\r\n\t})\r\n\tscd.appendChild(submit);\r\n\treturn scd;\r\n}\r\n\r\nTerminusMappingViewer.prototype.getFormFieldDOM = function(label){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-mapping-field\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-form-label terminus-mapping-label\");\r\n\tlab.appendChild(document.createTextNode(label));\r\n\tsci.appendChild(lab);\r\n\treturn sci;\r\n}\r\n\r\nTerminusMappingViewer.prototype.getFormField = function(holder, label){\r\n\tvar ff = this.getFormFieldDOM(label);\r\n\tvar source = document.createElement(\"textarea\");\r\n\tsource.setAttribute(\"class\", \"terminus-form-value terminus-textarea\");\r\n\tff.appendChild(source);\r\n\tholder.appendChild(ff);\r\n\treturn source;\r\n}\r\n\r\nmodule.exports=TerminusMappingViewer\r\n","/*\r\n * Draws the screen for viewing and updating the schema\r\n * and provides wrappers around the client's schema API\r\n */\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst UTILS=require('../Utils')\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusSchemaViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.mode = \"view\";\r\n\tthis.format = \"turtle\";\r\n\tthis.confirm_before_update = false;\r\n}\r\n\r\n/*\r\n * Retrieves schema from API and writes the response into the page\r\n */\r\nTerminusSchemaViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\r\n\tthis.loadSchema();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Fetching Database Schema\");\r\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.schema = response;\r\n\t\tself.refreshPage(msg, msgtype);\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.controldom);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaSaveButtons());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaImportActionButtons());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getShowSchemaButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n\telse if(this.mode == \"view\"){\r\n\t\tif(this.ui.showControl(\"update_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getSchemaEditButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"import_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getImportButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"schema_format\")){\r\n\t\t\tthis.controldom.appendChild(this.getFormatChoices());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\r\n\tvar fc = document.createElement(\"select\");\r\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\r\n\tvar tc = document.createElement(\"option\");\r\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\r\n\ttc.value = \"turtle\";\r\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\r\n\tif(this.format == \"turtle\") tc.selected = true;\r\n\tfc.appendChild(tc);\r\n\tvar tj = document.createElement(\"option\");\r\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\r\n\ttj.value = \"jsonld\";\r\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\r\n\tif(this.format == \"jsonld\") tj.selected = true;\r\n\tfc.appendChild(tj);\r\n\tvar self = this;\r\n\tfc.addEventListener(\"change\", function(e){\r\n\t\tself.format = this.value;\r\n\t\tself.loadSchema();\r\n\t});\r\n\treturn fc;\r\n}\r\n\r\n\r\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\r\n\tif(this.controldom) this.resetControlDOM();\r\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\r\n\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\tif(this.mode == 'view'){\r\n\t\tthis.pagedom.appendChild(this.getSchemaViewDOM());\r\n\t}\r\n\telse if(this.mode == \"edit\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaEditDOM());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaImportDOM());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tthis.pagedom.appendChild(this.getClassFrameDOM());\r\n\t}\r\n\tif(msg){\r\n\t\tthis.ui.showMessage(msg, msgtype);\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\tssb.appendChild(this.getSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\r\n\tssb.appendChild(this.getCancelButton(true));\r\n\tssb.appendChild(this.getImportSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"preview\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getCancelButton = function(is_import){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tif(is_import){\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(typeof self.doImport == \"function\"){\r\n\t\t\tself.doImport();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tvar text = self.schema_edit_dom.value;\r\n\t\tif(typeof(self.schema) == \"object\"){\r\n\t\t\ttext = JSON.parse(text);\r\n\t\t}\r\n\t\treturn self.updateSchema(text, {\"terminus:encoding\": \"terminus:\" + self.format});\r\n\t}\r\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"import\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Import New Schema\", \"import_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\r\n\tvar opt = document.createElement(\"button\");\r\n\topt.appendChild(document.createTextNode(label));\r\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\r\n\topt.addEventListener(\"click\", func);\r\n\treturn opt;\r\n}\r\n\r\n/*\r\n * Updates schema, then fetches updated version and updates the page with it\r\n */\r\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts){\r\n\tthis.ui.showBusy(\"Updating Database Schema\");\r\n\tvar self = this;\r\n\treturn this.ui.client.updateSchema(false, text, opts)\r\n\t.then(function(response){\r\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\r\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\r\n\t\t\tself.mode = \"view\";\r\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\r\n\t\t}\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"schema\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/*\r\n * Imports a schema from the passed url\r\n * mode: replace | append\r\n */\r\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\r\n\tvar self = this;\r\n\tmode = (mode ? mode : \"replace\");\r\n\tthis.ui.showBusy(\"Loading schema from \" + url);\r\n\tvar origurl = this.ui.client.connectionConfig.schemaURL();\r\n\treturn this.ui.client.getSchema(url, {\"terminus:user_key\": key, \"terminus:encoding\" : \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\r\n\t\tif(self.confirm_before_update){\r\n\t\t\t//reconnect to original db\r\n\t\t\tself.ui.showResult(\"Schema retrieved - click save to deploy\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.showConfirmPage(newschema);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showBusy(\"Updating schema\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.updateSchema(newschema, {\"terminus:encoding\": \"terminus:\" + self.format}).then(function(response){\r\n\t\t\t\tself.mode = \"view\";\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tself.ui.redraw();\r\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\r\n\tvar nschema = this.schema;\r\n\tif(this.format == 'turtle'){\r\n\t\tnschema = this.schema + s2;\r\n\t}\r\n\telse if(this.format == 'jsonld'){\r\n\t\tfor(var i in s2){\r\n\t\t\tnschema[i] = s2[i];\r\n\t\t}\r\n\t}\r\n\treturn nschema;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameChooser = function(){\r\n\tvar np = document.createElement(\"span\");\r\n\tnp.setAttribute(\"class\", \"terminus-class frame-chooser\");\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"View Individual Class Frames\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.cls = new_class;\r\n\t\t\tif(self.mode != \"class_frame\"){\r\n\t\t\t\tself.mode = \"class_frame\";\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.refreshMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM();\r\n\tnp.appendChild(tcdom);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-classframe-page\");\r\n\tvar docviewer = new TerminusDocumentViewer(this.ui, \"model\");\r\n\tdocviewer.loadCreateDocument(this.cls);\r\n\tdocviewer.page_config = \"model\";\r\n\tnp.appendChild(docviewer.getAsDOM());\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\r\n\tthis.schema = newschema;\r\n\tthis.confirm_before_update = false;\r\n\tthis.mode = \"edit\";\r\n\tthis.refreshPage(\"Confirm new schema\");\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\r\n\tvar ipval = document.createElement(\"textarea\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\r\n\tipval.setAttribute(\"width\", \"100%\");\r\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tipval.innerHTML = this.schema;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tthis.schema_edit_dom = ipval;\r\n\tnp.appendChild(ipval);\r\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\r\n\tvar self = this;\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\r\n\tvar ipval = document.createElement(\"pre\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\r\n         .replace(/</g, \"&lt;\")\r\n         .replace(/>/g, \"&gt;\")\r\n         .replace(/\"/g, \"&quot;\")\r\n         .replace(/'/g, \"&#039;\");\r\n\t\tipval.innerHTML = txt;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\r\n\tif(!cm) np.appendChild(ipval);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form-border terminus-schema-page terminus-schema-import-page\");\r\n\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"URL\"));\r\n\tsci.appendChild(slab);\r\n\tvar inpUrl  = document.createElement(\"input\");\r\n\tinpUrl.setAttribute(\"type\", \"text\");\r\n\tinpUrl.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-form-url terminus-url-connect\");\r\n\tinpUrl.setAttribute(\"placeholder\", \"Enter URL of DB to import from\");\r\n\tsci.appendChild(inpUrl);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label  terminus-control-label terminus-import_mode-input\");\r\n\tklab.appendChild(document.createTextNode(\"Import Mode\"));\r\n\tsci.appendChild(klab);\r\n\tvar modes = document.createElement(\"select\");\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\r\n\r\n\tvar overwrite = document.createElement(\"option\");\r\n\toverwrite.value = \"replace\";\r\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\r\n\tmodes.appendChild(overwrite);\r\n\tvar append = document.createElement(\"option\");\r\n\tappend.value = \"append\";\r\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\r\n\tmodes.appendChild(append);\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(modes);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input terminus-control-label\");\r\n\tklab.appendChild(document.createTextNode(\"Key\"))\r\n\tvar key = document.createElement(\"input\");\r\n\tkey.setAttribute(\"type\", \"text\");\r\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-url-key\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(key);\r\n\tscd.appendChild(sci);\r\n\tvar self = this;\r\n\tthis.doImport = function(){\r\n\t\tif(inpUrl.value){\r\n\t\t\tself.load(inpUrl.value, key.value, modes.value);\r\n\t\t}\r\n\t}\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports=TerminusSchemaViewer\r\n","/* User interface elements that relate to server context\r\n *\r\n * TerminusServerController is a control widget that invokes server actions\r\n * TerminusServerViewer is a window that displays server actions and server screens\r\n *\r\n */\r\n const Datatables = require('../plugins/datatables.terminus');\r\n const UTILS =require('../Utils');\r\n const HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\n function TerminusServerController(ui){\r\n\t this.ui = ui;\r\n }\r\n\r\nTerminusServerController.prototype.getAsDOM = function(){\r\n\tvar rsc = document.createElement(\"div\");\r\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\r\n\tvar self = this;\r\n\tif(this.ui && this.ui.server()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-connectiAlso, the title / hover stuff should include the full entry when it is shortened (for urls / comments) so when I hover over it I should see the full texton\");\r\n        var nav = document.createElement('div');\r\n        nav.setAttribute('class', 'span3');\r\n        var ul = document.createElement('ul');\r\n        ul.setAttribute('class', 'terminus-ul');\r\n        nav.appendChild(ul);\r\n        rsc.appendChild(nav);\r\n        // connected to server\r\n        var a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Server: ' + this.ui.server();\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n        // change server\r\n        if(this.ui.showControl(\"change-server\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                self.ui.showLoadURLPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Change Server');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        // view databases\r\n        if(this.ui.showControl(\"db\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showServerMainPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('View Databases');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        if(this.ui.showControl(\"create_database\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showCreateDBPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Create New Database');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n\t}\r\n\treturn rsc;\r\n}\r\n\r\nTerminusServerController.prototype.getServerLabelDOM = function(){\r\n\tvar srec = this.ui.client.connection.getServerRecord();\r\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\r\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\r\n\tdesc += \" Server URL: \"+ this.ui.server();\r\n\tvar val = document.createElement(\"span\");\r\n\tval.setAttribute(\"class\", \"terminus-server-value\");\r\n\tval.setAttribute(\"title\", desc);\r\n\tval.appendChild(document.createTextNode(lab));\r\n    val =  document.createElement('div');\r\n\treturn val;\r\n}\r\n\r\nfunction TerminusServerViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.max_cell_size = 500;\r\n\tthis.max_word_size = 40;\r\n}\r\n\r\nTerminusServerViewer.prototype.getAsDOM = function(selected){\r\n\tvar self = this;\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\r\n\tif(this.ui.server()){\r\n\t\tvar scd = document.createElement(\"span\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\r\n\t\tif(this.ui.showView(\"server\")){\r\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\r\n\t\t}\r\n\t\tif(this.ui.showView(\"change-server\")){\r\n\t\t\tvar csbut = document.createElement(\"button\");\r\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\r\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\r\n\t\t\tcsbut.addEventListener(\"click\", function(){\r\n\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t//self.ui.clearServer();\r\n\t\t\t\tself.ui.showLoadURLPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(csbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"create_database\")){\r\n\t\t\tvar crbut = document.createElement(\"button\");\r\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\r\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\r\n\t\t\tcrbut.addEventListener(\"click\", function(){\r\n\t\t\t\tif(self.ui.db()){\r\n\t\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t}\r\n\t\t\t\tself.ui.clearMessages();\r\n\t\t\t\tself.ui.showCreateDBPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(crbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"db\")){\r\n\t\t\tscd.appendChild(this.getDBListDOM());\r\n\t\t}\r\n\t\tpd.appendChild(scd);\r\n\t}\r\n\telse {\r\n\t\tself.ui.showLoadURLPage();\r\n\r\n\t\t//pd.appendChild(this.getLoadURLPage());\r\n\t}\r\n\treturn pd;\r\n}\r\n\r\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\r\n\tvar scl = document.createElement(\"span\");\r\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\r\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\r\n\tscs.appendChild(document.createTextNode(this.ui.server()))\r\n\tscd.appendChild(scl);\r\n\tscd.appendChild(scs);\r\n\treturn scd;\r\n}\r\n\r\nTerminusServerViewer.prototype.wrapTableLinkCell = function(tdElement,dbid, text){\r\n\tvar self = this;\r\n\tvar wrap = document.createElement(\"p\");\r\n//\twrap.setAttribute(\"href\", \"#\");\r\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\tHTMLFrameHelper.wrapShortenedText(wrap, text, this.max_cell_size, this.max_word_size);\r\n\ttdElement.addEventListener(\"click\", function(){\r\n\t\tself.ui.connectToDB(dbid);\r\n\t\tself.ui.showDBMainPage();\r\n\t});\r\n\treturn wrap;\r\n}\r\n\r\nTerminusServerViewer.prototype.getDBListDOM = function(){\r\n\tvar self = this;\r\n\tvar sec = document.createElement(\"div\");\r\n\tvar lihed = document.createElement(\"h3\");\r\n\tlihed.setAttribute(\"class\", \"terminus-db-list-title terminus-module-head\");\r\n\tlihed.appendChild(document.createTextNode(\"Available Databases\"));\r\n\tsec.appendChild(lihed);\r\n\tvar scd = document.createElement(\"table\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th1 = document.createElement(\"th\");\r\n\tth1.appendChild(document.createTextNode(\"ID\"));\r\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-header-full-css\");\r\n\tvar th2 = document.createElement(\"th\");\r\n\tth2.appendChild(document.createTextNode(\"Title\"));\r\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-header-full-css\");\r\n\tvar th3 = document.createElement(\"th\");\r\n\tth3.appendChild(document.createTextNode(\"Description\"));\r\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-header-full-css\");\r\n\tvar th4 = document.createElement(\"th\");\r\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-header-full-css\");\r\n\tth4.appendChild(document.createTextNode(\"Size\"));\r\n\tvar th5 = document.createElement(\"th\");\r\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-header-full-css\");\r\n\tth5.appendChild(document.createTextNode(\"Created\"));\r\n\tvar th6 = document.createElement(\"th\");\r\n\tth6.appendChild(document.createTextNode(\"Delete\"));\r\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-header-full-css\");\r\n\tthr.appendChild(th1);\r\n\tthr.appendChild(th2);\r\n\tthr.appendChild(th3);\r\n\t//thr.appendChild(th4);\r\n\t//thr.appendChild(th5);\r\n\tthr.appendChild(th6);\r\n\tthead.appendChild(thr);\r\n\tscd.appendChild(thead);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\tfor(let fullid in dbrecs){\r\n\t\tlet dbrec = dbrecs[fullid];\r\n\t\tconst dbid = fullid.split(\":\")[1];\r\n\t\tlet tr = document.createElement(\"tr\");\r\n\t\tvar td1 = document.createElement(\"td\");\r\n\t\ttd1.appendChild(this.wrapTableLinkCell(td1,dbid, dbid));\r\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id terminus-db-pointer\");\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\r\n\t\ttd2.appendChild(this.wrapTableLinkCell(td2,dbid, txt));\r\n\t\tvar td3 = document.createElement(\"td\");\r\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\r\n\t\ttd3.appendChild(this.wrapTableLinkCell(td3,dbid, txt));\r\n\t\tvar td4 = document.createElement(\"td\");\r\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\r\n\t\ttd4.appendChild(this.wrapTableLinkCell(td4,dbid, txt));\r\n\t\tvar td5 = document.createElement(\"td\");\r\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\r\n\t\ttd5.appendChild(this.wrapTableLinkCell(td5,dbid, txt));\r\n\t\tvar td6 = document.createElement(\"td\");\r\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\r\n        if(this.deleteDBPermitted(dbid)){\r\n            if(this.ui.pluginAvailable(\"font-awesome\")){\r\n                var delbut = document.createElement('i');\r\n        \t\tdelbut.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-times-circle\");\r\n        \t}\r\n            else{\r\n                var delbut = document.createElement(\"button\");\r\n    \t\t\tdelbut.appendChild(document.createTextNode(\"Delete\"));\r\n    \t\t\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\r\n            }\r\n\t\t\t// function to fix db in a closure\r\n\t\t\tvar delDB = function(db){\r\n\t\t\t\treturn function(){\r\n\t\t\t\t\tlet deleteConfirm = confirm(`Do you want to delete ${db} Database?`);\r\n\t\t\t\t\tif (deleteConfirm == true) {\r\n\t\t\t  \t\t\tself.ui.deleteDatabase(db);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//self.ui.deleteDatabase(db);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdelbut.addEventListener(\"click\", delDB(dbid));\r\n\t\t\ttd6.appendChild(delbut);\r\n\t\t}\r\n\r\n\t\ttr.appendChild(td1);\r\n\t\ttr.appendChild(td2);\r\n\t\ttr.appendChild(td3);\r\n\t\t//tr.appendChild(td4);\r\n\t\t//tr.appendChild(td5);\r\n\t\ttr.appendChild(td6);\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\tscd.appendChild(tbody);\r\n\tsec.appendChild(scd);\r\n\r\n\tif(this.ui.pluginAvailable(\"datatables\")){\r\n        var dt = new Datatables.CspDatatables(this.ui);\r\n\t\tvar tab = dt.draw(scd);\r\n\t}\r\n\treturn sec;\r\n}\r\n\r\nTerminusServerViewer.prototype.deleteDBPermitted = function(dbid){\r\n\tif(dbid == \"terminus\") return false;\r\n\tif(this.ui.client.connection.capabilitiesPermit(\"delete_database\", dbid)) return true;\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = {TerminusServerViewer,TerminusServerController}\r\n","function TerminusURLLoader(ui, val){\r\n\tthis.ui = ui;\r\n\tthis.val = val;\r\n\tthis.url_input = false;\r\n\tthis.key_input = false;\r\n}\r\n\r\nTerminusURLLoader.prototype.getLabelDOM = function(){\r\n\treturn document.createTextNode(\"Connect\");\r\n}\r\n\r\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-form-field terminus-field-\"+fname);\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\r\n\tlab.appendChild(document.createTextNode(ltxt))\r\n\tip.setAttribute(\"type\", \"text\");\r\n\tip.setAttribute(\"placeholder\", pholder);\r\n\tsci.appendChild(lab);\r\n\tsci.appendChild(ip);\r\n\treturn sci;\r\n}\r\n\r\nTerminusURLLoader.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\r\n\tvar stit = document.createElement(\"h3\");\r\n\tstit.setAttribute(\"class\", \"terminus-form-header terminus-connect-header terminus-module-head\");\r\n\tstit.appendChild(document.createTextNode(\"Connect To Terminus Server\"));\r\n\tscd.appendChild(stit);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tthis.url_input = document.createElement(\"input\");\r\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\r\n\tif(this.val){\r\n\t\tthis.url_input.value = this.val;\r\n\t}\r\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\r\n\tthis.key_input = document.createElement(\"input\");\r\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\r\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\r\n\tvar loadbuts = document.createElement(\"div\");\r\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tif(self.url_input.value){\r\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\r\n\t\t}\r\n\t});\r\n\tloadbuts.appendChild(loadbut);\r\n\tmfd.appendChild(loadbuts);\r\n\treturn scd;\r\n}\r\n\r\n\r\nmodule.exports=TerminusURLLoader\r\n"],"sourceRoot":""}