{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/utils.js","webpack://TerminusDashboard/./src/html/HTMLFrameHelper.js","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/errorMessage.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/frameHelper.js","webpack://TerminusDashboard/./src/client/WOQLQuery.js","webpack://TerminusDashboard/./src/client/RenderingMap.js","webpack://TerminusDashboard/./src/TerminusHTMLViewer.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/const.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/utils.js","webpack://TerminusDashboard/./src/html/document/ObjectViewer.js","webpack://TerminusDashboard/./src/html/datatypes/String.js","webpack://TerminusDashboard/./src/html/document/PropertyViewer.js","webpack://TerminusDashboard/./src/html/document/DataViewer.js","webpack://TerminusDashboard/./src/client/TerminusClassChooser.js","webpack://TerminusDashboard/./src/viewer/TerminusCodeSnippet.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/bind.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/buildURL.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/isCancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/defaults.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/adapters/xhr.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/createError.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/mergeConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/Cancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionCapabilities.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/terminusIDParser.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/framePattern.js","webpack://TerminusDashboard/./src/TerminusDocument.js","webpack://TerminusDashboard/./src/client/WOQLResultsViewer.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/html/datatypes/StringEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Boolean.js","webpack://TerminusDashboard/./src/html/datatypes/BooleanEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Choice.js","webpack://TerminusDashboard/./src/html/datatypes/ChoiceEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Coordinate.js","webpack://TerminusDashboard/./src/html/datatypes/CoordinateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Date.js","webpack://TerminusDashboard/./src/html/datatypes/DateHelper.js","webpack://TerminusDashboard/./src/html/datatypes/DateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Entity.js","webpack://TerminusDashboard/./src/html/datatypes/EntityEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Image.js","webpack://TerminusDashboard/./src/html/datatypes/ImageEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Link.js","webpack://TerminusDashboard/./src/html/datatypes/Number.js","webpack://TerminusDashboard/./src/html/datatypes/Range.js","webpack://TerminusDashboard/./src/html/datatypes/RangeEditor.js","webpack://TerminusDashboard/./src/html/datatypes/SanitizedHTML.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapEditor.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapHelper.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapViewer.js","webpack://TerminusDashboard/./src/html/datatypes/HTMLMarkupEditor.js","webpack://TerminusDashboard/./src/html/datatypes/S2EntityEditor.js","webpack://TerminusDashboard/./src/TerminusDB.js","webpack://TerminusDashboard/./src/viewer/WOQLRule.js","webpack://TerminusDashboard/./src/viewer/WOQLChooser.js","webpack://TerminusDashboard/./src/viewer/WOQLTable.js","webpack://TerminusDashboard/./src/viewer/DatatypeRenderers.js","webpack://TerminusDashboard/./src/viewer/WOQLQueryView.js","webpack://TerminusDashboard/./src/viewer/WOQLGraph.js","webpack://TerminusDashboard/./src/viewer/WOQLStream.js","webpack://TerminusDashboard/./src/viewer/TerminusFrame.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlClient.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/buffer/index.js","webpack://TerminusDashboard/(webpack)/buildin/global.js","webpack://TerminusDashboard/./node_modules/base64-js/index.js","webpack://TerminusDashboard/./node_modules/ieee754/index.js","webpack://TerminusDashboard/./node_modules/isarray/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/axios.js","webpack://TerminusDashboard/./node_modules/is-buffer/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/Axios.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/InterceptorManager.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/transformData.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/normalizeHeaderName.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/settle.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/enhanceError.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/parseHeaders.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/isURLSameOrigin.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/cookies.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/isAbsoluteURL.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/combineURLs.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/CancelToken.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/spread.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/objectFrame.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woql.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/WOQLResult.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/client/ObjectRenderer.js","webpack://TerminusDashboard/./src/client/ValueRenderer.js","webpack://TerminusDashboard/./src/client/TerminusDocumentChooser.js","webpack://TerminusDashboard/./src/html/Datatypes.js","webpack://TerminusDashboard/./src/html/QueryPane.js","webpack://TerminusDashboard/./src/html/table/SimpleTable.js","webpack://TerminusDashboard/./src/html/graph/SimpleGraph.js","webpack://TerminusDashboard/./src/html/graph/GraphResultsViewer.js","webpack://TerminusDashboard/./src/html/query/SimpleTextbox.js","webpack://TerminusDashboard/./src/html/chooser/SimpleChooser.js","webpack://TerminusDashboard/./src/html/document/SimpleDocument.js","webpack://TerminusDashboard/./src/html/document/DocumentTable.js","webpack://TerminusDashboard/./src/html/TerminusViolation.js","webpack://TerminusDashboard/./src/TerminusQuery.js","webpack://TerminusDashboard/./src/html/QueryPaneManager.js","webpack://TerminusDashboard/./src/TerminusSchema.js","webpack://TerminusDashboard/./src/TerminusServer.js","webpack://TerminusDashboard/./src/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","WOQLClient","ConnectionCapabilities","ConnectionConfig","IDParser","ErrorMessage","FrameHelper","ObjectFrame","WOQL","WOQLResult","isBuffer","toString","isArray","val","isObject","isFunction","forEach","obj","fn","length","isArrayBuffer","isFormData","FormData","isArrayBufferView","ArrayBuffer","isView","buffer","isString","isNumber","isUndefined","isDate","isFile","isBlob","isStream","pipe","isURLSearchParams","URLSearchParams","isStandardBrowserEnv","navigator","product","window","document","merge","result","assignValue","arguments","deepMerge","extend","a","b","thisArg","trim","str","replace","TerminusPluginManager","require","TerminusClient","HTMLFrameHelper","type","control","label","callback","disabled","dpropDOM","createElement","setAttribute","button","appendChild","createTextNode","addEventListener","this","innerHTML","objId","getElementsByClassName","style","background","view","pluginAvailable","icon","options","selected","sel","opt","labelFromURL","which","renderer","viewsDOM","setMode","getActionControl","isNew","cancel","url","location","href","loc","split","sh","getShorthand","bits","htmlid","prop","wrap","text","max_cell_size","max_word_size","substring","replacements","words","word","newstr","k","varname","lastIndexOf","help","input","infoDOM","linfo","lspacer","lval","Codemirror","getHeaderDom","hd","h","stylizeCodeDisplay","ui","txt","dom","cmConfig","pr","colorizePre","removeSelectedNavClass","el","classList","remove","showSubMenus","add","tolggleContent","content","display","stylizeEditor","cm","ar","colorizeTextArea","updateTextArea","deleteStylizedEditor","qip","nextElementSibling","removeChildren","showHttpResult","response","action","currForm","terminator","br","retHttpHeaders","headers","hdres","json","then","rd","data","JSON","stringify","pre","getResponse","getInfoAlertDom","msg","ald","getFunctionSignature","sigs","spec","descr","args","server_url","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","toggleVisibility","contains","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","displayDocumentSubMenus","showControl","setSelectedSubMenu","checkForMandatoryId","activateSelectedNav","nav","getCurrentWoqlQueryObject","query","settings","qval","limit","pageLength","start","elementMetadata","classMetadata","getEverything","getAllDocuments","documentMetadata","and","quad","sub","propertyMetadata","console","log","trimValue","preloaded","loaded","loading","precluded","plugins","css","js","requires","setPluginOptions","opts","init","calculatePreloaded","toload","calculateRequiredInitPlugins","self","loadPlugins","pins","pid","indexOf","push","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","plugin","version_check","pluginmeta","version","jQuery","slider","e","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","Error","element","span","className","body","insertBefore","getComputedStyle","getPropertyValue","removeChild","ticker","cback","loadPlugin","pug","cssid","loadDynamicCSS","scripts","sid","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","getElementById","parentNode","cssurl","pluginLoadable","pluginLoadedOrLoading","getPluginDOM","plugid","cl","cbox","id","checked","clab","togglePlugin","redraw","unloadPlugin","drawPlugins","num","getAsDOM","dm","clh","showPlugins","getErrorAsMessage","api","err","formatErrorMessage","status","method","nmsg","keys","getAPIErrorMessage","getAccessDeniedMessage","accessDenied","db","server","getInvalidURIMessage","parseAPIError","error","redirected","standard_urls","rdf","rdfs","xsd","owl","tcs","tbs","xdd","v","terminus","vio","docs","prefix","node","hasChildNodes","childNodes","Math","random","Date","getTime","link","pref","full","ida","idb","unshorten","sha","shb","prefixes","validURL","nurl","urlFragment","charAt","toUpperCase","slice","urlStr","baseUrl","stype","urlFirst","urlTmp","ext","viewIncludesProperties","parts","join","ty","parsed","parseXsdDate","parseXsdTime","parseXsdDateTime","year","month","day","tz","extractXsdTimezone","abs","parseInt","timezone","nparsed","hour","minute","second","xparsed","addXsdPadding","ret","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertTimestampToXsd","datetime","ptime","dividor","vals","scriptid","src","existingScript","script","onload","rel","WOQLQuery","client","default_limit","connectionConfig","platformEndpoint","colid","dbid","serverURL","schemaURL","dbURL","docURL","setPrefixes","shorten","execute","wrapped","select","getConcreteDocumentClassPattern","varc","getSubclassQueryPattern","not","getAbstractQueryPattern","clsname","queryWrappedWithLimit","getAllDocumentQuery","constraint","triple","getEverythingQuery","wjson","getPropertyListQuery","getElementMetaDataQuery","getClassListMetaDataQuery","getClassMetaDataQuery","getDataOfChosenClassQuery","chosen","getDataOfChosenPropertyQuery","getInstanceMeta","getDocumentQuery","getClassesQuery","ObjectViewer","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","SantizedHTMLViewer","GoogleMapEditor","GoogleMapViewer","HTMLMarkupEditor","S2EntityEditor","RenderingMap","registeredDataViewers","registeredDataEditors","getValidDataViewerList","frametype","valids","concat","getValidDataEditorList","nftypes","getViewer","datatype","vi","renderers","viewer","eval","alert","getAvailableDataViewers","viewers","nviewers","sets","getAvailableDataEditors","getViewerForDataFrame","getEditorForDataFrame","registerViewerForTypes","types","registerEditorForTypes","registerEditorForFrameType","registerViewerForFrameType","compiled_options","compileOptions","parent","facets","getDefaultFacets","facet","deffacet","getDefaultFacet","hide_disabled_buttons","features","controls","viewerType","viewerOptions","header","header_viewer","HTMLObjectHeaderViewer","filter","sort","rules","pattern","patternMatchesRenderer","output","WOQLRule","WOQLTable","WOQLChooser","WOQLQueryViewer","WOQLGraph","WOQLStream","TerminusFrame","Datatypes","QueryPane","SimpleTable","SimpleGraph","SimpleTextbox","SimpleChooser","SimpleDocument","DocumentTable","HTMLObjectViewer","HTMLPropertyViewer","HTMLDataViewer","TerminusCodeSnippet","TerminusHTMLViewer","config","setRenderers","showResult","table","graph","chooser","initialiseDataRenderers","setResult","render","displayResults","choice","loadResults","last_result","results","wqt","setDatatypes","setRenderer","stream","setQuery","ruleEditor","getAddRuleButton","cont","rbtn","getConfigButton","cbtn","querypane","testspan","qp","queryPane","WOQLChoice","lmg","show_all","holder","tdv","owner","loadDocument","loadRenderer","rendname","frame","evalstr","nr","freeze","CONNECT","GET_SCHEMA","UPDATE_SCHEMA","UPDATE_DOCUMENT","CLASS_FRAME","WOQL_SELECT","GET_DOCUMENT","DELETE_DATABASE","DELETE_DOCUMENT","CREATE_DATABASE","CREATE_DOCUMENT","WOQL_UPDATE","authorityActionsToArr","Array","map","item","URIEncodePayload","payload","encodeURIComponent","payloadArr","keyElement","valueElement","properties","headerViewer","renderedDOM","getObjectBodyDOM","getObjectDOM","orientation","getContentOrientation","pcls","sp","subjectClass","subject","vholder","getFeatureDOM","feature","hasFeatureViewer","featureViewer","redrawHeader","nheader","replaceWith","redrawBody","nbody","addRenderedProperty","renderedprop","clear","goTo","subj","goToName","getObjectIDMarker","idm","sumDOM","controlsDOM","objDOM","showFeature","facetDOM","getObjectFacetDOM","getObjectLabelDOM","idDOM","getObjectIDDOM","typeDOM","getObjectTypeDOM","getObjectStatusDOM","viewDOM","getViewPropertyDOM","hideDOM","getViewerSelectorDOM","getObjectControlsDOM","getObjectSummaryDOM","sum","getSummary","getInfoboxDOM","addDOM","getAddPropertyDOM","getModeSelectorDOM","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","rpropDOM","getObjectResetDOM","upropDOM","getObjectUpdateDOM","showDOM","getObjectShowDOM","getObjectHideDOM","viewables","getAvailableFacets","mpropDOM","getSelectionControl","currentFacet","setFacet","lab","getLabel","isNewDocument","required","isClassChoice","cs","getAvailableClassChoices","mlabDOM","cls","changeClass","getClassMeta","cmt","getVariableValueFromBinding","addables","getAddableProperties","unshift","cardControlAllows","addNewProperty","getViewableProperties","goToProperty","clone","isUpdated","reset","getAvailableViewers","currentViewer","setViewer","hide","show","save","size","renderFrame","dataviewer","renderValue","wrapShortenedText","values","HTMLPropertyHeaderViewer","propDOM","npropDOM","getPropertyDOM","getPropertyIDMarker","getPropertyBodyDOM","addRenderedValue","renderedval","index","wrapper","expModeMenu","getPropertyControlsDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","prepend","getPropertySummaryDOM","prelude","getPropertyFacetDOM","getViewValueDOM","getPropertyIDDOM","getPropertyRangeDOM","hasCardinalityRestriction","getPropertyCardinalityDOM","getPropertyCommentDOM","range","getComment","restriction","getRestriction","min","max","getActionControlDOM","settingsDOM","getPropertyDeleteDOM","getAddValueDOM","getPropertyResetDOM","getPropertyUpdateDOM","getPropertyShowDOM","getPropertyHideDOM","getSettingsControlDOM","addClass","getViewableValues","goToValue","showValue","HTMLDataHeaderViewer","valDOM","nvalDOM","getValueDOM","getValueIDMarker","getValueBodyDOM","vdom","getDataValueViewer","getDOM","getSummaryDOM","HTMLTerminusClient","fireInternalLink","preventDefault","load","internalLink","onclick","onClick","getValueFacetDOM","getValueTypeDOM","getValueStatusDOM","getValueControlsDOM","getValueDeleteDOM","getValueCloneDOM","getValueResetDOM","getValueUpdateDOM","getValueShowDOM","getValueHideDOM","TerminusClassChooser","show_single","setRoot","root","setFilter","change","ccdom","ccsel","wq","getResultsAsOptions","clist","choices","bindings","empty_choice","opt1","added","bclass","qObj","width","height","placeholder","snippet","getActionButtons","actbtn","displayFormat","prettyPrint","undefined","getFormatButtons","bsp","btn","getDOMParts","scont","entries","actionButton","snippetText","apply","utils","encode","params","paramsSerializer","serializedParams","toISOString","hashmarkIndex","__CANCEL__","normalizeHeaderName","DEFAULT_CONTENT_TYPE","setContentTypeIfUnset","adapter","defaults","process","XMLHttpRequest","transformRequest","transformResponse","parse","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","validateStatus","common","settle","buildURL","parseHeaders","isURLSameOrigin","createError","Promise","resolve","reject","requestData","requestHeaders","request","auth","username","password","Authorization","btoa","open","onreadystatechange","readyState","responseURL","responseHeaders","getAllResponseHeaders","responseType","responseText","statusText","onabort","onerror","ontimeout","cookies","xsrfValue","withCredentials","read","toLowerCase","setRequestHeader","onDownloadProgress","onUploadProgress","upload","cancelToken","promise","abort","send","enhanceError","message","code","config1","config2","Cancel","UTILS","CONST","connection","setClientKey","getClientKey","curl","addConnection","capabilities","capabilitiesKeys","pred","auths","scope","actions","actionsArr","j","nrec","serverConnected","capabilitiesPermit","connectionMode","client_checks_capabilities","rec","getServerRecord","getDBRecord","srvr","connectionObj","okeys","oid","dbCapabilityID","getServerDBRecords","dbrecs","removeDB","dbidCap","newParams","docid","setServer","setDB","doc","setDocument","connected_mode","include_key","includeKey","queryURL","frameURL","baseURL","inputStr","context","parser","parseServerURL","parseDBID","setSchemaURL","parseSchemaURL","parseDocumentURL","setQueryURL","parseQueryURL","setClassFrameURL","parseClassFrameURL","setContext","validPrefixedURL","expandPrefixed","validIDString","stripOptionalPath","bit","FramePatternMatcher","FrameRule","rule","testRules","onmatch","matched_rules","patternMatchesFrame","FramePattern","checkFrame","setPattern","frame_type","children","depth","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","ftype","stringMatch","compareIDs","vala","valb","RegExp","test","isProperty","isData","renderer_type","constructor","rend","func","compare","Renderers","TerminusDBViewer","TerminusDocumentViewer","page_config","editor","load_schema","config_options","getBuiltInViewerOptions","dbViewer","classmeta","instancemeta","wresult","hasBindings","refreshPage","getJsonLdViewer","getDocument","clearBusy","pagedom","res","document_json_response","ohv","getDocumentJsonldCreateButton","json_editor","getEncodingChooserDOM","scd","nbuts","enc","oframe","ojson","viewMode","ccDOM","getDocumentChooserDOM","dcip","nbut","showDocument","mcls","d2ch","TerminusDocumentChooser","sdom","nlab","click","getDocumentCreatorSelect","termcc","new_class","showCreateDocument","getDocumentCreatorDOM","cr","showBusy","createDocument","getListOfDocuments","showError","getDocumentJsonldSaveButton","sv","updateDocument","toggleControlActions","lod","getClassesDOM","getDocumentEditControls","dpc","getDocumentSubMenus","ul","active","controldom","loadDocumentHome","sd","elid","loadCreateDocument","loadDocumentSchema","setLabel","loadDataFrames","ncls","getClassFrame","loadSchemaFrames","deleteDocument","URL","extr","showViolations","durl","subjid","dataframes","domain","classframes","loadClassFrames","newDoc","fillFromSchema","getOptionsFromPageConfig","ObjectRenderer","controller","FrameConfig","pageconf","getClient","extract","labdom","dfs","getDataFrames","getStdURL","rends","getDocumentPageControls","Datatables","WOQLResultsViewer","woqlResult","queryPage","qPage","pman","count","showTable","show_table","orderColumns","sample","ordered","resultDOM","displayResultHeader","rs","rh","getTableDOM","nor","dtResult","getTable","tab","draw","getDtTableDOMOnChange","pageInfo","formatResultsForDatatableDisplay","columns","colDataData","formattedResult","ordered_headings","innerText","outerHTML","recordsTotal","recordsFiltered","getTableBody","tbody","tr","td","getDocumentLocalLink","selectDocumentNavBar","dtPlugin","thead","thr","th","CspDatatables","wResViewer","wrViewer","wQuery","currDTSettings","convertToDatatable","dt","DataTable","searching","lengthMenu","paging","initComplete","oInstance","$","each","html","columnDefs","targets","createdRow","row","find","attr","on","cell","column","showDBMainPage","dbInfo","parents","dbId","deleteDatabase","executeQuery","generateNewQueryOnPageChange","qTextDom","queryMode","getCallbackSettings","dtAPIChangeSettings","_iDisplayLength","_iDisplayStart","iDraw","chosenValue","setUp","dtdom","updateCurrDTSettings","getNewDataOnChange","drawnTab","aSettings","getDataFromServer","serverSide","processing","autoWidth","ajax","buttons","scrollX","big","isBigType","getTypeSize","set","vallab","elements","elt","foptions","getChoiceOptions","inputs","parseValue","lldom","getInputDOMs","lat","long","latdom","longdom","getLatLongDOM","firstcol","delbut","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","DateHelper","allowbce","date_spacer","time_spacer","datetime_separator","helper","HTMLDateHelper","parseDate","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","mdom","mlab","slab","dadom","ydom","getMonthName","ddom","months","part","xsdFromParsed","tdom","opdom","getEntityViewHTML","getController","getEntityLabel","dv","nspan","il","tit","ic","img","commas","numberWithCommas","delimiter","parseRangeValue","rvals","svals","x","useCommas","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","GoogleMapHelper","mapcontainer","ghelper","initMap","event","addListener","position","latLng","coo","lng","clearMarkers","marker","Marker","markers","path","polyline","getPath","addMarker","getLength","polygon","mapLat","mapLong","zoom","stroke","color","opacity","weight","fill","line","destroy","translatePolygonToArray","vertices","seenValue","xy","getAt","translateArrayToPolygon","array","jsonified","latlong","createPolygon","coords","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","setMap","createPolyline","Polyline","getCoordsFromMarkers","mapContainer","center","parseFloat","setPath","trigger","inner","quill","theme","ctl","TerminusDBController","wquery","TerminusDBCreator","dbc","dbrec","nm","getControlHTML","showQueryPage","showMappingPage","showSchemaPage","showDocumentPage","tcdom","gb","bi","tds","bt","tts","nlabs","pd","sth","banner","dhp","scs","getDeleteOnHomePage","getDbInfoBox","info","del","dbdel","confirm","getDBSummary","getDocumentTableConfig","nq","rowClick","hidden","annotateValue","ID","binding","Class","Description","from","qres","nt","first","ng","d1","sct","mfd","sci","idip","titip","descip","schem","kip","datip","butfield","cancbut","loadbut","schema","gatherips","createDatabase","showServerMainPage","WOQLStreamConfig","WOQLChooserConfig","WOQLTableConfig","show_pager","show_pagesize","change_pagesize","show_pagenumber","addNamespacesToVariables","vars","nvars","nvar","getMatchingRules","matches","match","WOQLGraphConfig","tf","trenderer","json_rules","jr","get_schema","fp","onChange","show_empty","value_variable","labels","label_variable","titles","title_variable","sort_variable","direction","sort_direction","dtypes","column_order","order","pager","pagesize","editable","page","cols","setVariables","col","literals","show_literals","source_variable","fontfamily","fontfam","show_force","force","fix_nodes","fixed","explode_out","explode","gwidth","gheight","selected_grows","bigsel","edge","edges","nedges","show_edges","charge","collisionRadius","border","arrow","distance","symmetric","w","hdr","hover","onHover","literal","list","variables","current_variable","constraints","tester","vundertest","ch","cursor","getVariableList","next","includeRow","rowToChoice","rownum","getRowID","getLabelFromBinding","getTitleFromBinding","getSelectedFromBinding","rval","getSpecialRenderer","renderSpecial","prev","DatatypeRenderers","DataValue","datavalue","datatypes","canAdvancePage","getLimit","canChangePage","canRetreatPage","getPage","getPageSize","setPage","setPageSize","update","nextPage","previousPage","getColumnsToRender","hasColumnOrder","getColumnOrder","hasSelect","getSelectVariables","getColumnHeaderContents","hr","nquery","nresult","hasDefinedEvent","getDefinedEvent","getRowClick","getCellClick","getRowHover","getCellHover","hasCellClick","hasRowClick","hasCellHover","hasRowHover","getRenderer","getSpecificRender","getRendererForDatatype","createRenderer","nvalue","defaultViewers","defaultEditors","specials","universalViewer","universalEditor","record","WOQLQueryView","parseText","nw","submitQuery","serialise","nodes","node_ids","calculateVariableTypes","getEdges","getBindings","rowIncludesEdge","makeEdgesFromRow","getNodes","source_variables","makeNodeFromSource","target_variables","makeNodeFromTarget","adornNode","adornEdge","makeEdgeFromRow","eid","extractFromBinding","lits","includeNode","includeLiteralNode","nid","genBNID","getLiteralOwner","addAdornedNode","addAdornedEdge","createEdgesFromIDs","ndid","ks","kt","nodetype","rad","radius","es","page_size","wqrs","applyRenderersToDocument","xhz","TerminusUI","ApiExplorer","TerminusDBsdk","TerminusViolations","TerminusQueryViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","setOptions","connect","connectToDB","showView","explorer","showExplorer","dbdets","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","getCrashString","showMessage","delrec","lid","dbn","dets","fname","getConnectionEndpoint","clearServer","clearDB","TerminusServerViewer","redrawMainPage","showLoadURLPage","showCreateDBPage","getDocViewerOptions","getDocCreatorOptions","mainDOM","clearMessages","messages","clearMainPage","main","setMessageDOM","setbuttonControls","setControllerDOM","setExplorerDOM","setPluginsDOM","setViewerDOM","comps","slocation","toggleControl","drawControls","toggleDashboardWidget","widget","drawExplorer","loadControls","ncontrol","nd","exp","ae","sc","TerminusServerController","show_controls","pseudoCapability","show_views","busy","getBusyLoader","bsyDom","pbc","pbsa","pbia","md","msgHolder","vios","nvios","cmsg","views","document_options","schema_options","piman","addPlugin","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getClassFrames","viewDocument","use_fetch","return_full_response","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","navOnSelect","createNavs","navConfig","navDom","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","getSignature","getForm","getServerForm","form","fd","inpLabel","cd","inpId","keyLabel","resd","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","inpKey","docLabel","inpDoc","inp","docUrl","getApiSendButton","getApiForm","schurl","buttonSelf","gtxtar","txtar","dcurl","schemaUrlDom","htmlEditor","getValue","sg","sig","DispatchRequest","URIError","dispatch","dburl","makeDocumentConsistentWithURL","addOptionsToDocument","docurl","qurl","q","addOptionsToWOQL","cfurl","pdoc","_","addKeyToPayload","dispatchFetch","redirect","referrer","hdrs","credentials","cache","Headers","fetch","ok","btoaImplementation","Buffer","axios","delete","catch","post","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","Uint8Array","__proto__","arg","encodingOrOffset","allocUnsafe","TypeError","byteOffset","byteLength","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","len","copy","fromObject","assertSize","loweredCase","utf8ToBytes","base64ToBytes","slowToString","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","arr","indexSize","arrLength","valLength","String","buf","readUInt16BE","foundIndex","hexWrite","offset","Number","remaining","strLen","substr","utf8Write","blitBuffer","asciiWrite","byteArray","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","allocUnsafeSlow","_isBuffer","y","pos","swap16","swap32","swap64","equals","inspect","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","out","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","dst","g","Function","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","Axios","mergeConfig","createInstance","defaultConfig","instance","instanceConfig","CancelToken","isCancel","all","promises","spread","default","isSlowBuffer","InterceptorManager","dispatchRequest","interceptors","chain","interceptor","fulfilled","rejected","shift","getUri","handlers","use","eject","transformData","isAbsoluteURL","combineURLs","throwIfCancellationRequested","throwIfRequested","reason","fns","normalizedName","isAxiosError","number","fileName","lineNumber","columnNumber","stack","ignoreDuplicateOf","originURL","msie","userAgent","urlParsingNode","resolveURL","protocol","host","search","hash","hostname","port","pathname","requestURL","expires","secure","cookie","toGMTString","decodeURIComponent","now","relativeURL","executor","resolvePromise","token","parentframe","empty","originalFrames","PropertyFrame","cframe","predicate","DataFrame","ClassFrame","Restriction","loadRestriction","jsonld_context","cf","isValid","hasSchema","frames","domainValue","getPropertyClassFrame","getChosenClassFrame","isLogic","getChosenFrame","addFrame","getAsFrame","ff","getAsFrames","isnew","restrictions","props","cascading","ignore_failure","filled","missing","getMissingPropertyList","nmissing","newb","getFilledPropertyList","newid","pf","cloned","getChild","childid","pframe","getProperty","addProperty","createEmpty","createEmptyChoice","clss","getClassChoices","df","addPropertyValue","addValue","removeProperty","removePropertyValue","removeValue","parentObject","renderProperties","sortProperties","nprops","unsorted","standardCompare","kid","hasRestriction","extracts","updated","childUpdated","deletePropertyValue","gets","renderValues","sortedVals","sortValues","rangeValue","comment","originalValue","nrend","setNew","isValidType","hasCardRestriction","getType","isObjectProperty","isDatatypeProperty","isRestriction","isDocument","isChoice","option","lang","getTypeShorthand","contents","normalizer","loadFromObjectFrame","par","child","getChosenClassFrames","objframe","nc","operands","dataframe","cloneDataFrame","other","domcls","operand","cardinality","maxCardinality","minCardinality","nrest","Pattern","chain_ended","contains_update","paging_transitive_properties","WOQLSchema","triples","when","Query","Update","or","queries","eq","isa","JSON_or_IRI","delete_triple","S","P","O","add_triple","delete_quad","G","add_quad","arith","plus","minus","times","divide","as","vari","remote","unique","isLiteralType","advanceCursor","last","isPaged","getPagingProperty","pageprop","setPagingProperty","addStart","nval","getContext","nspaces","spaces","indent","show_context","clauses","nxt","nvals","setLimit","psize","hasStart","getStart","pagenum","pstart","setStart","firstPage","npage","lastUpdate","Context","defaultContext","DB_IRI","def","scm","Subject","Predicate","Object_or_Literal","Graph","abstract","GraphIRI","getDataOfClass","getDataOfProperty","documentProperties","simpleGraphQuery","subs","getO","addPO","entity","relationship","card","os","od","no_compress","compress","nprop","curor","compareValues","asc_or_desc","textdom","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","refresh","setCodemirrorSize","defaultCharWidth","setOption","setSize","setTimeout","runMode","ValueRenderer","PropertyViewer","PropertyRenderer","originalValues","changed","originalProperties","newProperties","TerminusDashboard","decorateRenderer","getOptionsForChild","getOptionsForValue","getOptionsForObject","buildValueRenderers","getViewerForProperty","adorig","getDataFramesToRender","vr","kids","getChildrenToRender","kidf","viewIncludesChildren","allkids","getChildren","clsmeta","deleteProperty","addPropertyClass","rest","currentnum","new_property","hideDisabledControls","hide_disabled_controls","nocascade","parentFacetChange","multiline","summary","containsPage","setView","getAvailablePropertyViewers","getAvailablePropertyEditors","nukeViewer","ptype","getPropertyHeaderViewer","valcount","vsum","getFeaturesForFacet","getOptionsForProperty","buildPropertyRenderers","getViewerForObject","getPropertiesToRender","renders","nkid","parentobj","newrend","demandid","inputID","dval","new_object","isPartOfNewDocument","pfacet","vrend","propcount","getObjectHeaderViewer","JSONObjectViewer","nviewer","standardSort","patterns","sorted","rdft","rdfc","extractLDO","extractJSONLD","extracted","nf","nvr","inline","getAPIURL","DBURL","getEntityReference","entities","badData","bd","new_value","text_summary_length","getViewerForValue","objlit","getValueHeaderViewer","getViewerForDataValue","ft","show_button","getS2DOM","getIDDOM","docchooser","cfilter","s2config","dataType","contentType","delay","keyCode","dbut","toggleView","getChangeViewText","addPlugins","createDataRenderer","ResultViewer","query_viewers","result_viewers","ruleviewer","setRuleViewer","rv","addQueryViewer","qv","addResultViewer","addLibrary","lib","libraries","qps","woqltable","ctls","getControlsDOM","ctrls","getPaging","getTableHeader","getColumnHeader","getHTMLRow","getCell","rc","getCellData","pdom","pn","getFirst","getPrev","getPageNumber","getNext","chunk","clabel","pval","GraphResultsViewer","wgraph","getGraphDOM","gviz","gdom","setData","initDOM","svg","visid","chars","randomString","currentDate","link_elements","node_elements","container","loadedNodes","focusNodes","links","selected_id","setConfigOptions","initD3","d3DOM","loadNewData","updateGraph","updateSimulation","dqr","updateData","setFocusNodeFromResult","reload","getFocusNode","simulation","stop","wake","hibernate","no_animate","nnodes","getNodesAndFringes","snode","nnode","fx","fy","getLinks","scale_factor","setWidth","setHeight","clientWidth","clientHeight","jqid","append","forceSimulation","forceLink","getLinkDistance","forceManyBody","strength","getCharge","forceCollide","getCollisionRadius","forceCenter","drag_drop","drag","restart","zoomed","link_group","classed","node_group","current_transform","transform","follow_node_wrapper","graph_node","nodeSelected","selectAll","exit","node_enter","enter","getRadius","isFringe","getNodeIconUnicode","styleNodeElements","link_enter","styleLinkElements","alpha","getNodeColour","getNodeText","getNodeIconWeight","getNodeIconSize","getNodeIconColour","getLineWidth","getEdgeArrow","getEdgeColour","getLinkText","getEdgeDirection","reference","getArrowWidth","getArrowHeight","selected_node","selection_grows","getScaleTransform","scale","min_ratio","new_mol_width","new_mol_height","y_trans","x_trans","transition","duration","scaleToFit","min_x","min_y","max_x","max_y","mol_width","mol_height","width_ratio","height_ratio","recentre","translated","dcx","dcy","text_elements","unicode","faclass","getMultiplier","mult","colrad","linkDistance","getNodeIcon","isNeighbourLink","upgraded","woq","inputError","qbox","qbut","getEmptyOption","createOptionFromChoice","renderProperty","td2","TerminusViolation","context_msg","vioHeading","getPropertyAsDOM","ldom","QueryPaneManager","meta","thv","qpMan","getResultViewDom","qpm","qvc","getQueryCreatorChoiceDOM","qcc","generators","gen","changeGenerator","queryEditor","processResults","getqObjFromInput","qJson","showRuleEditor","rObj","showConfig","confirm_before_update","loadSchema","msgtype","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getSchemaEditButton","getImportButton","getFormatChoices","fc","tc","tj","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","getClassFrameDOM","ssb","getCancelButton","getSaveButton","getImportSaveButton","getSchemaButton","getImportPreviewButton","is_import","doImport","schema_edit_dom","origurl","newschema","appendSchema","showConfirmPage","s2","nschema","np","docviewer","ipval","klab","modes","overwrite","rsc","getServerLabelDOM","srec","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","wrapTableLinkCell","tdElement","getNDBListDOM","sec","lihed","th1","th2","th3","th4","th5","th6","fullid","td1","td3","td4","td5","td6","deleteDBPermitted","delDB","url_input","key_input","getLabelDOM","getFormFieldDOM","ip","ltxt","pholder","stit","loadbuts"],"mappings":"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","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 66);\n","'use strict';\r\nmodule.exports = {\r\n\t\t\t\t WOQLClient:require('./lib/woqlClient'),\r\n                  ConnectionCapabilities:require('./lib/connectionCapabilities'),\r\n                  ConnectionConfig:require('./lib/connectionConfig'),\r\n                  IDParser:require('./lib/terminusIDParser'),\r\n                  ErrorMessage:require('./lib/errorMessage'),\r\n                  FrameHelper:require('./lib/frameHelper'),\r\n                  ObjectFrame:require('./lib/objectFrame'),\r\n                  WOQL:require('./lib/woql'),\r\n\t\t\t  \t  WOQLResult:require('./lib/WOQLResult')};\r\n","'use strict';\n\nvar bind = require('./helpers/bind');\nvar isBuffer = require('is-buffer');\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||\n                                           navigator.product === 'NativeScript' ||\n                                           navigator.product === 'NS')) {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = merge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Function equal to merge with the difference being that no reference\n * to original objects is kept.\n *\n * @see merge\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction deepMerge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = deepMerge(result[key], val);\n    } else if (typeof val === 'object') {\n      result[key] = deepMerge({}, val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  deepMerge: deepMerge,\n  extend: extend,\n  trim: trim\n};\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nlet HTMLFrameHelper = {};\r\n\r\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\r\n\tvar pman = new TerminusPluginManager();\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control terminus-save-btn \" + type + \"-\" + control);\r\n\tvar pman = new TerminusPluginManager();\r\n    /*if(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tvar faic = this.getControlIcon(control);\r\n\t\tif(disabled){\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\r\n\t\t\ticon.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\r\n\t\t\ticon.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(icon);\r\n\t}\r\n\telse{*/\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.appendChild(document.createTextNode(label));\r\n\t\tif(disabled){\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\r\n\t\t\tbutton.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action \" + type + \"-\" + control);\r\n\t\t\tbutton.addEventListener(\"click\", function(){\r\n\t\t\t\tif(this.innerHTML == 'Save'){\r\n\t\t\t\t\tvar objId = document.getElementsByClassName('terminus-object-id-input');\r\n\t\t\t\t\tif(objId.length>0){\r\n\t\t\t\t\t\tif(!objId[0].value){\r\n\t\t\t\t\t\t\tobjId[0].setAttribute('placeholder', 'Required field');\r\n\t\t\t\t\t\t\tobjId[0].style.background = '#f8d7da';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse callback(control);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse callback(control);\r\n\t\t\t\t}\r\n\t\t\t\telse callback(control);\r\n\t\t\t\t//(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(button);\r\n\t//}\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLFrameHelper.getSettingsControl = function(view){\r\n\tvar pman = new TerminusPluginManager();\r\n\tif(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\r\n\t\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\r\n\t\ticon.setAttribute('style', 'margin: 10px;')\r\n\t\treturn icon;\r\n\t}\r\n\telse{\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.setAttribute('class', 'terminus-btn');\r\n\t\tbutton.appendChild(document.createTextNode('Settings'));\r\n\t\treturn button;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getControlIcon = function(control){\r\n\tvar icon;\r\n\tswitch(control){\r\n\t\tcase 'delete':\r\n\t\t\ticon = '-alt-delete';\r\n\t\tbreak;\r\n\t\tcase 'add':\r\n\t\t\ticon = '-plus';\r\n\t\tbreak;\r\n\t\tcase 'reset':\r\n\t\t\ticon = '-undo';\r\n\t\tbreak;\r\n\t\tcase 'save':\r\n\t\t\ticon = '-save';\r\n\t\tbreak;\r\n\t\tcase 'hide':\r\n\t\t\ticon = '-eye-slash';\r\n\t\tbreak;\r\n\t}\r\n\treturn icon;\r\n}\r\n\r\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\r\n\tfor(var i = 0; i < options.length; i++){\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\tif(typeof options[i] == \"object\"){\r\n\t\t\topt.value = options[i].value;\r\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.FrameHelper.labelFromURL(options[i].value)));\r\n\t\t\topt.appendChild(label);\r\n\t\t}\r\n\t\telse {\r\n\t\t\topt.value = options[i];\r\n\t\t\tlabel = TerminusClient.FrameHelper.labelFromURL(opt.value);\r\n\t\t\topt.appendChild(document.createTextNode(label));\r\n\t\t}\r\n\t\tif(selected == opt.value){\r\n\t\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t\t}\r\n\t\tsel.appendChild(opt);\r\n\t}\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\treturn sel;\r\n}\r\n\r\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\r\n\tvar viewsDOM = document.createElement(\"span\");\r\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\r\n\tif(renderer.mode == \"view\"){\r\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\r\n\t}\r\n\telse if(renderer.isNew()){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){ renderer.cancel();}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\r\n\t}\r\n\treturn viewsDOM;\r\n}\r\n\r\nHTMLFrameHelper.goToName = function(s, p, i){\r\n\tvar url = window.location.href;\r\n\tif(url){\r\n\t\tvar wbits = url.split(\"#\");\r\n\t\tvar loc = wbits[0];\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(s);\r\n\t    if(!sh) sh = s;\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tvar htmlid = sh;\r\n\t\tif(p){\r\n\t\t\tvar prop = TerminusClient.FrameHelper.getShorthand(p);\r\n\t\t\tif(!prop ) prop = p;\r\n\t\t\tvar bits = prop.split(\":\");\r\n\t\t\tif(bits.length > 1) prop = bits[1];\r\n\t\t\thtmlid += \"_\" + prop;\r\n\t\t\tif(i){\r\n\t\t\t\thtmlid += \"_\" + i;\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.location = loc + \"#\" + htmlid;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.wrapShortenedText = function(wrap, text, max_cell_size, max_word_size){\r\n\tif(max_cell_size && (text.length > max_cell_size)){\r\n\t\twrap.setAttribute(\"title\", text);\r\n\t\ttext = text.substring(0, max_cell_size) + \"...\";\r\n\t}\r\n\tif(max_word_size){\r\n\t\tconst replacements = {}\r\n\t\tconst words = text.split(\" \");\r\n\t\tfor(var i = 0; i < words.length; i++){\r\n\t\t\tvar word = words[i];\r\n\t\t\tif(word.length > max_word_size){\r\n\t\t\t\twrap.setAttribute(\"title\", text);\r\n\t\t\t\tvar newstr = word.substring(0, max_word_size) + \"...\";\r\n\t\t\t\treplacements[word] = newstr;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var k in replacements){\r\n\t\t\ttext = text.replace(k, replacements[k]);\r\n\t\t}\r\n\t}\r\n\twrap.appendChild(document.createTextNode(text));\r\n}\r\n\r\nHTMLFrameHelper.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\tconst obj = bind[key];\r\n\t\t\tif(typeof obj == \"object\" && obj['@value']) return obj['@value'];\r\n\t\t\treturn obj;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\r\n\t/*var frow = this.getFrameRow();\r\n\tvar fgroup = this.getFrameGroup(frow);*/\r\n\tvar infoDOM = document.createElement(\"span\");\r\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\r\n\t//fgroup.appendChild(infoDOM);\r\n\tif(help){\r\n\t\tinfoDOM.setAttribute(\"title\", help);\r\n\t}\r\n\tif(label){\r\n\t\tvar linfo = document.createElement(\"span\");\r\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\r\n\t\tlinfo.appendChild(document.createTextNode(label));\r\n\t\tinfoDOM.appendChild(linfo);\r\n\t}\r\n\tvar lspacer = document.createElement(\"span\");\r\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\r\n\tlspacer.appendChild(document.createTextNode(\" \"));\r\n\tinfoDOM.appendChild(lspacer);\r\n\tvar lval = document.createElement(\"span\");\r\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value terminus-property-label-align\");\r\n\tif(input){\r\n\t\tinput.value = value;\r\n\t\tlval.appendChild(input);\r\n\t}\r\n\telse if(value) {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(value);\r\n        if(sh){\r\n    \t   \tvar bits = sh.split(\":\");\r\n            sh = bits[1];\r\n   \t\t\tlval.setAttribute(\"title\", value);\r\n\t\t\tlval.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlval.appendChild(document.createTextNode(value));\r\n\t\t}\r\n\t}\r\n\tinfoDOM.appendChild(lval);\r\n\treturn infoDOM;\r\n}\r\n\r\nmodule.exports=HTMLFrameHelper\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Set of functions used across scripts\r\n */\r\nconst Codemirror= require('./plugins/codemirror.terminus');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n// function to read Files\r\nfunction readFile(file){\r\n    if (window.XMLHttpRequest){\r\n        // code for IE7+, Firefox, Chrome, Opera, Safari\r\n        xmlhttp=new XMLHttpRequest();\r\n    }\r\n    else{\r\n        // code for IE6, IE5\r\n        xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    xmlhttp.open(\"GET\",file,false);\r\n    xmlhttp.send();\r\n    xmlDoc=xmlhttp.responseText;\r\n    return xmlDoc;\r\n} // readFile()\r\n\r\n// function to write api call signatures from woql client\r\nfunction getFunctionSignature(which){\r\n  var sigs = {};\r\n  sigs.connect = {\r\n    spec   : \"WOQLClient.connect(surl, key)\",\r\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\r\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\r\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\r\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\r\n                + \" or the promise will be rejected.\"\r\n                + \"\\n1)The first (surl) argument: {string} argument it is the Server Url\"\r\n                + \"\\n2)The second(key) argument: {string} argument contains an API key\",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {server_url : 'url', key: 'Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.create = {\r\n    spec    : \"WOQLClient.createDatabase(dburl, details, key)\",\r\n    descr   : \"\\n\\nCreate a Terminus Database\"\r\n                + \"\\n1)The first (dburl) argument:{string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(details) argument:{object}, details which is the payload\"\r\n                + \"\\n which included information of the new database to be created\"\r\n                +  \"\\n3)The third (key) argument:{string}, contains an API key \",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {database_url : 'url', details: '', key: ' Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.delete = {\r\n      spec  : \"WOQLClient.deleteDatabase(dburl, key)\",\r\n      descr : \"\\n\\nDeletes a Database\"\r\n                + \"\\n1)The first (dburl) argument: {string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n      result: \"HTTP 200 on success, otherwise error code\",\r\n  };\r\n  sigs.getSchema = {\r\n    spec   : \"WOQLClient.getSchema(surl, options)\",\r\n    descr  : \"\\n\\nGets the schema of a database.\"\r\n             +\"\\n1)The first (surl) argument: {string}, it is a dbUrl/schema\"\r\n             + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.getClassFrames = {\r\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\r\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\r\n              +  \"\\nThe first (cfurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database or\"\r\n              +  \"\\n2) omitted - the current database will be used\"\r\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\r\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.updateSchema = {\r\n    spec    : \"WOQLClient.updateSchema(schurl, docs, options)\",\r\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\r\n                +\"\\n1)The first (surl) argument :{string}, is a dbUrl/schema\"\r\n                + \"\\n2)The second(docs) argument:{object}, is a valid owl ontology (new schema to be updated) in turtle format\"\r\n                + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document : 'doc'},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.createDocument = {\r\n    spec   : \"WOQLClient.createDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nCreates a new document in the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", fail_on_id_denied: false}\r\n  };\r\n  sigs.viewDocument = {\r\n    spec    : \"WOQLClient.getDocument(docurl, options)\",\r\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url'},\r\n    options: { format: \"turtle\"}\r\n  };\r\n  sigs.updateDocument = {\r\n    spec   : \"WOQLClient.updateDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\r\n                + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n                + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n                + \"\\n3)The third (key) argument:{string} argument contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.deleteDocument = {\r\n    spec  : \"WOQLClient.deleteDocument(docurl, key)\",\r\n    descr : \"\\n\\nDeletes a document from the specified database\"\r\n            + \"\\n1)The first (docurl) argument: {string},is a dbUrl/document/document_id\"\r\n            + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args  : {document_url : 'url'},\r\n  };\r\n  sigs.select = {\r\n    spec: \"WOQLClient.select(dburl, query, options)\",\r\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {woql: 'woql'},\r\n  };\r\n  sigs.update = {\r\n    spec  : \"WOQLClient.update(dburl, query, options)\",\r\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\r\n              + \"\\n1)The first (dburl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args  : {woql: 'woql'},\r\n  };\r\n  sigs.lookup = {\r\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', term: 'string'},\r\n  };\r\n  sigs.map = {\r\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {source: 'json', target: \"json\", woql: 'json'},\r\n  };\r\n  sigs.getClassFrame = {\r\n    spec: \"WOQLClient.getClassFrame(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  sigs.getPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', property: 'url'},\r\n  };\r\n  sigs.getFilledPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {document_url: 'url', property: 'url'},\r\n  };\r\n  sigs.getSubClasses = {\r\n    spec: \"WOQLClient.getSubClasses(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  return sigs[which];\r\n}//getFunctionSignature\r\n\r\n// returns dom element for header text\r\nfunction getHeaderDom(text){\r\n  var hd = document.createElement('div');\r\n  hd.setAttribute('class', 'terminus-module-head');\r\n  var h = document.createElement('h3');\r\n  h.innerHTML = text;\r\n  hd.appendChild(h);\r\n  return hd;\r\n} // getHeaderTextDom\r\n\r\n// returns dom for alert banner\r\nfunction getInfoAlertDom(type, label, msg){\r\n  var ald = document.createElement('div');\r\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\r\n  else ald.setAttribute('class', 'alert');\r\n  var str = document.createElement('STRONG');\r\n  str.innerHTML = label;\r\n  ald.appendChild(str);\r\n  var txt = document.createTextNode(msg);\r\n  ald.appendChild(txt);\r\n  return ald;\r\n} // getInfoAlertDom()\r\n\r\n// formats response results from platform\r\nfunction getResponse(currForm, action, response, terminator){\r\n\r\n  var rd = document.createElement('div');\r\n\r\n  // get header result\r\n  rd.appendChild(getHeaderDom('Result'));\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  var data = JSON.stringify(response, 0, 4);\r\n\r\n  var pre = document.createElement('pre');\r\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\r\n  pre.innerHTML = data;\r\n\r\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\r\n  if(!cm) rd.appendChild(pre);\r\n\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  currForm.appendChild(rd);\r\n\r\n  return currForm;\r\n}\r\n\r\n// formats the response from fetch call and spits out Http header and result\r\nfunction showHttpResult(response, action, currForm, terminator){\r\n    //var currForm = document.createElement('div');\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n    // get header result\r\n    currForm.appendChild(getHeaderDom('HTTP Header'));\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n     var retHttpHeaders  = '';\r\n\r\n     // iterate over all headers\r\n     for (let [key, value] of response.headers) {\r\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\r\n     }\r\n\r\n    // http header result\r\n    var hdres = document.createElement('pre');\r\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\r\n    var txt = document.createTextNode(retHttpHeaders);\r\n    hdres.appendChild(txt);\r\n\r\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\r\n    if(!cm) currForm.appendChild(hdres);\r\n\r\n    return response.json()\r\n    .then(function(response){\r\n      getResponse(currForm, action, response, terminator); // get return response\r\n    })\r\n\r\n} // UTILS.showHttpResult()\r\n\r\n\r\nfunction deleteStylizedEditor(ui, qip){\r\n    if(ui.pluginAvailable(\"codemirror\")){\r\n\t\tvar cm = qip.nextElementSibling;\r\n\t\tcm.setAttribute('class', 'terminus-hide');\r\n\t\tTerminusClient.FrameHelper.removeChildren(cm);\r\n\t}\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   view: defines the size of editor to appear in pages (schema/ query)\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeEditor(ui, txt, view, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return;\r\n\tvar cm = new Codemirror(txt, mode, cmConfig);\r\n\tvar ar = cm.colorizeTextArea(view);\r\n\tcm.updateTextArea(ar);\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   dom: stylized pre area is appended to dom\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return false;\r\n    var cm = new Codemirror(txt, mode, cmConfig);\r\n    var pr = cm.colorizePre();\r\n    dom.appendChild(pr);\r\n    return true;\r\n}\r\n\r\n/* name: classname to find and remove classes from elements\r\n*/\r\nfunction removeSelectedNavClass(name){\r\n    var el = document.getElementsByClassName(name);\r\n    if (el.length < 1) return;\r\n    for(var i=0; i<(el.length + 1); i++){\r\n        el[i].classList.remove(name);\r\n    }\r\n}\r\n\r\nfunction setSelectedSubMenu(a){\r\n    removeSelectedNavClass(\"terminus-submenu-selected\");\r\n    a.classList.add(\"terminus-submenu-selected\");\r\n}\r\n\r\n// toggles between contents\r\nfunction tolggleContent(icon, content){\r\n    if (content.style.display === \"block\"){\r\n        removeSelectedNavClass(\"fa-chevron-up\");\r\n        icon.classList.add(\"fa-chevron-down\");\r\n        content.style.display = \"none\";\r\n    }\r\n    else{\r\n        removeSelectedNavClass(\"fa-chevron-down\");\r\n        icon.classList.add(\"fa-chevron-up\");\r\n        content.style.display = \"block\";\r\n    }\r\n}\r\n\r\n// controls current selected nav bar\r\nfunction activateSelectedNav(nav, terminator){\r\n    removeSelectedNavClass(\"terminus-selected\");\r\n\t//checkDocumentSubMenus(terminator);\r\n\tnav.classList.add(\"terminus-selected\");\r\n}\r\n\r\nfunction hideDocumentSubMenus(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n}\r\n\r\nfunction checkDocumentSubMenus(terminator){\r\n\tif(terminator.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\thideDocumentSubMenus(gd[0]);\r\n\t}\r\n\tif(terminator.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\thideDocumentSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction toggleVisibility(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n    else if(el.classList.contains('terminus-hide')){\r\n        el.classList.remove('terminus-hide');\r\n\t\tel.classList.add('terminus-display');\r\n\t}\r\n}\r\n\r\nfunction extractValueFromCell(cellValue){\r\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\r\n    return ihtml.firstChild.innerHTML;\r\n}\r\n\r\nfunction displayDocumentSubMenus(ui) {\r\n\t//display submenus on click of documents\r\n\tif(ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\tshowSubMenus(gd[0]);\r\n\t}\r\n\tif(ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\tshowSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction checkForMandatoryId(){\r\n    var objId = document.getElementsByClassName('terminus-object-id-input');\r\n    if(objId.length>0){\r\n        if(!objId[0].value){\r\n            objId[0].setAttribute('placeholder', 'Required field');\r\n            objId[0].style.background = '#f8d7da';\r\n            return false;\r\n        }\r\n        else return true;\r\n    }\r\n}\r\n\r\nfunction showSubMenus (el){\r\n\tel.classList.remove('terminus-hide');\r\n\tel.classList.add('terminus-display');\r\n}\r\n\r\n// function which generates query based on current settings from different screens of dashboard\r\nfunction getCurrentWoqlQueryObject(query, settings){\r\n\tvar qval;\r\n    if(!query) query = settings.query;\r\n\tswitch(query){\r\n\t\tcase 'Show_All_Schema_Elements':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .elementMetadata();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Classes':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .classMetadata();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Data':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .getEverything();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Documents':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .getAllDocuments();\r\n\t\tbreak;\r\n        case 'Show_All_Document_classes':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .documentMetadata();\r\n        break;\r\n        case 'Show_Document_Classes':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start).and(\r\n                        TerminusClient.WOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\r\n                        TerminusClient.WOQL.abstract(\"v:Element\"),\r\n                        TerminusClient.WOQL.sub(\"v:Element\", \"tcs:Document\"),\r\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"));\r\n        break;\r\n        case 'Show_All_Properties':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .propertyMetadata();\r\n        break;\r\n\t\tdefault:\r\n\t\t\tconsole.log('Invalid query ' + query + ' passed in WOQLTextboxGenerator');\r\n\t\tbreak;\r\n\t}\r\n\treturn qval;\r\n}\r\n\r\n// removes spaces\r\nfunction trimValue(text){\r\n    (text).replace(/[\\s\\t\\r\\n\\f]/g,'');\r\n    return text;\r\n}\r\n\r\nmodule.exports={tolggleContent,\r\n               removeSelectedNavClass,\r\n               stylizeCodeDisplay,\r\n               stylizeEditor,\r\n               deleteStylizedEditor,\r\n               showHttpResult,\r\n               getHeaderDom,\r\n               getInfoAlertDom,\r\n               getFunctionSignature,\r\n               toggleVisibility,\r\n               extractValueFromCell,\r\n               displayDocumentSubMenus,\r\n               setSelectedSubMenu,\r\n               checkForMandatoryId,\r\n               activateSelectedNav,\r\n               getCurrentWoqlQueryObject,\r\n               trimValue}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nfunction TerminusPluginManager(){\r\n\tthis.preloaded = [];\r\n\tthis.loaded = [];\r\n\tthis.loading = [];\r\n\tthis.precluded = [];\r\n\tthis.plugins = {};\r\n\tthis.plugins[\"font-awesome\"] = {\r\n\t\tlabel: \"Font Awesome\",\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\r\n\t};\r\n\tthis.plugins[\"quill\"] = {\r\n\t\tlabel: \"Quill\",\r\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\r\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\r\n\t};\r\n\tthis.plugins[\"codemirror\"] = {\r\n\t\tlabel : \"Code Mirror\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\r\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\"\r\n\t  ],\r\n\t\tcss: [\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\r\n\t\t]\r\n\t};\r\n\tthis.plugins[\"jquery\"] = {\r\n\t\tlabel: \"jQuery\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\r\n\t};\r\n\tthis.plugins[\"jqueryui\"] = {\r\n\t\tlabel: \"jQuery UI\",\r\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\r\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"datatables\"] = {\r\n\t\tlabel: \"Data Tables\",\r\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\r\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\r\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"prettify\"] = {\r\n\t\tlabel: \"Prettify\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\r\n\t\trequires: ['jquery']\r\n\t};*/\r\n\tthis.plugins[\"gmaps\"] = {\r\n\t\tlabel: \"Google Maps\",\r\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\r\n\t\t//plugin: \"gmaps.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"d3\"] = {\r\n\t\tlabel: \"d3\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"select2\"] = {\r\n\t\tlabel: \"Select 2\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"jsoneditor\"] = {\r\n\t\tlabel: \"JSON Editor\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.css\"],\r\n\t\t//plugin: \"jsoneditor.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"bootstrap\"] = {\r\n\t\tlabel: \"Bootstrap\",\r\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\r\n\t};\r\n\tthis.plugins[\"flot\"] = {\r\n\t\tlabel: \"Flot\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\r\n\t\trequires: [\"jquery\"]\r\n\t};*/\r\n}\r\n\r\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\r\n\tfor(var p in opts){\r\n\t\tif(!this.plugins[p]) continue;\r\n\t\tfor(var k in opts[p]){\r\n\t\t\tthis.plugins[p][k] = opts[p][k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.init = function(opts, then){\r\n\tif(opts) this.setPluginOptions(opts);\r\n\tthis.calculatePreloaded();\r\n\tvar toload = this.calculateRequiredInitPlugins(opts);\r\n\tif(toload && toload[0].length) {\r\n\t\tif(toload[1].length){\r\n\t\t\tvar self = this;\r\n\t\t\tvar nthen = function(){\r\n\t\t\t\tself.loadPlugins(toload[1], then);\r\n\t\t\t}\r\n\t\t\tthis.loadPlugins(toload[0], nthen);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.loadPlugins(toload[0], then);\r\n\t\t}\r\n\t}\r\n\telse if(then){\r\n\t\tthen();\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\r\n\tif(opts){\r\n\t\tvar pins = [];\r\n\t\tfor(var pid in opts){\r\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\r\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\r\n\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\r\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\r\n\t\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar pins = this.getDefaultPlugins();\r\n\t}\r\n\tvar needed_pins = [];\r\n\tfor(var i = 0; i<pins.length; i++){\r\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\r\n\t\t\tneeded_pins.push(pins[i])\r\n\t\t}\r\n\t}\r\n\tvar loading_order = [[], []];\r\n\tfor(var i = 0; i<needed_pins.length; i++){\r\n\t\tif(this.plugins[needed_pins[i]]){\r\n\t\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\r\n\t\t\t\tloading_order[1].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tloading_order[0].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn loading_order;\r\n}\r\n\r\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\r\n\treturn this.plugins;\r\n}\r\n\r\nTerminusPluginManager.prototype.calculatePreloaded = function(){\r\n\tfor(var pl in this.plugins){\r\n\t\tif(this.pluginAvailable(pl)){\r\n\t\t\tthis.preloaded.push(pl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\r\n\tif(typeof this.plugins[plugin] == \"object\"){\r\n\t\tvar pluginmeta = this.plugins[plugin];\r\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\r\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\r\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\r\n\t\tswitch(plugin){\r\n\t\t\tcase \"jquery\": {\r\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\r\n\t\t\t\tif(version_check && required_version){}\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jqueryui\": {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\r\n\t\t\t\t}\r\n\t\t\t\tcatch(e){}\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"quill\": {\r\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jsoneditor\": {\r\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"codemirror\": {\r\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\r\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\r\n\t\t\t}\r\n\t\t\tcase \"font-awesome\": {\r\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\r\n\t\t\t\treturn this.fontAwesomeCheck();\r\n\t\t\t}\r\n\t\t\tcase \"datatables\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"select2\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"gmaps\": {\r\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"openlayers\": {\r\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"d3\": {\r\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\r\n\tvar span = document.createElement('span');\r\n\tspan.className = 'fa';\r\n\tspan.style.display = 'none';\r\n\tif(document.body){\r\n\t\tdocument.body.insertBefore(span, document.body.firstChild);\r\n\t\tfunction css(element, property) {\r\n\t\t  return window.getComputedStyle(element, null).getPropertyValue(property);\r\n\t\t}\r\n\t\tvar loaded = false;\r\n\t\tvar fontAwsm = css(span, 'font-family');\r\n\t\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\r\n\t\t\tloaded = true;\r\n\t\t}\r\n\t\tdocument.body.removeChild(span);\r\n\t\treturn loaded;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\r\n\tvar defplugs = [\"font-awesome\"];\r\n\treturn defplugs;\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\r\n\tvar ticker = plugins.length;\r\n\tvar cback = function(){\r\n\t\tif(--ticker <= 1 && then){\r\n\t\t\tthen();\r\n\t\t}\r\n\t};\r\n\tfor(var i = 0; i < plugins.length; i++){\r\n\t\tthis.loadPlugin(plugins[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\r\n\tvar pug = this.plugins[plugin];\r\n\tif(pug.css){\r\n\t\tfor(var i=0; i<pug.css.length; i++){\r\n\t\t\tvar cssid = plugin + \"_css_\" + i;\r\n\t\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssid, pug.css[i]);\r\n\t\t}\r\n\t}\r\n\tvar scripts = (pug.js ? pug.js : []);\r\n\tif(plugin == \"gmaps\" && pug.key){\r\n\t\tscripts[0] += \"?key=\" + pug.key;\r\n\t}\r\n\tif(pug.plugin){\r\n\t\t//scripts.push(\"plugins/\" + pug.plugin);\r\n\t}\r\n\tif(plugin == \"codemirror\"){\r\n\t\tvar cm = scripts[0];\r\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\r\n\t\tscripts.splice(0, 1);\r\n\t\tvar self = this;\r\n\t\tvar cback = function(){\r\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\r\n\t\t}\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, cm, cback);\r\n\t}\r\n\telse {\r\n\t\tthis.loadPluginScripts(plugin, scripts, then);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\r\n\tvar ticker = scripts.length - 1;\r\n\tvar self = this;\r\n\tvar cback = function(){\r\n\t\tif(ticker == 0) {\r\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\r\n\t\t\t\tself.loaded.push(plugin);\r\n\t\t\t}\r\n\t\t\tif(self.loading.indexOf(plugin) != -1){\r\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\r\n\t\t\t}\r\n\t\t\tthen();\r\n\t\t}\r\n\t\tticker--;\r\n\t};\r\n\tif(scripts.length == 0){\r\n\t\tthis.loaded.push(plugin);\r\n\t}\r\n\telse {\r\n\t\tthis.loading.push(plugin);\r\n\t}\r\n\tfor(var i = 0; i<scripts.length; i++){\r\n\t\tvar sid = plugin + \"_js_\" + i;\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, scripts[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPageCSS = function(css){\r\n\tcssfid = \"terminus_client_css\";\r\n\tvar cssdom = document.getElementById(cssfid);\r\n\tif(cssdom){\r\n\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t}\r\n\tif(css){\r\n\t\tcssurl = \"css/\" + css + \".css\";\r\n\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssfid, cssurl);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\r\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\r\n\tif(this.loaded.indexOf(pid) != -1) return true;\r\n\tif(this.preloaded.indexOf(pid) != -1) return true;\r\n\tif(this.loading.indexOf(pid) != -1) return true;\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.disabled = function(pid, obj){\r\n\tif(this.precluded.indexOf(pid) != -1) return true;\r\n\tif(obj.requires){\r\n\t\tfor(var i = 0; i<obj.requires.length; i++){\r\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\r\n\tvar a = document.createElement(\"a\");\r\n\tvar cl = document.createElement(\"span\");\r\n\ta.appendChild(cl);\r\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\r\n\tvar cbox = document.createElement(\"input\");\r\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\r\n\tcbox.type = \"checkbox\";\r\n\tif(this.preloaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\telse if(this.loaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.loading.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.disabled(plugid, obj)){\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\tvar clab = document.createElement(\"label\");\r\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\r\n\tclab.setAttribute(\"for\", cbox.id);\r\n\tclab.appendChild(document.createTextNode(obj.label));\r\n\tcl.appendChild(clab);\r\n\tcl.appendChild(cbox);\r\n\tvar self = this;\r\n\tcbox.addEventListener(\"change\", function(){\r\n\t\tself.togglePlugin(plugid, ui);\r\n\t});\r\n\treturn a;\r\n}\r\n\r\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\r\n\tif(this.loaded.indexOf(plugid) == -1){\r\n\t\tvar then = function(){\r\n\t\t\tui.redraw();\r\n\t\t}\r\n\t\tthis.loadPlugin(plugid, then);\r\n\t}\r\n\telse {\r\n\t\tthis.unloadPlugin(plugid);\r\n\t}\r\n\tTerminusClient.FrameHelper.removeChildren(ui.plugins);\r\n\tui.drawPlugins();\r\n}\r\n\r\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\r\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\r\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar pug = this.plugins[plugid];\r\n\tvar num = (pug.js) ? pug.js.length : 0;\r\n\tif(pug.plugin) num++;\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_js_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tnum = (pug.css ? pug.css.length : 0);\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_css_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\r\n}\r\n\r\nTerminusPluginManager.prototype.getAsDOM = function(ui){\r\n\tvar dm = document.createElement(\"span\");\r\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\r\n\tvar clh = document.createElement(\"span\");\r\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\r\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\r\n\tdm.appendChild(clh);\r\n\tvar a = document.createElement('a');\r\n\tthis.showPlugins(a, ui);\r\n\tclh.appendChild(a);\r\n\ta.style.display = 'none';\r\n\tclh.addEventListener('click', function(){\r\n\t\tif(a.style.display == 'none')\r\n\t\t\ta.style.display = 'block';\r\n\t\telse a.style.display = 'none';\r\n\t})\r\n\treturn dm;\r\n}\r\n\r\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\r\n\ta.setAttribute('style', 'background-color: #111;');\r\n\tfor(var pid in this.plugins){\r\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\r\n\t}\r\n}\r\n\r\nmodule.exports=TerminusPluginManager\r\n","function getErrorAsMessage(url, api, err) {\n\t// console.log('getErrorAsMessage');\n\tlet str = '';\n\tif (err.response) {\n\t\terr = err.response;\n\t\tif (err.data) str += `${formatErrorMessage(err.data)}`;\n\t} else if (err.body) str += `${formatErrorMessage(err.data)}`;\n\n\tif (err.status) str += `Code: ${err.status}`;\n\tif (err.action) str += `, Action: ${err.action}`;\n\tif (err.type) str += `, Type: ${err.type}`;\n\tif (url) str += `, url: ${url}`;\n\tif (api && api.method) str += `, method: ${api.method}`;\n\treturn str;\n}\n\nfunction formatErrorMessage(msg) {\n\tif (typeof msg === 'object') {\n\t\tlet nmsg = '';\n\t\tfor (const key of Object.keys(msg)) {\n\t\t\tnmsg += `${key} ${msg[key]} `;\n\t\t}\n\t\treturn nmsg;\n\t}\n\treturn msg;\n}\n\nfunction accessDenied(action, db, server) {\n\tconst err = {};\n\terr.status = 403;\n\terr.url = (server || '') + (db || '');\n\terr.type = 'client';\n\terr.action = action;\n\terr.body = `${err.action} not permitted for ${err.url}`;\n\treturn err;\n}\n\nfunction getAPIErrorMessage(url, api, err) {\n\treturn `API Error ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getAccessDeniedMessage(url, api, err) {\n\treturn `Access Denied ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getInvalidURIMessage(url, call) {\n\tconst str = `Invalid argument to\n            ${call}. \n            ${url}\n            is not a valid Terminus DB API endpoint`;\n\treturn str;\n}\n\n/**\n * Utility functions for generating and retrieving error messages\n * and storing error state\n */\n\nfunction parseAPIError(response) {\n\tconst err = {};\n\terr.status = response.status;\n\terr.type = response.type;\n\tif (response.data && typeof response.data === 'object') {\n\t\tlet msg;\n\t\ttry {\n\t\t\tmsg = response.text();\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tmsg = response.json();\n\t\t\t} catch (error) {\n\t\t\t\tmsg = response.toString();\n\t\t\t}\n\t\t}\n\t\terr.body = msg;\n\t} else if (response.data) err.body = response.data;\n\terr.url = response.url;\n\terr.headers = response.headers;\n\terr.redirected = response.redirected;\n\treturn err;\n}\n\n\nmodule.exports = {\n\tgetErrorAsMessage,\n\tgetAPIErrorMessage,\n\tgetAccessDeniedMessage,\n\taccessDenied,\n\tgetInvalidURIMessage,\n\tparseAPIError\n};\n","/**\n * Helper functions for dealing with frames and linked data documents\n */\nconst FrameHelper = {\n\tstandard_urls: {\n\t\trdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\n\t\trdfs: 'http://www.w3.org/2000/01/rdf-schema#',\n\t\txsd: 'http://www.w3.org/2001/XMLSchema#',\n\t\towl: 'http://www.w3.org/2002/07/owl#',\n\t\ttcs: 'http://terminusdb.com/schema/tcs#',\n\t\ttbs: 'http://terminusdb.com/schema/tbs#',\n\t\txdd: 'http://terminusdb.com/schema/xdd#',\n\t\tv: 'http://terminusdb.com/woql/variable/',\n\t\tterminus: 'http://terminusdb.com/schema/terminus#',\n\t\tvio: 'http://terminusdb.com/schema/vio#',\n\t\tdocs: 'http://terminusdb.com/schema/documentation#'\n\t}\n};\n\nFrameHelper.addURLPrefix = function (prefix, url) {\n\tthis.standard_urls[prefix] = url;\n};\n\n\nFrameHelper.removeChildren = function (node) {\n\tif (node) {\n\t\twhile (node.hasChildNodes()) {\n\t\t\tnode.removeChild(node.childNodes[0]);\n\t\t}\n\t}\n};\n\nFrameHelper.empty = function (obj) {\n\t   // null and undefined are \"empty\"\n\tif (!obj) return true;\n\t// Assume if it has a length property with a non-zero value\n\t// that that property is correct.\n\tif (obj.length > 0) return false;\n\tif (obj.length === 0) return true;\n\t// Otherwise, does it have any properties of its own?\n\t// Note that this doesn't handle\n\t// toString and valueOf enumeration bugs in IE < 9\n\t// for (const key in obj) {\n\tif (typeof obj === 'object') {\n\t\tfor (const key of Object.keys(obj)) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) return false;\n\t\t}\n\t}\n\treturn true;\n};\n\nFrameHelper.genBNID = function () {\n\tconst r = Math.random().toString(36).substring(7);\n\tconst d = new Date();\n\tconst bnid = `_:${r}${d.getTime()}`;\n\treturn bnid;\n};\n\nFrameHelper.getShorthand = function (link) {\n\tif (typeof link === 'object' && link.length) link = link[0];\n\tif (link && typeof link === 'string') {\n\t\tfor (const pref of Object.keys(this.standard_urls)) {\n\t\t\tconst full = this.standard_urls[pref];\n\t\t\tif (link.substring(0, full.length) === full) {\n\t\t\t\tconst sh = `${pref}:${link.substring(full.length)}`;\n\t\t\t\treturn sh;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n\nFrameHelper.compareIDs = function (ida, idb) {\n\tif (ida === idb) return true;\n\tif (this.unshorten(ida) === idb) return true;\n\tif (this.unshorten(ida) === this.unshorten(idb)) return true;\n\tconst sha = this.getShorthand(ida);\n\tconst shb = this.getShorthand(idb);\n\tif (sha && ((sha === idb) || (sha === shb))) return true;\n\tif (shb && shb === ida) return true;\n\treturn false;\n};\n\n\nFrameHelper.shorten = function (url, prefixes) {\n\tfor (const pref in prefixes) {\n\t\tif (prefixes[pref] == url.substring(0, prefixes[pref].length)) {\n\t\t\treturn (`${pref}:${url.substring(prefixes[pref].length)}`);\n\t\t}\n\t}\n\treturn url;\n};\n\nFrameHelper.unshorten = function (url) {\n\tif (this.validURL(url)) return url;\n\tif (!url) return url;\n\tconst bits = url.split(':');\n\tif (bits[1]) {\n\t\tif (this.standard_urls[bits[0]]) {\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\n\t\t}\n\t}\n\treturn url;\n};\n\n// Valid URLs are those that start with http:// or https://\nFrameHelper.validURL = function (str) {\n\tif (str && (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://')) return true;\n\treturn false;\n};\n\n\nFrameHelper.labelFromURL = function (url) {\n\tlet nurl = this.urlFragment(url);\n\tnurl = (nurl || url);\n\tif (nurl.lastIndexOf('/') < nurl.length - 1) {\n\t\tnurl = nurl.substring(nurl.lastIndexOf('/') + 1);\n\t}\n\tnurl = nurl.replace('_', ' ');\n\treturn nurl.charAt(0).toUpperCase() + nurl.slice(1);\n};\n\nFrameHelper.urlFragment = function (url) {\n\turl = (typeof url !== 'string') ? window.location.href : url;\n\tlet bits = url.split('#');\n\tif (bits.length <= 1) {\n\t\tif (!this.validURL(url)) {\n\t\t\tbits = url.split(':');\n\t\t}\n\t}\n\tif (bits.length >= 1) {\n\t\tconst [, urlStr] = bits;\n\n\t\tif (urlStr) {\n\t\t\tconst [baseUrl] = urlStr.split('?');\n\t\t\turl = baseUrl;\n\t\t}\n\t}\n\treturn url;\n};\n\nFrameHelper.isStringType = function (stype) {\n\tif (stype === 'http://www.w3.org/2001/XMLSchema#string') return true;\n\tif (stype === 'xsd:string') return true;\n\treturn false;\n};\n\nFrameHelper.lastURLBit = function (url) {\n\turl = (typeof url === 'undefined') ? window.location.href : url;\n\tconst [urlFirst] = url.split('#');\n\tconst [urlTmp] = urlFirst.split('?');\n\turl = urlTmp.substring(url.lastIndexOf('/') + 1);\n\treturn url;\n};\n\n\nFrameHelper.getStdURL = function (pref, ext, url) {\n\tif (this.standard_urls[pref]) {\n\t\tif (url) {\n\t\t\tif (url === this.standard_urls[pref] + ext) return url;\n\t\t} else {\n\t\t\treturn this.standard_urls[pref] + ext;\n\t\t}\n\t}\n\treturn false;\n};\n\nFrameHelper.viewIncludesProperties = function (view) {\n\tif (view === 'full' || view === 'production' || view === 'terse') {\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nFrameHelper.viewIncludesChildren = function (view, type) {\n\treturn this.viewIncludesProperties(view, type);\n};\n\nFrameHelper.viewIncludesValue = function (view, type) {\n\treturn this.viewIncludesProperties(view, type);\n};\n\nFrameHelper.numberWithCommas = function (value) {\n\tif (value >= 1000 || value <= -1000) {\n\t    const parts = value.toString().split('.');\n\t    if (value <= -1000) parts[0] = parts[0].substring(1);\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n\t    if (value <= -1000) value = `-${parts.join('.')}`;\n\t    else value = parts.join('.');\n\t}\n\treturn value;\n};\n\nFrameHelper.datatypes = [\n\t'xdd:coordinate', 'xdd:coordinatePolyline',\n\t'xdd:coordinatePolygon', 'xdd:dateRange', 'xdd:gYearRange', 'xdd:integerRange',\n\t'xdd:decimalRange', 'xdd:cc', 'xdd:email', 'xdd:html', 'xdd:url', 'xsd:anySimpleType',\n\t'xsd:string', 'xsd:boolean', 'xsd:decimal', 'xsd:double', 'xsd:float', 'xsd:time', 'xsd:date',\n\t'xsd:dateTime', 'xsd:dateTimeStamp', 'xsd:gYear', 'xsd:gMonth', 'xsd:gDay', 'xsd:gYearMonth',\n\t'xsd:gMonthDay', 'xsd:duration', 'xsd:yearMonthDuration', 'xsd:dayTimeDuration',\n\t'xsd:byte', 'xsd:short', 'xsd:integer', 'xsd:long', 'xsd:unsignedByte',\t'xsd:unsignedInt',\n\t'xsd:unsignedLong',\t'xsd:nonNegativeInteger', 'xsd:positiveInteger', 'xsd:negativeInteger',\n\t'xsd:nonPositiveInteger', 'xsd:base64Binary', 'xsd:anyURI', 'xsd:language', 'xsd:normalizedString',\n\t'xsd:token', 'xsd:NMTOKEN',\t'xsd:Name',\t'xsd:NCName', 'xsd:NOTATION', 'xsd:QName', 'xsd:ID',\n\t'xsd:IDREF', 'xsd:ENTITY', 'rdf:XMLLiteral', 'rdf:PlainLiteral', 'rdfs:Literal', 'xdd:json'\n];\n\nFrameHelper.parseDate = function (ty, value) {\n\tlet parsed;\n\tif (ty === 'xsd:date') {\n\t\tparsed = this.parseXsdDate(value);\n\t} else if (ty === 'xsd:time') {\n\t\tparsed = this.parseXsdTime(value);\n\t} else if (ty === 'xsd:dateTime') {\n\t\tparsed = this.parseXsdDateTime(value);\n\t} else if (ty === 'xsd:gYear') {\n\t\tparsed = { year: value };\n\t} else if (ty === 'xsd:gYearRange') {\n\t\tparsed = { year: value };\n\t} else if (ty === 'xsd:gMonth') {\n\t\tparsed = { month: value.substring(2) };\n\t} else if (ty === 'xsd:gDay') {\n\t\tparsed = { day: value };\n\t} else if (ty === 'xsd:gYearMonth') {\n\t\tconst bits = value.split('-');\n\t\twhile (bits.length < 2) bits.push('');\n\t\tparsed = { year: bits[0], month: bits[1] };\n\t} else if (ty === 'xsd:gMonthDay') {\n\t\tconst bits = value.split('-');\n\t\twhile (bits.length < 2) bits.push('');\n\t\tparsed = { month: bits[0], day: bits[1] };\n\t} else if (ty === 'xsd:dateTimeStamp') {\n\t\tparsed = this.parseXsdDateTime(value);\n\t}\n\treturn parsed;\n};\n\nFrameHelper.parseXsdDate = function (val) {\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tlet year;\n\tif (val.substring(0, 1) === '-') {\n\t\tyear = val.substring(0, 5);\n\t} else {\n\t\tyear = val.substring(0, 4);\n\t}\n\tlet parsed;\n\tif (year && Math.abs(year) < 10000) {\n\t\tlet month = val.substring(year.length + 1, year.length + 3);\n\t\tif (month) { month = parseInt(month, 10); } else return false;\n\t\tlet day = val.substring(year.length + 4);\n\t\tif (day) day = parseInt(day, 10);\n\t\telse return false;\n\t\tparsed = {\n\t\t\tyear,\n\t\t\t   month,\n\t\t\t   day,\n\t\t\t   timezone: tz\n\t\t};\n\t}\n\treturn parsed;\n};\n\nFrameHelper.addXsdPadding = function (parsed) {\n\tconst nparsed = {};\n\tif (typeof parsed.year !== 'undefined' && parsed.year !== false && parsed.year < 1000) {\n\t\tif (Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? `-000${Math.abs(parsed.year)}` : `000${parsed.year}`);\n\t\telse if (Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? `-00${Math.abs(parsed.year)}` : `00${parsed.year}`);\n\t\telse nparsed.year = (parsed.year < 0 ? `-0${Math.abs(parsed.year)}` : `0${parsed.year}`);\n\t} else if (parsed.year) {\n\t\tnparsed.year = parsed.year;\n\t}\n\tif (typeof parsed.month !== 'undefined' && parsed.month !== false && parsed.month < 10) {\n\t\tnparsed.month = `0${parsed.month}`;\n\t} else if (parsed.month) {\n\t\tnparsed.month = parsed.month;\n\t}\n\tif (typeof parsed.day !== 'undefined' && parsed.day !== false && parsed.day < 10) {\n\t\tnparsed.day = `0${parsed.day}`;\n\t} else if (parsed.day) {\n\t\tnparsed.day = parsed.day;\n\t}\n\tif (typeof parsed.hour !== 'undefined' && parsed.hour !== false && parsed.hour < 10) {\n\t\tnparsed.hour = `0${parsed.hour}`;\n\t} else if (parsed.hour) {\n\t\tnparsed.hour = parsed.hour;\n\t}\n\tif (typeof parsed.minute !== 'undefined' && parsed.minute !== false && parsed.minute < 10) {\n\t\tnparsed.minute = `0${parsed.minute}`;\n\t} else if (parsed.minute) {\n\t\tnparsed.minute = parsed.minute;\n\t}\n\tif (typeof parsed.second !== 'undefined' && parsed.second !== false && parsed.second < 10) {\n\t\tnparsed.second = `0${parsed.second}`;\n\t} else if (parsed.second) {\n\t\tnparsed.second = parsed.second;\n\t}\n\treturn nparsed;\n};\n\n\nFrameHelper.xsdFromParsed = function (parsed, ty) {\n\tconst xparsed = this.addXsdPadding(parsed);\n\tlet ret;\n\tif (ty === 'xsd:gYear') {\n\t\tret = (xparsed.year ? xparsed.year : false);\n\t} else if (ty === 'xsd:time') {\n\t\treturn (xparsed.hour && xparsed.minute && xparsed.second) ? `${xparsed.hour}:${xparsed.minute}:${xparsed.second}` : false;\n\t} else if (ty === 'xsd:date') {\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}` : false;\n\t} else if (ty === 'xsd:dateTime' || ty === 'xsd:dateTimeStamp') {\n\t\tret = (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}T` : false;\n\t\tif (ret) ret += `${xparsed.hour ? xparsed.hour : '12'}:${xparsed.minute ? xparsed.minute : '00'}:${xparsed.second ? xparsed.second : '00'}`;\n\t} else if (ty === 'xsd:gMonth') {\n\t\tret = (xparsed.month ? `--${xparsed.month}` : false);\n\t} else if (ty === 'xsd:gDay') {\n\t\tret = (xparsed.day ? `---${xparsed.day}` : false);\n\t} else if (ty === 'xsd:gYearMonth') {\n\t\tret = (xparsed.year && xparsed.month) ? `${xparsed.year}-${xparsed.month}` : false;\n\t} else if (ty === 'xsd:gMonthDay') {\n\t\tret = (xparsed.day && xparsed.month) ? `--${xparsed.month}-${xparsed.day}` : false;\n\t}\n\tif (xparsed.timezone) {\n\t\tret += xparsed.timezone;\n\t}\n\treturn ret;\n};\n\n\nFrameHelper.parseXsdTime = function (val) {\n\tif (!val) return {};\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tconst parsed = {\n\t\thour: val.substring(0, 2),\n\t\tminute: val.substring(3, 5),\n\t\tsecond: val.substring(6),\n\t\ttimezone: tz\n\t};\n\treturn parsed;\n};\n\nFrameHelper.convertTimestampToXsd = function (val) {\n\t  const a = new Date(val * 1000);\n\t  const parsed = {\n\t\tyear: a.getFullYear(),\n\t\tmonth: a.getMonth() + 1,\n\t\tday: a.getDate(),\n\t\thour: a.getHours(),\n\t\tminute: a.getMinutes(),\n\t\tsecond: a.getSeconds()\n\t  };\n\t  return parsed;\n};\n\nFrameHelper.parseXsdDateTime = function (val) {\n\tif (!val) return {};\n\tif (typeof val === 'number') {\n\t\treturn this.convertTimestampToXsd(val);\n\t}\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tconst datetime = this.parseXsdDate(val);\n\tconst ptime = this.parseXsdTime(val.substring(val.indexOf('T') + 1));\n\n\tfor (const i of Object.keys(ptime)) {\n\t\tdatetime[i] = ptime[i];\n\t}\n\tdatetime.timezone = tz;\n\treturn datetime;\n};\n\nFrameHelper.extractXsdTimezone = function (val) {\n\tif (val && val.charAt(val.length - 1) === 'Z') {\n\t\treturn 'Z';\n\t}\n\tif (val && (val.charAt(val.length - 6) === '+' || val.charAt(val.length - 6) === '-')) {\n\t\tval.substring(val.length - 6);\n\t}\n\treturn false;\n};\n\nFrameHelper.parseRangeValue = function (val, dividor) {\n\tdividor = (dividor || ',');\n\tlet vals = [];\n\tif (typeof val === 'object' && val.length) {\n\t\tvals = val;\n\t} else if (val) {\n\t\tif (typeof val !== 'string') {\n\t\t\tval = `${val}`;\n\t\t}\n\t\tif (val.length && (val.charAt(0) === '[') && val.charAt(val.length - 1) === ']') {\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length - 1));\n\t\t} else {\n\t\t\tvals.push(val);\n\t\t}\n\t}\n\treturn vals;\n};\n\nFrameHelper.loadDynamicScript = function (scriptid, src, callback) {\n\tconst existingScript = document.getElementById(scriptid);\n\tif (!existingScript) {\n\t\tconst script = document.createElement('script');\n\t\tscript.src = src; // URL for the third-party library being loaded.\n\t\tdocument.body.appendChild(script);\n\t\tscript.onload = function () {\n\t\t\tscript.id = scriptid; // do it here so it doesn't trigger the callback below on multiple calls\n\t\t\tif (callback) callback(scriptid);\n\t\t};\n\t}\n\tif (existingScript && callback) {\n\t\tcallback(scriptid);\n\t}\n};\n\nFrameHelper.loadDynamicCSS = function (cssid, src, callback) {\n\tconst existingScript = document.getElementById(cssid);\n\tif (!existingScript) {\n\t\tconst link = document.createElement('link');\n\t\tlink.href = src; // URL for the third-party library being loaded.\n\t\tlink.id = cssid; // e.g., googleMaps or stripe\n\t\tlink.rel = 'stylesheet';\n\t\tdocument.body.appendChild(link);\n\t\tlink.onload = function () {\n\t\t\tif (callback) callback(cssid);\n\t\t};\n\t}\n\tif (existingScript && callback) callback(cssid);\n};\n\nmodule.exports = FrameHelper;\n","const WOQLResult = require('./WOQLResultsViewer');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction WOQLQuery(client, options, ui){\r\n\tthis.client = client;\r\n\tthis.options = options;\r\n\tthis.ui = ui;\r\n\tthis.default_limit = 1000;\r\n\tthis.prefixes = {};\r\n\tif(client.connectionConfig.platformEndpoint()){\r\n\t\tvar sid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\"));\r\n\t\tthis.sid = sid;\r\n\t\tvar colid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\")) + client.connectionConfig.dbid;\r\n\t\tthis.prefixes['s'] = colid + \"/ontology/main#\";\r\n\t\tthis.prefixes['g'] = sid;\r\n\t\tthis.prefixes['db'] = colid + \"/\";\r\n\t\tthis.prefixes['doc'] = colid + \"/candidate/\";\r\n\t\tthis.prefixes['dg'] = colid + \"/graph/main/\";\r\n\t}\r\n\telse {\r\n\t\tthis.sid = client.connectionConfig.serverURL();\r\n\t\tthis.prefixes['s'] = client.connectionConfig.schemaURL() + \"#\";\r\n\t\tthis.prefixes['dg'] = client.connectionConfig.dbURL() + \"/schema\";\r\n\t\tthis.prefixes['doc'] = client.connectionConfig.docURL();\r\n\t\tthis.prefixes['db'] = client.connectionConfig.dbURL() + \"/\";\r\n\t\tthis.prefixes['g'] = client.connectionConfig.serverURL();\r\n\t}\r\n\tfor(var pref in TerminusClient.FrameHelper.standard_urls){\r\n\t\tthis.prefixes[pref] = TerminusClient.FrameHelper.standard_urls[pref];\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPrefixes = function(prefixes){\r\n\tthis.prefixes = prefixes;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.shorten = function(url){\r\n\tfor(var pref in this.prefixes){\r\n\t\tif(this.prefixes[pref] == url.substring(0, this.prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(this.prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nWOQLQuery.prototype.execute = function(woql){\r\n\tvar wrapped = this.wrap(woql);\r\n\tvar self = this;\r\n\treturn this.client.select(false, wrapped)\r\n\t.then(function(response){\r\n\t\tvar res = new WOQLResult.WOQLResult(response, self, self.options, self.ui);\r\n\t\treturn res;\r\n\t});\r\n}\r\n\r\nWOQLQuery.prototype.wrap = function(woql){\r\n\tvar wjson = {\r\n\t\t\"@context\" : this.prefixes,\r\n\t\t\"from\": [\r\n\t\t\tthis.client.connectionConfig.dbURL(),\r\n\t\t\twoql\r\n\t\t]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\nWOQLQuery.prototype.getConcreteDocumentClassPattern = function(varc){\r\n\tvar varc = varc || \"v:Class\";\r\n\tvar pat = {\r\n\t\tand: [\r\n\t\t\tthis.getSubclassQueryPattern(varc, \"tcs:Document\"),\r\n\t\t\t{\r\n\t\t\t\tnot: [this.getAbstractQueryPattern(varc)]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn pat;\r\n}\r\n\r\nWOQLQuery.prototype.getAbstractQueryPattern = function(varname){\r\n\tvar qp = {\r\n\t\tquad: [varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\"]\r\n\t}\r\n\treturn qp;\r\n}\r\n\r\nWOQLQuery.prototype.getSubclassQueryPattern = function(varname, clsname){\r\n\tvar sqp = {sub: [varname, clsname]};\r\n\treturn sqp;\r\n}\r\n\r\nWOQLQuery.prototype.queryWrappedWithLimit = function(query, limit, start){\r\n\tlimit = limit ? limit : this.default_limit ;\r\n\tstart = start ? start : 0;\r\n\tvar wjson = {\r\n\t\tlimit: [limit, {\r\n\t\t\tstart: [start, query]\r\n\t\t}]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\n//getAllDocuments\r\nWOQLQuery.prototype.getAllDocumentQuery = function(constraint, limit, start){\r\n\tvar query = {\r\n\t\tand: [\r\n\t\t\t{\r\n\t\t\t\ttriple: [\"v:Document\", \"rdf:type\", \"v:Type\"]\r\n\t\t\t},\r\n\t\t\tthis.getSubclassQueryPattern(\"v:Type\", \"tcs:Document\")\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\tquery.and.push(constraint);\r\n\t}\r\n\treturn this.queryWrappedWithLimit(query, limit, start);\r\n}\r\n\r\n//getEverything\r\nWOQLQuery.prototype.getEverythingQuery = function(constraint, limit, start){\r\n\tvar wjson = {triple: [\"v:Subject\", \"v:Predicate\", \"v:Object\"]};\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// propertyMetadata\r\nWOQLQuery.prototype.getPropertyListQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// elementMetadata() in new woql query\r\nWOQLQuery.prototype.getElementMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// classMetadata in new woql client\r\nWOQLQuery.prototype.getClassListMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// classMetadata\r\nWOQLQuery.prototype.getClassMetaDataQuery = WOQLQuery.prototype.getClassListMetaDataQuery;\r\n\r\nWOQLQuery.prototype.getDataOfChosenClassQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", \"rdf:type\", chosen]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"v:Property\", \"v:Value\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfChosenPropertyQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", chosen, \"v:Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [url, \"rdfs:label\", \"v:InstanceLabel\"]},\r\n\t\t\t{triple: [url, \"rdf:type\", \"v:InstanceType\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [url, \"rdfs:comment\", \"v:InstanceComment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getDocumentQuery = function(id, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [id, \"v:Property\", \"v:Property_Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n//documentMetadata\r\nWOQLQuery.prototype.getClassesQuery = function(limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [\"v:ID\", \"rdf:type\", \"v:Class\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:comment\", \"v:Comment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tsub: ['v:Class', 'tcs:Document']\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nmodule.exports=WOQLQuery\r\n","const ObjectViewer= require(\"../html/document/ObjectViewer\")\r\nconst HTMLStringViewer = require('../html/datatypes/String');\r\nconst HTMLStringEditor = require('../html/datatypes/StringEditor');\r\nconst HTMLBooleanViewer = require('../html/datatypes/Boolean');\r\nconst HTMLBooleanEditor = require('../html/datatypes/BooleanEditor');\r\nconst HTMLChoiceViewer = require('../html/datatypes/Choice');\r\nconst HTMLChoiceEditor = require('../html/datatypes/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('../html/datatypes/Coordinate');\r\nconst HTMLCoordinateEditor = require('../html/datatypes/CoordinateEditor');\r\nconst HTMLDateViewer = require('../html/datatypes/Date');\r\nconst HTMLDateEditor = require('../html/datatypes/DateEditor');\r\nconst HTMLEntityViewer = require('../html/datatypes/Entity');\r\nconst HTMLEntityEditor = require('../html/datatypes/EntityEditor');\r\nconst HTMLImageViewer = require('../html/datatypes/Image');\r\nconst HTMLImageEditor = require('../html/datatypes/ImageEditor');\r\nconst HTMLLinkViewer = require('../html/datatypes/Link');\r\nconst HTMLNumberViewer = require('../html/datatypes/Number');\r\nconst HTMLRangeViewer = require('../html/datatypes/Range');\r\nconst HTMLRangeEditor = require('../html/datatypes/RangeEditor');\r\nconst SantizedHTMLViewer = require('../html/datatypes/SanitizedHTML');\r\nconst GoogleMapEditor = require('../html/datatypes/GoogleMapEditor');\r\nconst GoogleMapViewer = require('../html/datatypes/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('../html/datatypes/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('../html/datatypes/S2EntityEditor');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet RenderingMap = {\r\n\tregisteredDataViewers: {},\r\n\tregisteredDataEditors: {},\t\r\n\tgetValidDataViewerList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringViewer'];\r\n\t\tif(frametype && typeof this.registeredDataViewers[frametype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[frametype]);\r\n\t\t}\r\n\t\tif(typeof this.registeredDataViewers[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidDataEditorList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringEditor'];\r\n\t\tif(frametype && typeof this.registeredDataEditors[frametype] != \"undefined\"){\r\n\t\t\tvar nftypes = this.registeredDataEditors[frametype];\r\n\t\t\tif(nftypes){\r\n\t\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof this.registeredDataEditors[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataEditors[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetViewer: function(type, options, datatype){\r\n\t\tvar vi = this.renderers[type];\r\n\t\toptions = (options ? options: {});\r\n\t\ttry {\r\n\t\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\r\n\t\t\tif(datatype) viewer.type = datatype;\r\n\t\t\treturn viewer;\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"failed on create \" + e.toString());\r\n\t\t}\r\n\t},\r\n\tgetAvailableDataViewers: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataViewerList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailableDataEditors: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataEditorList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetViewerForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataViewerList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tgetEditorForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataEditorList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tregisterViewerForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataViewers[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataViewers[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataViewers[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataEditors[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataEditors[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataEditors[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t},\r\n\tregisterEditorForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataEditors[frametype] == \"undefined\") this.registeredDataEditors[frametype] = [];\r\n\t\tif(this.registeredDataEditors[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataEditors[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataViewers[frametype] == \"undefined\") this.registeredDataViewers[frametype] = [];\r\n\t\tif(this.registeredDataViewers[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataViewers[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\trenderers: {\r\n\t\tHTMLStringViewer: { label: \"String Viewer\"},\r\n\t\tHTMLStringEditor: { label: \"String Editor\"},\r\n\t}\r\n}\r\n\r\nRenderingMap.addPlugin = function(plugin){\r\n\tif(plugin == \"gmaps\"){\r\n\t\tthis.registerEditorForTypes(\"GoogleMapEditor\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tthis.registerViewerForTypes(\"GoogleMapViewer\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugin == \"quill\"){\r\n\t\tthis.registerEditorForTypes(\"HTMLMarkupEditor\", \"Quill WYSIWIG HTML Editor\", [\"xdd:html\"]);\r\n\t}\r\n\tif(plugin == \"select2\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n\tif(plugin == \"jsoneditor\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n}\r\n\r\nRenderingMap.decorateRenderer = function(options, renderer){\r\n\tvar compiled_options = this.compileOptions(options, renderer);\r\n\tif(compiled_options && compiled_options.mode){\r\n\t\trenderer.mode = compiled_options.mode;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.mode) renderer.mode = renderer.parent.mode;\r\n\t\telse renderer.mode = \"view\";\r\n\t}\r\n\tif(compiled_options && compiled_options.view){\r\n\t\trenderer.view = compiled_options.view;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.view) renderer.view = renderer.parent.view;\r\n\t\telse renderer.view = \"full\";\r\n\t}\r\n\tif(compiled_options && compiled_options.facets){\r\n\t\trenderer.facets = compiled_options.facets;\r\n\t}\r\n\telse {\r\n\t\trenderer.facets = renderer.getDefaultFacets();\r\n\t}\r\n\tif(compiled_options && compiled_options.facet && typeof renderer.facets[compiled_options.facet] == \"object\"){\r\n\t\trenderer.facet = compiled_options.facet;\r\n\t}\t\r\n\telse {\r\n\t\tvar deffacet = renderer.getDefaultFacet();\r\n\t\tif(typeof renderer.facets[deffacet] == \"object\"){\r\n\t\t\trenderer.facet = deffacet;\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.facet = key(renderer.facets);\r\n\t\t}\r\n\t}\r\n\tif(compiled_options && compiled_options.hide_disabled_buttons){\r\n\t\trenderer.hide_disabled_buttons = compiled_options.hide_disabled_buttons;\r\n\t}\r\n\telse if(renderer.parent) renderer.hide_disabled_buttons = parent.hide_disabled_buttons;\r\n\telse renderer.hide_disabled_buttons = true;\r\n\tif(compiled_options && typeof compiled_options.features == \"object\"){\r\n\t\trenderer.features = compiled_options.features;\r\n\t}\r\n\telse {\r\n\t\trenderer.features = renderer.facets[renderer.facet].features;\r\n\t\t//renderer.features = renderer.getDefaultFeatures(renderer.facet);\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.controls == \"object\"){\r\n\t\trenderer.controls = compiled_options.controls;\r\n\t}\r\n\telse {\r\n\t\trenderer.controls = renderer.facets[renderer.facet].controls;\r\n\t\t//renderer.controls = renderer.getDefaultControls();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.viewerType != \"undefined\"){\r\n\t\trenderer.viewerType = compiled_options.viewerType;\r\n\t\tif(compiled_options.viewerOptions)\r\n\t\t\trenderer.viewerOptions = compiled_options.viewerOptions;\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.header != \"undefined\"){}\r\n\telse {\r\n\t\trenderer.header_viewer = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.filter != \"undefined\"){}\r\n\telse {}\r\n\tif(compiled_options && typeof compiled_options.sort != \"undefined\"){}\r\n\telse {}\r\n\treturn options;\r\n}\t\r\n\r\nRenderingMap.compileOptions = function(options, renderer){\r\n\tvar compiled_options = {};\r\n\tvar rules = [];\r\n\tfor(var key in options){\r\n\t\tif(key != \"rules\"){\r\n\t\t\tcompiled_options[key] = options[key];\r\n\t\t}\r\n\t}\r\n\tif(options.rules){\r\n\t\tfor(var i = 0; i<options.rules.length; i++){\r\n\t\t\tvar match = (!options.rules[i].pattern || this.patternMatchesRenderer(options.rules[i].pattern, renderer));\r\n\t\t\tif(match && options.rules[i].output){\r\n\t\t\t\tfor(var k in options.rules[i].output){\r\n\t\t\t\t\tcompiled_options[k] = options.rules[i].output[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn compiled_options;\r\n}\r\n\r\nRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", \"Checkbox Viewer\", [\"xsd:boolean\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", \"Checkbox Editor\", [\"xsd:boolean\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLChoiceViewer\", \"Choice Viewer\", \"oneOf\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLChoiceEditor\", \"Choice Selector\", \"oneOf\");\r\nRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", \"Coordinate Viewer\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", \"Coordinate Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", \"Date Viewer\", [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", \"Date Editor\", [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLEntityViewer\", \"Document Viewer\", \"document\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLEntityEditor\", \"Document Selector\", \"document\");\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", \"Link Viewer\", [\"xdd:url\", \"xsd:anyURI\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", \"Number with commas\", \r\n\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", \"Range Viewer\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", \"Range Editor\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", \"Sanitized HTML\", [\"xsd:string\", \"xdd:html\"]);\r\n\r\nmodule.exports=RenderingMap\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLRule = require(\"./viewer/WOQLRule\");\r\nconst WOQLTable = require(\"./viewer/WOQLTable\");\r\nconst WOQLChooser = require(\"./viewer/WOQLChooser\");\r\nconst WOQLQueryViewer = require(\"./viewer/WOQLQueryView\");\r\nconst WOQLGraph = require(\"./viewer/WOQLGraph\");\r\nconst WOQLStream = require(\"./viewer/WOQLStream\");\r\nconst TerminusFrame = require(\"./viewer/TerminusFrame\");\r\nconst Datatypes = require(\"./html/Datatypes\");\r\nconst QueryPane = require(\"./html/QueryPane\");\r\nconst SimpleTable = require(\"./html/table/SimpleTable\");\r\nconst SimpleGraph = require(\"./html/graph/SimpleGraph\");\r\n//const SimpleStream = require(\"./html/stream/SimpleStream\");\r\nconst SimpleTextbox = require(\"./html/query/SimpleTextbox\");\r\nconst SimpleChooser = require(\"./html/chooser/SimpleChooser\");\r\nconst SimpleDocument = require(\"./html/document/SimpleDocument\");\r\nconst DocumentTable = require(\"./html/document/DocumentTable\");\r\nconst HTMLObjectViewer = require(\"./html/document/ObjectViewer\");\r\nconst HTMLPropertyViewer = require(\"./html/document/PropertyViewer\");\r\nconst HTMLDataViewer = require(\"./html/document/DataViewer\");\r\nconst TerminusCodeSnippet = require('./viewer/TerminusCodeSnippet');\r\n\r\n/*\r\n * Simple wrapper functions for initialising\r\n * table, stream, graph, chooser, woql and documents\r\n */\r\n\r\nfunction TerminusHTMLViewer(client, config){\r\n\tthis.client = client;\r\n\r\n\tthis.config = config;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.setRenderers = function(config){\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showResult = function(result, config){\r\n\tconsole.log('config ***' , config)\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-results\");\r\n\tlet renderers = {\r\n\t\ttable: new SimpleTable(),\r\n\t\tgraph: new SimpleGraph(),\r\n\t\t//stream: new SimpleStream(),\r\n\t\tchooser: new SimpleChooser()\r\n\t}\r\n\tlet viewer = config.create(this.client, renderers, Datatypes.initialiseDataRenderers);\r\n\tviewer.setResult(result);\r\n\tspan.appendChild(viewer.render());\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.displayResults = function(query, config){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-results\");\r\n\tlet renderers = {\r\n\t\t\ttable: new SimpleTable(),\r\n\t\t\tgraph: new SimpleGraph(),\r\n\t\t//\tstream: [new SimpleStream()],\r\n\t\t\tchoice: new SimpleChooser()\r\n\t}\r\n\tlet viewer = config.create(this.client, renderers, Datatypes.initialiseDataRenderers);\r\n\tif(query){\r\n\t\tthis.loadResults(query, viewer, function(){ span.appendChild(viewer.render()); })\r\n\t}\r\n\telse {\r\n\t\tif(this.last_result){\r\n\t\t\tviewer.setResult(this.last_result);\r\n\t\t\tspan.appendChild(viewer.render());\r\n\t\t}\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.loadResults = function(query, viewer, then){\r\n\tvar self = this;\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tself.last_result = new TerminusClient.WOQLResult(results, query);\r\n\t\tviewer.setResult(self.last_result);\r\n\t\tconsole.log('self.last_result', self.last_result);\r\n\t\t//self.testspan(self.showResult(results, TerminusClient.WOQL.table()));\r\n\t});\r\n}\r\n\r\nTerminusHTMLViewer.prototype.table = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-table\");\r\n\tvar wqt = new WOQLTable(this.client).options(config);\r\n\twqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\twqt.setRenderer(new SimpleTable());\r\n\tquery.execute(this.client).then((results) => {\r\n\t\tvar result = new TerminusClient.WOQLResult(results, query);\r\n\t\twqt.setResult(result);\r\n\t\tspan.appendChild(wqt.render());\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.stream = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-stream\");\r\n\tvar wqt = new WOQLStream(this.client).options(config);\r\n\twqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render());\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.woql = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-woql\");\r\n\tvar wqt = new WOQLQueryViewer(this.client).options(config);\r\n\tspan.appendChild(wqt.render());\r\n\tif(query){\r\n\t\twqt.setQuery(query, true);\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.ruleEditor = function(){\r\n\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getAddRuleButton = function(cont){\r\n\tvar rbtn = document.createElement('button');\r\n\trbtn.appendChild(document.createTextNode('Add another rule'));\r\n\tvar self = this;\r\n\trbtn.addEventListener('click', function(){\r\n\t\t//self.QueryPane.addResultViewer(\"Choice\", wqc);\r\n\t\t//qp.addResultViewer(\"Choice\", wqc);\r\n\t\t//addResultViewer = function(label, rule, ruleviewer){\r\n\t})\r\n\tcont.appendChild(rbtn);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getConfigButton = function(cont){\r\n\tvar cbtn = document.createElement('button');\r\n\tcbtn.appendChild(document.createTextNode('Rule'));\r\n\tvar self = this;\r\n\tcbtn.addEventListener('click', function(){\r\n\t\tcont.appendChild(self.ruleEditor());\r\n\t\tself.getAddRuleButton(cont);\r\n\t})\r\n\tcont.appendChild(cbtn);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.querypane = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-woql-pane\");\r\n\tthis.testspan = span;\r\n\tvar qp = new QueryPane(this.client, query);\r\n\tqp.options(config);\r\n\tthis.queryPane = qp;\r\n\tvar wqv = new WOQLQueryViewer(this.client).options(config);\r\n\r\n\t// Query Viewer\r\n/*\tvar tcs = new TerminusCodeSnippet({}, 800, 250, 'Enter Query', 'edit');\r\n\tvar snippet = tcs.getAsDOM();\r\n\tspan.appendChild(snippet.dom);\r\n\t//span.appendChild(this.ruleEditor());\r\n\tvar abtn = snippet.actionButton;\r\n\tvar self = this; */\r\n\t// On submit query\r\n\t/*abtn.addEventListener('click', function(){\r\n\t\tvar qObj = wqv.getqObjFromInput(snippet.snippetText.value);\r\n\t\tlet t = TerminusClient.WOQL.table();\r\n\t\tconsole.log('t', t);\r\n\r\n\r\n\t\tspan.appendChild(self.displayResults(qObj, t));\r\n\t\tself.getConfigButton(span);\r\n\r\n\t\t/*qObj.execute(self.client).then(function(response){\r\n\t\t\t// default result in table format\r\n\t\t\tlet t = TerminusClient.WOQL.table();\r\n\t\t\tlet res = TerminusClient.WOQLResult(response, qObj, t);\r\n\t\t\t/*t.column(\"Label\").header(\"Document\");\r\n\t\t\tt.column(\"Range\").header(\"Range\");\r\n\t\t\tt.column(\"Domain\").header(\"Domain\");\r\n\t\t\tt.column(\"Comment\").header(\"Description\");\r\n\t\t\tt.column(\"Comment\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\t    t.column_order(\"Label\", \"Type\", \"Comment\");*/\r\n\t\t/*\tspan.appendChild(self.displayResults(res, t));\r\n\t\t\tself.getConfigButton(span);\r\n\t\t}) */\r\n\t\t//wqv.submitQuery(qObj);\r\n\t/*})\r\n\t*/\r\n\r\n\t//console.log('wqv', wqv);\r\n\t//var wqc = new WOQLChoice(this.client).options(config);\r\n\t//var wqs = new WOQLStream(this.client).options(config);\r\n\t//var wqg = new WOQLGraph(this.client).options(config);\r\n\t//var wqt = new WOQLTable(this.client).options(config)\r\n\t//wqv.setRenderer(new SimpleTextbox(wqv, 1000, 600));\r\n\t//wqt.setRenderer(new SimpleTable());\r\n\t//wqg.setRenderer(new SimpleGraph());\r\n\t//wqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\t//wqs.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\t//qp.addQueryViewer(wqv);\r\n\t//qp.addResultViewer(\"Choice\", wqc);\r\n\t//qp.addResultViewer(\"Stream\", wqs);\r\n\t//qp.addResultViewer(\"Graph\", wqg);\r\n\t//qp.addResultViewer(\"Table\", wqt);\r\n\r\n\t//qp.addResultViewer(\"ABC\", config, new SimpleTextbox(wqv, 1000, 600));\r\n\t//span.appendChild(qp.render());\r\n\r\n\treturn span;\r\n}\r\n\r\n\r\nTerminusHTMLViewer.prototype.chooser = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-chooser\");\r\n\tvar wqt = new WOQLChoice(this.client).options(config);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render(result));\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.graph = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-graph terminus-graph-holder\");\r\n\tvar wqt = new WOQLGraph(this.client).options(config);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render(result));\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.lmg = function(config){\r\n\tconfig.show_all(\"HTMLObjectViewer\", \"HTMLPropertyViewer\", \"HTMLDataViewer\");\r\n}\r\n\r\nTerminusHTMLViewer.prototype.document = function(id, config){\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-document terminus-document-holder\");\r\n\t//config.renderer(new DocumentTable());\r\n\tthis.lmg(config);\r\n\tvar tdv = new TerminusFrame(this.client).options(config);\r\n\ttdv.owner = this;\r\n\ttdv.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\ttdv.loadDocument(id).then(() => {\r\n\t\tlet dom = tdv.render();\r\n\t\tif(dom) holder.appendChild(dom);\r\n\t});\r\n\treturn holder;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.loadRenderer = function(rendname, frame, args){\r\n\tvar evalstr = \"new \" + rendname + \"(\";\r\n\tif(args) evalstr += JSON.stringify(args);\r\n\tevalstr += \");\";\r\n\ttry {\r\n\t\tvar nr = eval(evalstr);\r\n\t\treturn nr;\r\n\t}\r\n\tcatch(e){\r\n\t\tconsole.log(\"Failed to load \" + rendname + e.toString());\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports = TerminusHTMLViewer;\r\n","\nmodule.exports = Object.freeze({\n\tCONNECT: 'connect',\n\tGET_SCHEMA: 'get_schema',\n\tUPDATE_SCHEMA: 'update_schema',\n\tUPDATE_DOCUMENT: 'update_document',\n\tCLASS_FRAME: 'class_frame',\n\tWOQL_SELECT: 'woql_select',\n\tGET_DOCUMENT: 'get_document',\n\tDELETE_DATABASE: 'delete_database',\n\tDELETE_DOCUMENT: 'delete_document',\n\tCREATE_DATABASE: 'create_database',\n\tCREATE_DOCUMENT: 'create_document',\n\tWOQL_UPDATE: 'woql_update'\n});\n\n/*\n{\"extends\": \"strongloop\",\n  \"env\": {\n\t\t\"browser\": true,\n\t\t\"node\": true,\n\t\t\"es6\": true\n  },\n  \"rules\":{\"max-len\": [\"error\", { \"code\": 100 }]},\n \"parserOptions\": { \"ecmaVersion\": 6 }}\n*/\n","function authorityActionsToArr(action) {\n\tif (Array.isArray(action) === false) return [];\n\n\treturn action.map(item => item['@id']);\n}\n\nfunction URIEncodePayload(payload) {\n\tif (typeof payload === 'string') return encodeURIComponent(payload);\n\tconst payloadArr = [];\n\tfor (const key of Object.keys(payload)) {\n\t\tif (typeof payload[key] === 'object') {\n\t\t\tfor (const keyElement of Object.keys(payload[key])) {\n\t\t\t\t const valueElement = payload[key][keyElement];\n\t\t\t\t payloadArr.push(`${encodeURIComponent(keyElement)}=${encodeURIComponent(valueElement)}`);\n\t\t\t}\n\t\t} else {\n\t\t\tpayloadArr.push(`${encodeURIComponent(key)}=${encodeURIComponent(payload[key])}`);\n\t\t}\n\t}\n\treturn payloadArr.join('&');\n}\n\nmodule.exports = { authorityActionsToArr, URIEncodePayload };\n","/**\r\n * Object for producing a HTML view of a given object in a frame\r\n */\r\nconst HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLObjectViewer(renderer){\r\n\tthis.properties = [];\r\n\t//this.featureViewers = {};\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nHTMLObjectViewer.prototype.render = function(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = new HTMLObjectHeaderViewer();\r\n\tif(this.renderedDOM){\r\n\t\t//var renderedDOM = this.getObjectDOM();\r\n\t\t//this.renderedDOM.replaceWith(renderedDOM);\r\n\t\t//this.renderedDOM = renderedDOM;\r\n\t}\r\n\telse {\r\n\t\t//this.renderedDOM = this.getObjectDOM();\r\n\t}\r\n\t//this.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getObjectBodyDOM();\r\n\tif(this.body) this.renderedDOM.appendChild(this.body);\r\n\treturn this.renderedDOM;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\r\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\r\n\treturn sp;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\r\n\tvar orientation = \"page\";//this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-properties-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\r\n    for(var prop in this.properties){\r\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\r\n\tif(this.hasFeatureViewer(feature)){\r\n\t\treturn this.featureViewer[feature](this.renderer, this);\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redraw = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getObjectBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a rendered version of a property to the internal properties array\r\n */\r\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\r\n\tthis.properties[prop] = renderedprop;\r\n}\r\n\r\nHTMLObjectViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = {};\r\n}\r\n\r\n/**\r\n * Removes the object from the dom\r\n */\r\nHTMLObjectViewer.prototype.remove = function(){\r\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\r\n}\r\n\r\nHTMLObjectViewer.prototype.goTo = function(subj, property){\r\n\tHTMLFrameHelper.goToName(subj, property);\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the object on the page\r\n */\r\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\r\n\tvar sh = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n    if(!sh) sh = renderer.subject();\r\n    if(sh){\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tidm.setAttribute(\"name\", sh);\r\n    }\r\n\treturn idm;\r\n}\r\n\r\nfunction HTMLObjectHeaderViewer(){}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\r\n\t\tif(idDOM) objDOM.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\r\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\r\n\tif(renderer.showFeature(\"add\")){\r\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\r\n\t\tif(addDOM) controlsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\tif(lab){\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\r\n\tvar val = renderer.subject();\r\n\tvar input = false;\r\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\r\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\r\n\t\tinput = document.createElement(\"input\");\r\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\r\n\t\tinput.required  = true;\r\n\t\tif(val == \"_:\") val = \"\";\r\n\t\trenderer.idDOM = input;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\r\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\r\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.changeClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\r\n\tvar lab = renderer.subjectClass();\r\n\tvar cmt = \"All objects have types, identified by a unique URL\";\r\n\tif(cm){\r\n\t\tlab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", cm);\r\n\t\tcmt = HTMLFrameHelper.getVariableValueFromBinding(\"Comment\", cm);\r\n\t\tcmt = (cmt ? renderer.subjectClass() + \" \" + cmt : renderer.subjectClass());\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\r\n\tvar addables = renderer.getAddableProperties();\r\n\tif(addables && addables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\r\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.addNewProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableProperties();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.goToProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\r\n\tif(renderer.isNewDocument()){\r\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\telse {\r\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nmodule.exports=HTMLObjectViewer;\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLStringViewer(options){\r\n\tthis.size = ((options && options.size) ? options.size : false);\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.max_word_size = (options && options.max_word_size ? options.max_word_size : false);\r\n\tthis.max_cell_size = (options && options.max_cell_size ? options.max_cell_size : false);\r\n}\r\n\r\nHTMLStringViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\treturn this.render(value);\r\n}\r\n\r\nHTMLStringViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLStringViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(this.max_word_size || this.max_cell_size){\r\n\t\tHTMLFrameHelper.wrapShortenedText(input, value, this.max_cell_size, this.max_word_size);\r\n\t}\r\n\telse {\r\n\t\tvalue = document.createTextNode(value);\r\n\t\tinput.appendChild(value);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLStringViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n/**\r\n * Property Viewer\r\n */\r\nfunction HTMLPropertyViewer(renderer){\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Draws the property as header and body components\r\n */\r\nHTMLPropertyViewer.prototype.render = function(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = new HTMLPropertyHeaderViewer();\r\n\t//var block = document.createElement('div');\r\n\t//block.setAttribute('style', 'display: flex; margin: 10px');\r\n\t//var br = document.createElement('br');\r\n\t//block.appendChild(br);\r\n\tif(this.propDOM){\r\n\t\tvar npropDOM = this.getPropertyDOM();\r\n\t\t//npropDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t\t\t//block.appendChild(npropDOM);\r\n\t\tthis.propDOM.replaceWith(npropDOM);\r\n\t\tthis.propDOM = npropDOM;\r\n\t\t//this.propDOM = block;\r\n\t}\r\n\telse {\r\n\t\t//block.appendChild(this.getPropertyDOM());\r\n\t\t//this.propDOM = block;\r\n\t\tthis.propDOM = this.getPropertyDOM();\r\n\t\t//this.propDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t}\r\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.propDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getPropertyBodyDOM();\r\n\tif(this.body) this.propDOM.appendChild(this.body);\r\n\treturn this.propDOM;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\r\n\tif(orientation == \"label\"){\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\t//terminus-property-frame-spacer\r\n\r\n\tsp.setAttribute(\"class\", \"terminus-property-frame terminus-zebra-frame terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\r\n\tsp.setAttribute('data-property', this.renderer.property());\r\n\treturn sp;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-values-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\r\n\tfor(var i =0; i<this.values.length; i++){\r\n\t\tvholder.appendChild(this.values[i]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\r\n\tthis.values.push(renderedval);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.propDOM);\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Removes the property from the dom\r\n */\r\nHTMLPropertyViewer.prototype.remove = function(){\r\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\r\n}\r\n\r\n/**\r\n * Redraws the property to reflect an updated state\r\n */\r\nHTMLPropertyViewer.prototype.redraw = function(){\r\n\tvar npropDOM = this.getPropertyDOM();\r\n\tthis.propDOM.replaceWith(npropDOM);\r\n\tthis.propDOM = npropDOM;\r\n\tthis.values = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getPropertyBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\r\n\treturn idm;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\r\n\tHTMLFrameHelper.goToName(subj, property, index);\r\n}\r\n\r\nfunction HTMLPropertyHeaderViewer(){}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\r\n\tvar wrapper = document.createElement(\"span\");\r\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar expModeMenu = this.getPropertyControlsDOM(wrapper, renderer);\r\n\t\tif(orientation == 'page') this.expModeMenu = expModeMenu;\r\n\t\telse this.expModeMenu = null;\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\r\n\t\tif(renderer.showFeature(\"status\")){\r\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\r\n\t\t}\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\telse if(renderer.showFeature(\"status\")){\r\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\tif(statDOM) wrapper.appendChild(statDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\r\n\tvar prelude = document.createElement(\"span\");\r\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\r\n\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\r\n\t\tif(facetDOM) prelude.appendChild(facetDOM);\r\n\t\t//if(facetDOM && this.expModeMenu) this.expModeMenu.appendChild(facetDOM);//\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\r\n\t\tif(viewDOM) prelude.appendChild(viewDOM);\r\n\t\t//if(viewDOM && this.expModeMenu) this.expModeMenu.appendChild(viewDOM); //prelude.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\r\n\t\tif(idDOM) prelude.appendChild(idDOM);\r\n\t\t//if(idDOM && this.expModeMenu) this.expModeMenu.appendChild(idDOM); //\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\r\n\t\tif(typeDOM)\tprelude.appendChild(typeDOM);\r\n\t\t/*if(typeDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(typeDOM);//\r\n\t\t\ttypeDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\r\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\r\n\t\tif(hideDOM) prelude.appendChild(hideDOM);\r\n\t\t//\tthis.expModeMenu.appendChild(hideDOM); \t\t\thideDOM.style.display = 'block';\r\n\r\n\t}\r\n\tif(renderer.showFeature(\"comment\")){\r\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\r\n\t\tif(sumDOM) prelude.appendChild(sumDOM);\r\n\t\t/*if(sumDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(sumDOM); //\r\n\t\t\tsumDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\twrapper.appendChild(prelude);\r\n\tobjDOM.appendChild(wrapper);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\r\n\tvar lab = renderer.getComment();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\r\n\tvar restriction = renderer.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\r\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\r\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\r\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\r\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\r\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\r\n\tvar settings = document.createElement(\"div\");\r\n\tcontrolsDOM.appendChild(settings);\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tif(false && orientation == 'page'){ // expert mode\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('property');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.getActionControlDOM(menu, renderer);\r\n\t    settings.appendChild(sControl);\r\n\t\treturn menu;\r\n\t}\r\n\telse this.getActionControlDOM(controlsDOM, renderer);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(wrapper, renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\r\n\t//controlsDOM.setAttribute(\"style\", \"display: table-cell;\");\r\n\t// get settings icon or button\r\n\tvar expModeMenu = this.getSettingsControlDOM(controlsDOM, renderer);\r\n\twrapper.appendChild(controlsDOM);\r\n\treturn expModeMenu;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\r\n\tif(renderer.isClassChoice()){\r\n\t\tvar cs = renderer.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.addClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){renderer.add(\"edit\")};\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableValues();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\r\n\t\tvar callback = function(val){\r\n\t\t\trenderer.goToValue(val);\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\r\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\r\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\r\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\r\n}\r\n\r\nfunction HTMLDataViewer(){\r\n}\r\n\r\nmodule.exports=HTMLPropertyViewer;\r\n","/**\r\n * Draws the property as header and body components\r\n */\r\nconst HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst HTMLStringViewer = require('../datatypes/String');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDataViewer(){\r\n}\r\n\r\nHTMLDataViewer.prototype.render = function(renderer){\r\n\tthis.headerViewer = new HTMLDataHeaderViewer();\r\n\tif(this.valDOM){\r\n\t\tvar nvalDOM = this.getValueDOM();\r\n\t\tthis.valDOM.replaceWith(nvalDOM);\r\n\t\tthis.valDOM = nvalDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.valDOM = this.getValueDOM();\r\n\t}\r\n\tthis.valDOM.appendChild(this.getValueIDMarker(this.renderer));\r\n\tthis.body = this.getValueBodyDOM();\r\n\tif(this.body) this.valDOM.appendChild(this.body);\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.renderer.facet == 'page'){ //expert mode\r\n\t\t\tif(this.header && this.expModeMenu) {\r\n\t\t\t\tthis.expModeMenu.appendChild(this.header);\r\n\t\t\t\t//this.valDOM.appendChild(this.expModeMenu);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.header) this.valDOM.appendChild(this.header);\r\n\t}\r\n\treturn this.valDOM;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tsp.setAttribute(\"class\", \"terminus-property-value property-value-\" + this.renderer.currentFacet() + \" property-value-\" + this.renderer.mode);\r\n\tif(this.renderer.mode == \"view\"){\r\n\t\tsp.setAttribute('data-value', this.renderer.value());\r\n\t}\r\n\treturn sp;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueBodyDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', ' terminus-property-body property-value-body property-value-body-'+this.renderer.currentFacet() + ' terminus-property-body-align');\r\n\t//vholder.setAttribute('style', 'display: flex;');\r\n\tif(this.renderer.showFeature(\"body\")){\r\n        var valueViewer = this.renderer.getDataValueViewer();\r\n    \tvar vdom = valueViewer.getDOM(this.renderer, this);\r\n    }\r\n    else if(this.renderer.showFeature(\"summary\")){\r\n\t\tvar vdom = this.getSummaryDOM();\r\n    }\r\n    else {\r\n    \treturn false;\r\n    }\r\n    if(vdom) vholder.appendChild(vdom);\r\n\tif(false && this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('data');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property value'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n\t\t\ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.expModeMenu = menu;\r\n\t\tvholder.appendChild(sControl);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\n/**\r\n * Removes the value from the dom\r\n */\r\nHTMLDataViewer.prototype.remove = function(){\r\n\tthis.valDOM.parentNode.removeChild(this.valDOM);\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getValueBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLDataViewer.prototype.getValueIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-value-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop + \"_\" + renderer.index);\r\n\treturn idm;\r\n}\r\n\r\nHTMLDataViewer.prototype.getSummaryDOM = function(){\r\n\tvar sum = this.renderer.getSummary();\r\n\treturn HTMLTerminusClient.FrameHelper.getInfoboxDOM(\"value-summary\", false, sum.long, sum.long);\r\n}\r\n\r\nHTMLDataViewer.prototype.fireInternalLink = function(link){\r\n\tvar self = this;\r\n\tvar fire = function(e){\r\n\t\te.preventDefault();\r\n\t\tself.renderer.load(link);\t\t\r\n\t}\r\n\treturn fire;\r\n}\r\n\r\nHTMLDataViewer.prototype.internalLink = function(link, label){\r\n\tvar onclick = this.fireInternalLink(link);\r\n\tvar a = document.createElement(\"a\");\r\n\ta.onClick = onclick;\r\n\ta.href=link;\r\n\ta.addEventListener(\"click\", onclick);\r\n\tif(label){\r\n\t\ta.appendChild(document.createTextNode(label));\r\n\t}\r\n\telse {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(link);\r\n\t\tif(sh){\r\n\t\t\ta.setAttribute(\"title\", link);\r\n\t\t\ta.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ta.appendChild(document.createTextNode(link));\r\n\t\t}\r\n\t}\r\n\treturn a;\r\n}\r\n\r\nHTMLDataViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.valDOM);\r\n}\r\n\r\n\r\nfunction HTMLDataHeaderViewer(){}\r\n\r\nHTMLDataHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tif(renderer.currentFacet() == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-value-header terminus-value-header-\" + renderer.currentFacet());\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getValueFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getValueTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getValueStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getValueControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"value-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueTypeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"value-type\", \"Type\", renderer.type(), \"All data values have types, identified by a unique URL\");\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-value-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"value\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getValueDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getValueCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getValueResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getValueUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getValueShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getValueHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-value-update\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to save - no change\");\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"value\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"data-viewer\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=HTMLDataViewer;\r\n","/*\r\n * Utility class which runs a query against the schema and presents the returned classes as a drop-down / class filter list\r\n */\r\n\r\nconst WOQLQuery = require('./WOQLQuery');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nTerminusClassChooser = function(ui, filter, chosen){\r\n\tthis.ui = ui;\r\n\tthis.choice = (chosen ? chosen : false);\r\n\tthis.filter = filter;\r\n\tthis.show_single = true;\r\n}\r\n\r\nTerminusClassChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusClassChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusClassChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify class chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusClassChooser.prototype.getAsDOM = function(style){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"terminus-class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", style + \" terminus-type-select terminus-class-select\");\r\n\t// ccsel.setAttribute(\"class\", \"terminus-class-select terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tthis.choice = this.value;\r\n\t\tself.change(this.value);\r\n\t\tthis.value = \"\";\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = TerminusClient.WOQL.query().classMetadata();\r\n\tvar self = this;\r\n\twq.execute(this.ui.client)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tif(opts){\r\n\t\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\t\tccsel.appendChild(opts[i]);\r\n\t\t\t}\r\n\t\t\tself.options = opts;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tccdom.removeChild(ccsel);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusClassChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(clist.bindings){\r\n\t\tif(this.show_single == false && clist.bindings.length < 2) return false;\r\n\t\tif(this.empty_choice){\r\n\t\t\tvar opt1 = document.createElement(\"option\");\r\n\t\t\topt1.setAttribute(\"class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\t\topt1.value = \"\";\r\n\t\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\t\tchoices.push(opt1);\r\n\t\t}\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", clist.bindings[i]);\r\n\t\t\tif(!bclass) bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Class\", clist.bindings[i]);\r\n\t\t\tif(bclass && added.indexOf(bclass) == -1){\r\n\t\t\t\tadded.push(bclass);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = bclass;\r\n\t\t\t\tif(opt.value == this.choice){\r\n\t\t\t\t\topt.selected = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar lab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(bclass);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\n\r\n\r\nmodule.exports=TerminusClassChooser\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n/*\r\nqObj: WOQL object\r\nwidth: width of snippet in px\r\nheight: height of snippet in px\r\n*/\r\nfunction TerminusCodeSnippet(qObj, width, height, placeholder, mode){\r\n    this.qObj = qObj;\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n    this.placeholder = placeholder;\r\n    this.format = ['javascript', 'jsonld'];\r\n    this.mode = mode;\r\n    if(this.mode == 'view')\r\n        this.snippet = document.createElement('pre');\r\n    else this.snippet = document.createElement('textarea');\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getActionButtons = function(){\r\n    var actbtn = document.createElement('button');\r\n    actbtn.setAttribute('type', 'submit');\r\n    if(this.mode == 'view')\r\n        actbtn.appendChild(document.createTextNode(this.mode.charAt(0)\r\n                                                       .toUpperCase()\r\n                                                       + this.mode.slice(1)))\r\n    else actbtn.appendChild(document.createTextNode('Submit'));\r\n    return actbtn;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.displayFormat = function(button){\r\n    TerminusClient.FrameHelper.removeChildren(this.snippet);\r\n    switch(button.value){\r\n        case 'javascript':\r\n            this.snippet.appendChild(document.createTextNode(this.qObj.prettyPrint(this.qObj.query)));\r\n        break;\r\n        case 'jsonld':\r\n            this.snippet.appendChild(document.createTextNode(JSON.stringify(this.qObj.query, undefined, 2)));\r\n        break;\r\n        default:\r\n            console.log('Invalid Format specified in TerminusCodeSnippet.js')\r\n        break;\r\n    }\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getFormatButtons = function(){\r\n    var bsp = document.createElement('span');\r\n    for(var i=0; i<this.format.length; i++){\r\n        var btn = document.createElement('button');\r\n        btn.setAttribute('value', this.format[i]);\r\n        btn.appendChild(document.createTextNode(this.format[i].charAt(0)\r\n                                                    .toUpperCase()\r\n                                                    + this.format[i].slice(1)));\r\n        var self = this;\r\n        btn.addEventListener('click', function(){\r\n            self.displayFormat(this);\r\n        })\r\n        bsp.appendChild(btn);\r\n    }\r\n    return bsp;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getDOMParts = function(){\r\n    var snippet = {};\r\n    var scont = document.createElement('div');\r\n    scont.setAttribute('style', 'display:table-caption; margin: 20px');\r\n    if(this.placeholder)\r\n\t\tthis.snippet.setAttribute(\"placeholder\", this.placeholder);\r\n    if(this.width && this.height)\r\n\t\tthis.snippet.setAttribute(\"style\", \"width: \"+ this.width +\"px; height: \"+ this.height + \"px;\");\r\n    scont.appendChild(this.getFormatButtons());\r\n    if(Object.entries(this.qObj).length > 0)\r\n        this.snippet.appendChild(document.createTextNode(this.qObj.prettyPrint(this.qObj.query)));\r\n    scont.appendChild(this.snippet);\r\n    var actbtn = this.getActionButtons();\r\n    scont.appendChild(actbtn);\r\n    snippet.dom = scont; // html dom\r\n    snippet.actionButton = actbtn; // action button HTML obj\r\n    snippet.snippetText = this.snippet; // text area HTML obj\r\n    return snippet;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getAsDOM = function(){\r\n    return this.getDOMParts();\r\n}\r\n\r\nmodule.exports = TerminusCodeSnippet;\r\n","'use strict';\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%40/gi, '@').\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    var hashmarkIndex = url.indexOf('#');\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n","'use strict';\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar normalizeHeaderName = require('./helpers/normalizeHeaderName');\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  // Only Node.JS has a process variable that is of [[Class]] process\n  if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  } else if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Accept');\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n","'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildURL = require('./../helpers/buildURL');\nvar parseHeaders = require('./../helpers/parseHeaders');\nvar isURLSameOrigin = require('./../helpers/isURLSameOrigin');\nvar createError = require('../core/createError');\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(createError('Request aborted', config, 'ECONNABORTED', request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      var cookies = require('./../helpers/cookies');\n\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?\n        cookies.read(config.xsrfCookieName) :\n        undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (config.withCredentials) {\n      request.withCredentials = true;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (requestData === undefined) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n","'use strict';\n\nvar enhanceError = require('./enhanceError');\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n","'use strict';\n\nvar utils = require('../utils');\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n * @returns {Object} New object resulting from merging config2 to config1\n */\nmodule.exports = function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  var config = {};\n\n  utils.forEach(['url', 'method', 'params', 'data'], function valueFromConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    }\n  });\n\n  utils.forEach(['headers', 'auth', 'proxy'], function mergeDeepProperties(prop) {\n    if (utils.isObject(config2[prop])) {\n      config[prop] = utils.deepMerge(config1[prop], config2[prop]);\n    } else if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (utils.isObject(config1[prop])) {\n      config[prop] = utils.deepMerge(config1[prop]);\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  utils.forEach([\n    'baseURL', 'transformRequest', 'transformResponse', 'paramsSerializer',\n    'timeout', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',\n    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress', 'maxContentLength',\n    'validateStatus', 'maxRedirects', 'httpAgent', 'httpsAgent', 'cancelToken',\n    'socketPath'\n  ], function defaultToConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  return config;\n};\n","'use strict';\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n","const UTILS = require('./utils.js');\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n/*\n * Creates an entry in the connection registry for the server\n * and all the databases that the client has access to\n * maps the input authorties to a per-db array for internal storage and easy\n * access control checks\n * {doc:dbid => {terminus:authority =>\n * [terminus:woql_select, terminus:create_document, auth3, ...]}}\n *\n */\n\nfunction ConnectionCapabilities(connectionConfig, key) {\n\tthis.connection = {};\n\tthis.connectionConfig = connectionConfig;\n\tif (this.connectionConfig.server && key) {\n\t\tthis.setClientKey(this.connectionConfig.server, key);\n\t}\n}\n\nConnectionCapabilities.prototype.getClientKey = function (serverURL) {\n\tif (!serverURL) serverURL = this.connectionConfig.serverURL();\n\tif (serverURL && this.connection[serverURL]) return this.connection[serverURL].key;\n\treturn false;\n};\n\n\n/*\n * Utility functions for changing the state of connections with Terminus servers\n */\nConnectionCapabilities.prototype.setClientKey = function (curl, key) {\n\tif (typeof key === 'string' && key.trim()) {\n\t\tif (typeof this.connection[curl] === 'undefined') {\n\t\t\tthis.connection[curl] = {};\n\t\t}\n\t\tthis.connection[curl].key = key.trim();\n\t}\n};\n\n\n/**\n * @params {string} curl a valid terminusDB server URL\n * @params {object} capabilities it is the connect call response\n */\nConnectionCapabilities.prototype.addConnection = function (curl, capabilities) {\n\tif (typeof this.connection[curl] === 'undefined') {\n\t\tthis.connection[curl] = {};\n\t}\n\tconst capabilitiesKeys = capabilities ? Object.keys(capabilities) : [];\n\n\tfor (const pred of capabilitiesKeys) {\n\t    if (pred === 'terminus:authority' && capabilities[pred]) {\n\t      const auths = Array.isArray(capabilities[pred]) === true\n\t        ? capabilities[pred]\n\t        : [capabilities[pred]];\n\n\t      for (let i = 0; i < auths.length; i += 1) {\n\t        let scope = auths[i]['terminus:authority_scope'];\n\t        const actions = auths[i]['terminus:action'];\n\n\t        if (Array.isArray(scope) === false) scope = [scope];\n\t        const actionsArr = UTILS.authorityActionsToArr(actions);\n\n\t        for (let j = 0; j < scope.length; j += 1) {\n\t          const nrec = scope[j];\n\t          if (typeof this.connection[curl][nrec['@id']] === 'undefined') {\n\t            this.connection[curl][nrec['@id']] = nrec;\n\t          }\n\t          this.connection[curl][nrec['@id']]['terminus:authority'] = actionsArr;\n\t        }\n\t      }\n\t    } else {\n\t      this.connection[curl][pred] = capabilities[pred];\n\t    }\n\t}\n};\n\nConnectionCapabilities.prototype.serverConnected = function () {\n\treturn typeof this.connection[this.connectionConfig.server] !== 'undefined';\n};\n\nConnectionCapabilities.prototype.capabilitiesPermit = function (action, dbid, server) {\n\tif (!this.connectionConfig.connectionMode()\n         || this.connectionConfig.client_checks_capabilities !== true\n         || action === CONST.CONNECT) { return true; }\n\n\tserver = server || this.connectionConfig.server;\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tlet rec;\n\n\tif (action === CONST.CREATE_DATABASE) {\n\t\trec = this.getServerRecord(server);\n\t} else if (dbid) rec = this.getDBRecord(dbid);\n\telse console.log('no dbid', server, dbid);\n\tif (rec) {\n\t\tconst auths = rec['terminus:authority'];\n\t\tif (auths && auths.indexOf(`terminus:${action}`) !== -1) return true;\n\t} else {\n\t\tconsole.log('problem with ', this.connection, action, server, dbid);\n\t}\n\tthis.error = ErrorMessage.accessDenied(action, dbid, server);\n\treturn false;\n};\n\nConnectionCapabilities.prototype.getServerRecord = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst connectionObj = this.connection[url] || {};\n\tconst okeys = Object.keys(connectionObj);\n\n\tfor (const oid of okeys) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Server') {\n\t\t\treturn this.connection[url][oid];\n\t\t}\n\t}\n\treturn false;\n};\n\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tdbid = (dbid || this.connectionConfig.dbid);\n\tif (typeof this.connection[url] !== 'object') {\n\t\treturn false;\n\t}\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\tdbid = this.dbCapabilityID(dbid);\n\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\treturn undefined;\n};\n\nConnectionCapabilities.prototype.getServerDBRecords = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst dbrecs = {};\n\tconst connectionObj = this.connection[url] || {};\n\n\tfor (const oid of Object.keys(connectionObj)) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Database') {\n\t\t\tdbrecs[oid] = this.connection[url][oid];\n\t\t}\n\t}\n\treturn dbrecs;\n};\n\n/*\n * removes a database record from the connection registry (after deletion, for example)\n */\nConnectionCapabilities.prototype.removeDB = function (dbid, srvr) {\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tif (dbid && this.connectionConfig.dbid && this.connectionConfig.dbid === dbid) {\n\t\tthis.connectionConfig.dbid = false;\n\t}\n\n\tconst url = srvr || this.connectionConfig.server;\n\tconst dbidCap = this.dbCapabilityID(dbid);\n\tif (dbidCap && this.connection[url] && this.connection[url][dbidCap]) {\n\t\tdelete this.connection[url][dbidCap];\n\t}\n};\n\n\nConnectionCapabilities.prototype.dbCapabilityID = function (dbid) {\n\treturn `doc:${dbid}`;\n};\n\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\n\tconst url = srvr || this.connectionConfig.server;\n\tdbid = dbid || this.connectionConfig.dbid;\n\tif (typeof this.connection[url] !== 'object') {\n\t\treturn false;\n\t}\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\tdbid = this.dbCapabilityID(dbid);\n\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\treturn undefined;\n};\n\nmodule.exports = ConnectionCapabilities;\n","\nconst IDParser = require('./terminusIDParser');\n\nfunction ConnectionConfig(params) {\n\tconst newParams = params || {};\n\tthis.server = false;\n\tthis.dbid = false;\n\tthis.docid = false;\n\tif (newParams.server) this.setServer(newParams.server);\n\tif (newParams.db) this.setDB(newParams.db);\n\tif (newParams.doc) this.setDocument(newParams.doc);\n\t/*\n     * client configuration options - connected_mode = connected\n     * tells the client to first connect to the server before invoking other services\n     */\n\n\tthis.connected_mode = newParams.connected_mode || 'connected';\n\t// include a terminus:user_key API key in the calls\n\tthis.include_key = newParams.include_key || true;\n\t// client side checking of access control (in addition to server-side access control)\n\tthis.client_checks_capabilities = newParams.client_checks_capabilities || true;\n}\n\nConnectionConfig.prototype.serverURL = function () {\n\treturn this.server;\n};\n\n\nConnectionConfig.prototype.connectionMode = function () {\n\treturn this.connected_mode === 'connected';\n};\n\nConnectionConfig.prototype.includeKey = function () {\n\treturn this.include_key === true;\n};\n\nConnectionConfig.prototype.schemaURL = function () {\n\treturn `${this.dbURL()}/schema`;\n};\nConnectionConfig.prototype.queryURL = function () {\n\treturn `${this.dbURL()}/woql`;\n};\nConnectionConfig.prototype.frameURL = function () {\n\treturn `${this.dbURL()}/frame`;\n};\nConnectionConfig.prototype.docURL = function () {\n\treturn `${this.dbURL()}/document/${this.docid ? this.docid : ''}`;\n};\n\nConnectionConfig.prototype.dbURL = function (call) {\n\t// url swizzling to talk to platform using server/dbid/platform/ pattern..\n\tif (this.platformEndpoint()) {\n\t\tconst baseURL = this.server.substring(0, this.server.lastIndexOf('/platform/'));\n\n\t\tif (!call || call !== 'create') {\n\t\t\treturn `${baseURL}/${this.dbid}/platform`;\n\t\t} if (call === 'platform') {\n\t\t\treturn `${baseURL}/${this.dbid}`;\n\t\t}\n\t}\n\treturn this.server + this.dbid;\n};\n\nConnectionConfig.prototype.platformEndpoint = function () {\n\tif (this.server && this.server.lastIndexOf('/platform/') === this.server.length - 10) {\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n/**\n * Utility functions for setting and parsing urls and determining\n * the current server, database and document\n */\nConnectionConfig.prototype.setServer = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseServerURL(inputStr)) {\n\t\tthis.server = parser.server();\n\t\tthis.dbid = false;\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setDB = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDBID(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n// @param {string} inputStr TerminusDB server URL or a valid TerminusDB Id or omitted\n\nConnectionConfig.prototype.setSchemaURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseSchemaURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setDocument = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDocumentURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tif (parser.dbid()) this.dbid = parser.dbid();\n\t\tif (parser.docid()) this.docid = parser.docid();\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setQueryURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseQueryURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setClassFrameURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseClassFrameURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nmodule.exports = ConnectionConfig;\n","/*\n11.75s$ npm install\n6.39s$ npm test\n*/\n/*\n * Helper class for parsing and decomposing Terminus URLs /\n * and dealing with namespace prefixed URLs\n */\n// const URL = require('url').URL;\n\n/*\n\"@context\": {\n    \"owl\":\"http://www.w3.org/2002/07/owl#\",\n    \"rdf\":\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\n    \"xsd\":\"http://www.w3.org/2001/XMLSchema#\"\n  } */\n\n\nfunction IDParser(context) {\n\tthis.context = context;\n\tthis.server_url = false;\n\tthis.db = false;\n\tthis.doc = false;\n}\n\nIDParser.prototype.server = function () {\n\treturn this.server_url;\n};\n\nIDParser.prototype.dbid = function () {\n\treturn this.db;\n};\n\nIDParser.prototype.docid = function () {\n\treturn this.doc;\n};\n\nIDParser.prototype.setContext = function (context) {\n\tthis.context = context;\n};\n\nIDParser.prototype.parseServerURL = function (str) {\n\tthis.server_url = false;\n\n\tif (this.validURL(str)) {\n\t\tthis.server_url = str;\n\t} else if (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tthis.server_url = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.server_url && this.server_url.lastIndexOf('/') !== this.server_url.length - 1\n\t) {\n\t\tthis.server_url += '/';\n\t}\n\treturn this.server_url;\n};\n\nIDParser.prototype.parseDBID = function (str) {\n\tthis.db = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tif (str.lastIndexOf('/') === str.length - 1) {\n\t\t\t// trim trailing slash\n\t\t\tstr = str.substring(0, str.length - 1);\n\t\t}\n\t\tconst index = str.lastIndexOf('/');\n\n\t\tconst serverURL = str.substring(0, index);\n\t\t// only dbNamer\n\t\tstr = str.substring(index + 1);\n\n\t\tif (this.parseServerURL(serverURL) === false) return false;\n\t}\n\n\tif (this.validIDString(str)) {\n\t\tthis.db = str;\n\t}\n\treturn this.db;\n};\n\nIDParser.prototype.parseDocumentURL = function (str) {\n\tthis.doc = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.validURL(str)) {\n\t\tlet dbURL = str;\n\t\tif (str.lastIndexOf('/document/') !== -1) {\n\t\t\t// get dbURL\n\t\t\tdbURL = str.substring(0, str.lastIndexOf('/document/'));\n\t\t\tstr = str.substring(str.lastIndexOf('/document/') + 10);\n\t\t}\n\t\tif (this.parseDBID(dbURL) === false) return false;\n\t}\n\tif (str.substring(0, 4) === 'doc:') str = str.substring(4);\n\t// check if the document's name hasn't space or '/'\n\tif (this.validIDString(str)) {\n\t\tthis.doc = str;\n\t}\n\treturn this.doc;\n};\n\nIDParser.prototype.parseSchemaURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'schema');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.parseQueryURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'woql');\n\t\tstr = this.stripOptionalPath(str, 'query');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.stripOptionalPath = function (str, bit) {\n\tif (str.indexOf(`/${bit}`) !== -1) str = str.substring(0, str.indexOf(`/${bit}`));\n\treturn str;\n};\n\nIDParser.prototype.parseClassFrameURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'frame');\n\t}\n\treturn this.parseDBID(str);\n};\n\n// Valid URLs are those that start with http:// or https://\nIDParser.prototype.validURL = function (str) {\n\tif (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://') return true;\n\treturn false;\n};\n\nIDParser.prototype.validPrefixedURL = function (str, context) {\n\tif (typeof str !== 'string' || typeof context !== 'object') return false;\n\tconst parts = str.split(':');\n\tif (parts.length !== 2) return false;\n\tif (parts[0].length < 1 || parts[1].length < 1) return false;\n\tif (context && context[parts[0]] && this.validIDString(parts[1])) return true;\n\treturn false;\n};\n\nIDParser.prototype.validIDString = function (str) {\n\tif (typeof str !== 'string') return false;\n\tif (str.indexOf(':') !== -1 || str.indexOf(' ') !== -1 || str.indexOf('/') !== -1) return false;\n\treturn true;\n};\n\nIDParser.prototype.expandPrefixed = function (str, context) {\n\tconst parts = str.split(':');\n\treturn context[parts[0]] + parts[1];\n};\n\nmodule.exports = IDParser;\n","/**\r\n * FramePatternMatcher does pattern matching on frames\r\n * Does a given pattern match a given frame?\r\n */\r\nconst FramePatternMatcher = {};\r\n\r\n/**\r\n * Runs an array of matching rules across a frame and calls the passed onmatch function on each match\r\n * The optional onmatch function is called with each hit and is passed the frame and the rule that hit it.\r\n * A list of the matched rules is returned.\r\n *\r\n */\r\nFramePatternMatcher.testRules = function(rules, frame, onmatch){\r\n\tvar matched_rules = [];\r\n\tif(rules && rules.length){\r\n\t\tfor(var i = 0; i<rules.length; i++){\r\n\t\t\tvar match = (!rules[i].pattern || FramePatternMatcher.patternMatchesFrame(rules[i].pattern, frame));\r\n\t\t\tif(match){\r\n\t\t\t\tmatched_rules.push(rules[i]);\r\n\t\t\t\tif(onmatch && typeof onmatch == \"function\"){\r\n\t\t\t\t\tonmatch(frame, rules[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn matched_rules;\r\n};\r\n\r\n/**\r\n * Determines whether a given pattern matches a given frame\r\n */\r\nFramePatternMatcher.patternMatchesFrame = function (pattern, frame) {\r\n\tif (typeof pattern === 'object' && pattern.length) { // multiple patterns are ANDed\r\n\t\tfor (let i = 0; i < pattern.length; i++) {\r\n\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\tif (!fp.checkFrame(frame)) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tvar fp = new FramePattern(pattern);\r\n\treturn fp.checkFrame(frame);\r\n};\r\n\r\n\r\n/**\r\n * A frame pattern can have the following variables\r\n * renderer : object, property, data, * - matches a specific part of the frame\r\n * label : matches the label of a property\r\n * frame_type: object, data, document, oneOf\r\n * subject: id of the subject\r\n * subjectClass: class of the subject\r\n * range: type of a property (applies to property and data)\r\n * property: property id or list of property ids (parent property if it is an object or data)\r\n * value: value of the property\r\n * parent: a pattern relating to the parent of this frame\r\n * children: patterns for matching on the children of a frame\r\n * depth: how deep are we in the document? starts from 0\r\n * index: the index of a value in an array\r\n * status: updated, error, new, ok,\r\n */\r\n\r\nFramePattern = function (pattern) {\r\n\tif (pattern) {\r\n\t\tthis.setPattern(pattern);\r\n\t}\r\n};\r\n\r\nFramePattern.prototype.setPattern = function(pattern){\r\n\tthis.scope = (pattern.scope ? pattern.scope: false);\r\n\tthis.label = (pattern.label ? pattern.label : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif (pattern.children) {\r\n\t\tfor (let i = 0; i < pattern.children.length; i++) {\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth !== 'undefined' ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\r\n}\r\n\r\nFramePattern.prototype.checkFrame = function(frame){\r\n\tvar rtype = this.getRendererType(frame);\r\n\tif(!rtype) return false;\r\n\tif(this.scope && (this.scope != rtype) && (this.scope != \"*\" )) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, frame)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, frame)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, frame)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, frame)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, frame)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, frame)) return false;\r\n\tif(this.range && !this.checkRange(rtype, frame)) return false;\r\n\tif(this.value && !this.checkValue(rtype, frame)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, frame)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, frame)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, frame)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, frame)) return false;\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.illegalRuleType = function (rtype) {\r\n\t// data frames have no children\r\n\tif (rtype == 'data' && this.children.length) return true;\r\n\t// object frames have no range\r\n\tif (rtype == 'object' && this.range) return true;\r\n\treturn false;\r\n};\r\n\r\n/* subject is an id or an array of ids,\r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function (subject, frame) {\r\n\tif (typeof this.subject !== 'object' || !this.subject.length) this.subject = [this.subject];\r\n\tconst rsubj = frame.subject();\r\n\tfor (let i = 0; i < this.subject.length; i++) {\r\n\t\tif (this.IDsMatch(subject[i], rsubj)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function (rtype, frame) {\r\n\tfor (let i = 0; i < this.children.length; i++) {\r\n\t\tlet found = false;\r\n\t\tif (rtype == 'object') {\r\n\t\t\tfor (const prop in frame.properties) {\r\n\t\t\t\tif (this.children[i].checkFrame(frame.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (rtype == 'property') {\r\n\t\t\tfor (let j = 0; j <= renderer.values.length; j++) {\r\n\t\t\t\tif (this.children[j].checkFrame(frame.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!found) return false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.checkStatus = function (rtype, frame) {\r\n\tif (typeof this.status !== 'object' || this.status.length == 0) this.status = [this.status];\r\n\tfor (let i = 0; i < this.status.length; i++) {\r\n\t\tif (this.status[i] == 'updated' && !frame.isUpdated()) return false;\r\n\t\tif (this.status[i] == 'new' && !frame.isNew()) return false;\r\n\t\tif (this.status[i] == 'unchanged' && frame.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.checkDepth = function (rtype, frame) {\r\n\treturn this.numberMatch(this.depth, frame.depth());\r\n};\r\n\r\nFramePattern.prototype.checkParent = function (rtype, frame) {\r\n\treturn this.parent.checkFrame(frame.parent);\r\n};\r\n\r\nFramePattern.prototype.checkIndex = function (rtype, frame) {\r\n\tif (rtype == 'data') {\r\n\t\treturn this.index == frame.index;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkProperty = function (rtype, frame) {\r\n\tif (typeof this.property !== 'object' || !this.property.length) this.property = [this.property];\r\n\tfor (let i = 0; i < this.property.length; i++) {\r\n\t\tif (this.propertyIDsMatch(frame.property(), this.property[i])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function (rtype, frame) {\r\n\tif (typeof this.value !== 'object' || !this.value.length) this.value = [this.value];\r\n\tfor (let i = 0; i < this.value.length; i++) {\r\n\t\tif (rtype == 'data') {\r\n\t\t\tif (this.valuesMatch(frame.value(), this.value[i])) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (rtype == 'property') {\r\n\t\t\tfor (let j = 0; j <= frame.values.length; j++) {\r\n\t\t\t\tif (this.getRendererType(frame.values[i]) == 'data'\r\n\t\t\t\t\t\t&& this.valuesMatch(frame.values[i].get(), this.value[i])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (rtype == 'object') {\r\n\t\t\tfor (const prop in frame.properties) {\r\n\t\t\t\tif (this.checkValue(this.getRendererType(frame.properties[prop]), frame.properties[prop])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkRange = function (rtype, frame) {\r\n\tif (typeof this.range !== 'object' || !this.range.length) this.range = [this.range];\r\n\tfor (let i = 0; i < this.range.length; i++) {\r\n\t\tif (this.rangeIDsMatch(frame.range(), this.range[i])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkSubjectClass = function (rtype, frame) {\r\n\tif (typeof this.subjectClass !== 'object' || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tconst rcls = frame.subjectClass();\r\n\tfor (let i = 0; i < this.subjectClass.length; i++) {\r\n\t\tif (this.classIDsMatch(this.subjectClass[i], rcls)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, frame) {\r\n\tif (rtype == 'object') return this.frame_type == 'object';\r\n\tif (rtype == 'data') {\r\n\t\tif (frame.frame) {\r\n\t\t\treturn this.frame_type == frame.frame.ftype();\r\n\t\t}\r\n\t}\r\n\tif (rtype == 'property') return false;\r\n};\r\n\r\nFramePattern.prototype.checkLabel = function (rtype, frame) {\r\n\tif (typeof frame.getLabel !== 'function') {\r\n\t\tconsole.log(new Error('Rule passed to check label with broken renderer object - no getLabel'));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, frame.getLabel());\r\n};\r\n\r\nFramePattern.prototype.IDsMatch = function (ida, idb) {\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n};\r\n\r\nFramePattern.prototype.classIDsMatch = function (ida, idb) {\r\n\treturn this.IDsMatch(ida, idb);\r\n};\r\nFramePattern.prototype.propertyIDsMatch = function (ida, idb) {\r\n\tconst match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n};\r\nFramePattern.prototype.rangeIDsMatch = function (ida, idb) {\r\n\treturn this.IDsMatch(ida, idb);\r\n};\r\nFramePattern.prototype.valuesMatch = function (vala, valb) {\r\n\treturn vala == valb;\r\n};\r\nFramePattern.prototype.numberMatch = function (vala, valb) {\r\n\tif (typeof vala === 'string') {\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t} catch (e) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n};\r\n\r\nFramePattern.prototype.stringMatch = function (vala, valb) {\r\n\tconst pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n};\r\n\r\nFramePattern.prototype.getRendererType = function (frame) {\r\n\tif (frame.isProperty()) return 'property';\r\n\tif (frame.isObject()) return 'object';\r\n\tif (frame.isData()) return 'data';\r\n\tif (frame.renderer_type) return frame.renderer_type;\r\n\tconsole.log(new Error(`frame configuration passed non-renderer type ${frame.constructor.name}`));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n};\r\n\r\nfunction FrameRule() {\r\n\tthis.rule = { pattern: {} };\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.scope = function(scope){\r\n\tthis.rule.pattern.scope = scope;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.renderer = function(rend){\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.render = function (func) {\r\n\tthis.rule.render = func;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.args = function (json) {\r\n\tthis.rule.args = json;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.compare = function (func) {\r\n\tthis.rule.compare = func;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.frame_type = function (...frametype) {\r\n\tthis.rule.pattern.frametype = frame_type;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.label = function (...label) {\r\n\tthis.rule.pattern.label = label;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.subject = function (...subject) {\r\n\tthis.rule.pattern.subject = subject;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.subjectClass = function (...subjectClass) {\r\n\tthis.rule.pattern.subjectClass = subjectClass;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.property = function (...property) {\r\n\tthis.rule.pattern.property = property;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.depth = function (depth) {\r\n\tthis.rule.pattern.depth = depth;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.range = function (...range) {\r\n\tthis.rule.pattern.range = range;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.value = function (...value) {\r\n\tthis.rule.pattern.value = value;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.pattern = function () {\r\n\treturn this.rule.pattern;\r\n};\r\n\r\nFrameRule.prototype.json = function () {\r\n\treturn this.rule;\r\n};\r\n\r\nFrameRule.prototype.parent = function (parent) {\r\n\tthis.rule.pattern.parent = parent.pattern();\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.children = function (...children) {\r\n\tif (typeof this.rule.pattern.children === 'undefined') {\r\n\t\tthis.rule.pattern.children = [];\r\n\t}\r\n\tfor (let i = 0; i < children.length; i++) {\r\n\t\tthis.rule.pattern.children.push(children[i].pattern());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.index = function (...index) {\r\n\tthis.rule.pattern.index = index;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.status = function (...status) {\r\n\tthis.rule.pattern.status = status;\r\n\treturn this;\r\n};\r\n\r\n\r\nmodule.exports = {FramePatternMatcher, FramePattern, FrameRule } ;\r\n","const WOQLQuery = require('./client/WOQLQuery');\r\nconst Renderers = require('./client/ObjectRenderer');\r\nconst HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\nconst TerminusDBViewer = require('./TerminusDB');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst UTILS=require('./Utils');\r\n\r\nfunction TerminusDocumentViewer(ui, action, options){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.db = this.ui.db();\r\n\tthis.init();\r\n\tthis.page_config = (options && options.page_config ? options.page_config : \"view\");\r\n\tthis.mode = (options && options.mode ? options.mode : \"view\");\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n\tthis.load_schema = (options && options.load_schema ? options.load_schema : true);\r\n\tthis.config_options = this.getBuiltInViewerOptions();\r\n\tthis.options = (options ? options : this.config_options[action]);\r\n\tthis.action = action;\r\n\tthis.document = false;\r\n\tthis.dbViewer = new TerminusDBViewer.TerminusDBViewer(this.ui);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.init = function(){\r\n\tconst tbv = new TerminusDBViewer.TerminusDBViewer(this.ui);\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getClassMetaDataQuery();\r\n\tvar self = this;\r\n\tself.classmeta = {};\r\n\tself.instancemeta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar cls = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", wresult.bindings[i]);\r\n\t\t\t\tif(cls && typeof self.classmeta[cls] == \"undefined\"){\r\n\t\t\t\t\tself.classmeta[cls] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getJsonLdViewer = function(){\r\n\tswitch(this.page_config){\r\n\t\tcase 'view':\r\n\t\t\tvar self = this;\r\n\t\t\tthis.ui.client.getDocument()\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t    TerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n\t\t\t\tvar label = response['@id']; // get doc id\r\n\t\t\t\tvar header = document.createElement('div');\r\n\t\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t\t\theader.appendChild(document.createTextNode('jsonld format of ' + label));\r\n\t\t\t\tself.pagedom.appendChild(header);\r\n\t\t\t    var res = document.createElement('pre');\r\n\t\t\t\tself.document_json_response = response;\r\n\t\t\t\tres.innerHTML = JSON.stringify(response, undefined, 2);\r\n\t\t\t    res.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\t\tUTILS.stylizeCodeDisplay(self.ui, res, self.pagedom, 'javascript');\r\n\t\t\t})\r\n\t\t\t.catch(function(e){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tthrow(e);\r\n\t\t\t});\r\n\t\tbreak;\r\n\t\tcase 'create':\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\t\tvar header = document.createElement('div');\r\n\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t \tvar ohv = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t\t\theader.appendChild(ohv.getObjectIDDOM(this.renderer));\r\n\t\t\t//header.appendChild(document.createTextNode('Create new document in jsonld format'));\r\n\t\t\theader.appendChild(this.getDocumentJsonldCreateButton());\r\n\t\t\tthis.pagedom.appendChild(header);\r\n\t\t\tvar res = document.createElement('textarea');\r\n\t\t\tthis.json_editor = res;\r\n\t\t\tthis.pagedom.appendChild(res);\r\n\t\t\tres.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\tUTILS.stylizeEditor(this.ui, res, 'doc-json-create', 'javascript');\r\n\t\t\tbreak;\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getEncodingChooserDOM = function() {\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group\");\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar enc = document.createElement('select');\r\n\tenc.setAttribute('class', 'terminus-doc-config terminus-enc');\r\n\tvar oframe = document.createElement('option');\r\n\toframe.setAttribute('value', 'frame');\r\n\toframe.appendChild(document.createTextNode('HTML'));\r\n\tenc.appendChild(oframe);\r\n\tvar ojson = document.createElement('option');\r\n\tojson.setAttribute('value', 'jsonld');\r\n\tojson.appendChild(document.createTextNode('JSON-LD'));\r\n\tenc.appendChild(ojson);\r\n\tnbuts.appendChild(enc);\r\n\tvar self = this;\r\n\tenc.addEventListener('change', function(e){\r\n\t\tself.viewMode = this.value;\r\n\t\tswitch(self.page_config){\r\n\t\t\tcase 'view':\r\n\t\t\t\tself.page_config = 'view';\r\n\t\t\t\tif(this.value == 'frame'){\r\n\t\t\t\t\tself.renderer = false;\r\n\t\t\t\t\tself.refreshPage();\r\n\t\t\t\t}\r\n\t\t\t\telse self.getJsonLdViewer();\r\n\t\t\tbreak;\r\n\t\t\tcase 'create':\r\n\t\t\t\tself.page_config = 'create';\r\n\t\t\t\tif(this.value == 'frame'){\r\n\t\t\t\t\tself.renderer = false;\r\n\t\t\t\t\tself.refreshPage();\r\n\t\t\t\t}\r\n\t\t\t\telse self.getJsonLdViewer();\r\n\t\t\tbreak;\r\n\t\t}\r\n\t})\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(nbuts);\r\n\tscd.appendChild(ccDOM);\r\n\treturn scd;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentChooserDOM = function(holder){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-get-doc terminus-document-chooser terminus-form-horizontal terminus-control-group\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-doc-control-label terminus-control-label-padding\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID to view.\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.setAttribute('title', 'Enter Document ID to view');\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('class', 'fa fa-check');\r\n\tnbut.appendChild(i);\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) {\r\n\t\t\tself.ui.showDocument(dcip.value);\r\n\t\t}\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\tholder.appendChild(scd);\r\n};\r\n\r\nTerminusDocumentViewer.prototype.getDocumentCreatorSelect = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\treturn tcdom;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-create-doc terminus-document-creator terminus-form-horizontal terminus-control-group\");\r\n\t// get dropdown with list of types\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\t// get input type\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('title', 'Input which document type to create');\r\n\ti.setAttribute('class', 'fa fa-check');\r\n\tnbut.appendChild(i);\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tccDOM.setAttribute(\"class\", \"create-document-list terminus-display-flex\");\r\n\tccDOM.appendChild(this.getDocumentCreatorSelect());\r\n\t//ccDOM.appendChild(tcdom);\r\n\tccDOM.appendChild(dcip);\r\n\tccDOM.appendChild(nbut);\r\n\tccDOM.appendChild(this.getEncodingChooserDOM());\r\n\tscd.appendChild(ccDOM);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDocumentViewer.prototype.getDocumentJsonldCreateButton = function(){\r\n\tvar cr = document.createElement('button');\r\n\tcr.innerHTML = 'Save';\r\n\tcr.setAttribute('class', 'terminus-btn terminus-btn-float-right');\r\n\tvar self = this;\r\n\tcr.addEventListener('click', function(){\r\n\t\tif (!UTILS.checkForMandatoryId()) return;\r\n\t\tself.ui.showBusy();\r\n\t\tself.createDocument(self.renderer.idDOM.value, JSON.parse(self.json_editor.value))\r\n\t\t.then(function(page_config){\r\n\t\t\tif(page_config == 'home'){\r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n\t\t\t\tself.getListOfDocuments(self.pagedom);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tself.page_config = \"view\";\r\n\t\t\t\tself.mode = self.page_config;\r\n\t\t\t\tself.renderer = false;\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t})\r\n\treturn cr;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentJsonldSaveButton = function(){\r\n\tvar sv = document.createElement('button');\r\n\tsv.innerHTML = 'Save';\r\n\tsv.setAttribute('class', 'terminus-btn terminus-btn-float-right');\r\n\tvar self = this;\r\n\tsv.addEventListener('click', function(){\r\n\t\tself.ui.showBusy();\r\n\t\tself.updateDocument(JSON.parse(self.json_editor.value))\r\n\t\t.then(function(){\r\n\t\t\tself.page_config = \"view\";\r\n\t\t\tself.renderer = false;\r\n\t\t\tself.refreshPage();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t})\r\n\treturn sv;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.toggleControlActions = function(button){\r\n\tvar enc = document.getElementsByClassName('terminus-enc');\r\n\tif(button.innerHTML === 'Edit'){\r\n\t\tif(enc.length > 0) enc[0].style.display = 'none';\r\n\t\tbutton.innerHTML = 'Cancel';\r\n\t\tif(this.viewMode == 'frame'){\r\n\t\t\tthis.page_config = \"edit\";\r\n\t\t\tthis.renderer = false;\r\n\t\t\tthis.refreshPage();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\t\tvar label = this.document_json_response['@id']; // get doc id\r\n\t\t\tvar header = document.createElement('div');\r\n\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t\theader.appendChild(document.createTextNode('Edit ' + label + ' in jsonld format'));\r\n\t\t\theader.appendChild(this.getDocumentJsonldSaveButton());\r\n\t\t\tthis.pagedom.appendChild(header);\r\n\t\t\tvar res = document.createElement('textarea');\r\n\t\t\tthis.json_editor = res;\r\n\t\t\tthis.pagedom.appendChild(res);\r\n\t\t\tres.appendChild(document.createTextNode(JSON.stringify(this.document_json_response, undefined, 2)));\r\n\t\t\tres.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\tUTILS.stylizeEditor(this.ui, res, 'doc-json', 'javascript');\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tbutton.innerHTML = 'Edit';\r\n\t\tif(enc.length > 0) enc[0].style.display = 'block';\r\n\t\tif(this.viewMode == 'frame'){\r\n\t\t\tthis.page_config = \"view\";\r\n\t\t\tthis.renderer = false;\r\n\t\t\tthis.refreshPage();\r\n\t\t}\r\n\t\telse{ //jsonld\r\n\t\t\tthis.getJsonLdViewer();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getListOfDocuments = function(holder){\r\n\tvar lod = document.createElement('div');\r\n\tlod.setAttribute('class', 'terminus-list-of-doc');\r\n\tlod.appendChild(UTILS.getHeaderDom('List of Documents'))\r\n\tholder.appendChild(lod);\r\n\tthis.dbViewer.getClassesDOM(holder);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentEditControls = function(holder, doc){\r\n\tvar sp = document.createElement('span');\r\n\tsp.setAttribute('class', 'terminus-document-page-controls');\r\n\tholder.appendChild(sp);\r\n    sp.appendChild(this.getEncodingChooserDOM());\r\n\tvar dpc = document.createElement('button');\r\n\tdpc.setAttribute('class', 'terminus-btn terminus-document-config');\r\n\tdpc.innerHTML = 'Edit';\r\n\tsp.appendChild(dpc);\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"click\", function(){\r\n\t\tself.toggleControlActions(dpc);\r\n\t})\r\n }\r\n\r\nTerminusDocumentViewer.prototype.getDocumentSubMenus = function(feature, ul, holder, active){\r\n \tvar a = document.createElement('a');\r\n     a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n \tvar self = this;\r\n \tswitch(feature){\r\n \t\tcase 'get_document':\r\n \t\t\ta.appendChild(document.createTextNode('View Document'));\r\n \t\t\t// set selected nav after redrawMainPage and home page\r\n \t\t\tif(active) a.classList.add('terminus-submenu-selected');\r\n \t\t\tif((this.page_config == 'view') || (this.page_config == 'home')){ // hide in create mode\r\n \t\t\t\tvar sp = document.createElement('span');\r\n \t\t\t\tsp.setAttribute('class', 'terminus-display-flex');\r\n \t\t\t\tholder.appendChild(sp);\r\n \t\t\t\tthis.getDocumentChooserDOM(sp);\r\n \t\t\t\tthis.viewMode = 'frame';\r\n \t\t\t}\r\n \t\t\tif(this.page_config == 'view') this.getDocumentEditControls(sp);\r\n \t\t\ta.addEventListener('click', function(){\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(self.controldom);\r\n \t\t\t\tself.page_config = 'home';\r\n \t\t\t\tself.loadDocumentHome();\r\n \t\t\t});\r\n \t\tbreak;\r\n \t\tcase 'create_document':\r\n \t\t\ta.appendChild(document.createTextNode('Create Document'));\r\n \t\t    if(active) a.classList.add('terminus-submenu-selected');\r\n \t\t    holder.appendChild(self.getDocumentCreatorDOM());\r\n \t\t\ta.addEventListener('click', function(){\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(holder);\r\n \t\t\t\tUTILS.setSelectedSubMenu(this);\r\n \t\t\t\tholder.appendChild(self.getDocumentCreatorDOM());\r\n \t\t\t});\r\n \t\tbreak;\r\n \t\tdefault:\r\n \t\t\tconsole.log('Invalid features in TerminusDocument');\r\n \t\tbreak;\r\n \t} // switch(feature)\r\n \tul.appendChild(a);\r\n }\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentHome = function(){\r\n \tvar self = this;\r\n \tvar ul = document.createElement('ul');\r\n \tul.setAttribute('class','terminus-ul-horizontal');\r\n \tthis.controldom.appendChild(ul);\r\n \tvar holder = document.createElement('div');\r\n \tholder.setAttribute('class', 'terminus-doc-holder');\r\n \tthis.controldom.appendChild(holder);\r\n \tvar controls = document.createElement('span');\r\n \tcontrols.setAttribute('class', 'terminus-display-flex');\r\n \tholder.appendChild(controls);\r\n \tswitch(this.page_config){\r\n \t\tcase 'view':\r\n \t\t\tif(this.ui.showControl(\"get_document\"))\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, true);\r\n \t\t\tcontrols.appendChild(this.getDocumentCreatorSelect());\r\n \t\tbreak;\r\n \t\tcase 'create':\r\n \t\t\tif(this.ui.showControl(\"create_document\")){\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, false);\r\n \t\t\t\tthis.getDocumentSubMenus('create_document', ul, holder, true);\r\n \t\t\t}\r\n \t\tbreak;\r\n \t\tcase 'home':\r\n \t\t\tif(this.ui.showControl(\"get_document\"))\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, true);\r\n \t\t    var sd = document.createElement('div');\r\n \t\t\tsd.setAttribute('class', 'terminus-class-chooser-align');\r\n \t\t\tcontrols.appendChild(sd);\r\n \t\t\tsd.appendChild(this.getDocumentCreatorSelect());\r\n \t\t\tthis.getListOfDocuments(holder);\r\n \t\tbreak;\r\n \t\tcase 'default':\r\n \t\t\tconsole.log('Invalid page config passed in TerminusDocument.js');\r\n \t\tbreak;\r\n \t}\r\n }\r\n\r\nTerminusDocumentViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-document-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-document-viewer\");\r\n\tthis.loadDocumentHome();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getInstanceMeta = function(elid){\r\n\tvar self = this;\r\n\tif(self.instancemeta && typeof self.instancemeta[elid] != \"undefined\") return self.instancemeta[elid] ;\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getInstanceMeta(elid);\r\n\treturn wq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tvar res = wresult.bindings[0];\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn false;\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getClassMeta = function(cls){\r\n\tif(typeof this.classmeta[cls]){\r\n\t\treturn this.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadCreateDocument = function(url){\r\n\tif(url){\r\n\t\tthis.ui.showBusy(\"Fetching frame for document class \" + url);\r\n\t\tvar self = this;\r\n\t\tthis.mode = \"edit\";\r\n\t\tthis.page_config = \"create\";\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1) {\r\n\t\t\turl = \"schema:\" + url;\r\n\t\t}\r\n\t\treturn this.loadDocumentSchema(url)\r\n\t\t.then(function(response){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.setLabel();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\tthis.page_config = \"view\";\r\n\turl = url.replace(\"/candidate\", \"/platform/document\");\r\n\tthis.ui.showBusy(\"Loading Document from \" + url);\r\n\treturn this.ui.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.loadDataFrames(response);\r\n\t\tself.setLabel();\r\n\t\tself.refreshPage();\r\n\t\tif(self.load_schema){\r\n\t\t\tself.loadDocumentSchema(self.document.cls).then(function(){ self.refreshPage()}).catch(function(e){console.error(e)});\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error) {\r\n\t\tconsole.error(error);\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.ui.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\tself.loadSchemaFrames(response, cls);\r\n\t\tself.refreshPage();\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.deleteDocument = function(URL){\r\n\tthis.document = false;\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Deleting Document \" + URL);\r\n\treturn this.ui.client.deleteDocument(URL)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.createDocument = function(id, extr){\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Creating document\");\r\n\treturn this.ui.client.createDocument(id, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(id);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t\tself.page_config = 'home';\r\n\t\treturn self.page_config;\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.updateDocument = function(extr){\r\n\tvar durl = this.document.subjid;\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Updating document \" + durl);\r\n\treturn this.ui.client.updateDocument(durl, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(durl);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.page_config){\r\n\t\t\tthis.options = this.getOptionsFromPageConfig(this.page_config);\r\n\t\t}\r\n\t\ttry{\r\n\t\t\tthis.renderer = new Renderers.ObjectRenderer(this.document, false, this.options);\r\n\t\t\tthis.renderer.mode = this.mode;\r\n\t\t\tthis.renderer.controller = this;\r\n\t\t}catch(e){\r\n\t \t\tconsole.error('TerminusDocumentViewer render',e.toString())\r\n\t \t}\r\n\t}\r\n\tif(this.renderer){\r\n\t\treturn this.renderer.render();\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getBuiltInViewerOptions = function(){\r\n\treturn FrameConfig;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getOptionsFromPageConfig = function(pageconf){\r\n\tif(typeof this.config_options[pageconf] == \"object\") {\r\n\t\treturn this.config_options[pageconf];\r\n\t}\r\n\treturn this.options;\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.getClient = function(){\r\n\treturn this.ui.client;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.extract = function(options){\r\n\treturn this.renderer.extract();\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getLabel = function(){\r\n\tvar lab = (this.cls ? this.cls : false);\r\n\tif(!lab) lab = (this.docid ? this.docid : \"Void\");\r\n\treturn lab;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.setLabel = function(){\r\n\tif(this.document && this.labdom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.labdom);\r\n\t\tvar dfs = this.document.getDataFrames(TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\"));\r\n\t\tfor(var i = 0; i< dfs.length; i++){\r\n\t\t\tvar lab = dfs[i].get();\r\n\t\t\tif(lab) {\r\n\t\t\t\tthis.labdom.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.refreshPage = function(){\r\n\tif(this.pagedom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\tvar rends = this.render();\r\n\t\tif(rends){\r\n\t\t\tthis.pagedom.appendChild(rends);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentPageControls = function(){\r\n\tvar dpc = document.createElement(\"select\");\r\n\tdpc.setAttribute(\"class\", \"terminus-form-select terminus-document-config\");\r\n\tfor(var i in this.config_options){\r\n\t\tif(i === 'create') continue; // create docuemnt option from config is not taken in edit mode\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = i;\r\n\t\tif(this.page_config == i){\r\n\t\t\topt.selected = true;\r\n\t\t}\r\n\t\topt.appendChild(document.createTextNode(this.config_options[i].label));\r\n\t\tdpc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"change\", function(){\r\n\t\tself.page_config = this.value;\r\n\t\tself.renderer = false;\r\n\t\tself.refreshPage();\r\n\t})\r\n\treturn dpc;\r\n}\r\n\r\nmodule.exports=TerminusDocumentViewer\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst Datatables = require('../plugins/datatables.terminus');\r\nconst UTILS=require('../Utils');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLResult(res, query, options, ui){\r\n\tthis.ui = ui;\r\n\tthis.query = query;\r\n\tthis.bindings = ((res && res.bindings) ? res.bindings : []);\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.shorten = function(url){\r\n\treturn this.query.shorten(url);\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\tif(result) return (result.bindings && result.bindings.length);\r\n\telse return (this.bindings && this.bindings.length);\r\n}\r\n\r\n\r\nfunction WOQLResultsViewer(ui, wresult, woqlResult, options, settings, queryPage){\r\n\tthis.ui = ui;\r\n\tthis.result = wresult;\r\n\tthis.woqlResult = woqlResult;\r\n\tthis.max_cell_size = 400;\r\n\tthis.max_word_size = 60;\r\n\tthis.options = options;\r\n\tthis.qPage = queryPage;\r\n\t//this.wqlRes = new WOQLResult();\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.settings = settings;\r\n}\r\n\r\nWOQLResultsViewer.prototype.showTable = function(){\r\n\tif(this.options && typeof this.options.show_table != \"undefined\") return this.options.show_table;\r\n\treturn true;\r\n}\r\n\r\nWOQLResultsViewer.prototype.orderColumns = function(sample){\r\n\tvar ordered = [];\r\n\tfor(var h in sample){\r\n\t\tif(ordered.indexOf(h) == -1){\r\n\t\t\tordered.unshift(h);\r\n\t\t}\r\n\t}\r\n\treturn ordered;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getAsDOM = function(resultDOM, displayResultHeader){\r\n\tvar rs = document.createElement('div');\r\n\tresultDOM.appendChild(rs);\r\n\r\n\tif(displayResultHeader){\r\n\t\tvar rh = document.createElement('div');\r\n\t\trh.setAttribute(\"class\", \"terminus-margin-top-bottom terminus-module-head\");\r\n\t\trh.appendChild(document.createTextNode(\"Results\"));\r\n\t\trs.appendChild(rh);\r\n\t}\r\n\tif(this.result && this.woqlResult.hasBindings(this.result) && this.showTable()){\r\n\t\tthis.getTableDOM(this.result.bindings, rs);\r\n\t\treturn rs;\r\n\t}\r\n\telse {\r\n\t\tnor = document.createElement('div');\r\n\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\trs.appendChild(nor);\r\n\t\treturn rs;\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableDOM = function(bindings, resultDOM){\r\n\tif(this.pman.pluginAvailable(\"datatables\")){\r\n\t\tvar dtResult = this.getTable(bindings, true, {});\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\tvar dt = new Datatables.Datatables(this, this.qPage);\r\n\t\tdt.draw(dtResult, resultDOM);\r\n\t\tresultDOM.classList.add('terminus-expandable');\r\n\t\tresultDOM.classList.add('terminus-dt-result-cont');\r\n\t\treturn tab;\r\n    }\r\n\telse {\r\n\t\tvar tab = this.getTable(bindings, false, {});\r\n\t\tresultDOM.appendChild(tab);\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDtTableDOMOnChange = function(bindings, resultDOM, pageInfo){\r\n\t\tvar dtResult = this.getTable(bindings, true, pageInfo);\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.formatResultsForDatatableDisplay = function(bindings, pageInfo){\r\n    var columns = [], colDataData = {}, data = [], formattedResult = {}, arr = [];\r\n\tvar dtResult = {};\r\n    var ordered_headings = this.orderColumns(bindings[0]);\r\n\t// get columns\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[i]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n        columns.push({data: clab});\r\n\t}\r\n\t// get data for respective columns\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tcolDataData = {};\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\r\n\t\t\t\tvar wrap = document.createElement(\"p\");\r\n\t\t\t\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(wrap, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t\tlab = wrap.innerText;\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\t//var lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tvar lab = bindings[i][ordered_headings[j]];\r\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\t\telse if(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\t\tvar a = document.createElement(\"a\");\r\n\t\t\t\t\ta.setAttribute(\"title\", lab);\r\n\t\t\t\t\ta.setAttribute(\"href\", '#');\r\n\t\t\t\t\ta.appendChild(document.createTextNode(lab));\r\n\t\t\t\t\tlab = a.outerHTML;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[j]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[j]) : ordered_headings[j];\r\n\t\t\tcolDataData[clab] = lab;\r\n\t\t}\r\n\t\tdata.push(colDataData);\r\n\t}\r\n\tdtResult.columns                = columns;\r\n\tformattedResult.data            = data;\r\n\tformattedResult.recordsTotal    = 65;\r\n\tformattedResult.recordsFiltered = 65;\r\n\tformattedResult.draw \t\t\t= pageInfo.draw;\r\n\tdtResult.data \t\t\t\t\t= formattedResult;\r\n\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableBody = function(bindings, ordered_headings){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar self = this;\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tvar tr = document.createElement(\"tr\");\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tvar td = document.createElement(\"td\");\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\t//var lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tvar lab = bindings[i][ordered_headings[j]];\r\n\t\t\t}\r\n\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\tvar a = this.getDocumentLocalLink(lab);\r\n\t\t\t\ttd.appendChild(a);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(td, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t}\r\n\t\t\ttr.appendChild(td);\r\n\t\t}\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nWOQLResultsViewer.prototype.selectDocumentNavBar = function(ui) {\r\n\tUTILS.removeSelectedNavClass(\"terminus-selected\");\r\n\tvar dnav = document.getElementsByClassName('terminus-document-nav');\r\n\tdnav[0].classList.add(\"terminus-selected\");\r\n\tUTILS.displayDocumentSubMenus(ui);\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDocumentLocalLink = function(lab){\r\n\tvar a = document.createElement(\"a\");\r\n\ta.setAttribute(\"title\", lab);\r\n\ta.setAttribute(\"href\", '#');\r\n\tvar self = this;\r\n\ta.addEventListener(\"click\", function(){\r\n\t\tif(self.result.ui) {\r\n\t\t\tself.result.ui.showDocument(this.title);\r\n\t\t\t//self.result.ui.redraw();\r\n\t\t\tself.selectDocumentNavBar(self.ui);\r\n\t\t}\r\n\t});\r\n\ta.appendChild(document.createTextNode(lab));\r\n\treturn a;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTable = function(bindings, dtPlugin, pageInfo){\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar ordered_headings = this.orderColumns(bindings[0]);\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar th = document.createElement(\"th\");\r\n\t\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\t\tvar clab = (ordered_headings[i].indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n\t\tth.appendChild(document.createTextNode(clab));\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\ttab.appendChild(thead);\r\n\tif(dtPlugin){\r\n\t\tvar tbody = document.createElement(\"tbody\");\r\n\t\ttab.appendChild(tbody);\r\n\t\tvar dtResult ={};\r\n\t\tdtResult.result = this.formatResultsForDatatableDisplay(bindings, pageInfo);\r\n\t\tdtResult.tab = tab;\r\n\t\treturn dtResult;\r\n\t}\r\n\telse {\r\n\t\tvar tbody = this.getTableBody(bindings, ordered_headings);\r\n\t\ttab.appendChild(tbody);\r\n\t\treturn tab;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports={WOQLResultsViewer, WOQLResult}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst UTILS= require('../Utils')\r\n\r\n/*** client side processing ***/\r\nfunction CspDatatables(ui){\r\n    this.ui = ui;\r\n}\r\n\r\nCspDatatables.prototype.convertToDatatable = function(tab){\r\n    var dt = this;\r\n    var table = jQuery(tab).DataTable({\r\n         searching : false,\r\n         pageLength: 25,\r\n         lengthMenu: [10, 25, 50, 75, 100],\r\n         paging    : true,\r\n         select    : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\r\n         createdRow: function(row) {\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());}\r\n    }); //jQuery(tab)\r\n\r\n    // on click of row connect to db, on click of 5th column delete db\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).index().column == 5){\r\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\r\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\r\n            dt.ui.deleteDatabase(dbId);\r\n            return;\r\n        }\r\n        else dt.ui.showDBMainPage();\r\n     }); // on click\r\n\r\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '0');\r\n    tab.setAttribute('border'     , '0');\r\n    return tab;\r\n}\r\n\r\nCspDatatables.prototype.draw = function(dtResult){\r\n    return(this.convertToDatatable(dtResult));\r\n}\r\n\r\n/*** server side processing ***/\r\nfunction Datatables(wResViewer, qPage){\r\n   this.wrViewer = wResViewer;\r\n   this.wQuery = wResViewer.wQuery;\r\n   this.ui = wResViewer.ui;\r\n   this.qPage = qPage;\r\n   this.currDTSettings = wResViewer.settings;\r\n}\r\n\r\n/*\r\n    query: new woqlquery with current pagination changes\r\n    pageInfo: current drawCallBack page change info\r\n    resultDOM: result dom on veiwer page\r\n*/\r\nDatatables.prototype.executeQuery = function(qObj, pageInfo, resultDOM){\r\n    var self = this;\r\n    // return this.wQuery.execute(query)\r\n    return qObj.execute(this.ui.client)\r\n    .then(function(result){\r\n      var dtResult = {};\r\n      var wqRes = new TerminusClient.WOQLResult(result, qObj);\r\n      dtResult = self.wrViewer.formatResultsForDatatableDisplay(result.bindings, pageInfo)\r\n      return dtResult.data;\r\n    })\r\n    .catch(function(err){\r\n      console.error(err);\r\n      self.ui.showError(err);\r\n    });\r\n}\r\n\r\n/* get query string based on datatable pagination and current query */\r\n/*Datatables.prototype.getQueryOnPagination = function(wq, settings){\r\n    switch(settings.query){\r\n        case 'Show_All_Documents':\r\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Data':\r\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Schema_Elements':\r\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Classes':\r\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\r\n            return wq.getClassMetaDataQuery(sqp);\r\n        break;\r\n        case 'Show_All_Properties':\r\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Classes':\r\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Data_Class':\r\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Property_Class':\r\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Info_by_Id':\r\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Document_classes':\r\n            return wq.getClassesQuery(settings.pageLength, settings.start);\r\n        break;\r\n        default:\r\n            console.log('Invalid woql option passed');\r\n        break;\r\n\r\n    }\r\n}   */\r\n/*\r\n    pageInfo: current drawCallBack page change info\r\n*/\r\nDatatables.prototype.generateNewQueryOnPageChange = function(pageInfo){\r\n    if(this.qPage) UTILS.deleteStylizedEditor(this.ui, pageInfo.qTextDom);\r\n    var qObj = UTILS.getCurrentWoqlQueryObject(null, pageInfo);\r\n    //var query = this.getQueryOnPagination(this.wQuery, pageInfo)\r\n    if(this.qPage) {\r\n        if(pageInfo.queryMode.value == 'woql')\r\n            pageInfo.qTextDom.value = JSON.stringify(qObj.prettyPrint(), undefined, 2);\r\n        else pageInfo.qTextDom.value = JSON.stringify(qObj, undefined, 2);\r\n        UTILS.stylizeEditor(this.ui, pageInfo.qTextDom, 'query', 'javascript');\r\n    }\r\n    //return query;\r\n    return qObj;\r\n}\r\n\r\n/*\r\n    dt: Datatable reference\r\n    len : current number of records to display\r\n*/\r\nDatatables.prototype.getCallbackSettings = function(dt, dtAPIChangeSettings){\r\n    var pageInfo = {};\r\n    pageInfo.pageLength  = dtAPIChangeSettings._iDisplayLength;\r\n    pageInfo.start       = dtAPIChangeSettings._iDisplayStart;\r\n    pageInfo.draw        = dtAPIChangeSettings.iDraw;\r\n    pageInfo.qTextDom    = dt.qTextDom;\r\n    pageInfo.queryMode   = dt.queryMode;\r\n    if(this.qPage) pageInfo.query = dt.query;\r\n    else pageInfo.query = 'Show_All_Document_classes';\r\n    pageInfo.chosenValue = dt.chosenValue;\r\n    return pageInfo;\r\n}\r\n\r\n/*\r\n    tab: datatable table dom\r\n    settings : settings from woql txt generator\r\n    resultDOM: result dom of viewer\r\n*/\r\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\r\n    // delete previous datatable\r\n    TerminusClient.FrameHelper.removeChildren(this.dtdom);\r\n    this.dtdom = document.createElement('div');\r\n    this.dtdom.appendChild(tab);\r\n    resultDOM.appendChild(this.dtdom);\r\n    // saving query text box dom to change limit value on change of datatable page length\r\n    this.qTextDom = settings.qTextDom;\r\n    this.query = settings.query;\r\n    this.chosenValue = settings.chosenValue;\r\n    this.queryMode = settings.queryMode;\r\n}\r\n\r\n// update datatables settings so it can be reused in WOQLTextboxGenerator to re write query in woql/ jsonld\r\nDatatables.prototype.updateCurrDTSettings = function(pageInfo){\r\n    this.currDTSettings.pageLength = pageInfo.pageLength;\r\n    this.currDTSettings.start      = pageInfo.start;\r\n}\r\n\r\nDatatables.prototype.getNewDataOnChange = function(drawnTab, aSettings, resultDOM){\r\n    var pageInfo = this.getCallbackSettings(this, aSettings);\r\n    this.updateCurrDTSettings(pageInfo);\r\n   // var query = this.generateNewQueryOnPageChange(pageInfo);\r\n    var qObj = this.generateNewQueryOnPageChange(pageInfo);\r\n    return this.executeQuery(qObj, pageInfo, resultDOM);\r\n    //return this.executeQuery(query, pageInfo, resultDOM);\r\n    //return  dtResult.result.data;\r\n}\r\n\r\nDatatables.prototype.getDataFromServer = function(dtResult, resultDOM){\r\n    var dt = this;\r\n    var tab = dtResult.tab;\r\n    this.setUp(tab, this.wrViewer.settings, resultDOM);\r\n    // initialize datatables\r\n    var table = jQuery(tab).DataTable({\r\n         searching   : false,\r\n         pageLength  : dt.wrViewer.settings.pageLength,\r\n         serverSide  : true,\r\n         processing  : true,\r\n         lengthMenu  : [25, 50, 75, 100],\r\n         dom         : 'RBlftip',\r\n         columns     : dtResult.result.columns,\r\n         paging      : true,\r\n         select      : true,\r\n         autoWidth   : true,\r\n         ajax        : function (data, callback, settings) {\r\n                            if(Object.entries(dtResult.result.data).length > 0){\r\n                                // first draw is loaded\r\n                                var res = dtResult.result.data;\r\n                                dtResult.result.data = {};\r\n                                callback(res);\r\n                            }\r\n                            else{\r\n                                dt.getNewDataOnChange(this, settings, resultDOM)\r\n                                    .then(function(result){\r\n                                     callback(result);\r\n                                })\r\n                            }\r\n                       },\r\n         buttons     : [{ extend: 'copy', text: 'Copy to clipboard' },\r\n                        { extend: 'excel', text: 'Export to Excel' }],\r\n         columnDefs  : [{ targets:'_all',\r\n                          className:\"truncate\"}],\r\n         createdRow  : function(row){\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());},\r\n         scrollX     : true\r\n    }); //jQuery(tab)\r\n\r\n    // on click of doc\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).data){\r\n            if(this.innerText.substring(0, 4) == \"doc:\"){\r\n                if(dt.wrViewer.result.ui) {\r\n        \t\t\tdt.wrViewer.result.ui.showDocument(this.innerText);\r\n        \t\t\tdt.wrViewer.result.ui.redraw();\r\n        \t\t\tdt.wrViewer.selectDocumentNavBar(dt.ui);\r\n        \t\t}\r\n            }\r\n        }\r\n     }); // on click\r\n\r\n    //styling\r\n    tab.setAttribute('class'      , 'stripe dataTable');\r\n    tab.setAttribute('style'      , 'margin: 0!important');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '1');\r\n    tab.setAttribute('border'     , '0');\r\n\r\n    return tab;\r\n}\r\n\r\n/*\r\nserverside: true or false\r\n*/\r\nDatatables.prototype.draw = function(dtResult, resultDOM){\r\n    return(this.getDataFromServer(dtResult, resultDOM));\r\n}\r\n\r\nmodule.exports={Datatables, CspDatatables}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLStringEditor(options){\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.options = options; \r\n}\r\n\r\nHTMLStringEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar big = ((this.options && typeof this.options.big != \"undefined\") ? this.options.big : this.isBigType(this.type, value));\r\n\tif(big){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\r\n\t}\r\n\telse {\r\n\t\tvar size = ((this.options && typeof this.options.size != \"undefined\") ? this.options.size : this.getTypeSize(this.type, value));\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.setAttribute('type', \"text\");\r\n\t\tinput.setAttribute('size', size);\r\n\t}\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute(\"data-value\", value);\r\n\t\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"input\", function(){\r\n\t\tframe.set(this.value);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nHTMLStringEditor.prototype.isBigType = function(ty, value){\r\n\tif(value && value.length && value.length > 100) return true;\r\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\r\n\tif(longs.indexOf(ty) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\r\n\tif(value && value.length && value.length > 40) return 80;\r\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\r\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \r\n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \r\n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\r\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\r\n\tif(bigs.indexOf(ty) != -1) return 80;\r\n\tif(smalls.indexOf(ty) != -1) return 16;\r\n\tif(tinys.indexOf(ty) != -1) return 8;\r\n\treturn 32;\r\n}\r\n\r\nmodule.exports={HTMLStringEditor}\r\n\r\n\r\n","function HTMLBooleanViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-boolean \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLBooleanViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\t\r\n}\r\n\r\nHTMLBooleanViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tif(value){\r\n\t\tvar vallab = document.createTextNode(value);\r\n\t\tinput.appendChild(vallab);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\n\r\nmodule.exports={HTMLBooleanViewer}\r\n\r\n","function HTMLBooleanEditor(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute('type', \"checkbox\");\r\n\tif(value){\r\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\r\n\t}\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tif(value){\r\n\t\t\tframe.set(\"\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tframe.set(\"true\");\r\n\t\t}\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLChoiceViewer(options){};\r\n\r\nHTMLChoiceViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tif(frame.frame && frame.frame.elements){\r\n\t\tthis.elements = frame.frame.elements;\r\n\t}\r\n\treturn this.render(value);\r\n}\r\n\r\nHTMLChoiceViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLChoiceViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tvar lab = false;\r\n\tif(value && this.elements){\r\n\t\tfor(var i = 0; i<this.elements.length; i++){\r\n\t\t\tvar elt = this.elements[i];\r\n\t\t\tif(elt.class == value){\r\n\t\t\t\tif(elt.label && elt.label[\"@value\"]){\r\n\t\t\t\t\tlab = elt.label[\"@value\"];\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\tif(value && !lab){\r\n\t\tlab = TerminusClient.FrameHelper.labelFromURL(value);\t\t\t\t\t\r\n\t}\r\n\tif(lab){\r\n\t\tinput.appendChild(document.createTextNode(lab));\t\t\r\n\t}\r\n\treturn input\r\n}\r\n\r\nmodule.exports={HTMLChoiceViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLChoiceEditor(options){};\r\n\r\nHTMLChoiceEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar optInput = document.createElement(\"select\");\r\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\r\n\tvar foptions = frame.getChoiceOptions();\r\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\r\n\tvar callback = function(val){\r\n\t\tframe.set(val);\r\n\t}\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\r\n\treturn sel;\r\n}\r\n\r\nmodule.exports={HTMLChoiceEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLCoordinateViewer(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.parseValue = function(value){\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t\tif(parsed && this.type == \"xdd:coordinate\"){\r\n\t\t\tparsed = [parsed];\r\n\t\t}\r\n\t\treturn parsed;\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = this.type + \" value \" + value + \" failed to parse as json\", e.toString();\r\n\t\treturn [];\r\n\t}\r\n}\r\n\r\n\r\nHTMLCoordinateViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.render = function(value){ \r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tif(value){\r\n\t\tinput.setAttribute('data-value', value);\t\t\r\n\t\tvar parsed = this.parseValue(value);\r\n\t\tif(parsed){\r\n\t\t\tfor(var i = 0; i < parsed.length; i++){\r\n\t\t\t\tvar lldom = document.createElement(\"span\");\r\n\t\t\t\tlldom.setAttribute(\"class\", \"latlong\");\r\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" \" + \" \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" \" ));\r\n\t\t\t\tinput.appendChild(lldom);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinput.setAttribute(\"title\", this.error);\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateViewer}\r\n\r\n","function HTMLCoordinateEditor(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\r\n\tvar latdom = document.createElement(\"input\");\r\n\tlatdom.setAttribute(\"type\", \"text\");\r\n\tlatdom.value = lat;\r\n\tvar longdom = document.createElement(\"input\");\r\n\tlongdom.setAttribute(\"type\", \"text\");\r\n\tlongdom.value = long;\r\n\tlatdom.addEventListener(\"change\", change);\r\n\tlongdom.addEventListener(\"change\", change);\r\n\treturn [latdom, longdom];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\r\n\tvar lldom = document.createElement(\"span\");\r\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\r\n\tvar firstcol = document.createElement(\"span\");\r\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\r\n\tlldom.appendChild(firstcol);\r\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\r\n\t\tvar delbut = document.createElement(\"button\");\r\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\r\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\r\n\t\tdelbut.addEventListener(\"click\", function(){\r\n\t\t\tlong.value = \"\";\r\n\t\t\tlat.value = \"\";\r\n\t\t\tparent.removeChild(lldom);\r\n\t\t});\r\n\t\tfirstcol.appendChild(delbut);\r\n\t}\r\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\tlldom.appendChild(lat);\r\n\tlldom.appendChild(document.createTextNode(\" \" + \" \"));\r\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\r\n\tlldom.appendChild(long);\r\n\tlldom.appendChild(document.createTextNode(\"  \" ));\r\n\treturn lldom;\r\n}\r\n\r\n\r\nHTMLCoordinateEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = this.type + \" failed to parse as json\", e.toString();\r\n\t\tvar parsed = false;\r\n\t}\r\n\tvar self = this;\r\n\tvar updateValueFromForm = function(){\r\n\t\tvar vals = [];\r\n\t\tfor(var i = 0; i<self.inputs.length; i++){\r\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\r\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\r\n\t\t\t\tvals.push(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(vals.length == 0){\r\n\t\t\tframe.set(\"\");\r\n\t\t}\r\n\t\telse if(this.type == \"xdd:coordinate\"){\r\n\t\t\tframe.set(vals[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar op = \"[\";\r\n\t\t\tfor(var i = 0; i<vals.length; i++){\r\n\t\t\t\top += vals[i];\r\n\t\t\t\tif(i+1 < vals.length) op += \",\";\r\n\t\t\t}\r\n\t\t\top += \"]\";\r\n\t\t\tframe.set(op);\r\n\t\t}\r\n\t};\r\n\tif(!parsed){\r\n\t\tif(this.type == \"xdd:coordinate\") parsed = [\"\",\"\"];\r\n\t\telse {\r\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\r\n\t\t\tif(this.type == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\r\n\t\t}\r\n\t}\r\n\tif(this.type == \"xdd:coordinate\"){\r\n\t\tparsed = [parsed];\r\n\t}\r\n\tfor(var i = 0; i < parsed.length; i++){\r\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\r\n\t}\r\n\tvar lldoms = document.createElement(\"span\");\r\n\tfor(var i = 0; i < this.inputs.length; i++){\r\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], this.type, i, lldoms);\r\n\t\tlldoms.appendChild(lldom);\r\n\t}\r\n\tinput.appendChild(lldoms);\r\n\tvar self = this;\r\n\tif(this.type != \"xdd:coordinate\"){\r\n\t\tvar butspan = document.createElement(\"span\");\r\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\r\n\t\tvar addbut = document.createElement(\"button\");\r\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\r\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\r\n\t\taddbut.addEventListener(\"click\", function(){\r\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\r\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], this.type, self.inputs.length, lldoms);\r\n\t\t\tlldoms.appendChild(lldom);\r\n\t\t\tself.inputs.push(ipdoms);\r\n\t\t});\r\n\t\tbutspan.appendChild(addbut);\r\n\t\tinput.appendChild(butspan);\t\t\t\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateViewer(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLDateViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLDateViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar parsed = TerminusClient.FrameHelper.parseDate(this.type, value);\r\n\t\tvar datepart = this.getDateComponentDOM(parsed);\r\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\r\n\t\tif(timepart) input.appendChild(timepart);\r\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\t\tif(datepart) input.appendChild(datepart);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\r\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\r\n\tif(hdom){\r\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\r\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\r\n\t}\r\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\r\n\t\tvar mlab = (parsed.minute < 10 ? parsed.minute : parsed.minute);\r\n\t\tmdom.appendChild(document.createTextNode(mlab));\r\n\t}\r\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(sdom){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\r\n\t\tvar slab = (parsed.second < 10 ? parsed.second : parsed.second);\r\n\t\tsdom.appendChild(document.createTextNode(slab));\r\n\t}\r\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\r\n\tif(tz){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\r\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\r\n\t}\r\n\tif(hdom || mdom || sdom || tz){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\r\n\t\tif(hdom) dadom.appendChild(hdom); \r\n\t\tif(mdom) {\r\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(sdom) {\r\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t}\r\n\t\tif(tz){\r\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\r\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\r\n\tif(ydom){\r\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\r\n\t\tydom.appendChild(document.createTextNode(parsed.year));\r\n\t}\r\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\r\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\r\n\t}\r\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\r\n\tif(ddom){\r\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\r\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\r\n\t}\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateViewer}","function HTMLDateHelper(){\r\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n}\r\n\r\nHTMLDateHelper.prototype.getMonthName = function(num){\r\n\treturn this.months[num-1];\r\n}\r\n\r\nmodule.exports={HTMLDateHelper}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateEditor(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tthis.parsed = TerminusClient.FrameHelper.parseDate(this.type, value);\r\n\t}\r\n\telse this.parsed = {};\r\n\tvar datepart = this.getDateComponentDOM(this.parsed, this.type, frame);\r\n\tvar timepart = this.getTimeComponentDOM(this.parsed, this.type, frame);\r\n\tif(timepart) input.appendChild(timepart);\r\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\tif(datepart) input.appendChild(datepart);\r\n\treturn input;\r\n}\r\n\r\nHTMLDateEditor.prototype.set = function(part, val, frame, ty){\r\n\tthis.parsed[part] = val;\r\n\tvar xsd = TerminusClient.FrameHelper.xsdFromParsed(this.parsed, ty);\r\n\tif(xsd){\r\n\t\tframe.set(xsd);\r\n\t}\r\n}\r\n\r\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, frame){\r\n\tif([\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:time\"].indexOf(ty) == -1){\r\n\t\treturn false;\r\n\t}\r\n\tvar self = this;\r\n\tvar hdom = document.createElement(\"input\");\r\n\thdom.setAttribute(\"class\", \"terminus-hour-input terminus-hour-\"+ty);\r\n\thdom.setAttribute(\"size\", 2);\r\n\thdom.setAttribute(\"placeholder\", \"HH\");\r\n\thdom.value = (parsed.hour ? parsed.hour : \"\");\r\n\thdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"hour\", this.value, frame, ty);\r\n\t});\r\n\tvar mdom = document.createElement(\"input\");\r\n\tmdom.setAttribute(\"class\", \"terminus-minute-input terminus-minute-\"+ty);\r\n\tmdom.setAttribute(\"size\", 2);\r\n\tmdom.setAttribute(\"placeholder\", \"MM\");\r\n\tmdom.value = (parsed.minute ? parsed.minute: \"\");\r\n\tmdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"minute\", this.value, frame, ty);\r\n\t});\r\n\tvar sdom = document.createElement(\"input\");\r\n\tsdom.setAttribute(\"class\", \"terminus-second-input terminus-second-\"+ty);\r\n\tsdom.setAttribute(\"size\", 8);\r\n\tsdom.setAttribute(\"placeholder\", \"SS.sss...\");\r\n\tsdom.value = (parsed.second ? parsed.second: \"\");\r\n\tsdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"second\", this.value, frame, ty);\r\n\t})\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.appendChild(hdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(mdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(sdom);\r\n\treturn tdom;\r\n}\r\n\r\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, frame){\r\n\tvar self = this;\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\r\n\t\tvar ydom = document.createElement(\"input\");\r\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\r\n\t\tydom.setAttribute(\"size\", 6);\r\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\r\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\r\n\t\tydom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"year\", this.value, frame, ty);\r\n\t\t})\r\n\t}\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar mdom = document.createElement(\"select\");\r\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\r\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\r\n\t\t\tvar opdom = document.createElement(\"option\");\r\n\t\t\topdom.value = i+1;\r\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\r\n\t\t\tif(parsed.month && parsed.month == i+1){\r\n\t\t\t\topdom.selected = true;\r\n\t\t\t}\r\n\t\t\tmdom.appendChild(opdom);\r\n\t\t}\r\n\t\tmdom.addEventListener(\"change\", function(){\r\n\t\t\tself.set(\"month\", this.value, frame, ty);\r\n\t\t})\r\n\t}\t\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar ddom = document.createElement(\"input\");\r\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\r\n\t\tddom.setAttribute(\"size\", 2);\r\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\r\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\r\n\t\tddom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"day\", this.value, frame, ty);\r\n\t\t})\r\n\t}\t\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateEditor}","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLEntityViewer(options){\r\n\tthis.onclick = false;\r\n}\r\n\r\nHTMLEntityViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\t//this.client = dataviewer.getClient();\r\n\treturn this.render(frame.get());\t\r\n}\r\n\r\nHTMLEntityViewer.prototype.renderValue = function(dataviewer){\r\n\t//this.client = dataviewer.getClient();\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLEntityViewer.prototype.render = function(value){\r\n\t//var value = TerminusClient.FrameHelper.unshorten(value);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tvar self = this;\r\n\tif(this.holder){\r\n\t\treturn this.holder;\r\n\t}\r\n\tif(value){\r\n\t\tvar dom = this.showValue(value)\r\n\t\tholder.appendChild(dom);\r\n\t}\r\n\treturn holder;\r\n}\r\n\r\nHTMLEntityViewer.prototype.showValue = function(value){\r\n\treturn document.createTextNode(value);\r\n}\r\n\r\n\r\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, frame, dataviewer){\r\n\tvar span = document.createElement(\"span\");\r\n\tvar self = this;\r\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\r\n\tspan.appendChild(dataviewer.internalLink(value));\r\n\tif(controller = renderer.getController()){\r\n\t\tcontroller.getInstanceMeta(value).then(function(response){\r\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\r\n\t\t\tif(lab){ \r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\t\tspan.appendChild(lab);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\r\n\tvar nspan = document.createElement(\"span\");\r\n\tif(response && (il = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceLabel\", response))){\r\n\t\tnspan.appendChild(dv.internalLink(url, il));\r\n\t\tvar rt = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceType\", response);\r\n\t\tvar tit = url + \" Type: \" + rt;\r\n\t\tvar ic = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceComment\", response);\r\n\t\tif(typeof ic == \"object\" && ic[\"@value\"]){\r\n\t\t\ttit += \" \" + ic[\"@value\"];\r\n\t\t}\r\n\t\tnspan.setAttribute(\"title\", tit);\r\n\t\treturn nspan;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\r\nHTMLEntityEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tinput.setAttribute(\"type\", \"text\");\r\n\tinput.setAttribute('size', 80);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tvar url = this.value;\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\r\n\t\t\turl = \"doc:\" + url;\r\n\t\t}\r\n\t\tframe.set(url);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLEntityEditor}","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageViewer(options){}\r\n\r\nHTMLImageViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLImageViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLImageViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar img = document.createElement(\"a\");\r\n\t\timg.setAttribute('src', value);\r\n\t\tinput.appendChild(img);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLImageViewer}\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageEditor(options){}\r\nHTMLImageEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tif(this.type == \"xsd:base64Binary\"){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\r\n\t\tinput.value = value;\r\n\t\tinput.addEventListener(\"change\", function(){\r\n\t\t\tframe.set(this.value);\r\n\t\t});\r\n\t\treturn input;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLLinkViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLLinkViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLLinkViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('size', 80);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar a = document.createElement(\"a\");\r\n\t\ta.setAttribute('href', value);\r\n\t\ta.appendChild(document.createTextNode(value));\r\n\t\tinput.appendChild(a);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLLinkViewer}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLNumberViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n}\r\n\r\nHTMLNumberViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLNumberViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLNumberViewer.prototype.render = function(value){\r\n\tif(value === 0) value = \"0\";\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(value) : value);\r\n\tinput.appendChild(document.createTextNode(value));\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLNumberViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLRangeViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLRangeViewer.prototype.render = function(value){\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\r\n\tvar x = (this.useCommas() ? TerminusClient.FrameHelper.numberWithCommas(vals[0]) : vals[0]);\r\n\tvar tnode = document.createTextNode(x);\r\n\trvals.appendChild(tnode);\r\n\td.appendChild(rvals);\t\r\n\tif(vals.length == 2){\r\n\t\td.appendChild(getRangeSymbolDOM());\r\n\t\tvar x2 = (this.useCommas(renderer) ? TerminusClient.FrameHelper.numberWithCommas(vals[1]) : vals[1]);\r\n\t\tvar t2node = document.createTextNode(x2);\r\n\t\tsvals.appendChild(t2node);\r\n\t\td.appendChild(svals);\t\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nHTMLRangeViewer.prototype.useCommas = function(){\r\n\tif([\"xdd:gYearRange\", \"xdd:dateRange\"].indexOf(this.type) != -1) return false;\r\n\treturn this.commas;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeEditor(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\r\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\r\n\tvar firstip = document.createElement(\"input\");\r\n\tfirstip.setAttribute('type', \"text\");\r\n\tfirstip.setAttribute('size', 16);\r\n\tif(data1){\r\n\t\tfirstip.value = data1;\r\n\t}\r\n\tvar secondip = document.createElement(\"input\");\r\n\tsecondip.setAttribute('type', \"text\");\r\n\tsecondip.setAttribute('size', 16);\r\n\tif(data2){\r\n\t\tthis.showing_range = true;\r\n\t\tsecondip.value = data2;\r\n\t}\r\n\trvals.appendChild(firstip);\r\n\td.appendChild(rvals);\t\r\n\tif(this.showing_range){\r\n\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\tsvals.appendChild(secondip);\r\n\t}\r\n\td.appendChild(svals);\t\r\n\tvar but = document.createElement(\"button\");\r\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\r\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\tbut.appendChild(document.createTextNode(txt));\r\n\td.appendChild(but);\t\r\n\tvar self = this;\r\n\tbut.addEventListener(\"click\", function(){\r\n\t\tif(self.showing_range){\r\n\t\t\tself.showing_range = false;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(svals);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showing_range = true;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\t\tsvals.appendChild(secondip);\r\n\t\t}\r\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\t\tbut.innerText = txt;\r\n\t\tchangeHandler();\r\n\t});\r\n\tvar changeHandler = function(){\r\n\t\tif(self.showing_range && secondip.value){\r\n\t\t\tif(firstip.value) frame.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\r\n\t\t\telse frame.set(secondip.value);\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tframe.set(firstip.value);\r\n\t\t}\r\n\t}\r\n\tfirstip.addEventListener(\"change\", changeHandler);\r\n\tsecondip.addEventListener(\"change\", changeHandler);\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeEditor}\r\n","function SantizedHTMLViewer(options){\r\n\tthis.css = ((options && options.css) ? \"literal-value \" + options.css : \"literal-value\");\r\n}\r\n\r\nSantizedHTMLViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tinput.innerHTML = value;\r\n\treturn input;\r\n}\r\n\r\nSantizedHTMLViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\treturn this.render(value);\r\n}\r\n\r\nSantizedHTMLViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nmodule.exports={SantizedHTMLViewer}\r\n","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction GoogleMapEditor(options){}\r\n\r\nGoogleMapEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar mapcontainer = document.createElement(\"div\");\r\n\tmapcontainer.setAttribute('class', \"gmap-window gmap-editor\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tvar map = ghelper.initMap(mapcontainer, value, this.type);\r\n    if(ty == \"xdd:coordinate\"){\r\n\t    google.maps.event.addListener(map, 'click', function(event) {\r\n\t    \tvar position = event.latLng;\r\n\t    \tvar coo = \"[\" + position.lat() + \",\" + position.lng() + \"]\";\r\n\t    \trenderer.set(coo);\r\n\t        ghelper.clearMarkers();\r\n\t        var init = {\r\n\t    \t\tposition: position, \r\n\t    \t\tmap: map\r\n\t    \t}\r\n\t    \tvar marker = new google.maps.Marker(init);\r\n\t    \tghelper.markers.push(marker);\r\n\t  \t});\r\n\t}\r\n    else {\r\n    \tgoogle.maps.event.addListener(map, 'click', function(event) {\r\n        \tvar path = ghelper.polyline.getPath();\r\n        \tpath.push(event.latLng);\r\n      \t    var position = event.latLng;\r\n      \t    ghelper.addMarker(position, map, frame, '#' + path.getLength(), this.type);\r\n      \t});\r\n    }\r\n    return mapcontainer;\r\n}\r\n\r\nmodule.exports={GoogleMapEditor};","function GoogleMapHelper(options){\r\n\tthis.polygon = false;\r\n\tthis.polyline = false;\r\n\tthis.markers = [];\r\n\tthis.init(options);\r\n}\r\n\r\nGoogleMapHelper.prototype.init = function(config){\r\n\tthis.type = ((config && config.type) ? config.type: 'Shape'); \r\n\tthis.width = ((config && config.width) ? config.width : '400px'); \r\n\tthis.height = ((config && config.height ) ? config.height : '400px'); \r\n\tthis.mapLat = ((config && config.mapLat) ? config.mapLat : '41.9010004'); \r\n\tthis.mapLong = ((config && config.mapLong ) ? config.mapLong : '12.500061500000015');\r\n\tthis.zoom = ((config && config.zoom) ? config.zoom : 3);\r\n\tthis.stroke = ((config && config.stroke) ? config.stroke : { color: '#FF0000', opacity: 0.3, weight: 3});\r\n\tthis.fill = ((config && config.fill) ? config.fill : { color: '#FF0000', opacity: 0.1});\r\n\tthis.line = ((config && config.line) ? config.line : { color: '#000000', opacity: 0.9, weight: 3});\r\n}\r\n\r\nGoogleMapHelper.prototype.destroy = function(){\r\n    this.clear();\r\n} \r\n\r\nGoogleMapHelper.prototype.translatePolygonToArray = function(polygon){\r\n   var data = \"[\";\r\n   var vertices = polygon.getPath();\r\n   var seenValue = false;\r\n   for (var j=0; j<vertices.getLength(); j++){\r\n       if(seenValue){\r\n           data = data + \",\";\r\n       }\r\n       var xy = vertices.getAt(j);\r\n       data = data + \"[\" + xy.lat() + \",\" + xy.lng() + \"]\"\r\n       seenValue = true;\r\n   }\r\n   data = data + \"]\";\r\n   return data;\r\n};\r\n\r\nGoogleMapHelper.prototype.translateArrayToPolygon = function(array){\r\n   var jsonified = JSON.parse(array);\r\n   var output = [];\r\n   for(var i=0;i<jsonified.length;i++){\r\n       var latlong = {}\r\n       latlong.lat = jsonified[i][0];\r\n       latlong.lng = jsonified[i][1];\r\n       output.push(latlong);\r\n   }\r\n   return output;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolygon = function(coords, map) {\r\n\tvar polygon = new google.maps.Polygon({\r\n        paths: coords,\r\n        strokeColor: this.stroke.color,\r\n        strokeOpacity: this.stroke.opacity,\r\n        strokeWeight: this.stroke.weight,\r\n        fillColor: this.fill.color,\r\n        fillOpacity: this.fill.opacity\r\n\t});\r\n    polygon.setMap(map);\r\n\treturn polygon;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolyline = function(coords){\r\n\tvar init = {\r\n\t      strokeColor: this.line.color,\r\n\t      strokeOpacity: this.line.opacity,\r\n\t      strokeWeight: this.line.weight\r\n\t};\r\n\tif(coords){\r\n\t\tinit.paths = coords;\r\n\t}\r\n\tvar poly = new google.maps.Polyline(init);\r\n\treturn poly;\r\n}\r\n\r\nGoogleMapHelper.prototype.clearMarkers = function() {\r\n\tfor (var i = 0; i < this.markers.length; i++ ) {\r\n\t\tthis.markers[i].setMap(null);\r\n\t}\r\n\tthis.markers.length = 0;\r\n}\r\n\r\n\r\nGoogleMapHelper.prototype.addMarker = function(position, map, frame, title, ty) {\r\n\tvar init = {\r\n\t\tposition: position, \r\n\t\tmap: map\r\n\t}\r\n\tif(title){\r\n\t\tinit.title = title;\r\n\t}\r\n\tvar marker = new google.maps.Marker(init);\r\n\tvar self = this;\r\n\tif(this.markers.length == 0 && ty == \"xdd:coordinatePolygon\"){\r\n     \tmarker.addListener('click', function() {\r\n\t\t\tvar coords = self.getCoordsFromMarkers();\r\n    \t\tself.polygon = self.createPolygon(coords, map);\r\n            self.clearMarkers();\r\n            self.polyline.setMap(null);\r\n            frame.set(self.translatePolygonToArray(self.polygon));\r\n        });                \t\r\n    }\r\n\tthis.markers.push(marker);\r\n\tif(ty == \"xdd:coordinatePolyline\"){\r\n\t\tvar x = this.translatePolygonToArray(this.polyline);\r\n\t\tframe.set(x);\r\n\t}\r\n\treturn marker;\r\n}\r\n\r\nGoogleMapHelper.prototype.getCoordsFromMarkers = function(){\r\n\treturn this.polyline.getPath();\r\n}\r\n\r\nGoogleMapHelper.prototype.clear = function(){\r\n\tif(this.polygon) {\r\n\t\tthis.polygon.setMap(null);\r\n\t\tthis.polygon = false;\r\n\t}\r\n\tif(this.polyline) {\r\n\t\tthis.clearMarkers();\r\n\t\tthis.polyline.setMap(null);\r\n\t}\r\n}\r\n\r\nGoogleMapHelper.prototype.initMap = function(mapContainer, value, type){\r\n\tmapContainer.style.width = this.width;\r\n\tmapContainer.style.height = this.height;\r\n\tif(typeof google == \"undefined\"){\r\n\t\talert(\"google is not effing loaded\");\r\n\t\treturn false;\r\n\t}\r\n\tvar map = new google.maps.Map(mapContainer, {\r\n\t    zoom: this.zoom,\r\n\t\tcenter: {lat: parseFloat(this.mapLat), lng: parseFloat(this.mapLong)}  \r\n\t});\r\n\tif(type == \"xdd:coordinatePolygon\"){\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t\tif(value){\r\n\t    \tthis.polygon = this.createPolygon(coords, map);\r\n\t    }\r\n\t}\r\n\telse if(type == \"xdd:coordinatePolyline\"){\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\t\t\r\n\t\tif(value){\r\n\t    \tthis.polyline.setPath(coords);\r\n\t    }\r\n\t}\t\r\n\telse if(type == \"xdd:coordinate\"){\r\n\t\tif(value){\r\n\t\t\tthis.clearMarkers();\r\n            var lat = parseFloat(value.substring(1, value.indexOf(\",\")));\r\n\t\t\tvar long = parseFloat(value.substring(value.indexOf(\",\")+1, value.length-1));\r\n            var init = {\r\n            \tposition: {lat: lat, lng: long},\r\n        \t\tmap: map\r\n\t        }\r\n\t        var marker = new google.maps.Marker(init);\r\n\t        this.markers.push(marker);\r\n\t\t}\r\n\t}\r\n    google.maps.event.trigger(map, 'resize');\r\n    return map;\r\n}\r\n\r\nmodule.exports=GoogleMapHelper;","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction GoogleMapViewer(options){}\r\n\r\nGoogleMapViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nGoogleMapViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nGoogleMapViewer.prototype.render = function(value){\r\n\tvar map = document.createElement(\"div\");\r\n\tmap.setAttribute('class', \"gmap-window gmap-viewer\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tghelper.initMap(map, value, this.type);\t\t\r\n    return map;\r\n}\r\n\r\nmodule.exports={GoogleMapViewer};","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLMarkupEditor(options){}\r\n\r\nHTMLMarkupEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"div\");\r\n\tinput.setAttribute('class', \"html-wysiwyg\");\r\n\tvar inner = document.createElement(\"span\");\r\n\tinner.setAttribute('class', \"html-literal literal-value\");\r\n\tinner.innerHTML=value;\r\n\tinput.appendChild(inner);\r\n\tif(typeof Quill != \"undefined\"){\r\n\t\tvar quill = new Quill(inner, { theme: 'snow' });\r\n\t\tquill.on(\"text-change\", function(){\r\n\t\t\tframe.set(quill.root.innerHTML);\r\n\t\t});\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLMarkupEditor}","function S2EntityEditor(options){}\r\n\r\nS2EntityEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar cls = frame.range();\r\n\tvar cback = frame.set;\r\n\tvar ctl = dataviewer.getClient();\r\n\tvar d2ch = new TerminusDocumentChooser(ctl, cls, value);\r\n\td2ch.change = function(val){\r\n\t\tframe.set(val);\r\n\t}\r\n\td2ch.view = \"label\";\r\n\tvar d2dom = d2ch.getAsDOM();\r\n\treturn d2dom;\r\n}\r\n\r\n\r\nmodule.exports={S2EntityEditor}","/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nconst WOQLResultsViewer = require('./client/WOQLResultsViewer');\r\nconst TerminusClassChooser = require('./client/TerminusClassChooser');\r\nconst TerminusDocumentChooser = require('./client/TerminusDocumentChooser');\r\nconst WOQLQuery=require('./client/WOQLQuery');\r\nconst UTILS=require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusHTMLViewer = require(\"./TerminusHTMLViewer\");\r\n\r\n/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nfunction TerminusDBController(ui){\r\n\t this.ui = ui;\r\n}\r\n\r\n/*\r\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\r\n */\r\nTerminusDBController.prototype.getAsDOM = function(){\r\n\tvar self = this;\r\n\tvar dbc = document.createElement(\"div\");\r\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\r\n\tif(this.ui && this.ui.db()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\r\n\t\tvar lab = document.createElement(\"span\");\r\n\t\tlab.setAttribute(\"class\", \"terminus-label terminus-db-label terminus-control-panel-label\");\r\n\t\tlab.appendChild(document.createTextNode(\"DB \"));\r\n\t\tvar val = document.createElement(\"span\");\r\n\t\tval.setAttribute(\"class\", \"terminus-value terminus-db-value terminus-control-panel-value\");\r\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\r\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\tval.appendChild(document.createTextNode(nm));\r\n\t\tscd.appendChild(lab);\r\n\t\tscd.appendChild(val);\r\n\t\t//dbc.appendChild(scd);\r\n\t\tvar nav = document.createElement('div');\r\n\t\tnav.setAttribute('class', 'span3');\r\n\t\tdbc.appendChild(nav);\r\n\t\tvar ul = document.createElement('ul');\r\n\t\tul.setAttribute('class','terminus-ul' );\r\n\t\tnav.appendChild(ul);\r\n\t\t// connected to db\r\n\t\tvar a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Database: ' + nm;\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n\t\tif(this.ui.showControl(\"db\")){\r\n\t\t\tvar item = this.getControlHTML(\"Database Home\", \"fa-home\");\r\n\t\t\titem.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDBMainPage();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t    }\r\n\t\tif(this.ui.showControl(\"delete_database\")){\r\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.deleteDatabase();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_select\")){\r\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showQueryPage();\r\n\t\t\t});\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_update\")){\r\n\t\t\tvar item = this.getControlHTML(\"Mapping\", \"fa-file-import\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showMappingPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showSchemaPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif((this.ui.showControl(\"get_document\") || this.ui.showControl(\"create_document\"))){\r\n\t\t\tvar item = this.getControlHTML(\"Document\", \"fa-book\");\r\n\t\t\titem.classList.add('terminus-document-nav');\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDocumentPage();\r\n\t\t\t\t//UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n                //this.classList.add(\"terminus-selected\");\r\n\t\t\t\t//UTILS.displayDocumentSubMenus(self.ui);\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\t/*if(this.ui.showControl(\"get_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-get-doc');\r\n\t\t\ta.appendChild(self.getDocumentChooserDOM());\r\n\t\t\ta.classList.add();\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"create_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-create-doc');\r\n\t\t\ta.appendChild(self.getDocumentCreatorDOM());\r\n\t\t\tul.appendChild(a);\r\n\t\t} */\r\n\t}\r\n\treturn dbc;\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\r\n    var self = this;\r\n    var a = document.createElement('a');\r\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(text);\r\n    a.appendChild(txt);\r\n    return a;\r\n}\r\n\r\nTerminusDBController.prototype.getDocumentChooserDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-chooser terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"ID \"));\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"View\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showDocument(dcip.value);\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDBController.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"Type \"));\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"Create\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\r\n\tvar gb = document.createElement('div');\r\n\tgb.setAttribute('class', 'terminus-doc-btn-group');\r\n\tvar bi = document.createElement('button');\r\n\tbi.setAttribute('class', 'terminus-doc-btn-selected terminus-doc-toggle-btn');\r\n\tbi.appendChild((document.createTextNode('D')));\r\n\tvar tds = document.createElement('span');\r\n\ttds.setAttribute('class', 'terminus-tooltiptext');\r\n\ttds.appendChild(document.createTextNode('Dropdown List'));\r\n\tbi.appendChild(tds);\r\n\tvar bt = document.createElement('button');\r\n\tbt.setAttribute('class', 'terminus-doc-toggle-btn');\r\n\tbt.appendChild((document.createTextNode('T')));\r\n\tvar tts = document.createElement('span');\r\n\ttts.setAttribute('class', 'terminus-tooltiptext');\r\n\ttts.appendChild(document.createTextNode('Text Input'));\r\n\tbt.appendChild(tts);\r\n\tgb.appendChild(bt);\r\n\tgb.appendChild(bi);\r\n\tvar nlabs = document.createElement(\"div\");\r\n\tnlabs.setAttribute('class', 'terminus-doc-btn-gp-align');\r\n\tnlabs.appendChild(gb);\r\n\tscd.appendChild(nlabs);\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tnlabs.appendChild(ccDOM);\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(tcdom);\r\n\tvar which = \"select\";\r\n\tbt.addEventListener(\"click\", function(){\r\n\t\t// create document of TerminusClient.FrameHelper.removeChildren(nlabs);\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(dcip);\r\n\t\tccDOM.appendChild(nbut);\r\n\t});\r\n\r\n\tbi.addEventListener(\"click\", function(){\r\n\t\t// create document from dropdown\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(tcdom);\r\n\t});\r\n\treturn scd;\r\n};\r\n\r\nfunction TerminusDBViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, ui);\r\n}\r\n\r\nTerminusDBViewer.prototype.getAsDOM = function(selected){\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-db-home-page\");\r\n\tvar sth = document.createElement('div');\r\n\tvar banner = document.createElement('div');\r\n\t//pd.appendChild(banner);\r\n\tbanner.setAttribute('class', 'terminus-banner');\r\n\tvar dhp = document.createElement(\"span\");\r\n\tdhp.setAttribute('class', 'terminus-home-heading');\r\n\tdhp.appendChild(document.createTextNode(\"DB Home Page - \"));\r\n\tsth.appendChild(dhp);\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-details\");\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-db-details-value \");\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec){\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\r\n\t\tscs.appendChild(document.createTextNode(nm));\r\n\t\tscs.setAttribute('class', 'terminus-home-heading');\r\n\t}\r\n\tscd.appendChild(scs);\r\n\tsth.appendChild(scd);\r\n\tbanner.appendChild(sth);\r\n\t//pd.appendChild(sth);\r\n\t//pd.appendChild(UTILS.getHeaderDom('Summary'));\r\n\tthis.getDeleteOnHomePage(pd);\r\n\t//this.getDBSummary(pd);\r\n\tvar lod = document.createElement('div');\r\n\tlod.setAttribute('class', 'terminus-list-of-doc');\r\n\tlod.appendChild(UTILS.getHeaderDom('List of Documents'))\r\n\tpd.appendChild(lod);\r\n\tthis.getClassesDOM(pd);\r\n\treturn pd;\r\n}\r\n\r\nTerminusDBViewer.prototype.getDbInfoBox = function(r, module){\r\n\tvar sp = document.createElement('span');\r\n    sp.setAttribute('class', 'terminus-db-info-box');\r\n\tvar info = document.createElement('div');\r\n\tinfo.appendChild(document.createTextNode(module.charAt(0).toUpperCase() + module.slice(1)));\r\n\tinfo.setAttribute('class', 'terminus-db-info');\r\n\tsp.appendChild(info);\r\n\r\n    var i = document.createElement('i');\r\n\tswitch(module){\r\n\t\tcase 'size':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-balance-scale');\r\n\t\t    var txt = document.createTextNode('2 Gb');\r\n\t\tbreak;\r\n\t\tcase 'created':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-calendar');\r\n\t\t    var txt = document.createTextNode('16 July 2015');\r\n\t\tbreak;\r\n\t\tcase 'modified':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-clock');\r\n\t\t    var txt = document.createTextNode('22 Dec 2019');\r\n\t\tbreak;\r\n\t}\r\n    sp.appendChild(i);\r\n\tif(txt) sp.appendChild(txt);\r\n    r.appendChild(sp);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDeleteOnHomePage = function(d){\r\n\t// delete database\r\n\tif(this.ui.db() == \"terminus\") return;\r\n    var del = document.createElement('button');\r\n    del.setAttribute('class', 'terminus-btn terminus-btn-float-right terminus-home-del');\r\n    del.setAttribute('type', 'button');\r\n    del.innerHTML = 'Delete Database';\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec)\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n    var self = this;\r\n    var dbdel = this.ui.db();\r\n\r\n    del.addEventListener(\"click\", function(){\r\n      \tvar deleteConfirm = confirm(`Do you want to delete ${dbdel} Database?`);\r\n\t\tif (deleteConfirm == true) {\r\n\t\t\tself.ui.deleteDatabase(dbdel);\r\n\t\t}\r\n    });\r\n    d.appendChild(del);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDBSummary = function(d){\r\n    var r = document.createElement('span');\r\n    r.setAttribute('class', 'terminus-db-info-box-display');\r\n    d.appendChild(r);\r\n\r\n    /* getDbInfoBox() calls can change according to further requirments */\r\n    this.getDbInfoBox(r, 'size');\r\n    this.getDbInfoBox(r, 'created');\r\n    this.getDbInfoBox(r, 'modified');\r\n}\r\n\r\nTerminusDBViewer.prototype.getDocumentTableConfig = function(nq){\r\n\tvar self = this;\r\n\tvar rowClick = function(row){\r\n\t\tself.ui.showDocument(row['v:ID']);\r\n\t};\r\n\tvar cellClick = function(key, value){\r\n\t\tself.ui.showDocument(value);\r\n\t}\r\n\r\n\tvar opts = {\r\n\t\t//cellClick: cellClick,\r\n\t\trowClick: rowClick,\r\n\t\t\"v:ID\": {\r\n\t\t\thidden: true\r\n\t\t},\r\n\t\t\"v:Class\": {hidden: true },\r\n\t\t\"v:Type_Comment\": {hidden: true },\r\n\t\t\"v:Label\": {\r\n\t\t\theader: \"Document\",\r\n\t\t\trenderer: function(dataviewer){\r\n\t\t\t\treturn dataviewer.annotateValue(dataviewer.value(),\r\n\t\t\t\t\t{ ID: dataviewer.binding('v:ID')});\r\n\t\t\t},\r\n\t\t},\r\n\t\t\"v:Type\": {\r\n\t\t\trenderer: function(dataviewer){\r\n\t\t\t\treturn dataviewer.annotateValue(dataviewer.value(),\r\n\t\t\t\t\t\t{ Class: dataviewer.binding('v:Class'), Description: dataviewer.binding('v:Type_Comment')}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"v:Comment\": {\theader: \"Description\", renderer: \"HTMLStringViewer\", args: {max_cell_size: 40, max_word_size: 10} },\r\n\t\t\"column_order\" : [\"v:Label\", \"v:Type\", \"v:Comment\"]\r\n\t}\r\n\t//return {};\r\n\treturn opts;\r\n}\r\n\r\n\r\n\r\nTerminusDBViewer.prototype.getClassesDOM = function(d){\r\n\t/*var q = TerminusClient.WOQL\r\n\t\t\t\t.limit(25)\r\n\t\t\t\t.start(0)\r\n\t\t\t\t.documentMetadata();*/\r\n\tvar self = this;\r\n\tvar rowClick = function(row){\r\n\t\tself.ui.showDocument(row['v:ID']);\r\n\t};\r\n\tvar cellClick = function(key, value){\r\n\t\tself.ui.showDocument(value);\r\n\t}\r\n\r\n\tvar showLabel = function(value, key, row){\r\n\t\tif(value) return document.createTextNode(value['@value'] + \" aa\");\r\n\t\treturn document.createElement(\"span\");\r\n\t}\r\n\tlet nq = new TerminusHTMLViewer(this.ui.client);//should specify default renderers here....\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tlet query = WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(25).start(0).getEverything();\r\n\r\n\tquery.execute(this.ui.client).then((results) => {\r\n\t\tlet qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tvar nt = nq.showResult(qres, WOQL.table());\r\n\t\td.appendChild(nt);\r\n\t\tqres.first()\r\n\t\tvar n = nq.showResult(qres, WOQL.chooser());\r\n\t\td.appendChild(n);\r\n\t\tqres.first();\r\n\t\tvar ng = nq.showResult(qres, WOQL.graph());\r\n\t\td.appendChild(ng);\r\n\t\tqres.first();\r\n\t\t//var sg = nq.showResult(qres, WOQL.stream());\r\n\t\t//d.appendChild(sg);\r\n\t\t//d.appendChild(nc);\r\n\t\t//var ng = nq.displayResults(false, WOQL.graph());\r\n\t\t//d.appendChild(ng);\r\n\t\t/*let t = WOQL.table().pager(false);\r\n\t\t//t.column(\"Class\", \"Type_Comment\", \"ID\").hidden(true);\r\n\t\t//t.column(\"Label\").header(\"Document\");\r\n\t\t//t.column(\"Comment\").header(\"Description\");\r\n\t\t//t.column(\"Comment\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\tt.column_order(\"Subject\", \"Predicate\", \"Object\");\r\n\t\t//t.column(\"Label\").render(showLabel);\r\n\t\tt.row().click(rowClick);\r\n\t\tqres.first();\r\n\t\tvar dt2 = nq.showResult(qres, t);\r\n\t\td.appendChild(dt2);\r\n\r\n\t\tqres.first();\r\n\t\t//var w = WOQL.chooser().values(\"ID\").labels(\"Comment\").titles(\"Class\").sort(\"Comment\").direction(\"asc\");\r\n\t\t//w.change(function(x){\r\n\t\t//\talert(x);\r\n\t\t//}).show_empty(\"Choose something\");\r\n\t\t//var n2 = nq.showResult(qres, w);\r\n\t\t//d.appendChild(n2);\r\n\t\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tvar licon = { color: [255,255,255], weight: 100, unicode: \"\\uf1c2\"};\r\n\t\tvar licon3 = { color: [23,3,34], weight: 100, unicode: \"\\uf1c2\"};\r\n\t\tvar lborder = { color: [10,255,0], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tvar g = WOQL.graph();\r\n\t\t//g.source(\"ID\").width(\"1000\").height(1000);//.literals(false);\r\n\t\tg.node(\"Subject\").size(20).color([220, 202, 230]).collisionRadius(100).icon(licon3);\r\n\t\tg.node(\"Object\").size(24).color([20, 20, 20]).icon(licon2);\r\n\t\tg.node().literal(true).color([200, 200, 220]).size(10).icon(licon);\r\n\t\tg.node(\"Predicate\").hidden(true);\r\n\t\t//var e = g.rule().edge(\"ID\", \"Class\").label(x).icon(y).color();\r\n\t\t//var n = g.rule().node(\"ID\").label(x).icon(y).color();\r\n\t\tg.edges([\"Subject\", \"Object\"]);\r\n\t\tg.edge().color([150, 200, 250]);\r\n\t\tqres.first()\r\n\t\tvar ng3 = nq.showResult(qres, g);\r\n\t\td.appendChild(ng3);\r\n\t\t*/\r\n\t\tvar x = \"doc:access_all_areas\";\r\n\t\tvar d1 = nq.document(x, WOQL.document());\r\n\t\td.appendChild(d1);\r\n\r\n\t});\r\n\t//let c = WOQL.chooser();\r\n\r\n\t//t.display(query);\r\n\t//t.column(\"Label\").header(\"Document\").render(showLabel).click(cellClick);\r\n\t//t.column(\"ID\").header(\"l\").renderer(\"MyRenderer\");\r\n\t//should specify default renderers here....\r\n\t//var qp = nq.querypane(woql, this.getDocumentTableConfig());\r\n\r\n\t//let nquery = WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(1000).simpleGraphQuery();\r\n\t//let g = WOQL.graph();\r\n\t//g.edge(\"v:Source\", \"v:Edge\", \"v:Target\").label(\"bla\").color([23,23,45]).weight(\"v:Account\")\r\n\t//t.column(\"Class\", \"Type_Comment\", \"ID\").hidden(true);\r\n\t//t.column(\"Label\").header(\"Document\").render(showLabel).click(cellClick);\r\n\t//t.column(\"Comment\").header(\"Description\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t//t.column(\"ID\").header(\"l\").renderer(\"MyRenderer\");\r\n\t//t.order(\"Label\", \"Type\", \"Comment\");\r\n\t//var ng = nq.displayResults(nquery, g);\r\n\t//d.appendChild(ng);\r\n\r\n\r\n\treturn d;\r\n\t/*var q = this.wquery.getClassesQuery(25, 0);\r\n\tvar self = this;\r\n\t//this.wquery.execute(q)\r\n\tq.execute(this.ui.client)\r\n\t.then(function(result){\r\n\t\tvar wqRes = new TerminusClient.WOQLResult(result, q);\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, wqRes, {}, {}, false);\r\n\t\tif(self.result){\r\n\t\t\tvar nd = self.result.getAsDOM(d, false);\r\n\t\t\tif(nd){\r\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\r\n\t        }\r\n\t\t\telse{\r\n\t\t\t\tnor = document.createElement('div');\r\n\t\t\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\t\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\t\t\td.appendChild(nor);\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tconsole.error(err);\r\n\t\tself.ui.showError(err);\r\n\t});\r\n\treturn d;*/\r\n}\r\n\r\n\r\nfunction TerminusDBCreator(ui){\r\n\tthis.ui = ui;\r\n}\r\n\r\nTerminusDBCreator.prototype.getAsDOM = function(selected){\r\n\tvar scd = document.createElement(\"div\");\r\n\t/* test delete when over var txtHolder = document.createElement(\"div\");\r\n\ttxtHolder.appendChild(document.createTextNode('expecting laoder herer'));\r\n\tscd.appendChild(txtHolder);\r\n\tthis.ui.getLoader(scd);*/\r\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\r\n\tvar sct = document.createElement(\"h3\");\r\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\r\n\tsct.appendChild(document.createTextNode(\"Create New Database\"));\r\n\tscd.appendChild(sct);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"ID\"));\r\n\tsci.appendChild(slab);\r\n\tvar idip = document.createElement(\"input\");\r\n\tidip.setAttribute(\"type\", \"text\");\r\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\r\n\tsci.appendChild(idip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Title\"));\r\n\tvar titip = document.createElement(\"input\");\r\n\ttitip.setAttribute(\"type\", \"text\");\r\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\r\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tsci.appendChild(slab);\r\n\tsci.appendChild(titip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Description\"));\r\n\tsci.appendChild(slab);\r\n\tvar descip = document.createElement(\"textarea\");\r\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\r\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\r\n\tsci.appendChild(descip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\r\n\tsci.appendChild(slab);\r\n\tvar schem = document.createElement(\"input\");\r\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tschem.setAttribute(\"type\", \"text\");\r\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(schem);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Key\"));\r\n\tsci.appendChild(slab);\r\n\tvar kip = document.createElement(\"input\");\r\n\tkip.setAttribute(\"placeholder\", \"Server API Key\");\r\n\tkip.setAttribute(\"type\", \"text\");\r\n\tkip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(kip);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\r\n\tsci.appendChild(slab);\r\n\tvar datip = document.createElement(\"input\");\r\n\tdatip.setAttribute(\"type\", \"text\");\r\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(datip);\r\n\t//mfd.appendChild(sci);\r\n\tvar butfield = document.createElement(\"div\");\r\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar cancbut = document.createElement(\"button\");\r\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn\");\r\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\r\n\tvar self = this;\r\n\tvar gatherips = function(){\r\n\t\tvar input = {};\r\n\t\tinput.id = idip.value;\r\n\t\tinput.title = titip.value;\r\n\t\tinput.description = descip.value;\r\n\t\tinput.schema = schem.value;\r\n\t\tinput.key = kip.value;\r\n\t\tinput.data = datip.value;\r\n\t\treturn input;\r\n\t}\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tvar input = gatherips();\r\n\t\tself.ui.createDatabase(input);\r\n\t})\r\n\tcancbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.showServerMainPage();\r\n\t})\r\n\tbutfield.appendChild(cancbut);\r\n\tbutfield.appendChild(loadbut);\r\n\tmfd.appendChild(butfield);\r\n\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\r\n\t            TerminusDBController:TerminusDBController,\r\n\t            TerminusDBCreator:TerminusDBCreator}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLChooser = require(\"./WOQLChooser\");\r\nconst WOQLTable = require(\"./WOQLTable\");\r\nconst WOQLQueryViewer = require(\"./WOQLQueryView\");\r\nconst WOQLGraph = require(\"./WOQLGraph\");\r\nconst WOQLStream = require(\"./WOQLStream\");\r\nconst TerminusFrame = require(\"./TerminusFrame\");\r\n\r\nTerminusClient.WOQL.table = function(){ return new WOQLTableConfig(); }\r\nTerminusClient.WOQL.graph = function(){ return new WOQLGraphConfig(); }\r\nTerminusClient.WOQL.chooser = function(){ return new WOQLChooserConfig(); }\r\nTerminusClient.WOQL.stream = function(){ return new WOQLStreamConfig(); }\r\nTerminusClient.WOQL.document = function(){ return new FrameConfig(); }\r\n//the below are aspirational...\r\n//TerminusClient.WOQL.map = function(){ return new WOQLMapConfig(); }\r\n//TerminusClient.WOQL.chart = function(){ return new WOQLChartConfig(); }\r\n\r\n//Class for expressing and matching rules about WOQL results\r\n//especially for efficiently expressing rules about how they should be rendered\r\n//const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction FrameConfig(){\r\n\tthis.rules = [];\r\n}\r\n\r\nFrameConfig.prototype.create = function(client, renderers){\r\n\tvar tf = new TerminusFrame(client, this);\r\n\tif(this.trenderer) tf.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['frame']){\r\n\t\ttf.setRenderer(renderers['frame']);\r\n\t}\r\n\treturn tf;\r\n}\r\n\r\nFrameConfig.prototype.renderer = function(rend){\r\n\tif(typeof rend == \"undefined\") return this.trenderer;\r\n\tthis.trenderer = rend;\r\n\treturn this;\r\n}\r\n\r\n\r\nFrameConfig.prototype.json_rules = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\treturn jr;\r\n}\r\n\r\nFrameConfig.prototype.load_schema = function(tf){\r\n\tif(typeof tf == \"undefined\") return this.get_schema;\r\n\tthis.get_schema = tf;\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.show_all = function(o, p, d){\r\n\tthis.object().renderer(o);\r\n\tthis.property().renderer(p);\r\n\tthis.data().renderer(d);\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.object = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"object\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\nFrameConfig.prototype.property = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"property\");\r\n\tthis.rules.push(fp);\r\n\treturn fp;\t\r\n}\r\n\r\nFrameConfig.prototype.data = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"data\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\t\r\n}\r\n\r\n//WOQL.rule().renderer(\"object\").json(),\r\n//WOQL.rule().renderer(\"property\").json(),\r\n//WOQL.rule().renderer(\"data\").json(),\r\n//WOQL.rule().renderer(\"data\").property(\"rdfs:comment\").render(false).json()\r\n\r\n\r\nfunction WOQLStreamConfig(){\r\n\tthis.rules = [];\r\n}\r\n\r\nWOQLStreamConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLStreamConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLStream(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['stream']){\r\n\t\twqt.setRenderer(renderers['stream']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\n\r\nfunction WOQLChooserConfig(){\r\n\tthis.rules = [];\r\n}\r\n\r\nWOQLChooserConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLChooserConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLChooser(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['chooser']){\r\n\t\twqt.setRenderer(renderers['chooser']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLChooserConfig.prototype.change = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.onChange = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.onChange;\t\r\n}\r\n\r\nWOQLChooserConfig.prototype.show_empty = function(p){\r\n\tif(typeof p != \"undefined\"){\r\n\t\tthis.placeholder = p;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.placeholder;\t\r\n}\r\n\r\n\r\nWOQLChooserConfig.prototype.rule = function(v){\r\n\tlet nr = new WOQLRule(\"row\");\r\n\tthis.rules.push(nr);\r\n\treturn nr.v(v);\t\r\n}\r\n\r\nWOQLChooserConfig.prototype.values = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.value_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.value_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.labels = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.label_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.label_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.titles = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.title_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.title_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.sort = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.sort_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.sort_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.direction = function(v){\r\n\tif(v){\r\n\t\tthis.sort_direction = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.sort_direction;\r\n}\r\n\r\n\r\n//this.choice = (config && config.choice ? config.choice : false);\r\n\r\n\r\nfunction WOQLTableConfig(){\r\n\tthis.rules = [];\r\n\tthis.show_pager = true;\r\n\tthis.show_pagesize = true;\t\r\n\tthis.change_pagesize = true;\r\n\tthis.show_pagenumber = true;\r\n}\r\n\r\nWOQLTableConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLTableConfig.prototype.create = function(client, renderers, dtypes){\r\n\tvar wqt = new WOQLTable(client, this);\r\n\twqt.setDatatypes(dtypes);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['table']){\r\n\t\twqt.setRenderer(renderers['table']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLTableConfig.prototype.renderer = function(rend){\r\n\tthis.trenderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.column_order = function(...val){\r\n\tif(typeof val == \"undefined\" || val.length == 0){\r\n\t\treturn this.order;\r\n\t}\r\n\tthis.order = addNamespacesToVariables(val);\r\n\treturn this;\t\t\r\n}\r\n\r\nWOQLTableConfig.prototype.pager = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pager;\r\n\t}\r\n\tthis.show_pager = val;\r\n\treturn this;\t\r\n}\r\n\r\nWOQLTableConfig.prototype.pagesize = function(val, editable){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pagesize;\r\n\t}\r\n\tthis.show_pagesize = val;\t\r\n\tthis.change_pagesize = editable;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.page = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pagenumber;\r\n\t}\r\n\tthis.show_pagenumber = val;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.column = function(...cols){\r\n\tlet nr = new WOQLRule(\"column\");\r\n\tnr.setVariables(cols);\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\n/* shorthand alternative */\r\nWOQLTableConfig.prototype.col = WOQLTableConfig.prototype.column; \r\n\r\n\r\nWOQLTableConfig.prototype.row = function(){\r\n\tlet nr = new WOQLRule(\"row\");\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig = function(){\r\n\tthis.rules = [];\t\r\n}\r\n\r\nWOQLGraphConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLGraph(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['graph']){\r\n\t\twqt.setRenderer(renderers['graph']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLGraphConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLGraphConfig.prototype.literals = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.show_literals = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.show_literals;\r\n}\r\n\r\nWOQLGraphConfig.prototype.source = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.source_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.source_variable;\r\n}\r\n\r\nWOQLGraphConfig.prototype.fontfamily = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.fontfam = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.fontfam;\r\n}\r\n\r\nWOQLGraphConfig.prototype.show_force = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.force = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.force;\r\n}\r\n\r\nWOQLGraphConfig.prototype.fix_nodes = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.fixed = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.fixed;\r\n}\r\n\r\nWOQLGraphConfig.prototype.explode_out = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.explode = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.explode;\r\n}\r\n\r\nWOQLGraphConfig.prototype.width = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.gwidth = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.gwidth;\r\n}\r\n\r\nWOQLGraphConfig.prototype.height = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.gheight = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.gheight;\r\n}\r\n\r\nWOQLGraphConfig.prototype.selected_grows = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.bigsel = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.bigsel;\r\n}\r\n\r\nWOQLGraphConfig.prototype.node = function(...cols){\r\n\tlet nr = new WOQLRule(\"node\");\r\n\tnr.setVariables(cols);\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig.prototype.edge = function(source, target){\r\n\tlet nr = new WOQLRule(\"edge\");\r\n\tif(source && target) nr.setVariables([source, target]);\r\n\telse if(source) nr.setVariables([source]);\r\n\telse if(target) nr.setVariables([target]);\r\n\tif(source) nr.source = source;\r\n\tif(target) nr.target = target;\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig.prototype.edges = function(...edges){\r\n\tif(edges && edges.length){\r\n\t\tvar nedges = [];\r\n\t\tfor(var i = 0; i<edges.length; i++){\r\n\t\t\tnedges.push(addNamespacesToVariables(edges[i]));\r\n\t\t}\r\n\t\tthis.show_edges = nedges;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.show_edges;\r\n}\r\n\r\nfunction WOQLRule(s){\r\n\tthis.rule = { scope: s };\r\n}\r\n\r\nWOQLRule.prototype.size = function(size){\r\n\tif(typeof size == \"undefined\"){\r\n\t\treturn this.rule.size;\r\n\t}\r\n\tthis.rule.size = size;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.color = function(color){\r\n\tif(typeof color == \"undefined\"){\r\n\t\treturn this.rule.color;\r\n\t}\r\n\tthis.rule.color = color;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.charge = function(v){\r\n\tif(typeof v == \"undefined\"){\r\n\t\treturn this.rule.charge;\r\n\t}\r\n\tthis.rule.charge = v;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.collisionRadius = function(v){\r\n\tif(typeof v == \"undefined\"){\r\n\t\treturn this.rule.collisionRadius;\r\n\t}\r\n\tthis.rule.collisionRadius = v;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.icon = function(json){\r\n\tif(json){\r\n\t\tthis.rule.icon = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.icon;\r\n}\r\n\r\nWOQLRule.prototype.text = function(json){\r\n\tif(json){\r\n\t\tthis.rule.text = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.text;\r\n}\r\n\r\nWOQLRule.prototype.border = function(json){\r\n\tif(json){\r\n\t\tthis.rule.border = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.border;\r\n}\r\n\r\nWOQLRule.prototype.arrow = function(json){\r\n\tif(json){\r\n\t\tthis.rule.arrow = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.arrow;\r\n}\r\n\r\nWOQLRule.prototype.distance = function(d){\r\n\tif(typeof d != \"undefined\"){\r\n\t\tthis.rule.distance = d;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.distance;\r\n}\r\n\r\nWOQLRule.prototype.symmetric = function(d){\r\n\tif(typeof d != \"undefined\"){\r\n\t\tthis.rule.symmetric = d;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.symmetric ;\r\n}\r\n\r\n\r\nWOQLRule.prototype.weight = function(w){\r\n\tif(typeof w != \"undefined\"){\r\n\t\tthis.rule.weight = w;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.weight;\r\n}\r\n\r\n\r\nWOQLRule.prototype.renderer = function(rend){\r\n\tif(typeof rend == \"undefined\"){\r\n\t\treturn this.rule.renderer;\r\n\t}\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.header = function(hdr){\r\n\tif(typeof hdr == \"undefined\"){\r\n\t\treturn this.rule.header;\r\n\t}\r\n\tthis.rule.header = hdr;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLRule.prototype.render = function(func){\r\n\tif(typeof func == \"undefined\"){\r\n\t\treturn this.rule.render;\r\n\t}\r\n\tthis.rule.render = func;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.click = function(onClick){\r\n\tif(onClick){\r\n\t\tthis.rule.click = onClick;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.click;\r\n}\r\n\r\nWOQLRule.prototype.hover = function(onHover){\r\n\tif(onHover){\r\n\t\tthis.rule.hover = onHover;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.hover;\r\n}\r\n\r\nWOQLRule.prototype.hidden = function(hidden){\r\n\tif(typeof hidden == \"undefined\"){\r\n\t\treturn this.rule.hidden;\r\n\t}\r\n\tthis.rule.hidden = hidden;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.args = function(args){\r\n\tthis.rule.args = args;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.literal = function(tf){\r\n\tthis.rule.literal = tf;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLRule.prototype.type = function(...list){\r\n\tthis.rule.type = list;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.setVariables = function(vars){\r\n\tif(vars && vars.length){\r\n\t\tthis.rule.variables = addNamespacesToVariables(vars);\r\n\t\tthis.current_variable = this.rule.variables[this.rule.variables.length - 1];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.v = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.current_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.current_variable;\r\n}\r\n\r\nWOQLRule.prototype.in = function(...list){\r\n\tif(this.current_variable){\r\n\t\tif(!this.rule.constraints) this.rule.constraints = {};\r\n\t\tif(!this.rule.constraints[this.current_variable]) this.rule.constraints[this.current_variable] = [];\r\n\t\tthis.rule.constraints[this.current_variable].push(list);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.filter = function(tester){\r\n\tif(this.current_variable){\r\n\t\tif(!this.rule.constraints) this.rule.constraints = {};\r\n\t\tif(!this.rule.constraints[this.current_variable]) this.rule.constraints[this.current_variable] = [];\r\n\t\tthis.rule.constraints[this.current_variable].push(tester);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.label = function(l){\r\n\tif(l){\r\n\t\tthis.rule.label = l;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.label;\r\n}\r\n\r\nWOQLRule.prototype.title = function(l){\r\n\tif(l){\r\n\t\tthis.rule.title = l;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.title;\r\n}\r\n\r\nWOQLRule.prototype.selected = function(s){\r\n\tif(typeof s != \"undefined\"){\r\n\t\tthis.rule.selected = s;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.selected;\r\n}\r\n\r\n\r\n/*\r\n * Matches on\r\n * 1. scope (row, cell, column)\r\n * 2. variables - only match certain ones\r\n * 3. type - only match datatype\r\n * 4. constraints - on values of variables\r\n */\r\n\r\nWOQLRule.prototype.match = function(data, key, context, action){\r\n\tif(context && this.rule.scope != context) return false;\r\n\tif(key){\r\n\t\tif(this.rule.variables && this.rule.variables.length){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(this.rule.variables.indexOf(key[0]) == -1) return false;\r\n\t\t\t\tif(this.rule.variables.indexOf(key[1]) == -1) return false;\r\n\t\t\t}\r\n\t\t\telse if(this.rule.variables.indexOf(key) == -1) return false;\r\n\t\t}\r\n\t\tif(this.rule && this.rule.type){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(!(data[key][0][\"@type\"] && this.rule.type.indexOf(data[key][0][\"@type\"]) != -1)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(!(data[key][\"@type\"] && this.rule.type.indexOf(data[key][\"@type\"]) != -1)){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(this.rule && typeof this.rule.literal != \"undefined\"){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(data[key[0]]['@value']) {\r\n\t\t\t\t\tif(!this.rule.literal) return false; \r\n\t\t\t\t}\r\n\t\t\t\telse if(this.rule.literal) return false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif(data[key]['@value']) {\r\n\t\t\t\t\tif(!this.rule.literal) return false; \r\n\t\t\t\t}\r\n\t\t\t\telse if(this.rule.literal) return false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof key == \"object\"){\r\n\t\t\tif(this.rule.constraints && this.rule.constraints[key[0]]){\r\n\t\t\t\tfor(var i = 0; i<this.rule.constraints[key[0]].length; i++){\r\n\t\t\t\t\tif(!this.test(row[key[0]], this.rule.constraints[key][0])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\t\t\tif(this.rule.constraints && this.rule.constraints[key[1]]){\r\n\t\t\t\tfor(var i = 0; i<this.rule.constraints[key[1]].length; i++){\r\n\t\t\t\t\tif(!this.test(row[key[1]], this.rule.constraints[key][1])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.rule.constraints && this.rule.constraints[key]){\r\n\t\t\tfor(var i = 0; i<this.rule.constraints[key].length; i++){\r\n\t\t\t\tif(!this.test(row[key], this.rule.constraints[key])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\tif(context == \"edge\"){\r\n\t\t\tif(this.rule.source && this.rule.source != key[0]) return false;\r\n\t\t\tif(this.rule.target && this.rule.target != key[1]) return false;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tfor(var k in this.rule.constraints){\r\n\t\t\tfor(var i = 0; i<this.rule.constraints[k].length; i++){\r\n\t\t\t\tif(!this.test(data[k], this.rule.constraints[k])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\t\t\t\r\n\t\t}\r\n\t}\r\n\tif(action && typeof this.rule[action] == \"undefined\") return false;\r\n\treturn true;\r\n}\r\n\r\nWOQLRule.prototype.test = function(value, constraint){\r\n\tif(typeof constraint == \"object\" && constraint.length){\r\n\t\tvar vundertest = (value['@value'] ? value['@value'] : value);\r\n\t\treturn (constraint.indexOf(vundertest) != -1);\r\n\t}\r\n\tif(typeof constraint == \"function\"){\r\n\t\treturn constraint(value);\r\n\t}\t\r\n}\r\n\r\n\r\n/*\r\n * Utility function adds v: to variables...\r\n */\r\nfunction addNamespacesToVariables(vars){\r\n\tvar nvars = [];\r\n\tfor(var i = 0; i<vars.length; i++){\r\n\t\tvar nvar = (vars[i].substring(0, 2) == \"v:\") ? vars[i] : \"v:\" + vars[i];\r\n\t\tnvars.push(nvar);\r\n\t}\t\r\n\treturn nvars;\r\n}\r\n\r\nfunction getMatchingRules(rules, row, key, context, action){\r\n\tvar matches = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tif(rules[i].match(row, key, context, action)){\r\n\t\t\tmatches.push(rules[i].rule);\r\n\t\t}\r\n\t}\t\r\n\treturn matches;\r\n}\r\n\r\n\r\n/*\r\n * \r\nvar x = WOQL.schema();\r\nx.addClass(\"my:Class\").label(\"A class\").comment(\"A comment\").abstract().relationship();\r\nx.addProperty(\"my:prop\", \"xsd:string\").domain(\"my:Class\").label(\"x\").comment(\"x\").max(2).min(1);\r\nx.execute(client).then ...\r\n */\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n/*\r\n * Very simple implementation of a WOQL backed chooser\r\n * Makes a drop down from a WOQL query - configuration tells it which columns to use...\r\n */\r\n\r\nfunction WOQLChooser(client, options){\r\n\tthis.client = client;\r\n\tthis.selected = false;\r\n\treturn this.options(options);\r\n}\r\n\r\nWOQLChooser.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.chooser();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLChooser.prototype.set = function(id){\r\n\tif(this.selected != id){\r\n\t\tthis.selected = id;\r\n\t\tlet ch = this.config.change();\r\n\t\tif(ch) ch(id);\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLChooser.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Sets up the required variables from the result / config\r\n */\r\nWOQLChooser.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n\tthis.choices = [];\r\n\tthis.cursor = 0;\r\n\tconst variables = result.getVariableList();\r\n\tif(!this.config.values() && variables.length){\r\n\t\tthis.config.values(variables[0]);\r\n\t}\r\n\t//sort it \r\n\tif(this.config.sort()){\r\n\t\tthis.result.sort(this.config.sort(), this.config.direction());\r\n\t}\r\n\twhile(row = this.result.next()){\r\n\t\tif(row && this.includeRow(row)){\r\n\t\t\tthis.choices.push(this.rowToChoice(row, this.result.cursor));\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLChooser.prototype.includeRow = function(row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nWOQLChooser.prototype.rowToChoice = function(binding, rownum){\r\n\tvar choice = { \r\n\t\tid: this.getRowID(binding) \r\n\t};\r\n\tchoice.label = this.getLabelFromBinding(binding, rownum);\r\n\tchoice.title = this.getTitleFromBinding(binding, rownum);\r\n\tchoice.selected = this.getSelectedFromBinding(binding, rownum);\r\n\treturn choice;\r\n}\r\n\r\nWOQLChooser.prototype.getRowID = function(binding){\r\n\tvar rval = binding[this.config.values()];\r\n\tif(rval['@value']) return rval['@value'];\r\n\treturn rval;\r\n}\r\n\r\nWOQLChooser.prototype.getLabelFromBinding = function(binding, rownum){\r\n\tlet sp = this.getSpecialRenderer(binding, \"label\");\r\n\tif(sp) return this.renderSpecial(sp, binding, rownum);\r\n\tif(this.config.labels()){\r\n\t\tif(binding[this.config.labels()]){\r\n\t\t\tvar lab = binding[this.config.labels()];\r\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\tif(lab != \"unknown\") return lab;\r\n\t\t}\r\n\t}\r\n\treturn TerminusClient.FrameHelper.labelFromURL(this.getRowID(binding));\r\n}\r\n\r\nWOQLChooser.prototype.getTitleFromBinding = function(binding, rownum){\r\n\tlet sp = this.getSpecialRenderer(binding, \"title\");\r\n\tif(sp) return this.renderSpecial(sp, binding, rownum);\r\n\tif(this.config.titles()){\r\n\t\tif(binding[this.config.titles()]){\r\n\t\t\tvar lab = binding[this.config.titles()];\r\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\tif(lab != \"unknown\") return lab;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.getSelectedFromBinding = function(binding){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"selected\");\r\n\tif(matched_rules && matched_rules.length){\r\n\t\treturn matched_rules[matched_rules.length - 1].selected;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.getSpecialRenderer = function(row, type){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", type);\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i][type]) return matched_rules[i][type];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.renderSpecial = function(rule, row, rownum){\r\n\tif(rule && typeof rule == \"function\"){\r\n\t\treturn render(row);\r\n\t}\r\n\tif(rule && typeof rule == \"string\"){\r\n\t\treturn rule;\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.count = function(){\r\n\treturn this.result.count();\r\n}\r\n\r\nWOQLChooser.prototype.first = function(){\r\n\tthis.cursor = 0;\r\n\treturn this.choices[this.cursor];\r\n}\r\n\r\nWOQLChooser.prototype.prev = function(){\r\n\tif(this.cursor > 0) {\r\n\t\treturn this.choices[--this.cursor];\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.next = function(){\r\n\treturn this.choices[this.cursor++];\r\n}\r\n\r\n\r\nmodule.exports = WOQLChooser;","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst DatatypeRenderers = require(\"./DatatypeRenderers\");\r\n\r\nfunction WOQLTable(client, config){\r\n\tthis.client = client;\r\n\tif(config) this.options(config);\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setResult = function(res){\r\n\tthis.result = res;\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLTable.prototype.count = function(){\r\n\treturn this.result.count();\r\n}\r\n\r\nWOQLTable.prototype.first = function(){\r\n\treturn this.result.first();\r\n}\r\n\r\nWOQLTable.prototype.prev = function(){\r\n\treturn this.result.prev();\r\n}\r\n\r\nWOQLTable.prototype.next = function(){\r\n\treturn this.result.next();\r\n}\r\n\r\n\r\nWOQLTable.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.table();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setDatatypes = function(func){\r\n\tthis.datatypes = new DatatypeRenderers();\r\n\tif(this.config.datatypes) this.datatypes.options(this.config.datatypes);\r\n\tif(func) func(this.datatypes);\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.canAdvancePage = function(){\r\n\treturn (this.result.count() == this.result.query.getLimit()); \r\n}\r\n\r\nWOQLTable.prototype.canChangePage = function(){\r\n\treturn this.canAdvancePage() || this.canRetreatPage();\r\n}\r\n\r\nWOQLTable.prototype.canRetreatPage = function(){\r\n\treturn (this.result.query.getPage() > 1);\r\n}\r\n\r\nWOQLTable.prototype.getPageSize = function(){\r\n\treturn this.result.query.getLimit() ;\t\r\n}\r\n\r\nWOQLTable.prototype.setPage = function(l){\r\n\treturn this.result.query.setPage(l);\t\r\n}\r\n\r\n\r\nWOQLTable.prototype.getPage = function(){\r\n\treturn this.result.query.getPage();\t\r\n}\r\n\r\nWOQLTable.prototype.setPageSize = function(l){\r\n\treturn this.update(this.result.query.setPageSize(l));\r\n}\r\n\r\nWOQLTable.prototype.nextPage = function(){\r\n\treturn this.update(this.result.query.nextPage());\r\n}\r\n\r\nWOQLTable.prototype.previousPage = function(){\r\n\treturn this.update(this.result.query.previousPage());\r\n}\r\n\r\nWOQLTable.prototype.getColumnsToRender = function(){\r\n\tif(this.hasColumnOrder()){\r\n\t\tvar cols = this.getColumnOrder();\r\n\t}\r\n\telse if(this.result.query.hasSelect()){\r\n\t\tvar cols = this.result.query.getSelectVariables();\r\n\t}\r\n\telse {\r\n\t\tvar cols = this.result.getVariableList();\r\n\t}\r\n\tvar self = this;\r\n\treturn cols.filter(col => !self.hidden(col));\r\n}\r\n\r\nWOQLTable.prototype.getColumnHeaderContents = function(colid){\r\n\tlet hr = this.config.getMatchingRules(false, colid, \"column\", \"header\");\r\n\tif(hr && hr.length){\r\n\t\tlet h = hr[hr.length-1].header;\r\n\t\tif(typeof h == \"string\"){\r\n\t\t\treturn document.createTextNode(h);\t\t\t\r\n\t\t}\r\n\t\telse if(typeof h == \"function\"){\r\n\t\t\treturn h(colid);\r\n\t\t}\r\n\t\telse return h;\r\n\t}\r\n\tif(colid.indexOf(\"v:\") === 0) colid = colid.substring(2);\r\n\tvar clab = (colid.indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(colid) : colid;\r\n\tclab = clab.replace(\"_\", \" \");\r\n\treturn document.createTextNode(clab);\r\n}\r\n\r\n\r\nWOQLTable.prototype.hidden = function(col){\r\n\tconst matched_rules = this.config.getMatchingRules(false, col, \"column\", \"hidden\");\r\n\tif(matched_rules.length){\r\n\t\treturn matched_rules[matched_rules.length-1].hidden;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Called when you want to change the query associated with the table. \r\n */\r\nWOQLTable.prototype.update = function(nquery){\r\n\treturn nquery.execute(this.client).then((results) => {\r\n\t\tvar nresult = new TerminusClient.WOQLResult(results, nquery);\r\n\t\tthis.setResult(nresult);\r\n\t\treturn nresult;\r\n\t});\t\r\n}\r\n\r\nWOQLTable.prototype.hasDefinedEvent = function(row, key, context, action){\r\n\tconst matched_rules = this.config.getMatchingRules(row, key, context, action);\r\n\tif(matched_rules && matched_rules.length) return true;\r\n\treturn false;\r\n}\r\n\r\nWOQLTable.prototype.getDefinedEvent = function(row, key, context, action){\r\n\tconst matched_rules = this.config.getMatchingRules(row, key, context, action);\r\n\tif(matched_rules && matched_rules.length) {\r\n\t\tvar l = (matched_rules.length - 1);\r\n\t\treturn matched_rules[l][action];\r\n\t}\r\n}\r\n\r\n\r\nWOQLTable.prototype.getRowClick = function(row){\r\n\tlet re = this.getDefinedEvent(row, false, \"row\", \"click\");\r\n\treturn re;\r\n}\r\n\r\nWOQLTable.prototype.getCellClick = function(row, col){\r\n\tlet cc = this.getDefinedEvent(row, col, \"column\", \"click\");\r\n\treturn cc;\r\n}\r\n\r\nWOQLTable.prototype.getRowHover = function(row){\r\n\treturn this.getDefinedEvent(row, false, \"row\", \"hover\");\r\n}\r\n\r\nWOQLTable.prototype.getCellHover = function(row, key){\r\n\treturn this.getDefinedEvent(row, key, \"column\", \"hover\");\r\n}\r\n\r\nWOQLTable.prototype.getColumnOrder = function(){\r\n\treturn this.config.column_order();\r\n}\r\n\r\nWOQLTable.prototype.hasColumnOrder = WOQLTable.prototype.getColumnOrder;\r\nWOQLTable.prototype.hasCellClick = WOQLTable.prototype.getCellClick;\r\nWOQLTable.prototype.hasRowClick = WOQLTable.prototype.getRowClick;\r\nWOQLTable.prototype.hasCellHover = WOQLTable.prototype.getCellHover;\r\nWOQLTable.prototype.hasRowHover = WOQLTable.prototype.getRowHover;\r\n\r\nWOQLTable.prototype.getRenderer = function(key, row){\r\n\tvar rend = this.getSpecificRender(key, row);\r\n\tif(rend) return rend;\r\n\tlet renderer = this.getDefinedEvent(row, key, \"column\", \"renderer\");\r\n\tlet args =  this.getDefinedEvent(row, key, \"column\", \"args\");\r\n\tif(!renderer){\r\n\t\tlet r = this.getRendererForDatatype(row[key]);\r\n\t\trenderer = r.name;\r\n\t\tif(!args) args = r.args;\r\n\t}\r\n\tif(renderer){\r\n\t\treturn this.datatypes.createRenderer(renderer, args);\t\t\r\n\t}\r\n}\r\n\r\nWOQLTable.prototype.renderValue = function(renderer, val, key, row){\r\n\tif(val && val['@type']){\r\n\t\trenderer.type = val['@type'];\r\n\t\tvar dv = new DataValue(val['@value'], val['@type'], key, row);\r\n\t}\t\r\n\telse if(val && val['@language']){\r\n\t\trenderer.type = \"xsd:string\";\r\n\t\tvar dv = new DataValue(val['@value'], renderer.type, key, row);\r\n\t}\r\n\telse if(val && typeof val == \"string\"){\r\n\t\trenderer.type = \"id\";\r\n\t\tvar dv = new DataValue(val['@value'], \"id\", key, row);\r\n\t}\r\n\tif(dv) return renderer.renderValue(dv);\r\n}\r\n\r\nfunction DataValue(val, type){\r\n\tthis.datavalue = val;\r\n\tthis.datatype = type;\r\n}\r\n\r\nDataValue.prototype.value = function(nvalue){\r\n\tif(nvalue) {\r\n\t\tthis.datavalue = nvalue; \r\n\t\treturn this;\r\n\t}\r\n\treturn this.datavalue;\r\n}\r\n\r\n\r\nWOQLTable.prototype.getRendererForDatatype = function(val){\r\n\tif(val && val['@type']){\r\n\t\treturn this.datatypes.getRenderer(val['@type'], val['@value']);\r\n\t}\r\n\telse if(val && val['@language']){\r\n\t\treturn this.datatypes.getRenderer(\"xsd:string\", val['@value']);\r\n\t}\r\n\telse if(val && typeof val == \"string\"){\r\n\t\treturn this.datatypes.getRenderer(\"id\", val);\t\t\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLTable.prototype.getSpecificRender = function(key, row){\r\n\tlet rend = this.getDefinedEvent(row, key, \"column\", \"render\");\r\n\treturn rend;\r\n}\r\n\r\nmodule.exports = WOQLTable;","/*\r\n * Maintains a list of renderers that are available for rendering \r\n * datatype values - also covers choice values and id values\r\n */\r\n\r\nfunction DatatypeRenderers(options){\r\n\tthis.registeredDataViewers = {},\r\n\tthis.registeredDataEditors = {},\r\n\tthis.defaultViewers = {};\r\n\tthis.defaultEditors = {};\r\n\tif(options) this.options(options);\r\n\t//links to other documents, choices, id field, id fields of contained objects, ids of structural elements: properties, etc\r\n\tthis.specials = ['document', 'oneOf', 'id', 'contained', 'structural'];\r\n}\r\n\r\nDatatypeRenderers.prototype.options = function (options){\r\n\tthis.universalViewer = (options && options.universalViewer ? options.universalViewer : false);\r\n\tthis.universalEditor = (options && options.universalEditor ? options.universalEditor : false);\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n}\r\n\r\nDatatypeRenderers.prototype.getValidDataViewerList = function(datatype){\r\n\tlet valids = [];\r\n\tif(datatype && typeof this.registeredDataViewers[datatype] != \"undefined\"){\r\n\t\tvalids = valids.concat(this.registeredDataViewers[datatype]);\r\n\t}\r\n\tif(this.universalViewer && valids.indexOf(this.universalViewer) == -1){\r\n\t\tvalids.push(this.universalViewer);\r\n\t}\r\n\treturn valids;\r\n};\r\n\r\nDatatypeRenderers.prototype.getValidDataEditorList = function(datatype){\r\n\tlet valids = [];\r\n\tif(datatype && typeof this.registeredDataEditors[datatype] != \"undefined\"){\r\n\t\tvar nftypes = this.registeredDataEditors[datatype];\r\n\t\tif(nftypes){\r\n\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(typeof this.registeredDataEditors[datatype] != \"undefined\"){\r\n\t\tvalids = valids.concat(this.registeredDataEditors[datatype]);\r\n\t}\r\n\tif(this.universalEditor && valids.indexOf(this.universalEditor) == -1){\r\n\t\tvalids.push(this.universalEditor);\r\n\t}\r\n\treturn valids;\r\n}\r\n\r\nDatatypeRenderers.prototype.getEditorForDataFrame = function(datatype){\r\n\tvar vals = this.getValidDataEditorList(datatype);\r\n\tif(this.defaultEditors[datatype] && vals[this.defaultEditors[datatype]]){\r\n\t\treturn vals[this.defaultEditors[datatype]];\r\n\t}\r\n\t//last added is default if no explicit default is set\r\n\tif(vals){\r\n\t\treturn vals[Object.keys(vals)[0]];\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.getViewerForDataFrame = function(datatype){\r\n\tvar vals = this.getValidDataViewerList(datatype);\r\n\tif(this.defaultViewers[datatype] && vals[this.defaultViewers[datatype]]){\r\n\t\treturn vals[this.defaultViewers[datatype]];\r\n\t}\r\n\tif(vals){\r\n\t\treturn vals[Object.keys(vals)[0]];\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.registerViewerForTypes = function(viewer, record, types){\r\n\tfor(var i = 0; i < types.length; i++){\r\n\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\tthis.registeredDataViewers[types[i]] = {};\r\n\t\t}\r\n\t\tif(!this.registeredDataViewers[types[i]][viewer]){\r\n\t\t\tthis.registeredDataViewers[types[i]][viewer] = record;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.registerEditorForTypes = function(viewer, record, types){\r\n\tfor(var i = 0; i < types.length; i++){\r\n\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\tthis.registeredDataEditors[types[i]] = {};\r\n\t\t}\r\n\t\tif(!this.registeredDataEditors[types[i]][viewer]){\r\n\t\t\tthis.registeredDataEditors[types[i]][viewer] = record;\r\n\t\t}\t\t\t\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.getRenderer = function(type, value){\r\n\tvar r = {};\r\n\tlet v = this.getViewerForDataFrame(type);\r\n\tif(v){\r\n\t\tr.name = Object.keys(v)[0];\r\n\t\tif(v[r.name].label){\r\n\t\t\tr.label = v[r.name].label;\r\n\t\t}\r\n\t\tif(v[r.name].args){\r\n\t\t\tr.args = v[r.name].args;\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=DatatypeRenderers;\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLQueryView(client){\r\n\tthis.client = client;\r\n}\r\n\r\nWOQLQueryView.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.setQuery = function(query){\r\n\tthis.query = query;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.render = function(){\r\n\tif(this.renderer){\r\n\t\tif(this.query){\r\n\t\t\tthis.renderer.set(this.query);\r\n\t\t}\r\n\t\treturn this.renderer.render(this);\r\n\t}\r\n}\r\n\r\n//parses a string encoding a woql in either json or js notation\r\nWOQLQueryView.prototype.parseText = function(text, format){\r\n\ttry {\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tif(format == \"json\"){\r\n\t\t\tvar qval = JSON.parse(text);\r\n\t\t\treturn WOQL.json(qval);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar nw = eval(\"WOQL.\" + text);\r\n\t\t\treturn nw;\r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error(\"Failed to parse Query \" + e.toString());\r\n\t}\r\n}\r\n\r\nWOQLQueryView.prototype.submitQuery = function(qObj){\r\n\r\n}\r\n\r\nWOQLQueryView.prototype.error = function(msg){\r\n\tconsole.log(msg);\r\n}\r\n\r\nWOQLQueryView.prototype.serialise = function(query, format){\r\n\tif(format == \"json\"){\r\n\t\treturn JSON.stringify(query.json(), 0, 2);\r\n\t}\r\n\telse {\r\n\t\treturn query.prettyPrint(4);\r\n\t}\r\n}\r\n\r\nmodule.exports = WOQLQueryView;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLGraph(client, options){\r\n\tthis.client = client;\r\n\tthis.options(options);\r\n\tthis.nodes = [];\r\n\tthis.node_ids = [];\r\n\tthis.edges = [];\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n\tthis.calculateVariableTypes(result);\r\n}\r\n\r\nWOQLGraph.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLGraph.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.graph();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.getEdges = function(){\r\n\tif(this.edges) return this.edges;\r\n\tthis.edges = [];\r\n\tvar bindings = this.result.getBindings();\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tif(this.rowIncludesEdge(bindings[i])){\r\n\t\t\tthis.edges = this.edges.concat(this.makeEdgesFromRow(bindings[i]))\r\n\t\t}\r\n\t}\r\n\treturn this.edges;\r\n}\r\n\r\nWOQLGraph.prototype.getNodes = function(){\r\n\tif(this.nodes) return this.nodes;\r\n\tthis.nodes = [];\r\n\t//get column names first...\r\n\tvar bindings = this.result.getBindings();\r\n\tvar nodes = [];\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tfor(var k in bindings[i]){\r\n\t\t\tif(this.source_variables.indexOf(k) != -1 && nodes.indexOf(bindings[i][k]) == -1){\r\n\t\t\t\tnodes.push(bindings[i][k]);\r\n\t\t\t\tthis.nodes.push(this.makeNodeFromSource(bindings[i][k], k, bindings[i]));\r\n\t\t\t}\r\n\t\t\tif(this.target_variables.indexOf(k) != -1 && nodes.indexOf(bindings[i][k]) == -1){\r\n\t\t\t\tnodes.push(bindings[i][k]);\r\n\t\t\t\tthis.nodes.push(this.makeNodeFromTarget(bindings[i][k], k, bindings[i]));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this.nodes;\r\n}\r\n\r\nWOQLGraph.prototype.makeNodeFromSource = function(sid, k, row) {\r\n\tvar node = {type: \"node\", id: sid};\r\n\treturn this.adornNode(node, row);\r\n}\r\n\r\nWOQLGraph.prototype.makeNodeFromTarget = WOQLGraph.prototype.makeNodeFromSource ;\r\n\r\nWOQLGraph.prototype.adornNode = function(node){\r\n\treturn node;\r\n}\r\n\r\nWOQLGraph.prototype.adornEdge = function(edge){\r\n\treturn edge;\r\n}\r\n\r\nWOQLGraph.prototype.makeEdgeFromRow = function(eid, k, row){\r\n\tvar target = false;\r\n\tvar source = false;\r\n\tfor(var i = 0; i<this.target_variables.length; i++){\r\n\t\tif(row[this.target_variables[i]]){\r\n\t\t\ttarget = row[this.target_variables[i]];\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t}\r\n\tif(target){\r\n\t\tfor(var i = 0; i<this.source_variables.length; i++){\r\n\t\t\tif(row[this.source_variables[i]]){\r\n\t\t\t\tsource = row[this.source_variables[i]];\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\tif(source && target){\r\n\t\tvar edge = { type: \"link\", id: eid, target: target, source: source };\r\n\t\treturn this.adornEdge(edge, row);\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.calculateVariableTypes = function(){\r\n\tvar bindings = this.result.getBindings();\r\n\tif(bindings && bindings.length){\r\n\t\tfor(var i = 0; i<bindings.length; i++){\r\n\t\t\tthis.extractFromBinding(bindings[i]);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.extractFromBinding = function(row){\r\n\t//\r\n\tif(this.includeRow(row)){\r\n\t\t//get all the nodes (ids - non literals) //\r\n\t\t//see which nodes are excluded ...\r\n\t\tvar nodes = [];\r\n\t\tvar lits = [];\r\n\t\tfor(var k in row){\r\n\t\t\tif(typeof row[k] == \"string\"){\r\n\t\t\t\tif(row[k] && row[k] != \"unknown\" && this.includeNode(k, row)) nodes.push(k);\r\n\t\t\t}\r\n\t\t\telse if(typeof row[k][\"@value\"] == \"string\" && this.includeLiteralNode(k, row)){\r\n\t\t\t\tlits.push(k);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(nodes.length == 0) return;\r\n\t\t//first of all we need to make the literal nodes targets of \r\n\t\tfor(var i = 0; i<lits.length; i++){\r\n\t\t\t//make an edge and put the lit in as a node...\r\n\t\t\tvar nid = TerminusClient.FrameHelper.genBNID().substring(2);\r\n\t\t\tlet source = this.getLiteralOwner(nodes, lits[i], row);\r\n\t\t\tif(source) {\r\n\t\t\t\tthis.addAdornedNode(nid, lits[i], row);\r\n\t\t\t\tthis.addAdornedEdge(row[source], nid, source, lits[i], row);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.createEdgesFromIDs(nodes, row);\r\n\t\tfor(var i = 0; i<nodes.length; i++){\r\n\t\t\tvar ndid = row[nodes[i]];\r\n\t\t\tvar node = { type: \"node\", id: ndid, nodetype: nodes[i], text: row[nodes[i]] };\r\n\t\t\tthis.addAdornedNode(ndid, nodes[i], row);\r\n\t\t}\t\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.addAdornedEdge = function(source, target, ks, kt, row){\r\n\tvar edge = { type: \"link\", target: target, source: source, text: kt};\r\n\tconst matched_rules = this.config.getMatchingRules(row, [ks, kt], \"edge\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].size){\r\n\t\t\tif(typeof matched_rules[i].size == \"string\" && matched_rules[i].size.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].size];\r\n\t\t\t\tif(w && w['@value']) edge.size = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.size = matched_rules[i].size;\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\tif(matched_rules[i].color){\r\n\t\t\tedge.color = matched_rules[i].color;\t\t\t\r\n\t\t}\r\n\t\tif(matched_rules[i].distance){\r\n\t\t\tif(typeof matched_rules[i].distance == \"string\" && matched_rules[i].distance.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].distance];\r\n\t\t\t\tif(w && w['@value']) edge.distance = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.distance = matched_rules[i].distance;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].arrow){\r\n\t\t\tedge.arrow = matched_rules[i].arrow;\r\n\t\t}\r\n\t\tif(typeof matched_rules[i].symmetric != \"undefined\"){\r\n\t\t\tedge.symmetric = matched_rules[i].symmetric;\r\n\t\t}\r\n\t\tif(matched_rules[i].weight){\r\n\t\t\tif(typeof matched_rules[i].weight == \"string\" && matched_rules[i].weight.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].weight];\r\n\t\t\t\tif(w && w['@value']) edge.weight = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.weight = matched_rules[i].weight;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tthis.edges.push(edge);\t\r\n}\r\n\r\nWOQLGraph.prototype.addAdornedNode = function(nid, k, row){\r\n\tvar node = { type: \"node\", id: nid, nodetype: k };\r\n\tconst matched_rules = this.config.getMatchingRules(row, k, \"node\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].size){\r\n\t\t\tif(typeof matched_rules[i].size == \"string\" && matched_rules[i].size.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].size];\r\n\t\t\t\tif(rad && rad['@value']) node.radius = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.radius = matched_rules[i].size;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].color){\r\n\t\t\tnode.color = matched_rules[i].color;\r\n\t\t}\r\n\t\tif(matched_rules[i].charge){\r\n\t\t\tif(typeof matched_rules[i].charge == \"string\" && matched_rules[i].charge.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].charge];\r\n\t\t\t\tif(rad && rad['@value']) node.charge = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.charge = matched_rules[i].charge;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].collisionRadius ){\r\n\t\t\tif(typeof matched_rules[i].collisionRadius == \"string\" && matched_rules[i].collisionRadius.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].collisionRadius];\r\n\t\t\t\tif(rad && rad['@value']) node.collisionRadius = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.collisionRadius= matched_rules[i].collisionRadius;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].icon ){\r\n\t\t\tnode.icon = matched_rules[i].icon;\r\n\t\t}\r\n\t\tif(matched_rules[i].text){\r\n\t\t\tnode.text = matched_rules[i].text;\r\n\t\t}\r\n\t\tif(matched_rules[i].border){\r\n\t\t\tnode.border = matched_rules[i].border;\r\n\t\t}\r\n\t}\r\n\tif(!node.text){\r\n\t\tif(typeof row[k] == \"string\") node.text = row[k];\r\n\t\telse if(row[k]['@value']) node.text = row[k]['@value'];\r\n\t}\r\n\tthis.nodes.push(node);\r\n}\r\n\r\nWOQLGraph.prototype.getLiteralOwner = function(nodes, v, row){\r\n\tvar cs = this.config.source();\r\n\tif(cs && row[cs]){\r\n\t\treturn cs;\r\n\t}\r\n\tvar edges = this.config.edges();\r\n\tif(edges){\r\n\t\tfor(var i = 0; i < edges.length; i++){\r\n\t\t\tif(edges[i][1] == v){\r\n\t\t\t\treturn edges[i][0];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\treturn nodes[0];\r\n}\r\n\r\nWOQLGraph.prototype.createEdgesFromIDs = function(nodes, row){\r\n\tif(nodes.length < 2) return;\r\n\tvar cs = this.config.source();\r\n\tlet es = this.config.edges();\r\n\tif(!cs && es && es.length){\r\n\t\tfor(var i = 0; i< es.length; i++){\r\n\t\t\tif(nodes.indexOf(es[i][0]) != -1 && nodes.indexOf(es[i][1]) != -1 ){\r\n\t\t\t\tthis.addAdornedEdge(row[es[i][0]], row[es[i][1]], es[i][0], es[i][1], row);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tvar s = (cs && nodes.indexOf(cs) != -1) ? cs : nodes[0];\r\n\tfor(var i = 0; i<nodes.length; i++){\r\n\t\tif(nodes[i] == s) continue;\r\n\t\tthis.addAdornedEdge(row[s], row[nodes[i]], s, nodes[i], row);\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.includeNode = function(v, row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, v, \"node\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nWOQLGraph.prototype.includeLiteralNode = function(v, row){\r\n\tlet l = this.config.literals();\r\n\tif(typeof l != \"undefined\" && !l) return false;\r\n\tconst matched_rules = this.config.getMatchingRules(row, v, \"node\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\nWOQLGraph.prototype.includeRow = function(row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\n\r\nmodule.exports = WOQLGraph;","/*\r\n * Maps a woql query to a stream of results...\r\n */\r\n\r\nfunction WOQLStream(client){\r\n\tthis.client = client;\r\n}\r\n\r\nWOQLStream.prototype.options = function(opts){\r\n\tthis.page_size = 10;\r\n\treturn this;\r\n}\r\n\r\nWOQLStream.prototype.setResult = function(wqrs){\r\n\tthis.result = wqrs;\r\n}\r\n\r\nWOQLStream.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLStream.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nmodule.exports = WOQLStream;","const DatatypeRenderers = require(\"./DatatypeRenderers\");\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusFrame(client){\r\n\tthis.client = client;\r\n\tthis.load_schema = false;\r\n}\r\n\r\nTerminusFrame.prototype.options = function(opts){\r\n\tthis.config = opts || TerminusClient.WOQL.document();\r\n\treturn this;\r\n}\r\n\r\nTerminusFrame.prototype.setDatatypes = function(func){\r\n\tthis.datatypes = new DatatypeRenderers();\r\n\tif(this.config.datatypes) this.datatypes.options(this.config.datatypes);\r\n\tif(func) func(this.datatypes);\r\n\treturn this;\r\n}\r\n\r\nTerminusFrame.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\treturn this.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.loadDataFrames(response);\r\n\t\tif(self.config.load_schema()){\r\n\t\t\tself.loadDocumentSchema(self.document.cls);\r\n\t\t}\r\n\t\treturn response;\r\n\t});\r\n}\r\n\r\nTerminusFrame.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\treturn self.loadSchemaFrames(response, cls);\r\n\t});\r\n}\r\n\r\nTerminusFrame.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusFrame.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusFrame.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.config.renderer()){\r\n\t\t\tthis.renderer = this.config.renderer();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.applyRenderersToDocument(this.document, this.config);\r\n\t\t\tthis.renderer = this.document.render;\r\n\t\t}\r\n\t}\r\n\tif(this.renderer && this.renderer.render){\r\n\t\treturn this.renderer.render(this.document);\r\n\t}\r\n\telse if(typeof this.renderer == \"function\"){\r\n\t\tvar x = this.renderer(this.document);\r\n\t\treturn x;\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"didna make it \");\r\n\t}\r\n}\r\n\r\n/*\r\n * adds render and compare functions to object frames\r\n */\r\nTerminusFrame.prototype.applyRenderersToDocument = function(doc, config){\r\n\tvar self = this;\r\n\tfunction onmatch(frame, rule){\r\n\t\tif(typeof rule.render != \"undefined\"){\r\n\t\t\tframe.render = rule.render;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(rule.renderer){\r\n\t\t\t\tvar renderer = self.loadRenderer(rule.renderer, frame, rule.args);\r\n\t\t\t}\r\n\t\t\tif(renderer && renderer.render){\r\n\t\t\t\tframe.render = renderer.render;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(rule.compare){\r\n\t\t\tframe.compare = rule.compare;\r\n\t\t}\r\n\t}\r\n\tvar xhz = config.json_rules();\r\n\tthis.document.filter(xhz, onmatch);\r\n}\r\n\r\nTerminusFrame.prototype.loadRenderer = function(rendname, frame, args){\r\n\tif(this.owner){\r\n\t\treturn this.owner.loadRenderer(rendname, frame, args);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = TerminusFrame ;\r\n","const TerminusUI = require('./TerminusUI');\r\nconst RenderingMap = require('./client/RenderingMap');\r\nmodule.exports={TerminusUI:TerminusUI,\r\n                RenderingMap:RenderingMap}\r\n","/**\r\n * Terminus UI object\r\n *\r\n * Traffic control of messages going between different Terminus UI pages and features\r\n *\r\n * @param opts - options array\r\n */\r\nconst ApiExplorer = require('./ApiExplorer');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst TerminusDBsdk = require('./TerminusDB');\r\nconst TerminusViolations = require('./html/TerminusViolation');\r\nconst TerminusQueryViewer = require('./TerminusQuery');\r\nconst TerminusSchemaViewer = require('./TerminusSchema');\r\nconst TerminusServersdk = require('./TerminusServer');\r\nconst TerminusURLLoader = require('./TerminusURL');\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst RenderingMap = require('./client/RenderingMap');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusUI(opts){\r\n\tthis.client = new TerminusClient.WOQLClient();\r\n\tthis.controls = [];\r\n\tthis.setOptions(opts);\r\n}\r\n\r\n/*\r\n * Client connects to specified server and specified part\r\n * opts is a json with the following fields:\r\n * server: mandatory URL of the server to connect to\r\n * key: optional client API key\r\n * dbid: id of the database to connect to\r\n * schema: if set, the UI will load the schema page after connecting\r\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\r\n * document: if set, the document page corresponding to this document will be loaded after connecting\r\n *\r\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\r\n */\r\nTerminusUI.prototype.connect = function(opts){\r\n\tvar self = this;\r\n\tthis.client.connectionConfig.server = false;\r\n\tvar key = ((opts && opts.key) ? opts.key : false);\r\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\r\n\treturn this.client.connect(opts.server, key)\r\n\t.then( function(response) {\r\n\t\tself.clearBusy();\r\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\r\n\t\t\tself.connectToDB(opts.db);\r\n\t\t\tif(opts.document && self.showView(\"get_document\")){\r\n\t\t\t\tresponse = self.showDocument(opts.document);\r\n\t\t\t}\r\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\r\n\t\t\t\tresponse = self.showSchemaPage(opts.schema);\r\n\t\t\t}\r\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\r\n\t\t\t\tself.showQueryPage(opts.query);\r\n\t\t\t}\r\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\r\n\t\t\t\tself.showExplorer(opts.explorer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showServerMainPage();\r\n\t\t}\r\n\t\tself.redraw();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(err) {\r\n\t\tself.clearBusy();\r\n\t\tself.showError(err);\r\n\t\tthrow(err);\r\n\t});\r\n}\r\n\r\n/**\r\n * Sends a request to create a new database to the server and interprets the response\r\n *\r\n * dbdets is a json object with the following fields:\r\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\r\n * title: the text name of the new database for tables, etc. mandatory\r\n * description: text description of the database (optional)\r\n * key: a API client key for server auth\r\n * schema: the url of another Terminus DB from which to import schema\r\n * instance: the url of another Terminus DB from which to import data\r\n *\r\n */\r\nTerminusUI.prototype.createDatabase = function(dbdets){\r\n\tvar self = this;\r\n\tif(!dbdets.id || !dbdets.title){\r\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\r\n\t}\r\n\tvar dbid = dbdets.id;\r\n\tvar myserver = this.client.connectionConfig.server;\r\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\r\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\r\n\treturn this.client.createDatabase(dbid, dbdoc)\r\n\t.then(function(response){ //import schema into newly created DB\r\n\t\tif(dbdets.schema){\r\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\r\n\t\t\tvar opts = (dbdets.key ?  {\"terminus:user_key\": dbdets.key } : {});\r\n\t\t\topts['terminus:encoding'] = \"terminus:turtle\";\r\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\r\n\t\t\t\tself.client.connectionConfig.server = myserver;\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tvar nopts = {'terminus:encoding':  \"terminus:turtle\"};\r\n\t\t\t\treturn self.client.updateSchema(false, response, nopts);\r\n\t\t\t})\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.clearBusy();\r\n\t\t\t\tself.redraw();\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.clearBusy();\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.then(function(response){ //reload list of databases in background..\r\n\t\treturn self.refreshDBList()\r\n\t\t.then(function(response){\r\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/**\r\n * Deletes the database with the passed id from the currently connected server\r\n */\r\nTerminusUI.prototype.deleteDatabase = function(dbid){\r\n\tvar self = this;\r\n\tvar delrec = this.client.connection.getDBRecord();\r\n\tvar lid = (dbid ? dbid : this.db());\r\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\r\n\tthis.showBusy(\"Deleting database \" + dbn);\r\n\treturn this.client.deleteDatabase(dbid)\r\n\t.then(function(response){\r\n\t\tself.clearBusy();\r\n\t\tself.client.connectionConfig.dbid = false;\r\n\t\tself.removeDB(dbid);\r\n\t\tself.showServerMainPage();\r\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\r\n\t\tself.refreshDBList();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Transforms a details (id, title, description) array into  json-ld document\r\n */\r\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\r\n\tvar doc = {\r\n\t\t\"@context\" : {\r\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\r\n\t\t},\r\n\t\t\"@type\": \"terminus:Database\"\r\n\t}\r\n\tif(dets.title){\r\n\t\tdoc['rdfs:label'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.title\r\n\t\t};\r\n\t}\r\n\tif(dets.description){\r\n\t\tdoc['rdfs:comment'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.description\r\n\t\t};\r\n\t}\r\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\r\n\treturn doc;\r\n}\r\n\r\nTerminusUI.prototype.getBadArguments = function(fname, str){\r\n\treturn \"Bad arguments to \" + fname + \": \" + str;\r\n}\r\n\r\nTerminusUI.prototype.getCrashString = function(fname, str){\r\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\r\n}\r\n\r\n/*\r\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\r\n */\r\nTerminusUI.prototype.load = function(url, key){\r\n\tvar args = {};\r\n\tif(url && url.indexOf(\"/document/\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\r\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\r\n\t}\r\n\telse if(url && url.indexOf(\"/schema\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\r\n\t\targs.schema = {};\r\n\t}\r\n\telse if(url && url.indexOf(\"/woql\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\r\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\r\n\t}\r\n\targs.server = url;\r\n\tif(key) args.key = key;\r\n\treturn this.connect(args);\r\n}\r\n\r\n/**\r\n * Fetches the DB URL from the url by chopping off the extra bits\r\n */\r\nTerminusUI.prototype.getConnectionEndpoint = function(url){\r\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/document\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nTerminusUI.prototype.server = function(){\r\n\treturn this.client.connectionConfig.server;\r\n}\r\n\r\nTerminusUI.prototype.db = function(){\r\n\treturn this.client.connectionConfig.dbid;\r\n}\r\n\r\nTerminusUI.prototype.clearServer = function(){\r\n\tthis.client.connectionConfig.server = false;\r\n}\r\n\r\nTerminusUI.prototype.connectToDB = function(dbid){\r\n\tthis.client.connectionConfig.dbid = dbid;\r\n\tTerminusClient.FrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\r\n\tTerminusClient.FrameHelper.standard_urls['scm'] = this.client.connectionConfig.dbURL() + \"/schema#\";\r\n}\r\n\r\nTerminusUI.prototype.clearDB = function(){\r\n\tthis.client.connectionConfig.dbid = false;\r\n}\r\n\r\nTerminusUI.prototype.removeDB = function(db, url){\r\n\tthis.client.connection.removeDB(db, url);\r\n}\r\n\r\nTerminusUI.prototype.getDBRecord = function(db, url){\r\n\treturn this.client.connection.getDBRecord(db, url);\r\n}\r\n\r\nTerminusUI.prototype.refreshDBList = function(){\r\n\tvar self = this;\r\n\treturn this.client.connect();\r\n}\r\n\r\nTerminusUI.prototype.showServerMainPage = function(){\r\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showLoadURLPage = function(val){\r\n\tthis.viewer = new TerminusURLLoader(this, val);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDBMainPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDBPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showSchemaPage = function(durl){\r\n\tthis.viewer = new TerminusSchemaViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showQueryPage = function(query){\r\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocumentPage = function(durl){\r\n    var opts = {};\r\n    opts.page_config = 'home';\r\n    this.viewer = new TerminusDocumentViewer(this, \"view\", opts);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\r\n\tconst promise = this.viewer.loadDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.showCreateDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\r\n\tconst promise = this.viewer.loadCreateDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.redrawMainPage = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.mainDOM);\r\n\tif(this.viewer && this.mainDOM){\r\n\t\tvar x = this.viewer.getAsDOM();\r\n\t\tthis.mainDOM.appendChild(x);\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showResult = function(response){\r\n\tthis.showMessage(response, \"success\");\r\n};\r\n\r\nTerminusUI.prototype.showError = function(response){\r\n\tthis.showMessage(response, \"error\");\r\n};\r\n\r\nTerminusUI.prototype.clearMessages = function(response){\r\n\tif(this.messages) TerminusClient.FrameHelper.removeChildren(this.messages);\r\n};\r\n\r\nTerminusUI.prototype.clearMainPage = function(){\r\n\tif(this.main) TerminusClient.FrameHelper.removeChildren(this.main);\r\n}\r\n\r\nTerminusUI.prototype.setMessageDOM = function(dom){\r\n\tthis.messages = dom;\r\n}\r\n\r\nTerminusUI.prototype.setbuttonControls = function(dom){\r\n\tthis.buttons = dom;\r\n}\r\n\r\nTerminusUI.prototype.setControllerDOM = function(dom){\r\n\tthis.controller = dom;\r\n}\r\n\r\nTerminusUI.prototype.setExplorerDOM = function(dom){\r\n\tthis.explorer = dom;\r\n}\r\n\r\nTerminusUI.prototype.setPluginsDOM = function(dom){\r\n\tthis.plugins = dom;\r\n}\r\n\r\nTerminusUI.prototype.setViewerDOM = function(dom){\r\n\tthis.mainDOM = dom;\r\n}\r\n\r\nTerminusUI.prototype.draw = function(comps, slocation){\r\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\r\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\r\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\r\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\r\n\tif(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\r\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\r\n\tif(this.plugins){\r\n\t\tthis.drawPlugins();\r\n\t}\r\n\tif(this.buttons){\r\n\t\tthis.toggleControl();\r\n\t}\r\n\tvar self = this;\r\n\tvar cdrawn = false;\r\n\tif(slocation && slocation.server){\r\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\r\n\t\t\treturn this.connect(slocation)\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tself.showLoadURLPage();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.showLoadURLPage();\r\n\t};\r\n}\r\n\r\n\r\n\r\nTerminusUI.prototype.redraw = function(msg){\r\n\tthis.clearMessages();\r\n\tif(this.controller){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.controller);\r\n\t\tthis.drawControls();\r\n\t}\r\n\tif(this.explorer){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.explorer);\r\n\t\t//this.drawExplorer();\r\n\t}\r\n\tif(this.viewer){\r\n\t\tthis.redrawMainPage();\r\n\t}\r\n\tif(msg) this.showMessage(msg);\r\n};\r\n\r\n\r\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\r\n    TerminusClient.FrameHelper.removeChildren(this.controller);\r\n    TerminusClient.FrameHelper.removeChildren(this.explorer);\r\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\r\n    widget.classList.add('terminus-dashboard-selected');\r\n}\r\n\r\nTerminusUI.prototype.toggleControl = function(){\r\n  var self = this;\r\n  this.buttons.client.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawControls();\r\n    self.showServerMainPage();\r\n  })\r\n  this.buttons.explorer.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawExplorer();\r\n  })\r\n}\r\n\r\nTerminusUI.prototype.drawControls = function(){\r\n\tthis.controls = [];\r\n\tthis.loadControls();\r\n\tfor(var i = 0; i<this.controls.length; i++){\r\n\t\tvar ncontrol = this.controls[i];\r\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\r\n\t\t\tthis.controller.appendChild(nd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawExplorer = function(){\r\n\tif(this.explorer){\r\n\t\tif(this.showControl(\"api_explorer\")){\r\n\t\t\tvar exp = new ApiExplorer(this);\r\n\t\t\tae = exp.getAsDOM();\r\n\t\t\tthis.explorer.appendChild(ae);\r\n\t\t\tthis.explorer.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.loadControls = function(){\r\n\tif(this.showControl('server')){\r\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\r\n\t\tif(sc) {\r\n\t\t\tthis.controls.push(sc);\r\n\t\t}\r\n\t\tif(this.db() && this.showControl(\"db\")){\r\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\r\n\t\t\tif(sc) this.controls.push(sc);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showControl = function(el){\r\n\tif(this.show_controls.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.showView = function(el){\r\n\tif(this.show_views.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.clearBusy = function(response){\r\n\tthis.clearMessages();\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\r\n}\r\n\r\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\r\n     var pd = document.createElement('div');\r\n     var pbc = document.createElement('div');\r\n     pbc.setAttribute('class', 'term-progress-bar-container');\r\n     pd.appendChild(pbc);\r\n\r\n     var pbsa = document.createElement('div');\r\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\r\n     pbc.appendChild(pbsa);\r\n     var pbia = document.createElement('span');\r\n     pbia.setAttribute('class', 'term-progress-bar-inner');\r\n     pbsa.appendChild(pbia);\r\n\r\n     bsyDom.appendChild(pd);\r\n}\r\n\r\nTerminusUI.prototype.showMessage = function(msg, type){\r\n\tif(this.messages){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tvar md = document.createElement('div');\r\n        switch(type){\r\n            case 'busy':\r\n                var msgHolder = document.createElement('div');\r\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\r\n                msgHolder.appendChild(document.createTextNode(msg));\r\n                md.appendChild(msgHolder);\r\n                this.getBusyLoader(md);\r\n            break;\r\n            case 'success':\r\n                md.setAttribute('class', 'terminus-show-msg-success');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n            case 'error':\r\n                md.setAttribute('class', 'terminus-show-msg-error');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n        }\r\n\t\tthis.messages.appendChild(md);\r\n\t}\r\n};\r\n\r\nTerminusUI.prototype.showViolations = function(vios, type){\r\n\tvar nvios = new TerminusViolations(vios, this);\r\n\tif(this.messages){\r\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showBusy = function(msg){\r\n\tthis.showMessage(msg, \"busy\");\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\r\n};\r\n\r\nTerminusUI.prototype.pseudoCapability = function(el){\r\n\tvar pseuds = [\"server\", \"db\", \"change-server\", \"api_explorer\", \"import_schema\", \"schema_format\"];\r\n\tif(pseuds.indexOf(el) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nTerminusUI.prototype.setOptions = function(opts){\r\n\tthis.show_controls = opts && opts.controls ? opts.controls :\r\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\r\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\r\n\t\t\t\"create_document\", \"get_document\", \"update_schema\",\r\n\t\t\t\"get_schema\", \"woql_select\"\r\n\t\t];\r\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\r\n\tif(opts.document){\r\n\t\tthis.document_options = opts.document;\r\n\t}\r\n\tif(opts.schema){\r\n\t\tthis.schema_options = opts.schema;\r\n\t}\r\n\tthis.piman = new TerminusPluginManager();\r\n\tvar self = this;\r\n\tthis.piman.init(opts.plugins, function(){\r\n\t\tvar pins = [\"gmaps\", \"quill\", \"select2\"];\r\n\t\tfor(var i = 0; i<pins.length; i++){\r\n\t\t\tif(self.piman.pluginAvailable(pins[i])){\r\n\t\t\t\tRenderingMap.addPlugin(pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.redraw();\r\n\t});\r\n\tif(opts.css && this.piman){\r\n\t\tthis.piman.loadPageCSS(opts.css);\r\n\t}\r\n\tthis.loadControls();\r\n}\r\n\r\nTerminusUI.prototype.pluginAvailable = function(p){\r\n\treturn this.piman.pluginAvailable(p);\r\n}\r\n\r\nTerminusUI.prototype.drawPlugins = function(){\r\n\tif(!this.piman) {\r\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\r\n\t\treturn false;\r\n\t}\r\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\r\n}\r\n\r\nTerminusUI.prototype.getDocViewerOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDocCreatorOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getClassFrameOptions = function(){\r\n\treturn this.viewdoc_options;\r\n}\r\n\r\nmodule.exports=TerminusUI\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\r\n */\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet apiNavConfig = {\r\n    mainNav: {\r\n        connect: {\r\n    \t\tnavText: 'Connect API',\r\n            action : 'connect',\r\n            icon   : 'link',\r\n            defaultSelected: true\r\n    \t},\r\n        database: {\r\n            navText: 'Database API',\r\n            action : 'create',\r\n            icon   : 'database'\r\n        },\r\n        schema: {\r\n            navText: 'Schema API',\r\n            action : 'schema',\r\n            icon   : 'cog'\r\n        },\r\n        document: {\r\n            navText: 'Document API',\r\n            action : 'document',\r\n            icon   : 'file'\r\n        },\r\n        query: {\r\n            navText: 'Query API',\r\n            action : 'query',\r\n            icon   : 'search'\r\n        }\r\n    },\r\n    subNav: {\r\n        database: {\r\n            createDatabase: {\r\n                navText: 'Create database',\r\n                action : 'create',\r\n                icon   : 'plus',\r\n                defaultSelected: true\r\n            },\r\n            deleteDatabase: {\r\n                navText: 'Delete database',\r\n                action : 'delete',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        schema: {\r\n            getSchema: {\r\n                navText: 'View Schema',\r\n                action : 'getSchema',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n            },\r\n            updateSchema: {\r\n                navText: 'Update Schema',\r\n                action : 'updateSchema',\r\n                icon   : 'arrow-up'\r\n            },\r\n            getClassFrames: {\r\n                navText: 'Get Class Frames',\r\n                action : 'getClassFrames',\r\n                icon   : 'share-alt'\r\n            }\r\n        },\r\n        document: {\r\n            viewDocument: {\r\n        \t\tnavText: 'View Document',\r\n                action : 'viewDocument',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n        \t},\r\n            createDocument: {\r\n                navText: 'Create Document',\r\n                action : 'createDocument',\r\n                icon   : 'plus'\r\n            },\r\n            updateDocument: {\r\n                navText: 'Update Document',\r\n                action : 'updateDocument',\r\n                icon   : 'arrow-up'\r\n            },\r\n            deleteDocument:{\r\n                navText: 'Delete Document',\r\n                action : 'deleteDocument',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        query: {\r\n            select: {\r\n                navText: 'Select',\r\n                action : 'select',\r\n                icon   : 'mouse-pointer',\r\n                defaultSelected: true\r\n            },\r\n            update: {\r\n                navText: 'Update',\r\n                action : 'update',\r\n                icon   : 'arrow-up'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction ApiExplorer(ui){\r\n    this.ui = ui;\r\n    this.viewer = ui.main;\r\n    this.client = new TerminusClient.WOQLClient();\r\n    this.client.use_fetch = true;\r\n    this.client.return_full_response = true;\r\n    this.pman = new TerminusPluginManager();\r\n}\r\n\r\n// Controller provides access to Api explorer functions\r\nApiExplorer.prototype.getAsDOM = function(){\r\n \tvar aec = document.createElement(\"div\");\r\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\r\n    if(this.ui){\r\n       this.getApiNav(aec, this.viewer); // nav\r\n       this.getApiExplorerDom('connect', this.viewer); // content dom\r\n    } // if this.ui\r\n    return aec;\r\n }\r\n\r\n/***** Api Nav bar *****/\r\n// Toggle selected nav bars\r\nApiExplorer.prototype.setSelectedNavMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    a.classList.add(\"terminus-selected\");\r\n}\r\n\r\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    nav.classList.add(\"terminus-selected\");\r\n    this.getApiExplorerDom(action, viewer);\r\n}\r\n\r\n// create nav bars\r\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.navOnSelect(navConfig.action, this, viewer);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(navConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// gets api nav bar\r\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\r\n    // list view of apis\r\n    var nav = document.createElement('div');\r\n    navDom.appendChild(nav);\r\n    // connect to server api\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul');\r\n    nav.appendChild(ul);\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.mainNav){\r\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\r\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    return navDom;\r\n} // getApiNav()\r\n\r\n/***** Api sub navs  *****/\r\n// get schema api explorer - nav bar, alert msg, headers ...\r\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\r\n    // clear of viewer\r\n    TerminusClient.FrameHelper.removeChildren(viewer);\r\n    // wrapper\r\n    var wrap = document.createElement('div');\r\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\r\n    viewer.appendChild(wrap);\r\n    var cont = document.createElement('div');\r\n    cont.setAttribute('class', 'container-fluid');\r\n    wrap.appendChild(cont);\r\n    var row = document.createElement('div');\r\n    row.setAttribute('class', 'row-fluid');\r\n    cont.appendChild(row);\r\n    var body = document.createElement('div');\r\n    body.setAttribute('class', 'terminus-module-body');\r\n    row.appendChild(body);\r\n    var api = document.createElement('div');\r\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\r\n    body.appendChild(api);\r\n    // body\r\n    var cont = document.createElement('div');\r\n    var self = this;\r\n    switch(view){\r\n        case 'connect':\r\n            var apiCont = self.getConnectExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'create':\r\n            var apiCont = self.getDatabaseExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'schema':\r\n            var apiCont = self.getSchemaApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'document':\r\n            var apiCont = self.getDocumentApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'query':\r\n            var apiCont = self.getQueryApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n    }// switch(api)\r\n    return wrap;\r\n} // getApiExplorerDom\r\n\r\n// on trigger of click event - change dom\r\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\r\n    TerminusClient.FrameHelper.removeChildren(body);\r\n    switch(curSubMenu){\r\n        case 'database':\r\n            var dom = this.getDatabaseDom(action, body);\r\n        break;\r\n        case 'schema':  // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'document': // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'query':\r\n            var dom = this.getQueryApiDom(action, body);\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Config');\r\n        break;\r\n    }\r\n    cont.appendChild(dom);\r\n}\r\n\r\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\r\n    UTILS.setSelectedSubMenu(subNav);\r\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\r\n}\r\n\r\n// create sub nav bars\r\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\r\n    // comment getclassframes for api explorer time being\r\n    if(subMenuConfig.action == 'getClassFrames') return;\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function() {\r\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(subMenuConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// get connect to server api calls - on click of connectAPI nav bar\r\nApiExplorer.prototype.getConnectExplorer = function(body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature('connect');\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get server url\r\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\r\n    //body.appendChild(form);\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.database){\r\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\r\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    // landing page\r\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDatabaseExplorer\r\n\r\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\r\nApiExplorer.prototype.getSchemaApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.schema){\r\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\r\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getSchemaApi\r\n\r\n// get document api calls - on click of DocumentAPI nav bar\r\nApiExplorer.prototype.getDocumentApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.document){\r\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\r\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDocumentApi\r\n\r\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\r\nApiExplorer.prototype.getQueryApi  = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.query){\r\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\r\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} //getQueryApi\r\n\r\n/***** Api Content view  *****/\r\n// get database dom\r\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature(mode);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get database id\r\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\r\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n//get create & delete db form\r\nApiExplorer.prototype.getServerForm = function(){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var inpLabel = document.createElement('label');\r\n  inpLabel.setAttribute('class', 'terminus-control-label');\r\n  inpLabel.setAttribute('for', 'basicinput');\r\n  inpLabel.innerHTML = 'Url:';\r\n  fd.appendChild(inpLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var inpId = document.createElement('input');\r\n  inpId.setAttribute('type', 'text');\r\n  inpId.setAttribute('id', 'basicinput');\r\n  inpId.setAttribute('class', 'terminus-input-text');\r\n  inpId.setAttribute('placeholder', 'URL : server_url');\r\n  if(this.val) inpId.value = this.val;\r\n  cd.appendChild(inpId);\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var keyLabel = document.createElement('label');\r\n  keyLabel.setAttribute('class', 'terminus-control-label');\r\n  keyLabel.setAttribute('for', 'basicinput');\r\n  keyLabel.innerHTML = 'Key:';\r\n  fd.appendChild(keyLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var key = document.createElement('input');\r\n  key.setAttribute('type', 'text');\r\n  key.setAttribute('id', 'basicinput');\r\n  key.setAttribute('class', 'span8 terminus-input-text');\r\n  key.setAttribute('placeholder', 'Key : key');\r\n  if(this.val) key.value = this.val;\r\n  cd.appendChild(key);\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  var gatherips = function(){\r\n    var input = {};\r\n    input.url = inpId.value;\r\n    input.key = key.value;\r\n    return input;\r\n  }\r\n  var resd = document.createElement('div');\r\n  form.appendChild(button);\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  button.addEventListener(\"click\", function(){\r\n    var buttonSelf = this;\r\n    //opts = {};\r\n    var input = gatherips();\r\n    self.client.connect(input.url, input.key)\r\n    .then(function(response){\r\n      TerminusClient.FrameHelper.removeChildren(resd);\r\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\r\n    });\r\n  }) // button click\r\n  return form;\r\n} // getServerForm()\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n  var body = document.createElement('div');\r\n  // list view of Databse tools\r\n  var ul = document.createElement('ul');\r\n  ul.setAttribute('class','terminus-ul-horizontal');\r\n  // loop over apiNavConfig\r\n  for (var key in apiNavConfig.subNav.database){\r\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\r\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n      }\r\n  } // for apiNavConfig\r\n  cont.appendChild(ul);\r\n  // landing page\r\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n  cont.appendChild(dom);\r\n  return cont;\r\n} // getDatabaseExplorer\r\n\r\n\r\n// get schema & document dom\r\nApiExplorer.prototype.getShowApiDom = function(action, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get input\r\n    switch(action){\r\n        case 'getSchema':\r\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'getClassFrames':\r\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'updateSchema':\r\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\r\n        break;\r\n        case 'viewDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'deleteDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'createDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'updateDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Call on form');\r\n        break;\r\n   }// switch(action)\r\n\r\n   return body;\r\n } // getShowApiDom()\r\n\r\n// get query api dom\r\nApiExplorer.prototype.getQueryApiDom = function(action, body){\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\r\n    return body;\r\n} // getQueryApiDom\r\n\r\n/*ApiExplorer.prototype.getClassFramesForm = function(){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\r\n    if(this.val) inpUrl.value = this.val;\r\n    cd.appendChild(inpUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url/ ID:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpDocUrl = document.createElement('input');\r\n    inpDocUrl.setAttribute('type', 'text');\r\n    inpDocUrl.setAttribute('id', 'basicinput');\r\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n    cd.appendChild(inpDocUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var optLabel = document.createElement('label');\r\n    optLabel.setAttribute('class', 'terminus-control-label');\r\n    optLabel.setAttribute('for', 'basicinput');\r\n    optLabel.innerHTML = 'Options:';\r\n    fd.appendChild(optLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var optInp = document.createElement('input');\r\n    optInp.setAttribute('type', 'text');\r\n    optInp.setAttribute('id', 'basicinput');\r\n    optInp.setAttribute('class', 'span8 terminus-input-text');\r\n    optInp.setAttribute('placeholder', 'options');\r\n    cd.appendChild(optInp);\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    var gatherips = function(){\r\n        var input = {};\r\n        input.url = inpUrl.value;\r\n        input.docUrl = inpDocUrl.value;\r\n        input.options = optInp.value;\r\n        return input;\r\n    }\r\n    var self = this;\r\n    button.addEventListener(\"click\", function(form){\r\n      var input = gatherips();\r\n      var buttonSelf = this;\r\n      opts = {};\r\n      opts.explorer = true;\r\n      self.client.getClassFrame(input.url, input.docUrl, opts)\r\n      .then(function(response){\r\n          var currForm = buttonSelf.parentNode;\r\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\r\n      });\r\n    }) // button click\r\n    form.appendChild(button);\r\n    return form;\r\n}   */\r\n\r\n// get form for all Apis\r\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\r\n    // form\r\n    var formDoc = document.createElement('form');\r\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var urlLabel = document.createElement('label');\r\n    urlLabel.setAttribute('class', 'terminus-control-label');\r\n    urlLabel.setAttribute('for', 'basicinput');\r\n    urlLabel.innerHTML = 'Url:';\r\n    fd.appendChild(urlLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\r\n    cd.appendChild(inpUrl);\r\n    // add extra form fields based on current api chosen\r\n    switch(curApi){\r\n        case 'getClassFrames':\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var docUrlLabel = document.createElement('label');\r\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\r\n            docUrlLabel.setAttribute('for', 'basicinput');\r\n            docUrlLabel.innerHTML = 'Url/ ID:';\r\n            fd.appendChild(docUrlLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpDocUrl = document.createElement('input');\r\n            inpDocUrl.setAttribute('type', 'text');\r\n            inpDocUrl.setAttribute('id', 'basicinput');\r\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n            cd.appendChild(inpDocUrl);\r\n        break;\r\n        case 'schema':\r\n            //encoding\r\n           /* var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var encLabel = document.createElement('label');\r\n            encLabel.setAttribute('class', 'terminus-control-label');\r\n            encLabel.setAttribute('for', 'basicinput');\r\n            encLabel.innerHTML = 'Encoding:';\r\n            fd.appendChild(encLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpEnc = document.createElement('select');\r\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\r\n            inpEnc.setAttribute('placeholder', 'turtle');\r\n            var optTurt = document.createElement('option');\r\n            optTurt.setAttribute('value', 'terminus:turtle');\r\n            optTurt.appendChild(document.createTextNode('turtle'));\r\n            inpEnc.appendChild(optTurt);\r\n            var optJld = document.createElement('option');\r\n            optJld.setAttribute('value', 'terminus:jsonld');\r\n            optJld.appendChild(document.createTextNode('jsonLD'));\r\n            inpEnc.appendChild(optJld);\r\n            cd.appendChild(inpEnc); */\r\n        break;\r\n    }\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var keyLabel = document.createElement('label');\r\n    keyLabel.setAttribute('class', 'terminus-control-label');\r\n    keyLabel.setAttribute('for', 'basicinput');\r\n    keyLabel.innerHTML = 'Key:';\r\n    fd.appendChild(keyLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpKey = document.createElement('input');\r\n    inpKey.setAttribute('type', 'text');\r\n    inpKey.setAttribute('id', 'basicinput');\r\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\r\n    inpKey.setAttribute('placeholder', 'Key');\r\n    cd.appendChild(inpKey);\r\n    if(!view){\r\n        // include text area only if call is type post\r\n        var fd = document.createElement('div');\r\n        fd.setAttribute('class', 'terminus-control-group');\r\n        formDoc.appendChild(fd);\r\n        var docLabel = document.createElement('label');\r\n        docLabel.setAttribute('class', 'terminus-control-label');\r\n        docLabel.setAttribute('for', 'basicinput');\r\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\r\n        docLabel.innerHTML = 'Document:';\r\n        fd.appendChild(docLabel);\r\n        var cd = document.createElement('div');\r\n        cd.setAttribute('class', 'terminus-controls');\r\n        fd.appendChild(cd);\r\n        var inpDoc = document.createElement('textarea');\r\n        cd.appendChild(inpDoc);\r\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\r\n        UTILS.stylizeEditor(this.ui, inpDoc, 'api-doc', 'javascript');\r\n    }\r\n    body.appendChild(formDoc);\r\n    // gather inputs\r\n    var inp ={};\r\n    inp.url = inpUrl;\r\n    inp.key = inpKey;\r\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\r\n    //if(curApi == 'schema') inp.enc = inpEnc;\r\n    if(!view) inp.doc = inpDoc;\r\n    var form = this.getApiSendButton(action, inp);\r\n    body.appendChild(form);\r\n}\r\n\r\n// define event listeners on send api of schema & documents\r\n\r\nApiExplorer.prototype.getApiForm = function(action, input){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  form.appendChild(button);\r\n  var resd = document.createElement('div');\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  switch(action){\r\n    case 'getSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        var buttonSelf = this;\r\n        self.client.getSchema(schurl, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        self.client.connectionConfig.connected_mode = false;\r\n        self.client.updateSchema(schurl, input.doc.value, opts)\r\n        .then(function(response){\r\n          var gtxtar = document.createElement('textarea');\r\n          gtxtar.setAttribute('readonly', true);\r\n          gtxtar.innerHTML = response;\r\n          var currForm = buttonSelf.parentNode;\r\n          currForm.appendChild(gtxtar);\r\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'viewDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      opts.format = 'turtle';\r\n      self.client.getDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'deleteDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      self.client.deleteDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'createDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        self.client.createDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts.editmode = 'replace';\r\n        opts.format = 'json';\r\n        self.client.updateDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n  } // switch(action)\r\n\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n\r\n  return form;\r\n} // getApiForm()\r\n\r\n\r\n// define event listeners on send api of schema & documents\r\nApiExplorer.prototype.getApiSendButton = function(action, input){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    form.appendChild(button);\r\n    var resd = document.createElement('div');\r\n    form.appendChild(resd);\r\n    var self = this;\r\n    switch(action){\r\n        case 'connect':\r\n            button.addEventListener(\"click\", function(){\r\n                self.client.connect(input.url.value, input.key.value)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n            }) // button click\r\n        break;\r\n        case 'create':\r\n            button.addEventListener(\"click\", function(form){\r\n              self.client.createDatabase(input.url.value, JSON.parse(input.doc.value), input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        case 'delete':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts ={}\r\n              self.client.deleteDatabase(input.url.value, input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break\r\n        case 'getSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var schurl = input.url.value;\r\n                self.client.getSchema(schurl, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'updateSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var payload = input.doc.value;\r\n                var schurl = input.url.value;\r\n                self.client.connectionConfig.connected_mode = false;\r\n                self.client.updateSchema(schurl, input.doc.value, opts)\r\n                //self.client.updateSchema(schurl, input.doc.value, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'getClassFrames':\r\n            button.addEventListener(\"click\", function(form){\r\n                var schurl = input.url.value;\r\n                opts = {};\r\n                opts.explorer = true;\r\n                self.client.getClassFrame(input.url, JSON.parse(input.docUrl.value), opts)\r\n                .then(function(response){\r\n                    var currForm = buttonSelf.parentNode;\r\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'viewDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.getDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t    TerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n        }) // button click\r\n        break;\r\n        case 'deleteDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.deleteDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n          }) // button click\r\n        break;\r\n        case 'createDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var payload = input.doc.value;\r\n              opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.createDocument(dcurl, JSON.parse(payload), opts)\r\n              .then(function(response){\r\n            \t   TerminusClient.FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n          }) // button click\r\n        break;\r\n        case 'updateDocument':\r\n          button.addEventListener(\"click\", function(){\r\n            var dcurl = input.url.value;\r\n            var payload = input.doc.value;\r\n            var buttonSelf = this;\r\n            opts = {};\r\n            opts['terminus:encoding'] = \"jsonld\";\r\n            opts['terminus:user_key'] = input.key.value;\r\n            self.client.updateDocument(dcurl, JSON.parse(payload), opts)\r\n            .then(function(response){\r\n            \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n            });\r\n          }) // button click\r\n        break;\r\n        case 'select':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts.key = input.key.value;\r\n                var doc = JSON.parse(input.doc.value);\r\n                self.client.select(input.url.value, doc, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'update':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              var doc = JSON.parse(input.doc.value);\r\n              self.client.update(input.url.value, doc, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        default:\r\n            console.log('Invalid Api call on button');\r\n        break;\r\n    } // switch(action)\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    return form;\r\n} // getApiSendButton()\r\n\r\n// get signature of api calls\r\nApiExplorer.prototype.getSignature = function(action){\r\n    var api = document.createElement('div');\r\n    // get header signature\r\n    var sg = document.createElement('button');\r\n    sg.appendChild(document.createTextNode('Click to read API Signature'));\r\n    sg.setAttribute('class', 'terminus-collapsible');\r\n    ic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n    sg.appendChild(ic);\r\n    api.appendChild(sg);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    var cl = document.createElement('div');\r\n    cl.setAttribute('class', 'terminus-collapsible-content content');\r\n    var sig = UTILS.getFunctionSignature(action);\r\n    var txt = document.createTextNode(sig.spec);\r\n    var pre = document.createElement('pre');\r\n    pre.setAttribute('class', 'terminus-api-signature-pre');\r\n    pre.appendChild(txt);\r\n    var txt =  document.createTextNode(sig.descr);\r\n    pre.appendChild(txt);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var txt = document.createTextNode(sig.result);\r\n    pre.appendChild(txt);\r\n    cl.appendChild(pre);\r\n    api.appendChild(cl);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    sg.addEventListener('click', function(){\r\n        UTILS.tolggleContent(ic, cl);\r\n    });\r\n    return api;\r\n} // getSignature()\r\n\r\n// displays signature only on click\r\nfunction tolggleSignatureContent(content){\r\n    if (content.style.display === \"block\")\r\n        content.style.display = \"none\";\r\n    else content.style.display = \"block\";\r\n}\r\n\r\nmodule.exports=ApiExplorer\r\n","\nconst CONST = require('./const');\nconst DispatchRequest = require('./dispatchRequest');\nconst ErrorMessage = require('./errorMessage');\nconst ConnectionCapabilities = require('./connectionCapabilities');\nconst ConnectionConfig = require('./connectionConfig');\nconst UTILS = require('./utils.js');\n\n/**\n * @file Javascript WOQL client object\n * @license Apache Version 2\n * @summary Simple Javascript Client for accessing the Terminus DB API\n */\n\n/**\n  * @param {Object} params\n  */\nfunction WOQLClient(params) {\n\t// current connection context variables\n\tconst key = params ? params.key : undefined;\n\tthis.use_fetch = false;\n\tthis.return_full_response = false;\n\tthis.connectionConfig = new ConnectionConfig(params);\n\tthis.connection = new ConnectionCapabilities(this.connectionConfig, key);\n}\n\nWOQLClient.CONST = CONST;\n\n/**\n * Connect to a Terminus server at the given URI with an API key\n * Stores the terminus:ServerCapability document returned\n * in the connection register which stores, the url, key, capabilities,\n * and database meta-data for the connected server\n *\n * If the curl argument is false or null,\n * this.connectionConfig.server will be used if present,\n * or the promise will be rejected.\n\n * @param  {string} curl Terminus server URI\n * @param  {string} API  key\n * @return {Promise}\n * @public\n */\nWOQLClient.prototype.connect = function (curl, key) {\n\tif (curl && !this.connectionConfig.setServer(curl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(curl, CONST.CONNECT))\n\t\t);\n\t}\n\tconst serverURL = this.connectionConfig.serverURL();\n\tif (key) {\n\t\tthis.connection.setClientKey(serverURL, key);\n\t}\n\t// unset the current server setting until successful connect\n\tthis.connectionConfig.server = false;\n\tconst self = this;\n\treturn this.dispatch(serverURL, CONST.CONNECT).then((response) => {\n\t\tself.connectionConfig.server = serverURL;\n\t\tself.connection.addConnection(serverURL, response);\n\t\treturn response;\n\t});\n};\n\n/**\n * Create a Terminus Database by posting\n * a terminus:Database document to the Terminus API\n *\n * The dburl argument can be\n *    1) a valid URL of a terminus database or\n *    2) a valid Terminus database id or\n *    3) can be omitted\n * \t\tin case 2) the current server will be used,\n * \t\tin case 3) the database id will be set from the @id field of the terminuse:Database document.\n *\n * The second (details) argument contains a terminus:Database document\n * with a mandatory rdfs:label field and an optional rdfs:comment field.\n * The third (key) argument contains an optional API key\n *\n * @param {string} dburl Terminus server URI or a TerminusID\n * @param {object} details\n * @param {string} key\n * @return {Promise}\n * @public\n */\nWOQLClient.prototype.createDatabase = function (dburl, details, key) {\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Create Database'))\n\t\t);\n\t}\n\tif (\n\t\tdetails\n    && details['@id']\n    && !this.connectionConfig.setDB(details['@id'], details['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(details['@id'], 'Create Database'))\n\t\t);\n\t}\n\tdetails = this.makeDocumentConsistentWithURL(details, this.connectionConfig.dbURL());\n\n\tconst opts = {};\n\tif (key) {\n\t\topts.key = key;\n\t}\n\tconst doc = this.addOptionsToDocument(details, opts);\n\treturn this.dispatch(this.connectionConfig.dbURL('create'), CONST.CREATE_DATABASE, doc);\n};\n\n/**\n * Delete a Database\n * @param {String} dburl it is a terminusDB Url or a terminusDB Id\n * @param {String} key an optional API key\n * @return {Promise}\n *\n * if dburl is omitted, the current server and database will be used\n */\nWOQLClient.prototype.deleteDatabase = function (dburl, key) {\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Delete Database'))\n\t\t);\n\t}\n\tconst opts = {};\n\n\tif (key) {\n\t\topts.key = key;\n\t}\n\n\tconst self = this;\n\treturn this.dispatch(`${this.connectionConfig.dbURL()}`, CONST.DELETE_DATABASE, opts).then(\n\t\t(response) => {\n\t\t\tself.connection.removeDB();\n\t\t\treturn response;\n\t\t}\n\t);\n};\n\n/**\n * Retrieves the schema of the specified database\n *\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\n * @param {object} opts is an options object\n * @return {Promise}\n *\n * opts.format is optional and defines which format is requested (*json / turtle)\n * opts.key is an optional API key\n */\nWOQLClient.prototype.getSchema = function (schurl, opts) {\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Get Schema'))\n\t\t);\n\t}\n\t// consoleco.log('schemaURL', this.connectionConfig.schemaURL());\n\treturn this.dispatch(this.connectionConfig.schemaURL(), CONST.GET_SCHEMA, opts);\n};\n\n/**\n * Updates the Schema of the specified database\n *\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\n * @param {object} doc is a valid owl ontology in json-ld or turtle format\n * @param {object} opts is an options object\n * @return {Promise}\n *\n * if omitted the current server and database will be used\n * opts.format is used to specify which format is being used (*json / turtle)\n * opts.key is an optional API key\n */\nWOQLClient.prototype.updateSchema = function (schurl, doc, opts) {\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Update Schema'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(doc, opts);\n\treturn this.dispatch(this.connectionConfig.schemaURL(), 'update_schema', doc);\n};\n\n/**\n * Creates a new document in the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus database (an id will be randomly assigned) or\n * 2) a valid URL or of a terminus document (the document will be given the passed URL) or\n * 3) a valid terminus document id (the current server and database will be used)\n * 4) can be omitted (the URL will be taken from the document if present)\n * The second argument (doc) is a valid document in json-ld\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.createDocument = function (docurl, doc, opts) {\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Create Document'))\n\t\t);\n\t} if (\n\t\tdoc\n    && doc['@id']\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Create Document'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\n\t\topts\n\t);\n\treturn this.dispatch(this.connectionConfig.docURL(), 'create_document', doc);\n};\n\n/**\n * Retrieves a document from the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database\n * the second argument (opts) is an options json -\n * \t\topts.key is an optional API key\n * \t\topts.shape is frame | *document\n */\nWOQLClient.prototype.getDocument = function (docurl, opts) {\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Get Document'))\n\t\t);\n\t}\n\treturn this.dispatch(this.connectionConfig.docURL(), 'get_document', opts);\n};\n\n/**\n * Updates a document in the specified database with a new version\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database or\n * 3) omitted in which case the id will be taken from the document @id field\n * the second argument (doc) is a document in json-ld format\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.updateDocument = function (docurl, doc, opts) {\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Update Document'))\n\t\t);\n\t}\n\tif (doc && doc['@id']\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Update Document'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\n\t\topts\n\t);\n\treturn this.dispatch(this.connectionConfig.docURL(), 'update_document', doc);\n};\n\n/**\n * Deletes a document from the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database\n * 3) omitted - the current document will be used\n * the second argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.deleteDocument = function (docurl, opts) {\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Delete Document'))\n\t\t);\n\t}\n\treturn this.dispatch(this.connectionConfig.docURL(), 'delete_document', opts);\n};\n\n/**\n * Executes a read-only WOQL query on the specified database and returns the results\n *\n * @param {string} qurl TerminusDB server URL or omitted (the current DB will be used)\n * @param {string} woql is a \"woql query select statement\"\n * @param {object} opts it can contents the API key (opts.key)\n *\n */\nWOQLClient.prototype.select = function (qurl, woql, opts) {\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Select'))\n\t\t);\n\t}\n\tlet q = { 'terminus:query': JSON.stringify(woql) };\n\tq = this.addOptionsToWOQL(q, opts);\n\treturn this.dispatch(this.connectionConfig.queryURL(), CONST.WOQL_SELECT, q);\n};\n\n/**\n * Executes a WOQL query on the specified database which updates the state and returns the results\n *\n * The first (qurl) argument can be\n * 1) a valid URL of a terminus database or\n * 2) omitted - the current database will be used\n * the second argument (woql) is a woql select statement encoded as a string\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.update = function (qurl, woql, opts) {\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Update'))\n\t\t);\n\t}\n\twoql = this.addOptionsToWOQL(woql, opts);\n\treturn this.dispatch(this.connectionConfig.queryURL(), 'woql_update', woql);\n};\n\n/**\n * Retrieves a WOQL query on the specified database which updates the state and returns the results\n *\n * The first (cfurl) argument can be\n * 1) a valid URL of a terminus database or\n * 2) omitted - the current database will be used\n * the second argument (cls) is the URL / ID of a document class that exists in the database schema\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.getClassFrame = function (cfurl, cls, opts) {\n\tif (cfurl && !this.connectionConfig.setClassFrameURL(cfurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(cfurl, 'Get Class Frame'))\n\t\t);\n\t}\n\tif (!opts) opts = {};\n\topts['terminus:class'] = cls;\n\treturn this.dispatch(this.connectionConfig.frameURL(), 'class_frame', opts);\n};\n\n/*\n * Utility functions for adding standard fields to API arguments\n */\nWOQLClient.prototype.addOptionsToWOQL = function (woql, opts) {\n\tif (opts && opts.key) {\n\t\twoql.key = opts.key;\n\t}\n\treturn woql;\n};\n\nWOQLClient.prototype.addOptionsToDocument = function (doc, opts) {\n\tconst pdoc = {};\n\tpdoc['@context'] = doc['@context'];\n\tif (pdoc['@context'] && doc['@id']) { // add blank node prefix as document base url\n\t\tpdoc['@context']._ = `${doc['@id']}/`;\n\t}\n\tif (opts && opts['terminus:encoding'] && opts['terminus:encoding'] === 'terminus:turtle') {\n\t\tpdoc['terminus:turtle'] = doc;\n\t\tpdoc['terminus:schema'] = this.connectionConfig.schemaURL();\n\t\tdelete pdoc['terminus:turtle']['@context'];\n\t} else {\n\t\tpdoc['terminus:document'] = doc;\n\t\tdelete pdoc['terminus:document']['@context'];\n\t}\n\tpdoc['@type'] = 'terminus:APIUpdate';\n\tif (opts && opts['terminus:user_key']) {\n\t\tpdoc['terminus:user_key'] = opts['terminus:user_key'];\n\t}\n\tif (opts && opts.key) {\n\t\tpdoc['terminus:user_key'] = opts.key;\n\t}\n\treturn pdoc;\n};\n\nWOQLClient.prototype.addKeyToPayload = function (payload, url) {\n\tif (typeof payload !== 'object')payload = {};\n\tif (payload.key) {\n\t\tpayload['terminus:user_key'] = payload.key;\n\t\tdelete payload.key;\n\t} else if (this.connection.getClientKey()) {\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey();\n\t} else if (this.connection.getClientKey(url)) {\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey(url);\n\t}\n\treturn payload;\n};\n\nWOQLClient.prototype.makeDocumentConsistentWithURL = function (doc, dburl) {\n\tdoc['@id'] = dburl;\n\treturn doc;\n};\n\nWOQLClient.prototype.dispatch = function (url, action, payload) {\n\tif (this.connectionConfig.includeKey()) {\n\t\tpayload = this.addKeyToPayload(payload, url);\n\t}\n\tif (this.use_fetch) {\n\t\treturn this.dispatchFetch(url, action, payload);\n\t}\n\treturn DispatchRequest(url, action, payload);\n};\n\n\nWOQLClient.prototype.dispatchFetch = function (url, action, payload) {\n\tconst api = {\n\t\tmode: 'cors', // no-cors, cors, *same-origin\n\t\tredirect: 'follow', // manual, *follow, error\n\t\treferrer: 'client', // no-referrer, *client\n\t};\n\tlet hdrs = {};\n\tif (this.connectionConfig.platformEndpoint()) {\n\t\tapi.credentials = 'include'; // include, *same-origin, omit\n\t}\n\tif (payload && payload['terminus:user_key']) {\n\t\thdrs = { Authorization: `Basic ${btoa(`:${payload['terminus:user_key']}`)}` };\n\t\tdelete (payload['terminus:user_key']);\n\t}\n\t// read only API calls - use GET\n\tswitch (action) {\n\tcase CONST.DELETE_DATABASE:\n\tcase CONST.DELETE_DOCUMENT:\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\n\t\tapi.method = 'DELETE';\n\t\tapi.cache = 'no-cache';\n\t\tbreak;\n\tcase CONST.CREATE_DATABASE:\n\tcase CONST.UPDATE_SCHEMA:\n\tcase CONST.CREATE_DOCUMENT:\n\tcase CONST.UPDATE_DOCUMENT:\n\tcase CONST.WOQL_UPDATE:\n\t\tapi.method = 'POST';\n\t\tapi.cache = 'no-cache';\n\t\thdrs['Content-Type'] = 'application/json';\n\t\tapi.body = JSON.stringify(payload);\n\t\tbreak;\n\tcase CONST.GET_SCHEMA:\n\tcase CONST.CONNECT:\n\tcase CONST.CLASS_FRAME:\n\tcase CONST.WOQL_SELECT:\n\tcase CONST.GET_DOCUMENT:\n\tdefault:\n\t\tapi.method = 'GET';\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\n\t}\n\tconst self = this;\n\tif (Object.keys(hdrs).length > 0) {\n\t\tapi.headers = new Headers(hdrs);\n\t}\n\treturn fetch(url, api).then((response) => {\n\t\tif (self.return_full_response) return response;\n\t\tif (response.ok) {\n\t\t\treturn response.json();\n\t\t}\n\t\tself.error = self.parseAPIError(response);\n\t\treturn Promise.reject(new Error(self.getAPIErrorMessage(url, api, self.error)));\n\t});\n};\n\nmodule.exports = WOQLClient;\n","const axios = require('axios');\nconst UTILS = require('./utils.js');\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n/*\nAccess-Control-Allow-Credentials   true\nAccess-Control-Allow-Headers  X-PINGOTHER, Content-Type\nAccess-Control-Allow-Methods GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS\nAccess-Control-Allow-Origin: http://localhost:3000 // WILD CARD WILL NOT WORK WHEN POSTING\n*/\n\nfunction btoaImplementation(str) {\n\ttry {\n\t\treturn btoa(str);\n\t} catch (err) {\n\t\t// console.log('in buffer')\n\t\treturn Buffer.from(str).toString('base64');\n\t}\n}\n\nfunction DispatchRequest(url, action, payload) {\n\t/*\n\t*CORS is only required when trying to fetch data from a browser,\n\t*as browsers by default will block requests to different origins\n\t*/\n\tconst options = {\n\t\tmode: 'cors', // no-cors, cors, *same-origin\n\t\tredirect: 'follow', // manual, *follow, error\n\t\treferrer: 'client',\n\t\t// url:url,\n\t\t// no-referrer, *client\n\t};\n\tif (payload && payload['terminus:user_key']) {\n\t\toptions.headers = { Authorization: `Basic ${btoaImplementation(`:${payload['terminus:user_key']}`)}` };\n\t\tdelete (payload['terminus:user_key']);\n\t}\n\n\tswitch (action) {\n\tcase CONST.DELETE_DATABASE:\n\tcase CONST.DELETE_DOCUMENT:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.delete(url, options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\tcase CONST.CREATE_DATABASE:\n\tcase CONST.UPDATE_SCHEMA:\n\tcase CONST.CREATE_DOCUMENT:\n\tcase CONST.UPDATE_DOCUMENT:\n\tcase CONST.WOQL_UPDATE:\n\t\toptions.headers = options.headers ? options.headers : {};\n\t\toptions.headers['Content-Type'] = 'application/json';\n\t\treturn axios.post(url, JSON.stringify(payload), options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tconst e = new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t\tif (err.response && err.response.data) e.data = err.response.data;\n\t\t\t\tthrow e;\n\t\t\t});\n\tcase CONST.GET_SCHEMA:\n\tcase CONST.CONNECT:\n\tcase CONST.CLASS_FRAME:\n\tcase CONST.WOQL_SELECT:\n\tcase CONST.GET_DOCUMENT:\n\tdefault:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.get(url, options)\n\t\t\t.then((response => response.data))\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\t}\n}\n\nmodule.exports = DispatchRequest;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = require('./lib/axios');","'use strict';\n\nvar utils = require('./utils');\nvar bind = require('./helpers/bind');\nvar Axios = require('./core/Axios');\nvar mergeConfig = require('./core/mergeConfig');\nvar defaults = require('./defaults');\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = require('./cancel/Cancel');\naxios.CancelToken = require('./cancel/CancelToken');\naxios.isCancel = require('./cancel/isCancel');\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = require('./helpers/spread');\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","'use strict';\n\nvar utils = require('./../utils');\nvar buildURL = require('../helpers/buildURL');\nvar InterceptorManager = require('./InterceptorManager');\nvar dispatchRequest = require('./dispatchRequest');\nvar mergeConfig = require('./mergeConfig');\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = arguments[1] || {};\n    config.url = arguments[0];\n  } else {\n    config = config || {};\n  }\n\n  config = mergeConfig(this.defaults, config);\n  config.method = config.method ? config.method.toLowerCase() : 'get';\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\nAxios.prototype.getUri = function getUri(config) {\n  config = mergeConfig(this.defaults, config);\n  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\\?/, '');\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n","'use strict';\n\nvar utils = require('./../utils');\nvar transformData = require('./transformData');\nvar isCancel = require('../cancel/isCancel');\nvar defaults = require('../defaults');\nvar isAbsoluteURL = require('./../helpers/isAbsoluteURL');\nvar combineURLs = require('./../helpers/combineURLs');\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Support baseURL config\n  if (config.baseURL && !isAbsoluteURL(config.url)) {\n    config.url = combineURLs(config.baseURL, config.url);\n  }\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers || {}\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n","'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n","'use strict';\n\nvar createError = require('./createError');\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  if (!validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n","'use strict';\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n\n  error.request = request;\n  error.response = response;\n  error.isAxiosError = true;\n\n  error.toJSON = function() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: this.config,\n      code: this.code\n    };\n  };\n  return error;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n    (function standardBrowserEnv() {\n      var msie = /(msie|trident)/i.test(navigator.userAgent);\n      var urlParsingNode = document.createElement('a');\n      var originURL;\n\n      /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n      function resolveURL(url) {\n        var href = url;\n\n        if (msie) {\n        // IE needs attribute set twice to normalize properties\n          urlParsingNode.setAttribute('href', href);\n          href = urlParsingNode.href;\n        }\n\n        urlParsingNode.setAttribute('href', href);\n\n        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n        return {\n          href: urlParsingNode.href,\n          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n          host: urlParsingNode.host,\n          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n          hostname: urlParsingNode.hostname,\n          port: urlParsingNode.port,\n          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n            urlParsingNode.pathname :\n            '/' + urlParsingNode.pathname\n        };\n      }\n\n      originURL = resolveURL(window.location.href);\n\n      /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n      return function isURLSameOrigin(requestURL) {\n        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n        return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n      };\n    })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return function isURLSameOrigin() {\n        return true;\n      };\n    })()\n);\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n    (function standardBrowserEnv() {\n      return {\n        write: function write(name, value, expires, path, domain, secure) {\n          var cookie = [];\n          cookie.push(name + '=' + encodeURIComponent(value));\n\n          if (utils.isNumber(expires)) {\n            cookie.push('expires=' + new Date(expires).toGMTString());\n          }\n\n          if (utils.isString(path)) {\n            cookie.push('path=' + path);\n          }\n\n          if (utils.isString(domain)) {\n            cookie.push('domain=' + domain);\n          }\n\n          if (secure === true) {\n            cookie.push('secure');\n          }\n\n          document.cookie = cookie.join('; ');\n        },\n\n        read: function read(name) {\n          var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n          return (match ? decodeURIComponent(match[3]) : null);\n        },\n\n        remove: function remove(name) {\n          this.write(name, '', Date.now() - 86400000);\n        }\n      };\n    })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return {\n        write: function write() {},\n        read: function read() { return null; },\n        remove: function remove() {}\n      };\n    })()\n);\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n","'use strict';\n\nvar Cancel = require('./Cancel');\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n","/**\r\n * Represents a frame for programmatic access to object frame, anywhere within a document\r\n * Recursive data structure where this.children contains an indexed array of object frames\r\n * and this.dataframes contains a property indexed array of data frames\r\n * Every object frame carries a reference to its classframe\r\n * This gives us instructions as to how to create new frames according to the schema\r\n * After that it's turtles all the way down.\r\n * @param cls - ID of the class (URL)\r\n * @param classframe - an array of frames representing a class\r\n * @param archetypes list of class frames\r\n * @param parent parent object\r\n * @returns\r\n */\r\nconst FrameHelper = require('./frameHelper');\r\nconst FramePattern = require('./framePattern');\r\n\r\nfunction ObjectFrame(cls, dataframes, classframes, parent, parentframe) {\r\n\t// the class of the frame - mandatory\r\n\tthis.empty();\r\n\tthis.cls = cls;\r\n\r\n\t// array of frames representing the full class frame\r\n\t// (optional - required to be able to safely add missing properties)\r\n\tif (classframes && typeof classframes === 'object') {\r\n\t\tthis.loadClassFrames(classframes);\r\n\t}\r\n\tif (dataframes && typeof dataframes === 'object') {\r\n\t\tthis.originalFrames = dataframes;\r\n\t\tthis.loadDataFrames(dataframes);\r\n\t} else {\r\n\t\tthis.originalFrames = false;\r\n\t}\r\n\t// parent object frame\r\n\tthis.parent = parent;\r\n\t// original frame used by parent to create me\r\n\tthis.parentframe = parentframe;\r\n\t// set to true if this is a newly created document\r\n\tthis.newDoc = false;\r\n}\r\n\r\n/**\r\n * Loads class frames for the object's class - the instructions about how to put an object together\r\n */\r\nObjectFrame.prototype.loadClassFrames = function (classframes) {\r\n\tfor (let j = 0; j < classframes.length; j += 1) {\r\n\t\tif (classframes[j]['@context']) this.jsonld_context = classframes[j]['@context'];\r\n\r\n\t\tconst cf = new ClassFrame(classframes[j]);\r\n\t\tif (cf.isValid()) {\r\n\t\t\tif (typeof this.classframes[classframes[j].property] === 'undefined') {\r\n\t\t\t\tthis.classframes[classframes[j].property] = [];\r\n\t\t\t}\r\n\t\t\tthis.classframes[classframes[j].property] = cf;\r\n\t\t\tif (cf.isObject() && this.properties[classframes[j].property]) {\r\n\t\t\t\tfor (let i = 0; i < this.properties[classframes[j].property].values.length; i += 1) {\r\n\t\t\t\t\tthis.properties[classframes[j].property].values[i].loadClassFrames(classframes[j].frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/**\r\n * Does this object have a schema loaded?\r\n */\r\nObjectFrame.prototype.hasSchema = function () {\r\n\treturn !FrameHelper.empty(this.classframes);\r\n};\r\n\r\n/*\r\n * Loads an array of data frames into the object's internal index\r\n * {property: [frames]}\r\n */\r\nObjectFrame.prototype.loadDataFrames = function (frames) {\r\n\tif (typeof frames !== 'object' || !frames.length) return undefined;\r\n\tif (!this.originalFrames) this.originalFrames = frames;\r\n\tif (!this.subjid && frames[0].domainValue) this.subjid = frames[0].domainValue;\r\n\tfor (let i = 0; i < frames.length; i += 1) {\r\n\t\tif (frames[i]['@context']) this.jsonld_context = frames[i]['@context'];\r\n\t\tlet cframe = this.getPropertyClassFrame(frames[i].property, frames[i]);\r\n\t\tif (cframe.isClassChoice()) {\r\n\t\t\tcframe = cframe.getChosenClassFrame(frames[i].range);\r\n\t\t\tif (!cframe) {\r\n\t\t\t\tconsole.log(`no choice frame ${frames[i].range}`);\r\n\t\t\t}\r\n\t\t} else if (cframe.isLogic()) {\r\n\t\t\tcframe = cframe.getChosenFrame(frames[i]);\r\n\t\t}\r\n\t\tif (cframe) {\r\n\t\t\tif (typeof this.properties[frames[i].property] === 'undefined') {\r\n\t\t\t\tthis.properties[frames[i].property] = new PropertyFrame(frames[i].property, cframe, this);\r\n\t\t\t}\r\n\t\t\tthis.properties[frames[i].property].addFrame(frames[i]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Serialises the javascript object as an array of frames\r\n */\r\nObjectFrame.prototype.getAsFrame = function (prop, parent) {\r\n\tif (this.parentframe) return this.parentframe;\r\n\tconst ff = { type: 'objectProperty', property: prop };\r\n\tff.range = this.cls;\r\n\tff.domain = parent.cls;\r\n\tff.domainValue = parent.subjid;\r\n\tff.frame = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tff.frame = ff.frame.concat(ff.frame, this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn ff;\r\n};\r\n\r\nObjectFrame.prototype.isnew = function () {\r\n\treturn this.newDoc;\r\n};\r\n\r\n/**\r\n * Cleans out object and sets everything empty\r\n */\r\nObjectFrame.prototype.empty = function () {\r\n\t// all indexed by property\r\n\tthis.properties = {};\r\n\tthis.restrictions = {};\r\n\tthis.subjid = false;\r\n\tthis.cls = false;\r\n};\r\n\r\n/*\r\n * Resets object state to original state\r\n */\r\nObjectFrame.prototype.reset = function (prop) {\r\n\tif (prop) {\r\n\t\tconst props = [];\r\n\t\tfor (let i = 0; i < this.originalFrames.length; i += 1) {\r\n\t\t\tif (this.originalFrames[i].property === prop) {\r\n\t\t\t\tprops.push(this.originalFrames[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.properties[prop]) this.properties[prop] = [];\r\n\t\tthis.loadDataFrames(props);\r\n\t} else {\r\n\t\tthis.restrictions = {};\r\n\t\tthis.properties = {};\r\n\t\tthis.loadDataFrames(this.originalFrames);\r\n\t}\r\n};\r\n\r\n/*\r\n * Clears out any specific information from a tree\r\n */\r\nObjectFrame.prototype.clear = function () {\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.properties[prop].clear();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Filters the frame and its children\r\n */\r\nObjectFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (!!(options && options.ignore_failure));\r\n\tconst hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\tif (hits.length || cascading) {\r\n\t\tfor (const prop of Object.keys(this.properties)) {\r\n\t\t\tthis.properties[prop].filter(rules, onmatch, options);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n\r\n/**\r\n * If a class frame is present, it is returned for the given property\r\n * If no class frame is present and an instance frame is passed in the\r\n * this enables make it up as you go along editing\r\n * second argument a class frame will be created from the instance frame.\r\n */\r\nObjectFrame.prototype.getPropertyClassFrame = function (prop, instance) {\r\n\tif (this.classframes && typeof this.classframes === 'object' && typeof this.classframes[prop] === 'object') {\r\n\t\treturn this.classframes[prop];\r\n\t}\r\n\tif (instance) {\r\n\t\tconst cf = new ClassFrame(instance);\r\n\t\treturn cf;\r\n\t}\r\n\tif (this.properties[prop]) {\r\n\t\treturn new ClassFrame(this.properties[prop].values[0]);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/*\r\n * Returns a list of properties - type can be filled|missing|all\r\n */\r\nObjectFrame.prototype.properties = function (type) {\r\n\tif (type == 'filled') {\r\n\t\treturn Object.keys(this.properties);\r\n\t}\r\n\tif (type == 'missing') {\r\n\t\tconst filled = Object.keys(this.properties);\r\n\t\tconst all = Object.keys(this.classframes);\r\n\t\tconst missing = [];\r\n\t\tfor (let i = 0; i < all.length; i++) {\r\n\t\t\tif (filled.indexOf(all[i]) == -1 && missing.indexOf(all[i]) == -1) {\r\n\t\t\t\tmissing.push(all[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn missing;\r\n\t}\r\n\treturn Object.keys(this.classframes);\r\n};\r\n\r\n/**\r\n * Missing properties are those that are present in the classframe,\r\n * but not instantiated in the current object frame\r\n * for this to work we need to load the frame with the associated classframe\r\n */\r\nObjectFrame.prototype.getMissingPropertyList = function () {\r\n\tconst missing = this.properties('missing');\r\n\tconst nmissing = [];\r\n\tfor (let i = 0; i < missing.length; i++) {\r\n\t\tconst cframe = this.getPropertyClassFrame(missing[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: missing[i] };\r\n\t\tnmissing.push(newb);\r\n\t}\r\n\treturn nmissing;\r\n};\r\n\r\n/**\r\n * List of properties that are filled in the object\r\n */\r\nObjectFrame.prototype.getFilledPropertyList = function () {\r\n\tconst props = this.properties('filled');\r\n\tconst filled = [];\r\n\tfor (let i = 0; i < props.length; i++) {\r\n\t\tconst cframe = this.getPropertyClassFrame(props[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: props[i] };\r\n\t\tfilled.push(newb);\r\n\t}\r\n\treturn filled;\r\n};\r\n\r\n/*\r\n * Fills the object frame from the schema - adding all the necessary property frames, etc to make it complete\r\n */\r\nObjectFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (newid) this.subjid = newid;\r\n\tnewid = (newid || FrameHelper.genBNID());\r\n\tconst properties = {};\r\n\tfor (const prop of Object.keys(this.classframes)) {\r\n\t\tconst pf = this.getPropertyClassFrame(prop);\r\n\t\tproperties[prop] = new PropertyFrame(prop, pf);\r\n\t\tproperties[prop].fillFromSchema(newid);\r\n\t}\r\n\tthis.properties = properties;\r\n\tthis.originalFrames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.originalFrames.push(this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Clones an object frame to be a copy of the current frame\r\n */\r\nObjectFrame.prototype.clone = function (newid) {\r\n\tconst properties = {};\r\n\tconst cloned = new ObjectFrame(this.cls, false, false, this.parent);\r\n\tcloned.classframes = this.classframes;\r\n\tcloned.subjid = newid;\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tproperties[prop] = this.properties[prop].clone();\r\n\t}\r\n\tcloned.properties = properties;\r\n\treturn cloned;\r\n};\r\n\r\n\r\n/**\r\n * Returns a child frame with a particular id\r\n * If the second parameter is included, it will only look in that specific property\r\n * Otherwise searches all properties for the child\r\n */\r\nObjectFrame.prototype.getChild = function (childid, prop) {\r\n\tlet pframe = this.getProperty(prop);\r\n\tfor (let i = 0; i < pframe.values.length; pframe++) {\r\n\t\tif (pframe.values[i].isObject() && pframe.values[i].subject === childid) return pframe.values[i];\r\n\t}\r\n\tif (!prop) {\r\n\t\tfor (const key of Object.keys(this.properties)) {\r\n\t\t\tfor (let i = 0; i < this.properties[key].values.length; i += 1) {\r\n\t\t\t\tif (this.properties[key].values[i].subject() === childid) return this.properties[key].values[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.addProperty = function (prop, cls) {\r\n\tconst cframe = this.getPropertyClassFrame(prop);\r\n\tconst nprop = new PropertyFrame(prop, cframe);\r\n\tif (nprop.isData()) {\r\n\t\tconst df = cframe.copy();\r\n\t\tdf.set('');\r\n\t}\r\n\tif (cframe.isObject()) {\r\n\t\tif (!cframe.isClassChoice()) {\r\n\t\t\tconst df = cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t}\r\n\t\tif (cls) {\r\n\t\t\tconst df = cframe.createEmptyChoice(cls, FrameHelper.genBNID());\r\n\t\t}\r\n\t\tconst clss = cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t}\r\n\t}\r\n\tif (typeof this.properties[prop] === 'undefined') {\r\n\t\tthis.properties[prop] = [];\r\n\t}\r\n\tthis.properties[prop].push(df);\r\n\treturn df;\r\n};\r\n\r\nObjectFrame.prototype.addPropertyValue = function (prop, value) {\r\n\tconst pframe = this.properties[prop];\r\n\treturn pframe.addValue(value);\r\n};\r\n\r\nObjectFrame.prototype.removeProperty = function (prop) {\r\n\tif (typeof this.properties[prop] !== 'undefined') {\r\n\t\tdelete (this.properties[prop]);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.removePropertyValue = function (prop, value, index) {\r\n\tconst pframe = this.properties[prop];\r\n\tpframe.removeValue(value, index);\r\n\tif (pframe.values.length == 0) {\r\n\t\tthis.removeProperty(prop);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.error = function (msg) {\r\n\tconsole.error(msg);\r\n};\r\n\r\n\r\nObjectFrame.prototype.subject = function () {\r\n\treturn this.subjid;\r\n};\r\n\r\nObjectFrame.prototype.get = ObjectFrame.prototype.subject;\r\n\r\nObjectFrame.prototype.isObject = function () { return true; };\r\nObjectFrame.prototype.isProperty = function () { return false; };\r\nObjectFrame.prototype.isData = function () { return false; };\r\n\r\n\r\nObjectFrame.prototype.subjectClass = function () {\r\n\treturn this.cls;\r\n};\r\n\r\nObjectFrame.prototype.depth = function () {\r\n\tif (this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n};\r\n\r\nObjectFrame.prototype.getProperty = function (prop) {\r\n\treturn this.properties[prop];\r\n};\r\n\r\nObjectFrame.prototype.first = function (prop) {\r\n\tif (this.properties && this.properties[prop]) {\r\n\t\treturn this.properties[prop].first();\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.property = function (prop) {\r\n\tif (this.parent) return this.parent.property();\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.parentObject = function () {\r\n\tif (this.parent && this.parent.parent) {\r\n\t\treturn this.parent.parent;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.root = function () {\r\n\tif (this.parent) return false;\r\n\treturn true;\r\n};\r\n\r\nObjectFrame.prototype.renderProperties = function () {\r\n\tconst props = this.sortProperties();\r\n\tconst nprops = [];\r\n\tfor (let i = 0; i < props.length; i++) {\r\n\t\tif (this.properties[props[i]].render) {\r\n\t\t\tconst rend = this.properties[props[i]].render(this.properties[props[i]]);\r\n\t\t\tif (rend) nprops.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn nprops;\r\n};\r\n\r\nObjectFrame.prototype.sortProperties = function () {\r\n\tconst unsorted = Object.keys(this.properties);\r\n\tif (this.compare) {\r\n\t\treturn unsorted.sort((a, b) => this.compare(a, b, this));\r\n\t}\r\n\treturn unsorted.sort((a, b) => this.standardCompare(a, b, this));\r\n};\r\n\r\n/*\r\n * Label first, then datatype properties, then object properties\r\n */\r\nObjectFrame.prototype.standardCompare = function (a, b, doc) {\r\n\tif (a == 'rdfs:label') return -1;\r\n\tif (b == 'rdfs:label') return 1;\r\n\tif (a == 'rdfs:comment') return -1;\r\n\tif (b == 'rdfs:comment') return 1;\r\n\tif (doc.properties[a].isData() && doc.properties[b].isObject()) return -1;\r\n\tif (doc.properties[b].isData() && doc.properties[a].isObject()) return 1;\r\n\treturn 0;\r\n};\r\n\r\n\r\nfunction PropertyFrame(property, cframe, parent) {\r\n\tthis.predicate = property;\r\n\tthis.cframe = cframe;\r\n\tthis.parent = parent;\r\n\tthis.values = [];\r\n}\r\n\r\nPropertyFrame.prototype.addFrame = function (frame) {\r\n\tif (this.cframe.isData()) {\r\n\t\tconst df = new DataFrame(frame, this);\r\n\t\tthis.values.push(df);\r\n\t} else {\r\n\t\tconst kid = new ObjectFrame(this.range(), cframe.frame, frame.frame, this, frame);\r\n\t\tthis.values.push(kid);\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (this.isData() || (this.isObject() && !this.isClassChoice())) {\r\n\t\tif (this.hasRestriction() && this.restriction.min) {\r\n\t\t\tvalues = [];\r\n\t\t\tfor (let i = 0; i < this.restriction.min; i += 1) {\r\n\t\t\t\tvalues.push(this.createEmpty(newid));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvalues = [this.createEmpty(newid)];\r\n\t\t}\r\n\t} else if (this.isClassChoice()) {\r\n\t\tconst clss = this.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst empty = this.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\tvalues = [empty];\r\n\t\t}\r\n\t}\r\n\tthis.values = values;\r\n};\r\n\r\nPropertyFrame.prototype.isData = function () {\r\n\treturn this.cframe.isData();\r\n};\r\n\r\nPropertyFrame.prototype.isObject = function () {\r\n\treturn this.cframe.isObject();\r\n};\r\n\r\nPropertyFrame.prototype.isProperty = function () {\r\n\treturn true;\r\n};\r\n\r\nPropertyFrame.prototype.property = function () {\r\n\treturn this.predicate;\r\n};\r\n\r\nPropertyFrame.prototype.extract = function () {\r\n \tconst extracts = [];\r\n \tfor (let i = 0; i < this.values.length; i++) {\r\n \t\tconst val = this.values[i].extract();\r\n \t\tif (val !== '' && val !== false && typeof val !== 'undefined') extracts.push(val);\r\n \t}\r\n\treturn extracts;\r\n};\r\n\r\nPropertyFrame.prototype.subject = function () {\r\n\treturn (this.parent ? this.parent.subject() : false);\r\n};\r\nPropertyFrame.prototype.subjectClass = function () {\r\n\treturn (this.parent ? this.parent.subjectClass() : false);\r\n};\r\nPropertyFrame.prototype.depth = function () {\r\n\treturn (this.parent ? this.parent.depth() : false);\r\n};\r\nPropertyFrame.prototype.updated = function () {\r\n\treturn (this.parent ? this.parent.childUpdated() : false);\r\n};\r\nPropertyFrame.prototype.range = function () {\r\n\treturn (this.cframe ? this.cframe.range : '');\r\n};\r\nPropertyFrame.prototype.getLabel = function () {\r\n\treturn (\r\n\t\tthis.cframe ? this.cframe.getLabel() : '');\r\n};\r\nPropertyFrame.prototype.getComment = function () {\r\n\treturn (this.cframe ? this.cframe.getComment() : false);\r\n};\r\nPropertyFrame.prototype.hasCardinalityRestriction = function () {\r\n\treturn (this.cframe ? this.cframe.hasRestriction() : false);\r\n};\r\nPropertyFrame.prototype.getRestriction = function () {\r\n\treturn (this.cframe ? this.cframe.restriction : false);\r\n};\r\nPropertyFrame.prototype.isClassChoice = function () {\r\n\treturn (this.cframe ? this.cframe.isClassChoice() : false);\r\n};\r\n\r\nPropertyFrame.prototype.deletePropertyValue = function (value, index) {\r\n\tthis.parent.removePropertyValue(this.property(), value, index);\r\n};\r\n\r\nPropertyFrame.prototype.get = function () {\r\n\tconst gets = [];\r\n\tfor (let i = 0; i < this.values.length; i++) {\r\n\t\tgets.push(this.values[i].get());\r\n\t}\r\n\treturn get;\r\n};\r\n\r\n\r\nPropertyFrame.prototype.clear = function () {\r\n\talert('need clear');\r\n};\r\nPropertyFrame.prototype.clone = function () {\r\n\talert('need clone');\r\n};\r\n\r\nPropertyFrame.prototype.getAsFrames = function () {\r\n\talert('need gaf');\r\n};\r\n\r\nPropertyFrame.prototype.createEmpty = function () {\r\n\talert('creatempty');\r\n};\r\n\r\nPropertyFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (!!(options && options.ignore_failure));\r\n\tconst hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\tif (hits.length || cascading) {\r\n\t\tfor (let i = 0; i < this.values.length; i++) {\r\n\t\t\tthis.values[i].filter(rules, onmatch, options);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Shorthand functions to make it easier to access the underlying data\r\n */\r\n\r\nPropertyFrame.prototype.first = function () {\r\n\tif (this.values && this.values[0]) {\r\n\t\treturn this.values[0].get();\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.renderValues = function () {\r\n\tconst sortedVals = this.sortValues();\r\n\tconst vals = [];\r\n\tfor (let i = 0; i < sortedVals.length; i++) {\r\n\t\tif (sortedVals[i].render) {\r\n\t\t\tconst rend = sortedVals[i].render(sortedVals[i]);\r\n\t\t\tif (rend) vals.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n};\r\n\r\nPropertyFrame.prototype.sortValues = function () {\r\n\tif (this.compare) {\r\n\t\treturn this.values.sort((a, b) => this.compare(a, b, this));\r\n\t}\r\n\treturn this.values;\r\n};\r\n\r\nfunction DataFrame(frame, parent) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nDataFrame.prototype.load = function (frame) {\r\n\tif (typeof frame !== 'object') {\r\n\t\tthis.error('No frame passed to load');\r\n\t\treturn;\r\n\t}\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = frame.type;\r\n\tthis.predicate = frame.property;\r\n\tthis.range = frame.range;\r\n\tthis.rangeValue = frame.rangeValue;\r\n\tthis.domain = frame.domain;\r\n\tthis.domainValue = frame.domainValue;\r\n\tthis.frame = frame.frame;\r\n\tthis.label = frame.label;\r\n\tthis.comment = frame.comment;\r\n\tconst { restriction } = frame;\r\n\tthis.restriction = false;\r\n\tif (restriction && typeof restriction === 'object') {\r\n\t\tthis.restriction = new Restriction(restriction);\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.filter = function (rules, onmatch) {\r\n\tFramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\treturn this;\r\n};\r\n\r\nDataFrame.prototype.delete = function () {\r\n\tthis.parent.deletePropertyValue(this.get(), this.index);\r\n};\r\n\r\nDataFrame.prototype.save = function () {\r\n\tif (this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.reset = function () {\r\n\tthis.set(this.originalValue);\r\n\t// this.redraw();\r\n};\r\n\r\nDataFrame.prototype.clone = function () {\r\n\tconst newb = this.parent.addPropertyValue(this.get());\r\n\tconst nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = 'edit';\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n};\r\n\r\n\r\nDataFrame.prototype.depth = function () { return (this.parent ? this.parent.depth() : false); };\r\nDataFrame.prototype.property = function () { return (this.parent ? this.parent.property() : false); };\r\nDataFrame.prototype.subject = function () { return (this.parent ? this.parent.subject() : false); };\r\nDataFrame.prototype.subjectClass = function () { return (this.parent ? this.parent.subjectClass() : false); };\r\nDataFrame.prototype.range = function () {\treturn (this.frame ? this.frame.range : false); };\r\n\r\nDataFrame.prototype.isValidType = function (dt) {\r\n\tconst vtypes = ['datatypeProperty', 'objectProperty', 'restriction '];\r\n\tif (vtypes.indexOf(dt) === -1) return false;\r\n\treturn true;\r\n};\r\n\r\n\r\nDataFrame.prototype.getAsFrame = function () {\r\n\t const ff = { type: this.type, property: this.property() };\r\n\t if (this.range) ff.range = this.range;\r\n\t if (this.rangeValue) ff.rangeValue = this.rangeValue;\r\n\t if (this.domain) ff.domain = this.domain;\r\n\t if (this.domainValue) ff.domainValue = this.domainValue;\r\n\t if (this.frame) ff.frame = this.frame;\r\n\t if (this.label) ff.label = this.label;\r\n\t if (this.comment) ff.comment = this.comment;\r\n\t return ff;\r\n};\r\n\r\nDataFrame.prototype.hasRestriction = function () {\r\n\t if (this.restriction) {\r\n\t\t return this.restriction.hasCardRestriction();\r\n\t }\r\n\t return false;\r\n};\r\n\r\nDataFrame.prototype.copy = function (newid) {\r\n\tconst copy = new DataFrame(this, this.parent);\r\n\tif (newid) copy.domainValue = newid;\r\n\treturn copy;\r\n};\r\n\r\nDataFrame.prototype.getLabel = function () {\r\n\tlet lab = '';\r\n\tif(this.predicate == \"rdfs:label\") return \"Label\";\r\n\tif(this.predicate == \"rdfs:comment\") return \"Comment\";\r\n\tif (this.label && typeof this.label === 'object') lab = this.label['@value'];\r\n\tif (this.label && typeof this.label === 'string') lab = this.label;\r\n\t// always return something\r\n\tif (!lab && this.property()) lab = FrameHelper.labelFromURL(this.property());\r\n\tif (!lab) lab = FrameHelper.labelFromURL(this.cls);\r\n\treturn lab;\r\n};\r\n\r\nDataFrame.prototype.getType = function () {\r\n\tif (this.range) return this.range;\r\n\tif (this.rangeValue && this.rangeValue.type) return this.rangeValue.type;\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.getLabel = DataFrame.prototype.getLabel;\r\n\r\nDataFrame.prototype.getComment = function () {\r\n\tlet comment = '';\r\n\tif (this.comment && typeof this.comment === 'object') comment = this.comment['@value'];\r\n\tif (this.comment && typeof this.comment === 'string') comment = this.comment;\r\n\treturn comment;\r\n};\r\n\r\nObjectFrame.prototype.getComment = DataFrame.prototype.getComment;\r\n\r\n\r\nDataFrame.prototype.error = function (msg) {\r\n\tif (msg)\tthis.err = msg;\r\n\treturn this.err;\r\n};\r\n\r\nDataFrame.prototype.isValid = function () {\r\n\tif (!(this.type && this.isValidType(this.type))) {\r\n\t\tthis.error(`Missing or Illegal Frame Type ${this.type}`);\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.predicate)) {\r\n\t\tthis.error('Missing Frame Property');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.domain)) {\r\n\t\tthis.error('Missing Frame Domain');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.range)) {\r\n\t\tthis.error('Missing Frame Range');\r\n\t\treturn false;\r\n\t}\r\n\tif (this.isObjectProperty() && !(this.frame && typeof this.frame === 'object')) {\r\n\t\tthis.error('Missing Object Frame');\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nDataFrame.prototype.isObjectProperty = function () {\r\n\treturn this.type === 'objectProperty';\r\n};\r\n\r\nDataFrame.prototype.isDatatypeProperty = function () {\r\n\treturn this.type === 'datatypeProperty';\r\n};\r\n\r\nDataFrame.prototype.isLogic = function () {\r\n\tif (this.type === 'and' || this.type === 'or' || this.type === 'xor') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.isRestriction = function () {\r\n\treturn this.type === 'restriction';\r\n};\r\n\r\nDataFrame.prototype.ftype = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isDatatypeProperty()) return 'data';\r\n\tif (this.isChoice()) return 'oneOf';\r\n\tif (this.isObject()) return 'object';\r\n\tif (this.isLogic()) return 'logic';\r\n\tif (this.isClassChoice()) return 'class_choice';\r\n\treturn undefined;\r\n};\r\n\r\n\r\nDataFrame.prototype.isClassChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'class_choice');\r\n};\r\n\r\nDataFrame.prototype.isString = function () {\r\n\tif (this.range === FrameHelper.getStdURL('xsd', 'string')) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getChoiceOptions = function () {\r\n\tconst opts = [];\r\n\tfor (let i = 0; i < this.frame.elements.length; i += 1) {\r\n\t\tconst option = {};\r\n\t\tif (this.frame.elements[i].label) {\r\n\t\t\toption.label = this.frame.elements[i].label['@value'];\r\n\t\t} else {\r\n\t\t\toption.label = FrameHelper.labelFromURL(this.frame.elements[i].class);\r\n\t\t}\r\n\t\toption.value = this.frame.elements[i].class;\r\n\t\topts.push(option);\r\n\t}\r\n\treturn opts;\r\n};\r\n\r\nDataFrame.prototype.lang = function () {\r\n\treturn 'en';\r\n};\r\n\r\nDataFrame.prototype.isChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'oneOf');\r\n};\r\n\r\nDataFrame.prototype.isDocument = function () {\r\n\treturn (this.frame && this.frame.type === 'document');\r\n};\r\n\r\nDataFrame.prototype.isData = function () {\r\n\treturn (this.isDocument() || this.isChoice() || this.isDatatypeProperty());\r\n};\r\n\r\nDataFrame.prototype.isObject = function () {\r\n\treturn (this.isObjectProperty() && this.frame && !(this.isChoice() || this.isDocument()));\r\n};\r\n\r\nDataFrame.prototype.isProperty = function () {\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getTypeShorthand = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isChoice()) return 'choice';\r\n\tconst sh = FrameHelper.getShorthand(this.getType());\r\n\treturn (sh || this.getType());\r\n};\r\n\r\nDataFrame.prototype.get = function () {\r\n\tif (this.contents) {\r\n\t\treturn this.contents;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue && typeof this.rangeValue['@value'] !== 'undefined') {\r\n\t\treturn this.rangeValue['@value'];\r\n\t}\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\treturn this.frame.domainValue;\r\n\t}\r\n\treturn '';\r\n};\r\n\r\nDataFrame.prototype.set = function (value, normalizer) {\r\n\tif (normalizer) value = normalizer(value, this);\r\n\tthis.contents = value;\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\tthis.frame.domainValue = value;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue) {\r\n\t\tthis.rangeValue['@value'] = value;\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.clear = function () {\r\n\tif (this.isDocument() || this.isChoice() || this.isDatatypeProperty()) {\r\n\t\tthis.set('');\r\n\t}\r\n};\r\n\r\n/*\r\n * Class frames represent the archetypal version of a property frame as returned by the class frame api\r\n */\r\nfunction ClassFrame(frame, parent) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nClassFrame.prototype = DataFrame.prototype;\r\n\r\nClassFrame.prototype.loadFromObjectFrame = function (par, child) {\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = 'objectProperty';\r\n\tthis.predicate = par.property;\r\n\tthis.range = par.range;\r\n\tthis.rangeValue = child.subjid;\r\n\tthis.domain = par.cls;\r\n\tthis.domainValue = par.subjid;\r\n\tthis.label = par.getLabel();\r\n\tthis.comment = par.getComment();\r\n\tthis.restriction = par.restriction;\r\n};\r\n\r\nClassFrame.prototype.createEmptyChoice = function (cls, newid) {\r\n\tconst cf = this.getChosenClassFrames(cls);\r\n\tconst objframe = new ObjectFrame(cls);\r\n\tif (newid) objframe.subjid = newid;\r\n\tobjframe.loadClassFrames(cf);\r\n\tconst fframe = objframe.fillFromSchema();\r\n\treturn fframe;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrames = function (chosen) {\r\n\tlet nc = [];\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\tif (chosen === this.frame.operands[i][j].domain) {\r\n\t\t\t\tnc = nc.concat(this.frame.operands[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nc;\r\n};\r\n\r\nClassFrame.prototype.createEmpty = function (newid) {\r\n\tif (this.isObject()) {\r\n\t\tconst objframe = new ObjectFrame(this.range);\r\n\t\tif (newid) objframe.subjid = newid;\r\n\t\tobjframe.loadClassFrames(this.frame);\r\n\t\tconst fframe = objframe.fillFromSchema();\r\n\t\treturn fframe;\r\n\t}\r\n\tif (this.isData()) {\r\n\t\tconst dataframe = this.copy();\r\n\t\tdataframe.set('');\r\n\t\treturn dataframe;\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.cloneDataFrame = function (newid, other) {\r\n\treturn other;\r\n};\r\n\r\nClassFrame.prototype.clone = function (newid, other) {\r\n\tif (this.isObject()) {\r\n\t\tconsole.log('cannot clone class frame');\r\n\t} else if (this.isData()) {\r\n\t\treturn this.cloneDataFrame(newid, other);\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.getClassChoices = function () {\r\n\tconst choices = [];\r\n\tif (this.frame.operands) {\r\n\t\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\t\tconst domcls = this.frame.operands[i][j].domain;\r\n\t\t\t\tif (domcls && choices.indexOf(domcls) === -1) {\r\n\t\t\t\t\tchoices.push(domcls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrame = function (chosen) {\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tconst operand = this.frame.operands[i];\r\n\t\tif (operand.length) {\r\n\t\t\tfor (let j = 0; j < operand.length; j += 1) {\r\n\t\t\t\tif (operand[j] && (chosen === operand[j].domain)) {\r\n\t\t\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\t\t\treturn cf;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (operand.range && chosen === operand.range) {\r\n\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\treturn cf;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nClassFrame.prototype.getChosenFrame = function (dataframe) {\r\n\treturn dataframe;\r\n};\r\n\r\n\r\nfunction Restriction(restriction) {\r\n\tthis.min = 0;\r\n\tthis.max = 0;\r\n\tif (restriction) this.loadRestriction(restriction);\r\n}\r\n\r\nRestriction.prototype.hasCardRestriction = function () {\r\n\tif (this.min === 0 && this.max === 0) return false;\r\n\treturn true;\r\n};\r\n\r\nRestriction.prototype.loadRestriction = function (restriction) {\r\n\tif (typeof restriction.cardinality !== 'undefined') {\r\n\t\tthis.max = restriction.cardinality;\r\n\t\tthis.min = restriction.cardinality;\r\n\t} else if (typeof restriction.maxCardinality !== 'undefined') {\r\n\t\tthis.max = restriction.maxCardinality;\r\n\t} else if (typeof restriction.minCardinality !== 'undefined') {\r\n\t\tthis.min = restriction.minCardinality;\r\n\t} else if (typeof restriction.type !== 'undefined' && restriction.type === 'and' && typeof restriction.operands === 'object') {\r\n\t\tfor (let i = 0; i < restriction.operands.length; i += 1) {\r\n\t\t\tconst nrest = new Restriction(restriction.operands[i]);\r\n\t\t\tif (this.max === 0 && nrest.max > 0) this.max = nrest.max;\r\n\t\t\telse if (this.max > 0 && nrest.max > 0 && nrest.max < this.max) this.max = nrest.max;\r\n\t\t\tif (this.min === 0 && nrest.min > 0) this.min = nrest.min;\r\n\t\t\telse if (this.min > 0 && nrest.min > 0 && nrest.min > this.min) this.min = nrest.min;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nmodule.exports = ObjectFrame;\r\n","/**\r\n * The WOQL object is a wrapper around the WOQL query object\r\n * Syntactic sugar to allow you to write WOQL.triple()... instead of new WOQLQuery().triple()\r\n * Every function matches one of the public api functions of the woql query object\r\n */\r\nconst FrameHelper = require('./frameHelper');\r\nconst Pattern = require('./framePattern');\r\n\r\nconst WOQL = {};\r\n\r\n/*\r\n * We expose all the real woql predicates via the WOQL object,\r\n * for ease of typing - all return a WOQL query object\r\n */\r\nWOQL.when = function(Query, Update){ return new WOQLQuery().when(Query, Update);}\r\nWOQL.opt = function(query){ return new WOQLQuery().opt(query); }\r\nWOQL.from = function(dburl, query){ return new WOQLQuery().from(dburl, query); }\r\nWOQL.limit = function(limit, query){ return new WOQLQuery().limit(limit, query); }\r\nWOQL.select = function(...list){ return new WOQLQuery().select(...list); }\r\nWOQL.or = function(...queries){\treturn new WOQLQuery().or(...queries); }\r\nWOQL.and = function(...queries){ return new WOQLQuery().and(...queries); }\r\nWOQL.not = function(query){ return new WOQLQuery().not(query); }\r\nWOQL.triple = function(a, b, c){ return new WOQLQuery().triple(a, b, c); }\r\nWOQL.quad = function(a, b, c, d){ return new WOQLQuery().quad(a, b, c, d); }\r\nWOQL.eq = function(a, b){ return new WOQLQuery().eq(a, b);}\r\nWOQL.sub = function(a, b){ return new WOQLQuery().sub(a, b); }\r\nWOQL.isa = function(a, b){\treturn new WOQLQuery().isa(a, b);\t}\r\nWOQL.trim = function(a, b){\treturn new WOQLQuery().trim(a, b);\t}\r\nWOQL.delete = function(JSON_or_IRI){ return new WOQLQuery().delete(JSON_or_IRI);\t}\r\nWOQL.delete_triple = function( S, P, O ){ return new WOQLQuery().delete_triple (S, P, O);\t}\r\nWOQL.add_triple = function( S, P, O ){ return new WOQLQuery().add_triple (S, P, O); }\r\nWOQL.delete_quad = function( S, P, O, G ){ return new WOQLQuery().delete_triple (S, P, O, G); }\r\nWOQL.add_quad = function( S, P, O, G ){ \treturn new WOQLQuery().add_triple (S, P, O, G);}\r\nWOQL.eval = function(arith, v){\treturn new WOQLQuery().eval(arith, v);}\r\nWOQL.plus = function(...args){\treturn new WOQLQuery().plus(...args);}\r\nWOQL.minus = function(...args){\treturn new WOQLQuery().minus(...args); }\r\nWOQL.times = function(...args){\treturn new WOQLQuery().times(...args); }\r\nWOQL.divide = function(...args){ return new WOQLQuery().divide(...args); }\r\nWOQL.exp = function(a, b){\treturn new WOQLQuery().exp(a, b); }\r\n\r\nWOQL.get = function(map, target){\treturn new WOQLQuery().get(map, target); }\r\nWOQL.as = function(map, vari){\treturn new WOQLQuery().as(map, vari); }\r\nWOQL.remote = function(url){\treturn new WOQLQuery().remote(url); }\r\nWOQL.unique = function(prefix, vari){\treturn new WOQLQuery().unique(prefix, vari); }\r\nWOQL.list = function(vars){\treturn new WOQLQuery().list(vars); }\r\n//WOQL.value = function(vars){\treturn new WOQLQuery().list(vars); }\r\n\r\n/*\r\n * Beneath here are pseudo predicates - they belong to the javascript object\r\n * but not to the WOQL language\r\n */\r\n//returns empty query object\r\nWOQL.query = function(){\treturn new WOQLQuery(); }\r\n//loads query from json\r\nWOQL.json = function(json){\treturn new WOQLQuery().json(json); }\r\n//returns a special schema object for terse schema updates\r\nWOQL.schema = function(){\treturn new WOQLSchema(); }\r\n\r\nWOQL.rule = function(){ return new Pattern.FrameRule(); }\r\n//Simple utility function for typechecking\r\nWOQL.isLiteralType = function(t){\r\n\tif(t){\r\n\t\tvar pref = t.split(\":\");\r\n\t\tif(pref[0] == \"xdd\" || pref[0] == \"xsd\") return true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/**\r\n * The WOQL Query object implements the WOQL language via the fluent style\r\n * @param query - json version of query\r\n * @returns WOQLQuery object\r\n */\r\nfunction WOQLQuery(query){\r\n\tthis.query = (query ? query : {});\r\n\tthis.cursor = this.query;\r\n\tthis.chain_ended = false;\r\n\tthis.contains_update = false;\r\n\t// operators which preserve global paging\r\n\tthis.paging_transitive_properties = ['select', 'from', 'start', 'when', 'opt', 'limit'];\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Control Functions\r\n */\r\n\r\n/**\r\n * Advances internal cursor to support chaining of calls: limit(50).start(50). rather than (limit, [50, (start, [50, (lisp-style (encapsulation)))))\r\n */\r\nWOQLQuery.prototype.advanceCursor = function (action, value) {\r\n\tthis.cursor[action] = [value];\r\n\tthis.cursor[action][1] = {};\r\n\tthis.cursor = this.cursor[action][1];\r\n};\r\n\r\n/**\r\n * Called to indicate that this is the last call that is chainable - for example triple pattern matching..\r\n *\r\n */\r\nWOQLQuery.prototype.last = function () {\r\n\tthis.chain_ended = true;\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.isPaged = function (q) {\r\n\tq = (q || this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif (prop == 'limit') return true;\r\n\t\tif (this.paging_transitive_properties.indexOf(prop) !== -1) {\r\n\t\t\treturn this.isPaged(q[prop][q[prop].length - 1]);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nWOQLQuery.prototype.getPagingProperty = function (pageprop, q) {\r\n\tq = (q || this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif (prop == pageprop) return q[prop][0];\r\n\t\tif (this.paging_transitive_properties.indexOf(prop) !== -1) {\r\n\t\t\tconst val = this.getPagingProperty(pageprop, q[prop][q[prop].length - 1]);\r\n\t\t\tif (typeof val !== 'undefined') {\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\nWOQLQuery.prototype.setPagingProperty = function (pageprop, val, q) {\r\n\tq = (q || this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif (prop == pageprop) {\r\n\t\t\tq[prop][0] = val;\r\n\t\t} else if (this.paging_transitive_properties.indexOf(prop) !== -1) {\r\n\t\t\tthis.setPagingProperty(pageprop, val, q[prop][q[prop].length - 1]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.addStart = function (val, q) {\r\n\tq = (q || this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif (prop == 'limit') {\r\n\t\t\tconst nval = { start: [0, q[prop][1]] };\r\n\t\t\tq[prop][1] = nval;\r\n\t\t} else if (this.paging_transitive_properties.indexOf(prop) !== -1) {\r\n\t\t\tthis.addStart(val, q[prop][q[prop].length - 1]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.getContext = function (q) {\r\n\tq = (q || this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif (prop == '@context') return q[prop];\r\n\t\tif (this.paging_transitive_properties.indexOf(prop) !== -1) {\r\n\t\t\tconst nq = q[prop][1];\r\n\t\t\tconst nc = this.getContext(nq);\r\n\t\t\tif (nc) return nc;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nWOQLQuery.prototype.nspaces = function (n) {\r\n\tlet spaces = '';\r\n\tfor (let i = 0; i < n; i++) {\r\n\t\tspaces += ' ';\r\n\t}\r\n\treturn spaces;\r\n};\r\n\r\n\r\nWOQLQuery.prototype.prettyPrint = function (indent, show_context, q) {\r\n\tq = (q || this.query);\r\n\tlet str = '';\r\n\tfor (const key in q) {\r\n\t\tif (key == '@context') {\r\n\r\n\t\t} else {\r\n\t\t\tstr += key;\r\n\t\t\tconst val = q[key];\r\n\t\t\tif (key == 'and' || key == 'or') {\r\n\t\t\t\tconst clauses = [];\r\n\t\t\t\tfor (var i = 0; i < val.length; i++) {\r\n\t\t\t\t\tconst nxt = this.prettyPrint(indent + 4, show_context, val[i]);\r\n\t\t\t\t\tclauses.push(nxt);\r\n\t\t\t\t}\r\n\t\t\t\tstr += `(\\n${this.nspaces(indent)}WOQL.${clauses.join(`,\\n${this.nspaces(indent)}WOQL.`)}\\n` + ')';\r\n\t\t\t} else if (typeof val[val.length - 1] === 'object') {\r\n\t\t\t\tconst nvals = [];\r\n\t\t\t\tfor (var i = 0; i < val.length - 1; i++) {\r\n\t\t\t\t\tif (key == 'limit' || key == 'start') {\r\n\t\t\t\t\t\tnvals.push(val[i]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnvals.push(`\"${val[i]}\"`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (nvals.length) {\r\n\t\t\t\t\tstr += `(${nvals.join(',')}`;\r\n\t\t\t\t\tif (key == 'from') str += ')\\n.';\r\n\t\t\t\t\telse str += ').';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstr += '().';\r\n\t\t\t\t}\r\n\t\t\t\tstr += this.prettyPrint(indent, show_context, val[val.length - 1]);\r\n\t\t\t} else {\r\n\t\t\t\tstr += `(\"${val.join('\", \"')}\")`;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n};\r\n\r\nWOQLQuery.prototype.setLimit = function (limit) {\r\n\treturn this.setPagingProperty('limit', limit);\r\n};\r\n\r\nWOQLQuery.prototype.getLimit = function () {\r\n\treturn this.getPagingProperty('limit');\r\n};\r\n\r\nWOQLQuery.prototype.getPage = function () {\r\n\tif (this.isPaged()) {\r\n\t\tconst psize = this.getLimit();\r\n\t\tif (this.hasStart()) {\r\n\t\t\tconst s = this.getStart();\r\n\t\t\treturn (parseInt(s / psize) + 1);\r\n\t\t}\r\n\t\treturn 1;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nWOQLQuery.prototype.setPage = function (pagenum) {\r\n\tconst pstart = (this.getLimit() * (pagenum - 1));\r\n\tif (this.hasStart()) {\r\n\t\tthis.setStart(pstart);\r\n\t} else {\r\n\t\tthis.addStart(pstart);\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n\r\nWOQLQuery.prototype.hasStart = function () {\r\n\treturn (typeof this.getPagingProperty('start') !== 'undefined');\r\n};\r\n\r\nWOQLQuery.prototype.getStart = function () {\r\n\treturn this.getPagingProperty('start');\r\n};\r\n\r\nWOQLQuery.prototype.nextPage = function () {\r\n\treturn this.setPage(this.getPage() + 1);\r\n};\r\n\r\nWOQLQuery.prototype.firstPage = function () {\r\n\treturn this.setPage(1);\r\n};\r\n\r\nWOQLQuery.prototype.previousPage = function () {\r\n\tconst npage = this.getPage() - 1;\r\n\tif (npage > 0) this.setPage(npage);\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.hasSelect = function () {\r\n\treturn this.getPagingProperty('select');\r\n};\r\n\r\nWOQLQuery.prototype.getSelectVariables = function (q) {\r\n\tq = (q || this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif (prop == 'select') {\r\n\t\t\tconst vars = q[prop].slice(0, q[prop].length - 1);\r\n\t\t\treturn vars;\r\n\t\t}\r\n\t\tif (this.paging_transitive_properties.indexOf(prop) !== -1) {\r\n\t\t\tconst val = this.getSelectVariables(q[prop][q[prop].length - 1]);\r\n\t\t\tif (typeof val !== 'undefined') {\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\nWOQLQuery.prototype.setStart = function(start){\r\n\treturn this.setPagingProperty(\"start\", start);\r\n}\r\n\r\nWOQLQuery.prototype.setPageSize = function (size) {\r\n\tthis.setPagingProperty('limit', size);\r\n\tif (this.hasStart()) {\r\n\t\tthis.setStart(0);\r\n\t} else {\r\n\t\tthis.addStart(0);\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Called to indicate an update that is the last chainable element in a query\r\n */\r\nWOQLQuery.prototype.lastUpdate = function () {\r\n\tthis.last();\r\n\tthis.contains_update = true;\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * JSON context specifying prefixes\r\n */\r\nWOQLQuery.prototype.context = function (Context) {\r\n\tthis.cursor['@context'] = Context;\r\n};\r\n\r\nWOQLQuery.prototype.defaultContext = function (DB_IRI) {\r\n\tconst def = {};\r\n\tfor (const pref in FrameHelper.standard_urls) {\r\n\t\tdef[pref] = FrameHelper.standard_urls[pref];\r\n\t}\r\n\tdef.scm = `${DB_IRI}/schema#`;\r\n\tdef.doc = `${DB_IRI}/document/`;\r\n\tdef.db = `${DB_IRI}/`;\r\n\treturn def;\r\n};\r\n\r\n\r\n/**\r\n * Executes the query using the passed client to connect to a server\r\n */\r\nWOQLQuery.prototype.execute = function (client) {\r\n\tif (!this.query['@context']) {\r\n\t\tthis.query['@context'] = this.defaultContext(client.connectionConfig.dbURL());\r\n\t\tvar json = this.json();\r\n\t} else {\r\n\t\tvar json = this.json();\r\n\t}\r\n\tif (this.contains_update) {\r\n\t\treturn client.update(false, json);\r\n\t}\r\n\r\n\treturn client.select(false, json);\r\n};\r\n\r\n/*\r\n * json version of query for passing to api\r\n */\r\nWOQLQuery.prototype.json = function (json) {\r\n\tif (json) {\r\n\t\tthis.query = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.query;\r\n};\r\n\r\n/*\r\n * Functions which take a query as an argument advance the cursor to make the chaining of queries fall\r\n * into the corrent place in the encompassing json\r\n */\r\nWOQLQuery.prototype.when = function (Query, Update) {\r\n\tthis.advanceCursor('when', Query);\r\n\tif (Update) {\r\n\t\tthis.cursor = Update.json();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.opt = function (query) {\r\n\tif (query) {\r\n\t\tthis.cursor.opt = [query];\r\n\t} else {\r\n\t\tthis.cursor.opt = [{}];\r\n\t\tthis.cursor = this.cursor.opt[0];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.from = function(dburl, query){\r\n\tthis.advanceCursor(\"from\", dburl);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.limit = function (limit, query) {\r\n\tthis.advanceCursor('limit', limit);\r\n\tif (query) {\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.start = function (start, query) {\r\n\tthis.advanceCursor('start', start);\r\n\tif (query) {\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.select = function (...list) {\r\n\tthis.cursor.select = list;\r\n\tconst index = list.length;\r\n\tif (typeof this.cursor.select[index - 1] === 'object') {\r\n\t\tthis.cursor.select[index - 1] = this.cursor.select[index - 1].json();\r\n\t} else {\r\n\t\tthis.cursor.select[index] = {};\r\n\t\tthis.cursor = this.cursor.select[index];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.and = function (...queries) {\r\n\tthis.cursor.and = [];\r\n\tfor (let i = 0; i < queries.length; i++) {\r\n\t\tif (queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor.and.push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.or = function (...queries) {\r\n\tthis.cursor.or = [];\r\n\tfor (let i = 0; i < queries.length; i++) {\r\n\t\tif (queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor.or.push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.not = function (query) {\r\n\tif (query) {\r\n\t\tif (query.contains_update) this.contains_update = true;\r\n\t\tthis.cursor.not = [query.json()];\r\n\t} else {\r\n\t\tthis.cursor.not = [{}];\r\n\t\tthis.cursor = this.cursor.not[0];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.triple = function (a, b, c) {\r\n\tthis.cursor.triple = [a, b, c];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.quad = function (a, b, c, g) {\r\n\tthis.cursor.quad = [a, b, c, g];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.eq = function (a, b) {\r\n\tthis.cursor.eq = [a, b];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.sub = function (a, b) {\r\n\tthis.cursor.sub = [a, b];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.isa = function (a, b) {\r\n\tthis.cursor.isa = [a, b];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.trim = function (a, b) {\r\n\tthis.cursor.trim = [a, b];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.eval = function (arith, v) {\r\n\tthis.cursor.eval = [arith, v];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.plus = function (...args) {\r\n\tthis.cursor.plus = args;\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.minus = function (...args) {\r\n\tthis.cursor.minus = args;\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.times = function (...args) {\r\n\tthis.cursor.times = args;\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.divide = function (...args) {\r\n\tthis.cursor.divide = args;\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.exp = function (a, b) {\r\n\tthis.cursor.exp = [a, b];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.delete = function (JSON_or_IRI) {\r\n\tthis.cursor.delete = [JSON_or_IRI];\r\n\treturn this.lastUpdate();\r\n};\r\n\r\nWOQLQuery.prototype.delete_triple = function (Subject, Predicate, Object_or_Literal) {\r\n\tthis.cursor.delete_triple = [Subject, Predicate, Object_or_Literal];\r\n\treturn this.lastUpdate();\r\n};\r\n\r\nWOQLQuery.prototype.add_triple = function (Subject, Predicate, Object_or_Literal) {\r\n\tthis.cursor.add_triple = [Subject, Predicate, Object_or_Literal];\r\n\treturn this.lastUpdate();\r\n};\r\n\r\nWOQLQuery.prototype.delete_quad = function (Subject, Predicate, Object_or_Literal, Graph) {\r\n\tthis.cursor.delete_quad = [Subject, Predicate, Object_or_Literal, Graph];\r\n\treturn this.lastUpdate();\r\n};\r\n\r\nWOQLQuery.prototype.add_quad = function (Subject, Predicate, Object_or_Literal, Graph) {\r\n\tthis.cursor.add_quad = [Subject, Predicate, Object_or_Literal, Graph];\r\n\treturn this.lastUpdate();\r\n};\r\n\r\nWOQLQuery.prototype.update = function (json) {\r\n\tthis.cursor.update = [json];\r\n\treturn this.lastUpdate();\r\n};\r\n\r\n/*\r\n * higher level composite queries\r\n */\r\n\r\nWOQLQuery.prototype.abstract = function (varname) {\r\n\tvarname = (varname || `v:${FrameHelper.genBNID()}`);\r\n\treturn this.quad(varname, 'tcs:tag', 'tcs:abstract', 'db:schema');\r\n};\r\n\r\nWOQLQuery.prototype.getEverything = function (GraphIRI) {\r\n\tif (GraphIRI) {\r\n\t\treturn this.quad('v:Subject', 'v:Predicate', 'v:Object', GraphIRI);\r\n\t}\r\n\r\n\treturn this.triple('v:Subject', 'v:Predicate', 'v:Object');\r\n};\r\n\r\nWOQLQuery.prototype.getAllDocuments = function () {\r\n\treturn this.and(\r\n\t\tWOQL.triple('v:Document', 'rdf:type', 'v:Type'),\r\n\t\tWOQL.sub('v:Type', 'tcs:Document')\r\n\t);\r\n};\r\n\r\nWOQLQuery.prototype.documentMetadata = function () {\r\n\treturn this.and(\r\n\t\tWOQL.triple('v:ID', 'rdf:type', 'v:Class'),\r\n\t\tWOQL.sub('v:Class', 'tcs:Document'),\r\n\t\tWOQL.opt().triple('v:ID', 'rdfs:label', 'v:Label'),\r\n\t\tWOQL.opt().triple('v:ID', 'rdfs:comment', 'v:Comment'),\r\n\t\tWOQL.opt().quad('v:Class', 'rdfs:label', 'v:Type', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Class', 'rdfs:comment', 'v:Type_Comment', 'db:schema')\r\n\t);\r\n};\r\n\r\n\r\nWOQLQuery.prototype.propertyMetadata = function () {\r\n\treturn this.and(\r\n\t\tWOQL.or(\r\n\t\t\tWOQL.quad('v:Property', 'rdf:type', 'owl:DatatypeProperty', 'db:schema'),\r\n\t\t\tWOQL.quad('v:Property', 'rdf:type', 'owl:ObjectProperty', 'db:schema')\r\n\t\t),\r\n\t\tWOQL.opt().quad('v:Property', 'rdfs:range', 'v:Range', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Property', 'rdf:type', 'v:Type', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Property', 'rdfs:label', 'v:Label', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Property', 'rdfs:comment', 'v:Comment', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Property', 'rdfs:domain', 'v:Domain', 'db:schema')\r\n\t);\r\n};\r\n\r\nWOQLQuery.prototype.elementMetadata = function () {\r\n\treturn this.and(\r\n\t\tWOQL.quad('v:Element', 'rdf:type', 'v:Type', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Element', 'tcs:tag', 'v:Abstract', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Element', 'rdfs:label', 'v:Label', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Element', 'rdfs:comment', 'v:Comment', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Element', 'rdfs:domain', 'v:Domain', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Element', 'rdfs:range', 'v:Range', 'db:schema')\r\n\t);\r\n};\r\n\r\nWOQLQuery.prototype.classMetadata = function () {\r\n\treturn this.and(\r\n\t\tWOQL.quad('v:Element', 'rdf:type', 'owl:Class', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Element', 'rdfs:label', 'v:Label', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Element', 'rdfs:comment', 'v:Comment', 'db:schema'),\r\n\t\tWOQL.opt().quad('v:Element', 'tcs:tag', 'v:Abstract', 'db:schema')\r\n\t);\r\n};\r\n\r\nWOQLQuery.prototype.getDataOfClass = function (chosen) {\r\n\treturn this.and(\r\n\t\tWOQL.triple('v:Document', 'rdf:type', chosen),\r\n\t\tWOQL.opt().triple('v:Document', 'v:Property', 'v:Value')\r\n\t);\r\n};\r\n\r\nWOQLQuery.prototype.getDataOfProperty = function (chosen) {\r\n\treturn this.and(\r\n\t\tWOQL.triple('v:Document', chosen, 'v:Value'),\r\n\t\tWOQL.opt().triple('v:Document', 'rdfs:label', 'v:Label')\r\n\t);\r\n};\r\n\r\nWOQLQuery.prototype.documentProperties = function (id) {\r\n\treturn this.and(\r\n\t\t'WOQL.triple(id, \"v:Property\", \"v:Property_Value\")',\r\n\t\t'WOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\")',\r\n\t\t'WOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\")'\r\n\t);\r\n};\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function (url) {\r\n\treturn this.and(\r\n\t\tWOQL.triple(url, 'rdf:type', 'v:InstanceType'),\r\n\t\tWOQL.opt().triple(url, 'rdfs:label', 'v:InstanceLabel'),\r\n\t\tWOQL.opt().triple(url, 'rdfs:comment', 'v:InstanceComment'),\r\n\t\tWOQL.opt().quad('v:InstanceType', 'rdfs:label', 'v:ClassLabel', 'db:schema')\r\n\t);\r\n};\r\n\r\nWOQLQuery.prototype.simpleGraphQuery = function () {\r\n\treturn this.and(\r\n\t    WOQL.triple('v:Source', 'v:Edge', 'v:Target'),\r\n\t    WOQL.isa('v:Source', 'v:Source_Class'),\r\n\t    WOQL.sub('v:Source_Class', 'tcs:Document'),\r\n\t    WOQL.isa('v:Target', 'v:Target_Class'),\r\n\t    WOQL.sub('v:Target_Class', 'tcs:Document'),\r\n\t    WOQL.opt().triple('v:Source', 'rdfs:label', 'v:Source_Label'),\r\n\t    WOQL.opt().triple('v:Source', 'rdfs:comment', 'v:Source_Comment'),\r\n\t    WOQL.opt().quad('v:Source_Class', 'rdfs:label', 'v:Source_Type', 'db:schema'),\r\n\t    WOQL.opt().quad('v:Source_Class', 'rdfs:comment', 'v:Source_Type_Comment', 'db:schema'),\r\n\t    WOQL.opt().triple('v:Target', 'rdfs:label', 'v:Target_Label'),\r\n\t    WOQL.opt().triple('v:Target', 'rdfs:comment', 'v:Target_Comment'),\r\n\t    WOQL.opt().quad('v:Target_Class', 'rdfs:label', 'v:Target_Type', 'db:schema'),\r\n\t    WOQL.opt().quad('v:Target_Class', 'rdfs:comment', 'v:Target_Type_Comment', 'db:schema'),\r\n\t    WOQL.opt().quad('v:Edge', 'rdfs:label', 'v:Edge_Type', 'db:schema'),\r\n\t    WOQL.opt().quad('v:Edge', 'rdfs:comment', 'v:Edge_Type_Comment', 'db:schema')\r\n\t);\r\n};\r\n\r\nfunction WOQLSchema() {\r\n\tthis.triples = [];\r\n\tthis.subject = false;\r\n}\r\n\r\nWOQLSchema.prototype.execute = function (client) {\r\n\tconst subs = [];\r\n\tfor (let i = 0; i < this.triples.length; i++) {\r\n\t\tsubs.push(WOQL.add_quad(...this.triples[i], 'db:schema'));\r\n\t}\r\n\treturn WOQL.and(subs).execute(client);\r\n};\r\n\r\nWOQLSchema.prototype.getO = function (s, p) {\r\n\tfor (let i = 0; i < this.triples.length; i++) {\r\n\t\tif (this.triples[i][0] == s && this.triples[i][1] == p) return this.triples[i][2];\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n\r\nWOQLSchema.prototype.addPO = function (p, o) {\r\n\tthis.triples.push([this.subject, p, o]);\r\n\treturn this;\r\n};\r\n\r\nWOQLSchema.prototype.addClass = function (c) {\r\n\tthis.subject = c;\r\n\treturn this.addPO('rdf:type', 'owl:Class');\r\n};\r\n\r\nWOQLSchema.prototype.addProperty = function (p, t) {\r\n\tthis.subject = p;\r\n\tthis.addPO('rdfs:range', t);\r\n\tif (WOQL.isLiteralType(t)) {\r\n\t\treturn this.addPO('rdf:type', 'owl:DatatypeProperty');\r\n\t}\r\n\r\n\treturn this.addPO('rdf:type', 'owl:ObjectProperty');\r\n};\r\n\r\nWOQLSchema.prototype.label = function (l, lang) {\r\n\tlang = (lang || 'en');\r\n\treturn this.addPO('rdfs:label', { '@value': l, '@language': 'en' });\r\n};\r\n\r\nWOQLSchema.prototype.comment = function (c, lang) {\r\n\tlang = (lang || 'en');\r\n\treturn this.addPO('rdfs:comment', { '@value': c, '@language': 'en' });\r\n};\r\n\r\nWOQLSchema.prototype.parent = function (...p) {\r\n\treturn this.addPO('rdfs:subClassOf', p);\r\n};\r\n\r\nWOQLSchema.prototype.abstract = function () {\r\n\treturn this.addPO('tcs:tag', 'tcs:abstract');\r\n};\r\n\r\nWOQLSchema.prototype.entity = function () {\r\n\treturn this.parent('tcs:Entity');\r\n};\r\n\r\nWOQLSchema.prototype.relationship = function () {\r\n\treturn this.parent('tcs:Relationship');\r\n};\r\n\r\nWOQLSchema.prototype.card = function (n, which) {\r\n\tconst os = this.subject;\r\n\tthis.subject += `_${which}`;\r\n\tthis.addPO('rdf:type', 'owl:Restriction');\r\n\tthis.addPO('owl:onProperty', os);\r\n\tswitch (which) {\r\n\tcase 'max': this.addPO('owl:maxCardinality', n);\r\n\t\tbreak;\r\n\tcase 'min': this.addPO('owl:minCardinality', n);\r\n\t\tbreak;\r\n\tdefault: this.addPO('owl:cardinality', n);\r\n\t}\r\n\tconst od = this.getO(os, 'rdfs:domain');\r\n\tif (od) {\r\n\t\tthis.triples.push([od, 'rdfs:subClassOf', this.subject]);\r\n\t}\r\n\tthis.subject = os;\r\n\treturn this;\r\n};\r\n\r\nWOQLSchema.prototype.max = function (m) {\r\n\treturn this.card(m, 'max');\r\n};\r\n\r\nWOQLSchema.prototype.min = function (m) {\r\n\treturn this.card(m, 'min');\r\n};\r\n\r\nWOQLSchema.prototype.cardinality = function (m) {\r\n\treturn this.card(m, 'cardinality');\r\n};\r\n\r\nWOQLSchema.prototype.domain = function (d) {\r\n\treturn this.addPO('rdfs:domain', d);\r\n}\r\n/*\r\n *\r\n\r\n let s = WOQL.schema();\r\n s.addClass(\"myclass\").label(\"whatever\").comment(\"yo\").entity();\r\n s.addProperty(\"myprop\", \"string\").label(\"whatever\").comment(\"yo\").domain(\"myclass\").max(1);\r\n s.execute(client).then()\r\n\r\n WOQL.when(WQOL.query().get(mytwitterfriends).column(\"adfa\").as(\"v:X\").update(triple(v:X));\r\n\r\n WOQL.select(\"fadfadf\").execute().done()\r\n g = WOQL.graph()....\r\n show(result, g);\r\n\r\n *\r\n *\r\n *\r\n *\r\n\r\n\r\n *\r\n */\r\n\r\n\r\nmodule.exports = WOQL;\r\n","const FrameHelper = require('./frameHelper');\r\n\r\nfunction WOQLResult(results, query, config) {\r\n\tthis.bindings = results.bindings;\r\n\tthis.query = query;\r\n\tthis.cursor = 0;\r\n\tif (!(config && config.no_compress)) {\r\n\t\tconst context = (config && config.context ? config.context : false);\r\n\t\tthis.compress(context);\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.compress = function (context) {\r\n\tcontext = (context || this.query.getContext());\r\n\tfor (let i = 0; i < this.bindings.length; i++) {\r\n\t\tfor (const prop of Object.keys(this.bindings[i])) {\r\n\t\t\tconst nprop = FrameHelper.shorten(prop, context);\r\n\t\t\tconst nval = ((typeof this.bindings[i][prop] === 'string')\r\n\t\t\t\t? FrameHelper.shorten(this.bindings[i][prop], context)\r\n\t\t\t\t: this.bindings[i][prop]\r\n\t\t\t);\r\n\t\t\tdelete (this.bindings[i][prop]);\r\n\t\t\tthis.bindings[i][nprop] = nval;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.first = function () {\r\n\tthis.cursor = 0;\r\n\treturn this.bindings[0];\r\n};\r\n\r\nWOQLResult.prototype.last = function () {\r\n\tthis.curor = this.bindings.length - 1;\r\n\treturn this.bindings[this.bindings.length - 1];\r\n};\r\n\r\nWOQLResult.prototype.next = function () {\r\n\tconst res = this.bindings[this.cursor];\r\n\tthis.cursor++;\r\n\treturn res;\r\n};\r\n\r\nWOQLResult.prototype.prev = function () {\r\n\tif (this.cursor > 0) {\r\n\t\tthis.cursor--;\r\n\t\treturn this.bindings[this.cursor];\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.compareValues = function(a, b, asc_or_desc){\r\n\tif(!a || !b) return 0;\r\n\tif(typeof a['@value'] != \"undefined\" && typeof b['@value'] != \"undefined\"){\r\n\t\ta = a['@value'];\r\n\t\tb = b['@value'];\r\n\t}\r\n\tif (a > b) {\r\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? 1 : -1);\r\n\t}\r\n\tif (b > a) {\r\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? -1 : 1);\r\n\t}\r\n};\r\n\r\n\r\nWOQLResult.prototype.sort = function (key, asc_or_desc) {\r\n\tthis.bindings.sort((a, b) => this.compareValues(a[key], b[key], asc_or_desc));\r\n};\r\n\r\nWOQLResult.prototype.getVariableList = function () {\r\n\tif (this.bindings && this.bindings[0]) {\r\n\t\treturn Object.keys(this.bindings[0]);\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.count = function () {\r\n\treturn this.bindings.length;\r\n};\r\n\r\nWOQLResult.prototype.hasBindings = function (result) {\r\n\treturn (this.bindings && this.bindings.count());\r\n};\r\n\r\nWOQLResult.prototype.getBindings = function () {\r\n\treturn this.bindings;\r\n};\r\n\r\nmodule.exports = WOQLResult;\r\n","function Codemirror(text, format, config){\r\n  this.textdom = text;\r\n  this.mode = format;\r\n  this.darkMode = config.darkMode;\r\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\r\n}\r\n\r\n/*\r\ntxtar    : editor is attached to textar\r\nmode     : format for highlighting, ex: json, html etc.\r\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\r\nCodemirror.prototype.colorizeTextArea = function(mode){\r\n    //initize auto complete\r\n    /*CodeMirror.commands.autocomplete = function(cm) {\r\n    cm.showHint({hint: CodeMirror.hint.anyword});\r\n    }*/\r\n\r\n    // initialise code editor on text area\r\n    var editor = CodeMirror.fromTextArea(this.textdom, {\r\n        mode                : this.mode,\r\n        firstLineNumber     : 1,\r\n        lineNumbers         : true,\r\n        styleActiveLine     : true,\r\n        lineWrapping        : true,\r\n        smartIndent         : true,\r\n        indentWithTabs      : true,\r\n        newlineAndIndent    : true,\r\n        autoCloseBrackets   : true,\r\n        matchBrackets       : {afterCursor: true},\r\n        extraKeys           : {\"Ctrl-F\": \"find\", \"Tab\": \"autocomplete\" },\r\n        refresh             : true\r\n    });\r\n\r\n    this.setCodemirrorSize(editor, mode);\r\n    editor.defaultCharWidth('20px');\r\n    if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\r\n    else editor.setOption(\"theme\", 'neo');\r\n\r\n    return editor;\r\n} // colorizeTextArea()\r\n\r\n/*\r\n  set editor size according to screens\r\n  editor : code mirror editor Object\r\n  mode   : editor being viewed from schema/ doc/ query page*/\r\nCodemirror.prototype.setCodemirrorSize = function(editor, mode){\r\n  switch(mode){\r\n    case 'query':\r\n      editor.setSize('800', '400');\r\n    break;\r\n    case 'schema':\r\n      editor.setSize('auto', '1550');\r\n    break;\r\n    case 'document':\r\n     editor.setSize('765', '500');\r\n    break;\r\n    case 'api-doc':\r\n        editor.setSize('800', '500');\r\n    break;\r\n    case 'doc-json':\r\n        editor.setSize('1410', 'auto');\r\n    break;\r\n    case 'doc-json-create':\r\n        editor.setSize('1410', '500');\r\n    break;\r\n  } // switch(mode)\r\n} // setCodemirrorSize()\r\n\r\n// updateTextArea(): highlights new changes on editor\r\nCodemirror.prototype.updateTextArea = function(editor){\r\n  editor.save();\r\n  setTimeout(function() {\r\n      editor.refresh();\r\n  },1);\r\n  // save changes of code mirror editor\r\n  editor.on('change', function(){\r\n    editor.save();\r\n  });\r\n} //updateTextArea()\r\n\r\n/*\r\ncolorizePre() to colorise pre tags (read only mode)\r\ntext (string)    : The document to run through the highlighter.\r\nmode (mode spec) : format to highlight color\r\noutput (DOM node): The tokens will be converted to spans as in an editor,\r\n                   and inserted into the node (through innerHTML).*/\r\nCodemirror.prototype.colorizePre = function(){\r\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\r\n  if(this.darkMode)\r\n      var theme = 'cm-s-erlang-dark';\r\n  else var theme = 'cm-s-neo';\r\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\r\n  return this.textdom;\r\n} // colorizePre()\r\n\r\nCodemirror.prototype.jsonldCheck = function(format){\r\n  if(format == 'jsonld') return true;\r\n}\r\n\r\nmodule.exports=Codemirror\r\n","/**\r\n * object renderer binds to object frame - provides filters, sorts and manipulations of underlying object frame\r\n * and coordinates viewer to draw updates\r\n\r\n * Object Renderer - provides sorting / filtering / state management of objects\r\n * @param obj ObjectFrame object - contains underlying data and frame structure\r\n * @param parent PropertyRenderer - property that owns this object (if any)\r\n * @param options options json\r\n * @returns\r\n */\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst ValueRenderer = require('./ValueRenderer');\r\nconst ObjectViewer = require('../html/document/ObjectViewer');\r\nconst PropertyViewer = require('../html/document/PropertyViewer');\r\nconst HTMLDataViewer = require('../html/document/DataViewer');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\n\r\nfunction PropertyRenderer(prop, parent, options){\r\n\tthis.predicate = prop;\r\n\tthis.parent = parent;\r\n\tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n\tthis.originalValues = false;\r\n\tthis.changed = false;\r\n\tthis.values = [];\r\n\tthis.renderer_type = \"property\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nPropertyRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForChild = function(){\r\n\tvar opts = {};\r\n\tif(this.options.features){ opts.features = this.options.features };\r\n\tif(this.options.controls){ opts.controls = this.options.controls};\r\n\treturn this.options;\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForValue = function(df, index){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForObject = function(objframe){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.render = function(viewer){\r\n \tthis.buildValueRenderers();\r\n \tif(this.cframe && this.cframe.property){\r\n \t\tthis.viewer = (viewer ? viewer : this.getViewerForProperty());\r\n \t\tfor(var i = 0; i<this.values.length; i++){\r\n \t\t\tvar renderedval = this.values[i].render();\r\n \t\t\tif(renderedval && this.showFeature(\"body\")) this.viewer.addRenderedValue(renderedval);\r\n \t\t}\r\n \t\treturn this.viewer.render();\r\n \t}\r\n}\r\n\r\n/*\r\n * Creates the array of object renderer or value renderer objects corresponding to the property values.\r\n */\r\nPropertyRenderer.prototype.buildValueRenderers = function(){\r\n \tvar adorig = (this.originalValues === false ? true : false);\r\n \tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n \tif(!this.cframe){\r\n \t\tconsole.error(\"No frame for \" + this.property() + \" id: \" + this.subject());\r\n \t\treturn false;\r\n \t}\r\n \tif(this.cframe && this.cframe.isData()){\r\n \t\tvar dataframes = this.getDataFramesToRender();\r\n \t\tif(dataframes.length == 0){\r\n \t\t\talert(this.predicate);\r\n \t\t}\r\n \t\tvar vals = [];\r\n \t\tfor(var i = this.values.length; i<dataframes.length; i++){\r\n \t\t\tvar vr = new ValueRenderer(dataframes[i], i, this, this.getOptionsForValue(dataframes[i], i));\r\n \t\t\tthis.values.push(vr);\r\n \t\t\tvals.push(vr.value());\r\n \t\t}\r\n \t\tif(adorig) this.originalValues = vals;\r\n \t}\r\n \telse {\r\n \t\tif(adorig) this.originalValues = [];\r\n \t\tvar kids = this.getChildrenToRender();\r\n \t\tif(kids && kids.length){\r\n \t\t\tfor(var i = this.values.length; i<kids.length; i++){\r\n \t\t\t\tvar kidf = new ObjectRenderer(kids[i], this, this.getOptionsForObject(kids[i]));\r\n \t\t\t\tif(adorig) this.originalValues.push(kidf.subject());\r\n \t\t\t\tthis.values.push(kidf);\r\n \t\t\t}\r\n \t\t}\r\n \t}\r\n}\r\n\r\n/*\r\n * Returns the array of values that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getDataFramesToRender = function(options){\r\n \tvar allvals = this.parent.objframe.getDataFrames(this.property());\r\n \treturn allvals;\r\n}\r\n\r\n/*\r\n * Returns the array of child / objects that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getChildrenToRender = function(options){\r\n \tif(TerminusClient.FrameHelper.viewIncludesChildren(this.view, \"property\")){\r\n \t\tvar allkids = this.parent.objframe.getChildren(this.property());\r\n \t}\r\n \telse {\r\n \t\tvar allkids = [];\r\n \t}\r\n \treturn allkids;\r\n}\r\n\r\nPropertyRenderer.prototype.redraw = function(){\r\n \tthis.viewer.clear();\r\n \tthis.render(this.viewer, \"x\");\r\n \t//alert(this.values.length);\r\n}\r\n\r\nPropertyRenderer.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n \tif(this.cframe.isData()){\r\n \t\treturn extracts;\r\n \t}\r\n \telse {\r\n \t\treturn extracts;\r\n \t\tvar extr = {};\r\n \t\tfor(var i = 0; i<extracts.length; i++){\r\n \t\t\tfor(var subjid in extracts[i]){\r\n \t\t\t\textr[subjid] = extracts[i][subjid];\r\n \t\t\t}\r\n \t\t}\r\n \t\treturn extr;\r\n \t}\r\n}\r\n\r\n/*\r\n * simple wrapper functions\r\n */\r\nPropertyRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\nPropertyRenderer.prototype.property = function(){return this.predicate;}\r\nPropertyRenderer.prototype.subject = function(){return (this.parent ? this.parent.subject() : false);};\r\nPropertyRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nPropertyRenderer.prototype.subjectClass = function(){return (this.parent ? this.parent.subjectClass() : false);};\r\nPropertyRenderer.prototype.updated = function(){ return (this.parent ? this.parent.childUpdated() : false);};\r\nPropertyRenderer.prototype.range = function(){\treturn (this.cframe ? this.cframe.range : \"\");};\r\nPropertyRenderer.prototype.getLabel = function(){ return (this.cframe ? this.cframe.getLabel() : \"\" );};\r\nPropertyRenderer.prototype.getComment = function(){ return (this.cframe ? this.cframe.getComment() : false);}\r\nPropertyRenderer.prototype.load = function(link){ return (this.parent ? this.parent.load(link) : false);}\r\nPropertyRenderer.prototype.hasCardinalityRestriction = function(){return (this.cframe ? this.cframe.hasRestriction() : false);};\r\nPropertyRenderer.prototype.getRestriction = function(){return (this.cframe ? this.cframe.restriction : false);};\r\nPropertyRenderer.prototype.isClassChoice = function(){\treturn (this.cframe ? this.cframe.isClassChoice() : false);};\r\nPropertyRenderer.prototype.currentFacet = function(){\treturn this.facet;} ;\r\nPropertyRenderer.prototype.save = function(){ return (this.parent ? this.parent.save() : false);};\r\n\r\nPropertyRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableClassChoices = function(){\r\n\tif(this.cframe){\r\n\t\tvar cf = this.cframe.getClassChoices();\r\n\t\tif(this.parent){\r\n\t\t\tvar choices = [];\r\n\t\t\tfor(var i = 0; i < cf.length; i++){\r\n\t\t\t\tvar clsmeta = this.parent.getClassMeta(cf[i]);\r\n\t\t\t\tvar lab = (clsmeta ? HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clsmeta) : false);\r\n\t\t\t\tvar lab = (lab ? lab : TerminusClient.FrameHelper.labelFromURL(cf[i]));\r\n\t\t\t\tchoices.push({value: cf[i], label: lab});\r\n\t\t\t}\r\n\t\t\treturn choices;\r\n\t\t}\r\n\t\treturn cf;\r\n\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n\r\nPropertyRenderer.prototype.delete = function(){\r\n\tvar prop = this.predicate;\r\n\tif(prop){\r\n\t\tthis.reset();\r\n\t\tthis.parent.deleteProperty(prop);\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nPropertyRenderer.prototype.add = function(view){\r\n\tthis.parent.addProperty(this.property(), view);\r\n\tthis.updated();\r\n\tif(view) {\r\n\t\tthis.values[this.values.length-1].setMode(view);\r\n\t\tthis.values[this.values.length-1].setNew();\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.goToValue = function(index){\r\n\tthis.viewer.goTo(this.subject(), this.property(), index);\r\n}\r\n\r\nPropertyRenderer.prototype.addClass = function(cls){\r\n\tthis.parent.addPropertyClass(this.property(), cls);\r\n\tthis.updated();\r\n\tvar newb = this.values[this.values.length-1];\r\n\tif(newb){\r\n\t\tnewb.setNew();\r\n\t\tnewb.setMode(\"edit\");\r\n\t}\r\n\tthis.redraw();\r\n\tif(newb) this.viewer.goTo(newb.subject());\r\n}\r\n\r\nPropertyRenderer.prototype.reset = function(){\r\n\tthis.parent.objframe.reset(this.predicate);\r\n\tif(this.cframe && this.cframe.isData()){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t\tthis.values = [];\r\n\t}\r\n\telse {\r\n\t\tvar nvals = [];\r\n\t\tfor(var i = 0; i<this.originalValues.length; i++){\r\n\t\t\tfor(var j = 0; j<this.values.length; j++){\r\n\t\t\t\tthis.values[j].reset();\r\n\t\t\t\tif(this.values[j].subject() == this.originalValues[i]){\r\n\t\t\t\t\tnvals.push(this.values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.values = nvals;\r\n\t}\r\n\tthis.redraw();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nPropertyRenderer.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.objframe.removePropertyValue(this.property(), value, index);\r\n\tvar nvals = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(typeof index == \"undefined\"){\r\n\t\t\tif(this.values[i].subject() == value){\r\n\t\t\t\tthis.values[i].reset();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnvals.push(this.values[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(i != index){\r\n\t\t\tthis.values[i].index = nvals.length;\r\n\t\t\tnvals.push(this.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t}\r\n\tthis.values = nvals;\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.addPropertyValue = function(value){\r\n\tthis.updated();\r\n\treturn this.parent.objframe.addPropertyValue(this.property(), value);\r\n}\r\n\r\n/*\r\n * Checks to see if an action (add, clone, delete) which affects the cardinality of the property is allowed by cardinality rules.\r\n */\r\nPropertyRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyRenderer.prototype.isNew = function(){\r\n\tif(this.new_property){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\nPropertyRenderer.prototype.setNew = function(){\r\n\tthis.new_property = true;\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.isUpdated = function(){\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\n\r\n/**\r\n * Sets mode of viewer to either \"view\" or \"edit\"\r\n */\r\nPropertyRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tthis.values[i].setMode(mode);\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\n/*\r\n * Jump to property value\r\n */\r\nPropertyRenderer.prototype.getViewableValues = function(){\r\n\tvar viewables = [];\r\n\tif(this.cframe && this.cframe.isData())\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvar sum = this.values[i].getSummary();\r\n\t\tvar lab = sum.long;\r\n\t\tviewables.push({label: lab, value: i});\r\n\t}\r\n\treturn viewables;\r\n}\r\n\r\nPropertyRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nPropertyRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.parentFacetChange = function(facet){\r\n\tif(facet == 'page'){\r\n\t\tif(!(this.facet == \"page\" || this.facet == \"multiline\")){\r\n\t\t\tthis.setFacet('multiline');\r\n\t\t}\r\n\t}\r\n\tif(facet == 'line'){\r\n\t\tthis.setFacet(\"label\");\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tmultiline: {\r\n\t\t\tlabel: \"Multiple Lines\", value: \"multiline\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n\tvar facets = [];\r\n\tfacets.push({label: \"Full Page\", value: \"page\"});\r\n\tfacets.push({label: \"Multiple Lines\", value: \"multiline\"});\r\n\tfacets.push({label: \"Single Line\", value: \"line\"});\r\n\tfacets.push({label: \"Summary\", value: \"summary\"});\r\n\tfacets.push({label: \"Label\", value: \"label\"});\r\n\tfacets.push({label: \"Snippet\", value: \"icon\"});\r\n\treturn facets;\r\n}\r\n\r\nPropertyRenderer.prototype.getContentOrientation = function(facet){\r\n\tif(this.currentFacet() == \"page\" || this.containsPage()){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\" || this.currentFacet() == \"multiline\" || this.currentFacet() == \"summary\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.cframe && this.cframe.isObject()){\r\n\t\treturn \"page\";\r\n\t}\r\n\treturn \"multiline\";\r\n}\r\n\r\n/*\r\n * Viewers for specific properties\r\n */\r\n\r\nPropertyRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nPropertyRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nPropertyRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableViewers = function(){\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailablePropertyViewers(this);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailablePropertyEditors(this);\r\n}\r\n\r\nPropertyRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nPropertyRenderer.prototype.containsPage = function(){\r\n\t//collapsed facets do not show their values\r\n\tif(this.currentFacet() == \"icon\" || this.currentFacet() == \"label\") return false;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i].facet == \"page\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.getViewerForProperty = function(ptype){\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n\t}\r\n\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n}\r\n\r\nPropertyRenderer.prototype.getPropertyHeaderViewer = function(){\r\n\treturn new PropertyViewer.HTMLPropertyHeaderViewer();\r\n}\r\n\r\nPropertyRenderer.prototype.getSummary = function(){\r\n\tvar status = \"ok\";\r\n\tif(this.isNew()) status = \"new\";\r\n\telse if(this.isUpdated()) status = \"updated\";\r\n\tvar ret = {\r\n\t\tstatus: status,\r\n\t\tvalcount: this.values.length\r\n\t};\r\n\tret.long = ((ret.valcount != 1) ? \"(\" + ret.valcount + \") \" : \"\");\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvsum = this.values[i].getSummary();\r\n\t\tret.long += vsum.long;\r\n\t\tif(i < this.values.length-1) ret.long += \", \";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nPropertyRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nPropertyRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\nfunction ObjectRenderer(obj, parent, options){\r\n\tthis.objframe = obj;\r\n\tthis.parent = parent;\r\n\tthis.properties = {};\r\n\tthis.originalProperties = false;\r\n\tthis.newProperties = [];\r\n\tthis.renderer_type = \"object\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\n//options has to include mode, viewer, facet, controls, features, hide_disabled_controls\r\n\r\nObjectRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nObjectRenderer.prototype.getOptionsForProperty = function(prop){\r\n\treturn this.options;\r\n}\r\n\r\nObjectRenderer.prototype.render = function(viewer){\r\n\tthis.buildPropertyRenderers();\r\n\tthis.viewer = (viewer ? viewer: this.getViewerForObject());\r\n\tfor(var prop in this.properties){\r\n\t\tvar renderedprop = this.properties[prop].render();\r\n\t\tif(renderedprop && this.showFeature(\"body\")) this.viewer.addRenderedProperty(prop, renderedprop);\r\n\t}\r\n\treturn this.viewer.render(this.view);\r\n}\r\n\r\nObjectRenderer.prototype.buildPropertyRenderers = function(){\r\n\tvar props = this.getPropertiesToRender();\r\n\tif(this.originalProperties === false) this.originalProperties = props;\r\n\tvar renders = {};\r\n\tfor(var j = 0; j<props.length; j++){\r\n\t\tif(typeof this.properties[props[j]] == \"undefined\"){\r\n\t\t\trenders[props[j]] = new PropertyRenderer(props[j], this, this.getOptionsForProperty(props[j]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenders[props[j]] = this.properties[props[j]];\r\n\t\t}\r\n\t\tif(this.newProperties.indexOf(props[j]) != -1) {\r\n\t\t\trenders[props[j]].setNew();\r\n\t\t\trenders[props[j]].mode = \"edit\";\r\n\t\t}\r\n\t}\r\n\tthis.properties = renders;\r\n}\r\n\r\nObjectRenderer.prototype.subject = function(){\r\n\tif(this.objframe) return this.objframe.subjid;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.subjectClass = function(){\r\n\tif(this.objframe) return this.objframe.cls;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableViewers = function(){\r\n\t//if(this.mode == \"view\"){\r\n\t//\treturn RenderingMap.getAvailableObjectViewers(this);\r\n\t//}\r\n\t//return RenderingMap.getAvailableObjectEditors(this);\r\n\treturn [\"html\", \"json\"];\r\n}\r\n\r\nObjectRenderer.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.property = function(){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent && this.parent.parent.objframe){\r\n\t\treturn this.parent.parent.objframe;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.load = function(link){\r\n\tvar self = this;\r\n\tif(this.controller){\r\n\t\tthis.controller.ui.showDocument(link);\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.load(link);\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.copy = function(nkid){\r\n\tnkid = (nkid ? nkid : this.objframe);\r\n\tvar other = new ObjectRenderer(nkid, this.parent, this.options);\r\n\treturn other;\r\n}\r\n\r\nObjectRenderer.prototype.clone = function(){\r\n\tif(this.root()){\r\n\t\tthis.objframe = this.objframe.clone(\"_:\");\r\n\t\tthis.objframe.newDoc = true;\r\n\t\tthis.setMode(\"edit\");\r\n\t}\r\n\telse {\r\n\t\tvar nkid = this.objframe.clone(TerminusClient.FrameHelper.genBNID());\r\n\t\tvar parentobj = this.parentObject();\r\n\t\tvar prop = this.property();\r\n\t\tif(parentobj && prop){\r\n\t\t\tif(typeof parentobj.children[prop] == \"undefined\"){\r\n\t\t\t\tparentobj.children[prop] = [];\r\n\t\t\t}\r\n\t\t\tparentobj.children[prop].push(nkid);\r\n\t\t\tvar newrend = this.copy(nkid);\r\n\t\t\tthis.parent.values.push(newrend);\r\n\t\t}\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nObjectRenderer.prototype.save = function(){\r\n\tif(this.controller){\r\n\t\tif(this.isNewDocument()){\r\n\t\t\tvar demandid = this.inputID();\r\n\t\t\tif(demandid == \"_:\") demandid = \"\";\r\n            var extr = this.extract();\r\n\t\t\tthis.controller.createDocument(demandid, extr);\r\n\t\t}\r\n\t\telse {\r\n            var extr = this.extract();\r\n\t\t\tthis.controller.updateDocument(extr);\r\n\t\t}\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.delete = function(){\r\n\tvar dval = this.subject();\r\n\tif(this.controller && this.root()){\r\n\t\tif(!this.isNewDocument()){\r\n\t\t\tthis.controller.deleteDocument(dval);\r\n\t\t}\r\n\t\tthis.nukeViewer();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent){\r\n\t\t\tthis.parent.deletePropertyValue(dval);\r\n\t\t\tthis.parent.redraw();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.reset = function(){\r\n\tthis.objframe.reset();\r\n\tvar nprops = {};\r\n\tfor(var i = 0; i<this.originalProperties.length; i++){\r\n\t\tvar prop = this.originalProperties[i];\r\n\t\tif(typeof this.properties[prop] == \"object\"){\r\n\t\t\tthis.properties[prop].reset();\r\n\t\t\tnprops[prop] = this.properties[prop];\r\n\t\t}\r\n\t}\r\n\tthis.properties = nprops;\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.deleteProperty = function(prop){\r\n\tthis.objframe.removeProperty(prop);\r\n\tdelete(this.properties[prop]);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.addProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.addNewProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.newProperties.push(prop);\r\n\tthis.redraw();\r\n\tthis.goToProperty(prop);\r\n}\r\n\r\nObjectRenderer.prototype.addPropertyClass = function(prop, cls){\r\n\tthis.objframe.addProperty(prop, cls);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.changeClass = function(cls){\r\n\tif(this.parent){\r\n\t\tthis.parent.addClass(cls);\r\n\t\tthis.parent.deletePropertyValue(this.subject());\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getClassMeta = function(cls){\r\n\tvar ctl = this.getController();\r\n\tif(ctl && ctl.classmeta && ctl.classmeta[cls]){\r\n\t\treturn ctl.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getController = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller;\r\n\t}\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getClient = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller.getClient();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent && this.parent.parent){\r\n\t\t\treturn(this.parent.parent.getClient())\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.inputID = function(){\r\n\tif(this.idDOM){\r\n\t\treturn this.idDOM.value;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isNew = function(){\r\n\tif(this.new_object){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.isPartOfNewDocument()){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.parent) return this.parent.isNew();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setNew = function(){\r\n\tthis.new_object = true;\r\n}\r\n\r\nObjectRenderer.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalProperties[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\r\n\t}\r\n\tif(i != this.originalProperties.length) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\nObjectRenderer.prototype.updated = ObjectRenderer.prototype.childUpdated;\r\n\r\nObjectRenderer.prototype.isNewDocument = function(){\r\n\tif(this.root() && this.objframe.isnew()) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isPartOfNewDocument = function(){\r\n\tif(this.isNewDocument()) return true;\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.isPartOfNewDocument();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var prop in this.properties){\r\n\t\t\tthis.properties[prop].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tif(this.parent){\r\n\t\tthis.parent.redraw();\r\n\t}\r\n\telse {\r\n\t\tthis.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.keys(this.facets);\r\n}\r\n\r\nObjectRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacet = function(){\r\n\tif(!this.parent) return \"page\";\r\n\tvar pfacet = this.parent.currentFacet();\r\n\tif(pfacet == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(pfacet == \"multiline\") return \"line\";\r\n\tif(pfacet == \"line\") return \"summary\";\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"line\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"summary\");\r\n}\r\n\r\nObjectRenderer.prototype.getContentOrientation = function(){\r\n\tif(this.currentFacet() == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.getLabel = function(){\r\n\tfor(var prop in this.properties){\r\n\t\tif(TerminusClient.FrameHelper.getShorthand(prop) == \"rdfs:label\" || prop == \"rdfs:label\"){\r\n\t\t\tvar prend = this.properties[prop];\r\n\t\t\tvar vrend = prend.values[0];\r\n\t\t\tif(vrend){\r\n\t\t\t\tvar sum = vrend.getSummary();\r\n\t\t\t\tif(sum.long != \"empty\") return sum.long;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar s = this.subject();\r\n\tif(s && s.substring(0, 2) == \"_:\"){\r\n\t\tvar ty = this.subjectClass();\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(ty);\r\n\t\tif(!sh) sh = ty;\r\n\t\tvar b = sh.split(\":\");\r\n\t\tif(b.length > 1){\r\n\t\t\treturn \"New \" + b[1];\r\n\t\t}\r\n\t\treturn \"New Object\";\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\r\n}\r\n\r\nObjectRenderer.prototype.getObjectHeaderViewer = function(){\r\n\treturn this.header_viewer;\r\n}\r\n\r\nObjectRenderer.prototype.getViewerForObject = function(format){\r\n\tif(format == \"json\"){\r\n\t\treturn new ObjectViewer.JSONObjectViewer(this);\r\n\t}\r\n\treturn new ObjectViewer.HTMLObjectViewer(this);\r\n}\r\n\r\nObjectRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nObjectRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nObjectRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(this.isNewDocument() && which == \"clone\") return false;\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\tif (fets.indexOf(which) != -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.goToProperty = function(prop){\r\n\tthis.viewer.goTo(this.subject(), prop);\r\n}\r\n\r\nObjectRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var prop in this.properties){\r\n\t\tthis.properties[prop].setMode(mode);\r\n\t}\r\n\tthis.viewer.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\n\r\n\r\nObjectRenderer.prototype.setViewer = function(viewer){\r\n\tvar nviewer = this.getViewerForObject(viewer);\r\n\tif(nviewer){\r\n\t\tthis.viewerType = viewer;\r\n\t\tthis.viewer = nviewer;\r\n\t\tthis.viewer.redraw();\r\n\t}\r\n}\r\n\r\n\r\nObjectRenderer.prototype.setView = function(view){\r\n\tvar views = {\r\n\t\t\"full\": {\r\n\r\n\t\t},\r\n\t\t\"hidden\": {\r\n\r\n\t\t}\r\n\t};\r\n\tthis.view = view;\r\n\tthis.viewer.redraw();\r\n}\r\n\r\n\r\nObjectRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nObjectRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nObjectRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nObjectRenderer.prototype.getViewableProperties = function(){\r\n\treturn this.objframe.getFilledPropertyList();\r\n}\r\n\r\nObjectRenderer.prototype.getAddableProperties = function(){\r\n\tvar props = this.objframe.getMissingPropertyList();\r\n\treturn props;\r\n}\r\n\r\nObjectRenderer.prototype.getPropertiesToRender = function(options){\r\n\tvar sort = this.standardSort;\r\n\tvar filter = function(){return true};\r\n\tif(options && options.map && options.map.patterns){\r\n\t\t/*for(var i = 0; i<options.map.patterns.length; i++){\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"sort\"}, options.map.patterns[i])){\r\n\t\t\t\tsort = options.map.patterns[i].sort;\r\n\t\t\t}\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"filter\"}, options.map.patterns[i])){\r\n\t\t\t\tfilter = options.map.patterns[i].filter;\r\n\t\t\t}\r\n\t\t}*/\r\n\t}\r\n\treturn sort(this.objframe, filter);\r\n}\r\n\r\nObjectRenderer.prototype.standardSort = function(objframe, filter){\r\n\tvar sorted = [];\r\n\tvar rdft = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\");\r\n\tif(objframe.dataframes[rdft] && filter(objframe, rdft, objframe.dataframes[rdft])){\r\n\t\tsorted.push(rdft);\r\n\t}\r\n\tvar rdfc = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"comment\");\r\n\tif(objframe.dataframes[rdfc]){\r\n\t\tsorted.push(rdfc);\r\n\t}\r\n\tfor(var prop in objframe.dataframes){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\tfor(var prop in objframe.children){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\treturn sorted;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\nObjectRenderer.prototype.extractLDO = function(extracts){\r\n\textracts[\"rdf:type\"] = this.objframe.cls;\r\n\tvar full = {};\r\n\tfull[this.subject()] = extracts;\r\n\treturn full;\r\n}\r\n\r\nObjectRenderer.prototype.extractJSONLD = function(extracts){\r\n\textracts[\"@type\"] = this.objframe.cls;\r\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\r\n\tif(this.objframe.jsonld_context) extracts['@context'] = this.objframe.jsonld_context;\r\n\treturn extracts;\r\n}\r\n\r\nObjectRenderer.prototype.extract = function(){\r\n\tvar extracts = {};\r\n\tfor(var i in this.properties){\r\n\t\tvar extracted = this.properties[i].extract();\r\n\t\tif(!TerminusClient.FrameHelper.empty(extracted)){\r\n\t\t\textracts[i] = extracted;\r\n\t\t}\r\n\t}\r\n\tif(TerminusClient.FrameHelper.empty(extracts) && this.parent){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar ext = this.extractJSONLD(extracts);\r\n\t\treturn ext;\r\n\t\t//return this.extractLDO(extracts);\r\n\t}\r\n}\r\n\r\nmodule.exports={ObjectRenderer,PropertyRenderer}\r\n","const HTMLPropertyViewer = require('../html/document/PropertyViewer');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst HTMLDataViewer = require('../html/document/DataViewer');\r\n\r\nfunction ValueRenderer(dataframe, index, parent, options){\r\n\tthis.frame = dataframe;\r\n\tthis.index = index;\r\n\tthis.parent = parent;\r\n\tthis.originalValue = this.value();\r\n\tthis.renderer_type = \"value\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nValueRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nValueRenderer.prototype.property = function(){ return (this.parent ? this.parent.property() : false);};\r\nValueRenderer.prototype.subject = function(){ return (this.parent ? this.parent.subject() : false);};\r\nValueRenderer.prototype.subjectClass = function(){ return (this.parent ? this.parent.subjectClass() : false);};\r\nValueRenderer.prototype.type = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.range = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.value = function(){\treturn (this.frame ? this.frame.get() : false);};\r\nValueRenderer.prototype.isDocument = function(){\treturn (this.frame ? this.frame.isDocument() : false);};\r\nValueRenderer.prototype.currentViewer = function(){\treturn this.viewerType;}\r\n\r\nValueRenderer.prototype.copy = function(nf){\r\n\tvar nvr = new ValueRenderer(nf, false, this.parent, this.options);\r\n\tnvr.mode = this.mode;\r\n\tnvr.view = this.view;\r\n\treturn nvr;\r\n}\r\n\r\nValueRenderer.prototype.setFacet = function(facet){\r\n\tthis.facet = facet;\r\n\tthis.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"line\");\r\n\tif(pfacet == \"line\") this.setFacet(\"inline\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"icon\");\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.parent.currentFacet() == \"page\" || this.parent.currentFacet() == \"multiline\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"inline\";\r\n}\r\n\r\nValueRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tinline: {\r\n\t\t\tlabel: \"Inline\", value: \"inline\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"body\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nValueRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nValueRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nValueRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nValueRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tthis.options.mode = mode;\r\n\tthis.viewerType = false;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.options.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getAPIURL = function(a, b){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\tvar apiurl = client.dbURL() + a + \"/\" + b;\r\n\t\t\treturn apiurl;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getClient = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getClient();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getController = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.DBURL = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.dbURL();\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getEntityReference = function(url, cls, entities, opts){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.getEntityReference(url, cls, entities, opts);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.badData = function(bd){\r\n\talert(\"bad data \" + bd);\r\n}\r\n\r\nValueRenderer.prototype.setNew = function(){\r\n\tthis.new_value = true;\r\n}\r\n\r\nValueRenderer.prototype.isNew = function(){\r\n\tif(this.new_value){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\n\r\nValueRenderer.prototype.isUpdated = function(){\r\n\tif(this.frame.get() != this.originalValue){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\telse if(this.isUpdated()) ret.status = \"updated\";\r\n\tvar val = this.frame.get();\r\n\tif(val){\r\n\t\tif(val.length && val.length > this.text_summary_length){\r\n\t\t\tret.long = val.substring(0, this.text_summary_length) + \"...\" + \" (\" + val.length + \" characters)\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret.long = val;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tret.long = \"empty\";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nValueRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nValueRenderer.prototype.set = function(v){\r\n\tthis.frame.set(v);\r\n\tthis.viewer.redrawHeader();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nValueRenderer.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.value(), this.index);\r\n\tthis.parent.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.load = function(link){\r\n\tthis.parent.load(link);\r\n}\r\n\r\nValueRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nValueRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nValueRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nValueRenderer.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.value());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n\tthis.parent.goToValue(this.parent.values.length-1);\r\n}\r\n\r\nValueRenderer.prototype.getViewerForValue = function(){\r\n\treturn new HTMLDataViewer.HTMLDataViewer(this);\r\n}\r\n\r\nValueRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nValueRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\n\r\nValueRenderer.prototype.render = function(viewer){\r\n\tthis.viewer = (viewer ? viewer : this.getViewerForValue());\r\n\treturn this.viewer.render();\r\n}\r\n\r\nValueRenderer.prototype.extract = function(){\r\n\tvar val = this.value();\r\n\tif(val !== \"\" && val !== false){\r\n\t\tif(this.frame.isDatatypeProperty()){\r\n\t\t\tvar objlit = { \"@value\": this.value()}\r\n\t\t\t//var objlit = { data: this.value()}\r\n\t\t\tif(this.frame.isString()) objlit[\"@language\"] = this.frame.lang();\r\n\t\t\telse objlit[\"@type\"] = this.type();\r\n\t\t\treturn objlit;\r\n\t\t}\r\n\t\telse if(this.frame.isChoice() || this.frame.isDocument()){\r\n\t\t\treturn {\"@id\": val}\r\n\t\t}\r\n\t}\r\n\telse return val;\r\n}\r\n\r\nValueRenderer.prototype.getValueHeaderViewer = function(){\r\n\treturn new HTMLDataViewer.HTMLDataHeaderViewer();\r\n}\r\n\r\nValueRenderer.prototype.getDataValueViewer = function(){\r\n\tif(!this.viewerType) {\r\n\t\tthis.viewerType = this.getViewerForDataValue();\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewer(this.viewerType, this.viewerOptions);\r\n}\r\n\r\nValueRenderer.prototype.getAvailableViewers = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailableDataViewers(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailableDataEditors(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.setViewer = function(viewer){\r\n\tthis.viewerType = viewer;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getViewerForDataValue = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getEditorForDataFrame(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewerForDataFrame(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\n\r\n\r\n\r\n\r\nmodule.exports=ValueRenderer\r\n","const WOQLQuery = require('./WOQLQuery');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\n/*\r\n * Utility class which allows the user to choose a document by id or by label (if select2 and full text indexing is turned on)\r\n */\r\n\r\nTerminusDocumentChooser = function(ui, root, value, view){\r\n\tthis.ui = ui;\r\n\tthis.root = root;\r\n\tthis.choice = value;\r\n\tthis.view = (view ? view : \"id\");\r\n\tthis.show_button = true;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.change = function(docid){\r\n\talert(\"Need to specify doc chooser function (\" + docid + \")\");\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getAsDOM = function(style){\r\n\tif(this.view == \"label\" && \tthis.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\treturn this.getS2DOM(style);\r\n\t}\r\n\treturn this.getIDDOM();\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getS2DOM = function(style){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar cfilter = wq.getSubclassQueryPattern(\"v:Class\", \"'\"+this.root+\"'\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, cfilter);\r\n\ttermcc.empty_choice = \"Filter by Type\";\r\n\ttermcc.show_single = false;\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.filter = new_class;\r\n\t\t}\r\n\t}\r\n\ttdom = termcc.getAsDOM(style);\r\n\tif(tdom) docchooser.appendChild(tdom);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-entity-reference-value\");\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-entity-class-input\");\r\n\tholder.appendChild(sel);\r\n\tvar opt = document.createElement(\"option\");\r\n\tvar lookup = function (params) {\r\n\t\tparams.class = self.filter;\r\n\t\treturn JSON.stringify(params);\r\n    }\r\n\tvar searchurl = this.ui.client.dbURL() + \"/search\";\r\n\tvar s2config = {\r\n\t\tajax: {\r\n\t\t    url: searchurl,\r\n\t\t    dataType: 'json',\r\n\t\t    data: lookup,\r\n\t\t    type: \"POST\",\r\n\t\t\tcontentType: \"application/json; charset=utf-8\",\r\n\t\t    delay: 250,\r\n\t\t    cache: true\r\n\t\t},\r\n\t\tplaceholder: \"Enter Document Name\",\r\n\t\twidth: 200\r\n\t};\r\n\tjQuery(sel).select2(s2config).change(function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\tdocchooser.appendChild(holder);\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getIDDOM = function(){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-document-chooser terminus-query-text\");\r\n\t//11092019 dcip.setAttribute(\"class\", \"terminus-form-value terminus-document-chooser\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tdcip.addEventListener('keypress', function(e){\r\n\t\tvar key = e.which || e.keyCode;\r\n\t\t// on enter\r\n\t\tif (key === 13 && dcip.value) {\r\n\t\t\tself.choice = dcip.value;\r\n\t\t\tself.change(dcip.value);\r\n\t\t}\r\n\t});\r\n\tdocchooser.appendChild(dcip);\r\n\tif(this.show_button){\r\n\t\tvar dbut = document.createElement(\"button\");\r\n\t\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\");\r\n\t\tvar self = this;\r\n\t\tdbut.addEventListener(\"click\", function(){\r\n\t\t\tif(dcip.value) {\r\n\t\t\t\tself.choice = dcip.value;\r\n\t\t\t\tself.change(dcip.value);\r\n\t\t\t}\r\n\t\t});\r\n\t\t//11092019 dbut.appendChild(document.createTextNode(\"View Document Properties\"));\r\n\t\tdbut.appendChild(document.createTextNode(\"Go\"));\r\n\t\tdocchooser.appendChild(dbut);\r\n\t}\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.toggleView = function(){\r\n\tif(this.view == \"id\") this.view = \"label\";\r\n\telse this.view = \"id\";\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getChangeViewText = function(){\r\n\tif(this.view == \"id\"){\r\n\t\treturn \"Document Lookup\";\r\n\t}\r\n\treturn \"Load Document ID\";\r\n}\r\n\r\nmodule.exports=TerminusDocumentChooser\r\n","const HTMLStringViewer = require('./datatypes/String');\r\nconst HTMLStringEditor = require('./datatypes/StringEditor');\r\nconst HTMLBooleanViewer = require('./datatypes/Boolean');\r\nconst HTMLBooleanEditor = require('./datatypes/BooleanEditor');\r\nconst HTMLChoiceViewer = require('./datatypes/Choice');\r\nconst HTMLChoiceEditor = require('./datatypes/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('./datatypes/Coordinate');\r\nconst HTMLCoordinateEditor = require('./datatypes/CoordinateEditor');\r\nconst HTMLDateViewer = require('./datatypes/Date');\r\nconst HTMLDateEditor = require('./datatypes/DateEditor');\r\nconst HTMLEntityViewer = require('./datatypes/Entity');\r\nconst HTMLEntityEditor = require('./datatypes/EntityEditor');\r\nconst HTMLImageViewer = require('./datatypes/Image');\r\nconst HTMLImageEditor = require('./datatypes/ImageEditor');\r\nconst HTMLLinkViewer = require('./datatypes/Link');\r\nconst HTMLNumberViewer = require('./datatypes/Number');\r\nconst HTMLRangeViewer = require('./datatypes/Range');\r\nconst HTMLRangeEditor = require('./datatypes/RangeEditor');\r\nconst SantizedHTMLViewer = require('./datatypes/SanitizedHTML');\r\nconst GoogleMapEditor = require('./datatypes/GoogleMapEditor');\r\nconst GoogleMapViewer = require('./datatypes/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('./datatypes/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('./datatypes/S2EntityEditor');\r\n\r\n\r\nfunction initialiseDataRenderers(RenderingMap, plugins){\r\n\tRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", {label: \"Checkbox Viewer\"}, [\"xsd:boolean\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", {label: \"Checkbox Editor\"}, [\"xsd:boolean\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLChoiceViewer\", {label: \"Choice Viewer\"}, [\"oneOf\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLChoiceEditor\", {label: \"Choice Selector\"}, [\"oneOf\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", {label: \"Coordinate Viewer\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", {label: \"Coordinate Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", {label: \"Date Viewer\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", {label: \"Date Editor\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLEntityViewer\", {label: \"Document Viewer\"}, [\"document\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLEntityEditor\", {label: \"Document Selector\"}, [\"document\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", {label: \"Link Viewer\"}, [\"xdd:url\", \"xsd:anyURI\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", {label: \"Number with commas\"}, \r\n\t\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", {label: \"Range Viewer\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", {label: \"Range Editor\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\n\tRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", {label: \"Sanitized HTML\"}, [\"xsd:string\", \"xdd:html\"]);\r\n\taddPlugins(RenderingMap, plugins);\r\n\tRenderingMap.createRenderer = function(type, args){\r\n\t\tlet r = createDataRenderer(type, args);\r\n\t\treturn r;\r\n\t}\r\n}\r\n\r\nfunction createDataRenderer(type, options){\r\n\ttry {\r\n\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\r\n\t}\r\n\tcatch(e){\r\n\t\treturn false;\r\n\t}\r\n\treturn viewer;\r\n}\r\n\r\nfunction addPlugins(RenderingMap, plugins){\r\n\tif(plugins && plugins.indexOf(\"gmaps\") != -1){\r\n\t\tRenderingMap.registerEditorForTypes(\"GoogleMapEditor\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tRenderingMap.registerViewerForTypes(\"GoogleMapViewer\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugins && plugins.indexOf(\"quill\") != -1){\r\n\t\tRenderingMap.registerEditorForTypes(\"HTMLMarkupEditor\", {label: \"Quill WYSIWIG HTML Editor\"}, [\"xdd:html\"]);\r\n\t}\r\n\tif(plugins && plugins.indexOf(\"select2\") != -1){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", {label: \"S2 Autocomplete Selector\"}, \"document\");\r\n\t}\r\n}\r\n\r\nmodule.exports = {createDataRenderer, initialiseDataRenderers};","function ResultViewer(rule){\r\n\tthis.rules = [];\r\n\tif(rule) this.rules.push(rule);\r\n}\r\n\r\nResultViewer.prototype.render = function(){\r\n\tvar span = document.createElement(\"span\");\r\n\tif(this.ruleviewer){\r\n\t\tlet r = this.ruleviewer.render();\r\n\t\tif(r) span.appendChild(r);\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nResultViewer.prototype.setRuleViewer = function(rv){\r\n\tthis.ruleviewer = rv;\r\n}\r\n\r\nfunction QueryPane(client, query, results){\r\n\tthis.client = client;\r\n\tthis.query = query;\r\n\tthis.result = results;\r\n\tthis.query_viewers = [];\r\n\tthis.result_viewers = {};\r\n\t//this.libraries = [];\r\n\tthis.rules = [];\r\n}\r\n\r\nQueryPane.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nQueryPane.prototype.addQueryViewer = function(qv){\r\n\tthis.query_viewers.push(qv);\r\n\tif(this.query) qv.setQuery(this.query);\r\n\treturn this;\r\n}\r\n\r\nQueryPane.prototype.addResultViewer = function(label, rule, ruleviewer){\r\n\tlet rv = new ResultViewer(rule);\r\n\tif(ruleviewer) rv.setRuleViewer(ruleviewer);\r\n\tthis.result_viewers[label] = rv;\r\n\treturn this;\r\n}\r\n\r\n\r\n\r\nQueryPane.prototype.addLibrary = function(lib){\r\n\tthis.libraries.push(lib);\r\n\treturn this;\r\n}\r\n\r\nQueryPane.prototype.render = function(lib){\r\n\tvar qps = document.createElement(\"span\");\r\n\tfor(var i = 0; i<this.query_viewers.length; i++){\r\n\t\tvar qv = this.query_viewers[i];\r\n\t\tif(qv){\r\n\t\t\tlet v = qv.render();\r\n\t\t\tif(v) qps.appendChild(v);\r\n\t\t}\r\n\t}\r\n\r\n\tfor(var k in this.result_viewers){\r\n\t\tvar rv = this.result_viewers[k];\r\n\t\tif(rv){\r\n\t\t\tvar x = rv.render();\r\n\t\t\tif(x) qps.appendChild(x);\r\n\t\t}\r\n\t}\r\n\treturn qps;\r\n}\r\n\r\nmodule.exports = QueryPane;","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n\r\nfunction SimpleTable(){\r\n\tthis.holder = document.createElement(\"div\");\r\n}\r\n\r\nSimpleTable.prototype.options = function(options){\r\n\tfor(var k in options){\r\n\t\tthis[k] = options[k];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nSimpleTable.prototype.render = function(woqltable){\r\n\tif(woqltable) this.woqltable = woqltable;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\tvar ctls = this.getControlsDOM();\r\n\tvar tab = this.getTableDOM();\r\n\tif(ctls) this.holder.appendChild(ctls)\r\n\tthis.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\nSimpleTable.prototype.getControlsDOM = function(result){\r\n\tvar ctrls = document.createElement(\"span\");\r\n\tif(this.woqltable.config.pager()){\r\n\t\tvar paging = this.getPaging(result);\r\n\t\tif(paging) ctrls.appendChild(paging);\r\n\t}\r\n\treturn ctrls;\r\n}\r\n\r\nSimpleTable.prototype.getTableDOM = function(){\r\n\tconst columns = this.woqltable.getColumnsToRender();\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = this.getTableHeader(columns);\r\n\ttab.appendChild(thead);\r\n\tvar tbody = this.getTableBody(columns);\r\n\ttab.appendChild(tbody);\r\n\treturn tab;\r\n}\r\n\r\nSimpleTable.prototype.getTableHeader = function(cols){\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tfor(var i = 0; i<cols.length; i++){\r\n\t\tvar th = this.getColumnHeader(cols[i]);\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\treturn thead;\r\n}\r\n\r\nSimpleTable.prototype.getColumnHeader = function(colid){\r\n\tvar th = document.createElement(\"th\");\r\n\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\tvar clab = this.woqltable.getColumnHeaderContents(colid);\r\n\tth.appendChild(clab);\r\n\treturn th;\r\n}\r\n\r\nSimpleTable.prototype.getTableBody = function(cols){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\twhile(row = this.woqltable.next()){\r\n\t\tvar tr = this.getHTMLRow(row, cols);\r\n\t\tif(tr) tbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nSimpleTable.prototype.getHTMLRow = function(row, cols){\r\n\tvar tr = document.createElement(\"tr\");\r\n\tfor(var i = 0; i<cols.length; i++){\r\n\t\tvar td = this.getCell(cols[i], row);\r\n\t\ttr.appendChild(td);\r\n\t}\r\n\tvar self = this;\r\n\tif(this.woqltable.hasRowClick(row)){\r\n\t\tvar rc = this.woqltable.getRowClick(row);\r\n\t\ttr.addEventListener(\"click\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(this.woqltable.hasRowHover(row)){\r\n\t\tvar rc = this.woqltable.getRowHover(row);\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t}\r\n\treturn tr;\r\n}\r\n\r\nSimpleTable.prototype.getCell = function(key, row){\r\n\tvar td = document.createElement(\"td\");\r\n\tif(this.woqltable.hasCellClick(row, key)){\r\n\t\tvar rc = this.woqltable.getCellClick(row, key);\r\n\t\ttd.addEventListener(\"click\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t\ttd.addEventListener(\"mouseover\", function(){\r\n\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(this.woqltable.hasCellHover(row, key)){\r\n\t\tvar rc = this.woqltable.getCellHover(row, key);\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t}\r\n\tvar c = this.getCellData(key, row);\r\n\tif(c) td.appendChild(c);\r\n\treturn td;\r\n}\r\n\r\nSimpleTable.prototype.getCellData = function(key, row){\r\n\tvar renderer = this.woqltable.getRenderer(key, row);\r\n\tif(renderer && typeof renderer == \"function\"){\r\n\t\treturn renderer(row[key], key, row);\r\n\t}\r\n\telse if(renderer && typeof renderer == \"object\"){\r\n\t\treturn this.woqltable.renderValue(renderer, row[key], key, row);\r\n\t}\r\n\tvar val = row[key]\r\n\tif(val && val['@value']) val = val['@value'];\r\n\treturn document.createTextNode(val);\r\n}\r\n\r\nSimpleTable.prototype.getPaging = function(){\r\n\tif(this.woqltable.result.query.isPaged()){\r\n\t\tvar pdom = document.createElement(\"div\");\r\n\t\tpdom.setAttribute(\"class\", \"table-page-size\");\r\n\t\tif(this.woqltable.config.pagesize()) pdom.appendChild(this.getPageSize());\r\n\t\tif(this.woqltable.canChangePage()){\r\n\t\t\tvar pn = this.woqltable.result.query.getPage();\r\n\t\t\tif(pn > 2){\r\n\t\t\t\tpdom.appendChild(this.getFirst());\r\n\t\t\t}\r\n\t\t\tif(pn > 1){\r\n\t\t\t\tpdom.appendChild(this.getPrev(pn));\r\n\t\t\t}\r\n\t\t\tif(this.woqltable.config.page()) pdom.appendChild(this.getPageNumber(pn));\r\n\t\t\tpdom.appendChild(this.getNext(this.woqltable.result));\r\n\t\t}\r\n\t\treturn pdom;\r\n\t}\r\n}\r\n\r\nSimpleTable.prototype.getPageSize = function(){\r\n\tvar chunk = document.createElement(\"span\");\r\n\tchunk.setAttribute(\"class\", \"woql-table-pagesize\");\r\n\tclabel = document.createElement(\"span\");\r\n\tclabel.appendChild(document.createTextNode(\"Page Size\"));\r\n\tchunk.appendChild(clabel);\r\n\tif(this.woqltable.config.change_pagesize){\r\n\t\tvar ctl = document.createElement(\"input\");\r\n\t\tctl.setAttribute(\"size\", 6);\r\n\t\tvar self = this;\r\n\t\tctl.value = this.woqltable.getPageSize();\r\n\t\tctl.addEventListener(\"blur\", function(){\r\n\t\t\tvar pval = (this.value ? parseInt(this.value) : false);\r\n\t\t\tself.woqltable.setPageSize(pval).then(() => self.render());\r\n\t\t});\r\n\t\tchunk.appendChild(ctl);\r\n\t}\r\n\telse {\r\n\t\tchunk.appendChild(document.createTextNode(this.woqltable.getPageSize()));\r\n\t}\r\n\treturn chunk;\r\n}\r\n\r\nSimpleTable.prototype.getPageNumber = function(){\r\n\tvar ctl = document.createElement(\"input\");\r\n\tctl.setAttribute(\"size\", 4);\r\n\tctl.value = this.woqltable.result.query.getPage();\r\n\tvar self = this;\r\n\tctl.addEventListener(\"blur\", function(){\r\n\t\tvar pval = (this.value ? parseInt(this.value) : false);\r\n\t\tself.woqltable.setPage(pval).then(() => self.render());\r\n\t});\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getNext = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tvar self = this;\r\n\tctl.appendChild(document.createTextNode(\"next\"));\r\n\tif(!this.woqltable.canAdvancePage(result)){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.nextPage().then(() => self.render());\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getPrev = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tctl.appendChild(document.createTextNode(\"previous\"));\r\n\tvar self = this;\r\n\tif(!this.woqltable.canRetreatPage(result)){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.previousPage().then(() => self.render());\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getFirst = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tctl.appendChild(document.createTextNode(\"first\"));\r\n\tvar self = this;\r\n\tif(!this.woqltable.canRetreatPage(result) || this.woqltable.getPage() <= 2){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.firstPage().then(() => self.render());\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nmodule.exports = SimpleTable;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst GraphResultsViewer = require('./GraphResultsViewer');\r\n\r\n\r\nfunction SimpleGraph(){\r\n\tthis.holder = document.createElement(\"div\");\t\r\n}\r\n\r\nSimpleGraph.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n}\r\n\r\nSimpleGraph.prototype.render = function(wgraph){\r\n\tthis.graph = wgraph;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\t//var ctls = this.getControlsDOM(result);\r\n\tvar tab = this.getGraphDOM(this.result);\r\n\t//if(ctls) this.holder.appendChild(ctls)\r\n\tthis.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\n\r\nSimpleGraph.prototype.getGraphDOM = function(){\r\n\tthis.gviz = new GraphResultsViewer(this.graph.config); \r\n\tvar gdom = this.gviz.getAsDOM();\r\n\tgdom.setAttribute(\"style\", \"border: 2px solid blue; width: 400px; height: 400px\");\r\n\tthis.gviz.setData(this.graph);\r\n\tthis.gviz.initDOM(gdom);\r\n\treturn gdom;\r\n}\r\n\r\nmodule.exports = SimpleGraph;","function GraphResultsViewer(config) {\t\r\n\tthis.svg;\r\n\tthis.visid = randomString(8);\r\n\tthis.currentDate = Date.now() / 1000; // nowish\r\n\t// Individual links, nodes and text graphical elements\r\n\tthis.link_elements;\r\n\tthis.node_elements;\r\n\t// DOM object that this this is directly drawn into\r\n\tthis.container = false;\r\n\t// Map of ids to loaded nodes for ease\r\n\tthis.loadedNodes = {};\r\n\tthis.focusNodes = [];\r\n\t// Currently displayed nodes and links\r\n\tthis.nodes;\r\n\tthis.links;\r\n\t// Var for selecting and deselecting elements \r\n\tthis.selected_id;\t\r\n\tthis.setConfigOptions(config);\r\n}\r\n\r\n/*\r\n * Loads the graph with new data and optionally starts the animation\r\n */\r\nGraphResultsViewer.prototype.load = function(show) {\r\n\tthis.initD3(this.d3DOM);\r\n\tthis.loadNewData();\r\n\tthis.updateGraph();\r\n\tif(show){\r\n\t\tthis.updateSimulation(\"init\");\r\n\t}\r\n}\r\n\r\n/*\r\n * Called to issue a new set of datapoints \r\n */\r\nGraphResultsViewer.prototype.setData = function(dqr, show){\r\n\t//this.setFocusNodeFromResult(dqr);\r\n\tif(this.result){\r\n\t\tthis.clear();\r\n\t}\r\n\tthis.result = dqr;\r\n\t//if(this.svg){\r\n\t\tthis.load(show);\r\n\t//}\r\n}\r\n\r\nGraphResultsViewer.prototype.loadNewData = function(){\r\n\tthis.nodes = jQuery.extend(true, [], this.result.getNodes());\r\n\tfor(var i = 0 ; i<this.nodes.length; i++){\r\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\r\n\t}\r\n\tthis.links = this.result.getEdges();\r\n\t//this.browser.rebuildController();\r\n}\r\n\r\n\r\n/*\r\n * Called to indicate that the current set of datapoints has been updated\r\n */\r\nGraphResultsViewer.prototype.updateData = function(dqr, show) {\r\n\tthis.setFocusNodeFromResult(dqr);\r\n\tthis.result = dqr;\r\n\tthis.reload(show, \"update\", this.fix_nodes);\r\n}\r\n\r\nGraphResultsViewer.prototype.setFocusNodeFromResult = function(dqr) {\r\n\tvar fn = dqr.getFocusNode();\r\n\tif(fn){\r\n\t\tthis.selected_id = fn;\r\n\t\tthis.focusNodes.push(fn);\r\n\t}\r\n}\r\n\r\n/*\r\n * Called to indicate that the filter setting has been changed on the current datapoints \r\n */\r\nGraphResultsViewer.prototype.setFilter = function(dqr, show){\r\n\tthis.simulation.stop();\r\n\tthis.reload(show, \"filter\", true);\r\n}\r\n\r\nGraphResultsViewer.prototype.wake = function() {\r\n\tif(this.simulation)\tthis.updateSimulation(\"wake\");\r\n}\r\n\r\nGraphResultsViewer.prototype.hibernate = function() {\r\n\tthis.simulation.stop();\r\n}\r\n\r\n/*\r\n * Called when more data is added to the result but the query remains the same\r\n */\r\nGraphResultsViewer.prototype.reload = function(show, mode, no_animate) {\r\n\tfor(var i = 0 ; i<this.nodes.length; i++){\r\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\r\n\t}\t\r\n\tvar nnodes = jQuery.extend(true, [], this.result.getNodesAndFringes());\r\n\tthis.nodes = [];\r\n\tvar snode = this.loadedNodes[this.selected_id];\r\n\tfor(var i = 0 ; i<nnodes.length; i++){\r\n\t\tvar nnode = nnodes[i];\r\n\t\tif(this.loadedNodes[nnode.id]){\r\n\t\t\tif(nnode.id == this.selected_id){\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\r\n\t\t\t}\r\n\t\t\telse if(!no_animate) {\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = null;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = null;\r\n\t\t\t}\r\n\t\t\telse if(this.loadedNodes[nnode.id].x){\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.explode_out && snode.x){\r\n\t\t\t\tnnode.x = snode.x;\r\n\t\t\t\tnnode.y = snode.y;\r\n\t\t\t}\r\n\t\t\tthis.loadedNodes[nnode.id] = nnode;\r\n\t\t}\r\n\t\tthis.nodes.push(this.loadedNodes[nnode.id]);\r\n\t}\r\n\tthis.links = this.result.getLinks();\r\n\tthis.updateGraph();\r\n\tif(show){\r\n\t\t//this.browser.rebuildController();\r\n\t\tthis.updateSimulation(mode);\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.clear = function() {\r\n\tthis.nodes = [];\r\n\tthis.loadedNodes = {};\r\n\tthis.links = [];\r\n\tthis.updateGraph();\r\n\tjQuery(this.d3DOM).empty();\t\r\n\tthis.scale_factor = 1;\r\n}\r\n\r\n/*\r\n * Called to initialise the DOM when it is first loaded (called after setData)\r\n */\r\nGraphResultsViewer.prototype.initDOM = function(vdom) {\r\n\tif(!this.width) this.width = this.setWidth();\r\n\tif(!this.height) this.height = this.setHeight();\r\n\tthis.d3DOM = vdom;\r\n\tif(this.result){\r\n\t\tthis.load(true);\r\n\t}\r\n}\r\n\r\n/*\r\n * Generate the div that contains the visualisation panel\r\n */\r\nGraphResultsViewer.prototype.getAsDOM = function() {\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-gviz-panel\");\r\n\tvdom.setAttribute(\"id\", this.visid);\r\n\tvdom.setAttribute(\"width\", \"100%\");\r\n\tthis.container = vdom;\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Calculates the width of the container area available for the SVG\r\n */\r\nGraphResultsViewer.prototype.setWidth = function() {\r\n\tif(this.container && this.container.clientWidth){\r\n\t\tthis.width = this.container.clientWidth;\r\n\t}\r\n\telse if(this.container.parentNode && this.container.parentNode.clientWidth){\r\n\t\tthis.width = this.container.parentNode.clientWidth;\r\n\t}\r\n\telse {\r\n\t\tvar w = jQuery(this.container).width();\r\n\t\tif(w == 0){\r\n\t\t\tw = jQuery(this.container.parentNode).width();\r\n\t\t}\r\n\t\tif(w == 0) {\r\n\t\t\tw = 800;\r\n\t\t}\r\n\t\tthis.width = w;\r\n\t}\r\n\treturn this.width;\r\n}\r\n\r\nGraphResultsViewer.prototype.setHeight = function() {\r\n\tif(this.container && this.container.clientHeight){\r\n\t\tthis.height = this.container.clientHeight;\r\n\t}\r\n\telse if(this.container.parentNode && this.container.parentNode.clientHeight){\r\n\t\tthis.height = this.container.parentNode.clientHeight;\r\n\t}\r\n\telse {\r\n\t\tvar w = jQuery(this.container).height();\r\n\t\tif(w == 0){\r\n\t\t\tw = jQuery(this.container.parentNode).height();\r\n\t\t}\r\n\t\tif(w == 0) {\r\n\t\t\tw = 400;\r\n\t\t}\r\n\t\tthis.height = w;\r\n\t}\r\n\treturn this.height;\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.initD3 = function(jqid) {\r\n\tvar self = this;\r\n\r\n\t/********************* Seed the data **************************/\r\n\tthis.svg = d3.select(jqid).append(\"svg\")\r\n\t\t.attr(\"width\", this.width)\r\n\t\t.attr(\"height\", this.height);\r\n\r\n\tvar distanceFun = function(link){\r\n\t\treturn self.getLinkDistance(link); \r\n\t}\r\n\t\r\n\t// create the force object \r\n\tthis.simulation  = d3.forceSimulation()\r\n\t\t//link distance varies with link type\r\n\t    .force(\"link\", d3.forceLink().distance(distanceFun).id(function(link) { return link.id; }))\r\n\t    //charge is the same for all nodes\r\n\t    .force('charge', d3.forceManyBody().strength(function(node){ return self.getCharge(node)}))\r\n\t    //collision radius changes with node type\r\n\t    .force('collision', d3.forceCollide().radius(function(node) {\r\n\t    \treturn (self.getCollisionRadius(node));\r\n\t    }))\r\n\t\t.force(\"center\", d3.forceCenter(this.width / 2, this.height / 2));\r\n\t\r\n\t// node drag \r\n\tthis.drag_drop = d3.drag()\r\n\t\t.on('start', function(node) {\r\n\t\t\tnode.fx = node.x\r\n\t\t\tnode.fy = node.y\r\n\t\t})\r\n\t\t.on('drag', function(node) {\r\n\t\t\tself.simulation.restart()\r\n\t\t\tnode.fx = d3.event.x;\r\n\t\t\tnode.fy = d3.event.y;\r\n\t\t})\r\n\t\t.on('end', function(node) {\r\n\t\t\tnode.fx = null;\r\n\t\t\tnode.fx = null;\r\n\t\t\tself.simulation.stop()\r\n\t\t});\r\n\t\r\n\tthis.svg.append(\"rect\")\r\n\t   .attr(\"width\", this.width)\r\n\t   .attr(\"height\", this.height)\r\n\t   .style(\"fill\", \"none\")\r\n\t   .style(\"pointer-events\", \"all\")\r\n\t   .call(d3.zoom().on(\"zoom\", function(){self.zoomed()}));\r\n\t\r\n\t// Append graphic element to svg which are groups for graph elements\r\n\tthis.link_group = this.svg.append(\"g\").classed(\"links\", true);\r\n\tthis.node_group = this.svg.append(\"g\").classed(\"nodes\", true);\r\n}\r\n\r\nGraphResultsViewer.prototype.zoomed = function() {\r\n\tthis.current_transform = d3.event.transform;\r\n\tif(this.node_elements)\r\n\t\tthis.node_elements.attr(\"transform\", d3.event.transform);\r\n    if(this.link_elements)\r\n    \tthis.link_elements.attr(\"transform\", d3.event.transform);    \r\n}\r\n\r\n/***\r\n * updates the svg with the current nodes and links\r\n */\r\nGraphResultsViewer.prototype.updateGraph = function(nodes, links) {\r\n\tvar self = this;\r\n\t   \r\n\tvar follow_node_wrapper = function(graph_node){\r\n\t\tself.nodeSelected(graph_node);\r\n\t}\r\n\tvar zoomed = function(){\r\n\t\tself.zoomed();\r\n\t} \r\n\t\r\n\tnodes = (typeof nodes != \"undefined\" ? nodes : this.nodes);\r\n\tlinks = (typeof links != \"undefined\" ? links : this.links);\r\n\tthis.node_elements  = this.node_group.selectAll(\"g\").data(nodes);\r\n\tthis.node_elements.exit().remove();\r\n\t\r\n\t/*Create and place the \"blocks\" containing the circle and the text */  \r\n    var node_enter = this.node_elements.enter().append(\"g\");\r\n\r\n\t// enter and create new ones\r\n\tnode_enter.append(\"circle\")\r\n\t\t.style('opacity', 0.99)\r\n\t\t.attr('r', function(node){return self.getRadius(node)})\r\n\t\t.attr(\"cx\",  function(node){ return node.x})\r\n\t\t.attr(\"cy\",  function(node){ return node.y})\r\n\t\t.attr(\"type\", function(node) {return self.isFringe(node) ? \"fringe\" : \"node\"})\r\n\t\t.call(self.drag_drop)\r\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\r\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\r\n\t\t.on('click', follow_node_wrapper);\r\n\t\r\n    node_enter.append(\"text\")\r\n\t\t.attr(\"x\",  function(node){ return node.x})\r\n\t\t.attr(\"y\",  function(node){ return node.y})\r\n\t\t.text(function(node) { return self.getNodeIconUnicode(node)})\r\n\t\t.call(self.drag_drop)\r\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\r\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\r\n\t\t.on('click', follow_node_wrapper);\r\n\r\n\t// merge new and old nodes\t\r\n\tthis.node_elements = node_enter.merge(this.node_elements);\r\n\t\r\n\tthis.styleNodeElements();\r\n\r\n\t// update LINKS ********************************************\r\n\tthis.link_elements  = this.link_group.selectAll(\"line\").data(links);\r\n\r\n\t// remove old links\r\n\tthis.link_elements.exit().remove();\r\n\t// enter and create new ones\r\n\tvar link_enter = this.link_elements.enter().append(\"line\");\r\n\r\n\t// merge new and old links \r\n\tthis.link_elements = link_enter.merge(this.link_elements)\r\n\t\r\n\tthis.styleLinkElements();\r\n\t\r\n\t//execute the current state of the pan-zoom transform\r\n\tif(this.current_transform){\r\n\t\tif(this.node_elements)\r\n\t\t\tthis.node_elements.attr(\"transform\", this.current_transform);\r\n\t    if(this.link_elements)\r\n\t    \tthis.link_elements.attr(\"transform\", this.current_transform);\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.updateSimulation = function(mode) {\r\n\tvar self = this;\r\n\t//move all of the graphical elements corresponding to the nodes with each tick\r\n\tvar ticker = function(){\r\n\t\tself.node_elements.selectAll(\"circle\")\r\n\t\t\t.attr(\"cx\",  function(node){ return node.x})\r\n\t\t\t.attr(\"cy\",  function(node){ return node.y});\r\n\t\tself.node_elements.selectAll(\"text\")\r\n\t\t\t.attr(\"x\",  function(node){ return node.x})\r\n\t\t\t.attr(\"y\",  function(node){ return node.y});\r\n\t\tself.link_elements\r\n\t\t\t.attr('x1', function(link){ return link.source.x})\r\n\t\t\t.attr('y1', function(link){ return link.source.y})\r\n\t\t\t.attr('x2', function(link){ return link.target.x})\r\n\t\t\t.attr('y2', function(link){ return link.target.y});\r\n\t}\r\n\tif(this.show_force){\r\n\t\tthis.simulation.nodes(this.nodes).on('tick', ticker).force('link').links(this.links);\r\n\t}\r\n\telse {\r\n\t\tthis.simulation.nodes(this.nodes).on('end', ticker).force('link').links(this.links);\t\t\r\n\t}\r\n\tif(this.nodes.length){\r\n\t\tif(mode == \"wake\" || mode == \"init\"){\r\n\t\t\tthis.simulation.restart();\r\n\t\t}\r\n\t\telse if(mode == \"filter\"){\r\n\t\t\tthis.simulation.restart();\t\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.simulation.alpha(1).restart();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.styleNodeElements = function() {\r\n\tvar self = this;\r\n\tif(this.node_elements){\r\n\t\tthis.node_elements.each(function(node){\r\n\t\t\tvar g = d3.select(this);\r\n\t\t\tvar sel = g.select(\"circle\");\r\n\t\t\tsel.select(\"title\").remove();\r\n\t\t\tsel.style(\"fill\", self.getNodeColour(node));\r\n\t\t\tsel.attr('r', self.getRadius(node));\t\r\n\t\t\tsel.classed(\"highlighted\", function(node) { return self.focusNodes.indexOf(node.id) != -1});\t\r\n\t\t\tsel.append(\"title\")\r\n\t\t\t\t.classed(\"terminus-gnode-title\", true)\r\n\t\t\t\t.text(self.getNodeText(node));\r\n\t\t\tvar txt = g.select(\"text\");\r\n\t\t\ttxt.select(\"title\").remove();\r\n\t\t\ttxt.attr('text-anchor', 'middle')\r\n\t\t\t\t.attr(\"title\", self.getNodeText(node))\r\n\t\t\t\t.attr('dominant-baseline', 'central')\r\n\t\t\t\t.style('font-family', \"'\" + self.fontfam + \"'\")\r\n\t\t\t\t.style('font-weight', self.getNodeIconWeight(node))\r\n\t\t\t\t.style('font-size', self.getNodeIconSize(node))\r\n\t\t\t\t.style(\"fill\", self.getNodeIconColour(node))\r\n\t\t\t\t.text(self.getNodeIconUnicode(node))\r\n\t\t\t\t.append(\"title\")\r\n\t\t\t\t\t.classed(\"terminus-gnode-title\", true)\r\n\t\t\t\t\t.text(self.getNodeText(node));\r\n\t\t});\r\n\t}\t\r\n}\r\n\r\nGraphResultsViewer.prototype.styleLinkElements = function() {\r\n\tvar self = this;\r\n\tif(this.link_elements){\r\n\t\tthis.link_elements.each(function(link){\r\n\t\t\tvar sel = d3.select(this);\r\n\t\t\tsel.select(\"title\").remove();\r\n\t\t\tsel.attr(\"stroke-width\", self.getLineWidth(link));\r\n\t\t\tsel.attr(\"marker-end\", self.getEdgeArrow(link));\r\n\t\t\tsel.style(\"stroke\", self.getEdgeColour(link));\r\n\t\t\tsel.append(\"title\")\r\n\t\t\t\t.classed(\"terminus-glink-title\", true)\r\n\t\t\t\t.text(self.getLinkText(link));\r\n\t\t});\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeArrow = function(edge) {\r\n\tif(edge){\r\n\t\tvar dir = this.getEdgeDirection(edge);\r\n\t\t//if(dir){\r\n\t\t\tvar col = this.getEdgeColour(edge);\r\n\t\t\tvar reference;\r\n\t\t\tthis.svg.append(\"svg:defs\").selectAll(\"marker\")\r\n\t\t\t\t.data([reference])\r\n\t\t\t\t.enter().append(\"svg:marker\")\r\n\t\t\t\t.attr(\"id\", String)\r\n\t\t\t\t.attr(\"viewBox\", \"0 -5 10 10\")\r\n\t\t\t\t.attr(\"refX\", 22)  // This sets how far back it sits, kinda\r\n\t\t\t\t.attr(\"refY\", 0)\r\n\t\t\t\t.attr(\"markerWidth\", this.getArrowWidth(edge))\r\n\t\t\t\t.attr(\"markerHeight\", this.getArrowHeight(edge))\r\n\t\t\t\t.attr(\"orient\", \"auto\")\r\n\t\t\t\t.attr(\"markerUnits\", \"userSpaceOnUse\")\r\n\t\t\t\t.append(\"svg:path\")\r\n\t\t\t\t\t.attr(\"d\", dir)\r\n\t\t\t\t\t.style(\"fill\", col);\r\n\t\t\t\treturn \"url(#\" + reference + \")\";\r\n\t\t//}\r\n\t}\r\n\treturn \"\";\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.nodeSelected = function(selected_node) {\r\n\tvar self = this;\r\n\tif(this.selected_id == selected_node.id && this.selection_grows){\r\n\t\tthis.selection_grows = false;\r\n\t\tthis.styleNodeElements();\r\n\t}\r\n\telse {\r\n\t\tthis.selection_grows = true;\r\n\t\tthis.selected_id = selected_node.id;\r\n\t\tthis.styleNodeElements();\r\n\t\t//this.browser.nodeSelected(selected_node);\r\n\t\tif(this.isFringe(selected_node)){\r\n\t\t\t//this.browser.followNode(selected_node);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getScaleTransform = function(x, y, scale_factor){\r\n\treturn \"scale(\"+ scale_factor + \") translate(\" + x + \",\" + y + \")\";\r\n} \r\n\r\nGraphResultsViewer.prototype.scale = function(min_ratio) {\r\n    // the new dimensions of the molecule\r\n    new_mol_width = this.width * min_ratio;\r\n    new_mol_height = this.height * min_ratio;\r\n    \r\n    var y_trans = (this.height - new_mol_height) ; \r\n    \r\n    var x_trans = (this.width - new_mol_width); \r\n    // do the actual moving\r\n    var self = this;\r\n    if(this.node_elements)\r\n    \tthis.node_elements.transition()\r\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\r\n    if(this.link_elements)\r\n        this.link_elements.transition()\r\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\r\n\tthis.scale_factor = min_ratio;\r\n\tthis.svg.selectAll(\"marker\").attr(\"markerWidth\", this.getArrowWidth())\r\n\t\t\t.attr(\"markerHeight\", this.getArrowHeight());\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.scaleToFit = function() {\r\n    // Center the view on the molecule(s) and scale it so that everything\r\n    // fits in the window\r\n    //no molecules, nothing to do\r\n    if (this.nodes.length === 0)\r\n        return;\r\n\r\n    // Get the bounding box\r\n    min_x = d3.min(this.nodes.map(function(d) {return d.x;}));\r\n    min_y = d3.min(this.nodes.map(function(d) {return d.y;}));\r\n    max_x = d3.max(this.nodes.map(function(d) {return d.x;}));\r\n    max_y = d3.max(this.nodes.map(function(d) {return d.y;}));\r\n\r\n    // The width and the height of the graph\r\n    mol_width = max_x - min_x;\r\n    mol_height = max_y - min_y;\r\n    \r\n    mol_width = mol_width * 1.05;\r\n    mol_height = mol_height * 1.05;\r\n    // how much larger the drawing area is than the width and the height\r\n    width_ratio = this.width / mol_width;\r\n    height_ratio = this.height / mol_height;\r\n\r\n    // we need to fit it in both directions, so we scale according to\r\n    // the direction in which we need to scale the most\r\n    min_ratio = Math.min(width_ratio, height_ratio);\r\n    if(min_ratio < 1){\r\n    \tthis.scale(min_ratio);\r\n    }    \r\n};\r\n\r\n// recentre graph\r\nGraphResultsViewer.prototype.recentre = function(graph_node) {\r\n\tthis.translated = true;\r\n\t// get the x and y you need to transform the nodes by \r\n\tthis.dcx = (this.width/2-graph_node.x);\r\n\tthis.dcy = (this.height/2-graph_node.y);\r\n\t//zoom.translate([dcx,dcy]); If we do zooming we'll need to do something here\r\n\tthis.node_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n\tthis.link_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n\tthis.text_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.setConfigOptions = function(config) {\r\n\t//configuration options for different types of behaviour\r\n\t// Need to explicitly know font family name for unicode glyphs\r\n\tthis.fontfam = (config && config.fontfamily ? config.fontfamily() : 'Font Awesome\\ 5 Free'); \r\n\tthis.selected_grows = (config && typeof config.selected_grows() != \"undefined\" ? config.selected_grows() : true);\r\n\tthis.show_force = (config && typeof config.show_force() != \"undefined\" ? config.show_force() : true);\r\n\tthis.fix_nodes = (config && typeof config.fix_nodes() != \"undefined\" ? config.fix_nodes() : false);\r\n\tthis.explode_out = (config && typeof config.explode_out() != \"undefined\" ? config.explode_out(): false);\r\n\tthis.width = (config && config.width() ? config.width(): false);\r\n\tthis.height = (config && config.height() ? config.height(): false);\r\n\tthis.defaults = {\r\n\t\tedge: {\r\n\t\t\ttype: \"edge\",\r\n\t\t\tdistance: (config && config.edge && config.edge.distance ? config.edge.distance : 70),\r\n\t\t\tarrow: (config && config.edge && config.edge.arrow ? config.edge.arrow : { width: 36, height: 16}),\r\n\t\t\tsymmetric: (config && config.edge && config.edge.symmetric ? config.edge.symmetric : true),\r\n\t\t\tcolor: (config && config.edge && config.edge.color ? config.edge.color : [150,150,255]),\r\n\t\t\tweight: (config && config.edge && config.edge.weight ? config.edge.weight : 0.3),\r\n\t\t\tsize: (config && config.edge && config.edge.size ? config.edge.size : 4)\r\n\t\t},\r\n\t\tnode: {\r\n\t\t\ttype: \"node\",\r\n\t\t\tradius: (config && config.node && config.node.radius ? config.node.radius : 14),\r\n\t\t\tcharge: (config && config.node && config.node.charge ? config.node.charge : -60),\r\n\t\t\tcollisionRadius: (config && config.node && config.node.collisionRadius ? config.node.collisionRadius : 20),\r\n\t\t\tcolor: (config && config.node && config.node.color ? config.node.color : [0,255,255]),\r\n\t\t\ticon: {\r\n\t\t\t\tweight: (config && config.node && config.node.icon && config.node.icon.weight ? config.node.icon.weight : 900),\r\n\t\t\t\tcolor: (config && config.node && config.node.icon && config.node.icon.color ? config.node.icon.color : [0,0,255]),\r\n\t\t\t\tunicode: (config && config.node && config.node.icon && config.node.icon.unicode ? config.node.icon.unicode : \"\\uf4fb\"),\r\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.icon.size ? config.node.icon.size : 10),\r\n\t\t\t\tfaclass: (config && config.node && config.node.icon && config.node.icon.faclass ? config.node.icon.faclass : \"fas fa-user-astronaut\")\r\n\t\t\t},\r\n\t\t\ttext: {\r\n\t\t\t\tcolor: (config && config.node && config.node.text && config.node.text.color ? config.node.text.color : [0,0,0]),\r\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.text.size ? config.node.text.size : 10)\r\n\t\t\t},\r\n\t\t\tborder: {\r\n\t\t\t\tcolor: (config && config.node && config.node.border && config.node.border.color ? config.node.border.color : [0,0,0]),\r\n\t\t\t\tsize: (config && config.node && config.node.border && config.node.border.size ? config.node.border.size : 10)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/*\r\n * Dimensions / forces / etc all settable with a scale factor - for zooming\r\n */\r\nGraphResultsViewer.prototype.getMultiplier = function(node) {\r\n\tvar mult = (node && node.size ? node.size : 1);\r\n\tif(node.id == this.selected_id && this.selection_grows){\r\n\t\tmult = mult * 2;\r\n\t}\r\n\treturn mult;\r\n}\r\n\r\nGraphResultsViewer.prototype.getRadius = function(node) {\r\n\tvar radius = (node && node.radius ? node.radius : this.defaults.node.radius);\r\n\tvar r = (this.scale_factor ? Math.min(this.scale_factor * radius, radius) : radius);\r\n\tr = r * this.getMultiplier(node);\r\n\treturn r;\r\n}\r\n\r\nGraphResultsViewer.prototype.getCollisionRadius = function(node) {\r\n\tvar colrad = (node && node.collisionRadius ? node.collisionRadius : this.defaults.node.collisionRadius );\r\n\tvar v = (this.scale_factor ? Math.min(this.scale_factor * colrad, colrad) : colrad);\r\n\treturn v * this.getMultiplier(node);\r\n}\r\n\r\nGraphResultsViewer.prototype.getCharge = function(node) {\r\n\tvar charge = (node && node.charge ? node.charge : this.defaults.node.charge);\r\n\tif(charge < 0){\r\n\t\tvar v = (this.scale_factor ? Math.max(this.scale_factor * charge, charge) : charge);\r\n\t}\r\n\telse {\r\n\t\tvar v = (this.scale_factor ? Math.min(this.scale_factor * charge, charge) : charge);\r\n\t}\r\n\treturn v * this.getMultiplier(node);\r\n}\r\n\r\nGraphResultsViewer.prototype.getLinkDistance = function(link) {\r\n\tvar linkDistance = (link && link.distance ? link.distance : this.defaults.edge.distance);\r\n\tvar x = (this.scale_factor ? Math.min(this.scale_factor * linkDistance, linkDistance) : linkDistance);\r\n\treturn x;\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconSize = function(node) {\r\n\tif(node && node.icon && node.icon.size){\r\n\t\treturn node.icon.size + \"em\";\r\n\t}\r\n\treturn (this.getMultiplier(node) + \"em\");\r\n}\t\r\n\r\nGraphResultsViewer.prototype.getNodeColour = function(node) {\r\n\tvar col = (node && node.color ? node.color : this.defaults.node.color);\r\n\tif(this.isFringe(node)){\r\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\r\n\t}\r\n\telse {\r\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIcon = function(node) {\r\n\tvar fac = (node && node.icon && node.icon.faclass ? node.icon.faclass : this.defaults.node.icon.faclass);\r\n\treturn fac;\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconUnicode= function(node) {\r\n\treturn (node && node.icon && node.icon.unicode ? node.icon.unicode : this.defaults.node.icon.unicode);\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconWeight = function(node) {\r\n\treturn (node && node.icon && node.icon.weight ? node.icon.weight : this.defaults.node.icon.weight );\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconColour = function(node) {\r\n\tvar col = (node && node.icon && node.icon.color ? node.icon.color : this.defaults.node.icon.color );\r\n\tif(this.isFringe(node)){\r\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\r\n\t}\r\n\telse {\r\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeColour = function(edge) {\r\n\tvar col = (edge && edge.color ? edge.color : this.defaults.edge.color );\r\n\tvar weight = (edge && edge.weight ? edge.weight : this.defaults.edge.weight);\r\n\tvar nc = col.concat([weight]);\r\n\treturn \"rgba(\"+nc.join(\",\")+\")\";\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeDirection = function(edge) {\r\n\tif(edge && edge.symmetric){\r\n\t\treturn \"M10,-5 L0,0 L10,5\";\r\n\t}\r\n\treturn \"M0,-5 L10,0 L0,5\";\r\n\treturn false;\r\n}\r\n\r\nGraphResultsViewer.prototype.getLineWidth = function(link) {\r\n\tvar x = (link && link.size ? link.size : this.defaults.edge.size);\r\n\treturn x;\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.getNodeText = function(node) {\r\n\tif(node && node.text) return node.text;\r\n\treturn node.id; \r\n}\r\n\r\nGraphResultsViewer.prototype.getLinkText = function(edge) {\r\n\tif(edge && edge.text) return edge.text;\r\n\tif(edge && edge.id) return edge.id;\r\n\treturn \"\";\r\n}\r\n\r\nGraphResultsViewer.prototype.getArrowWidth = function(edge) {\r\n\tvar w = (edge && edge.arrow && edge.arrow.width ? edge.arrow.width : this.defaults.edge.arrow.width);\r\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\r\n}\r\n\r\nGraphResultsViewer.prototype.getArrowHeight = function(edge) {\r\n\tvar w = (edge && edge.arrow && edge.arrow.height ? edge.arrow.height : this.defaults.edge.arrow.height );\r\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\r\n}\r\n\r\nGraphResultsViewer.prototype.isNeighbourLink = function(node, link) { \r\n\treturn link.target.id === node.id || link.source.id === node.id;  \r\n}\r\n\r\nGraphResultsViewer.prototype.isFringe = function(node){\r\n\tif(this.result && this.result.added && this.result.added.upgraded){\r\n\t\tif(this.result.added.upgraded.indexOf(node.id) != -1){\r\n\t\t\tnode.type = \"node\";\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn node.type && node.type == \"fringe\";\r\n}\r\n\r\nfunction randomString(length) {\r\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');\r\n    if (! length) {\r\n        length = Math.floor(Math.random() * chars.length);\r\n    }\r\n    var str = '';\r\n    for (var i = 0; i < length; i++) {\r\n        str += chars[Math.floor(Math.random() * chars.length)];\r\n    }\r\n    return str;\r\n}\r\n\r\nmodule.exports = GraphResultsViewer;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst UTILS= require('../../Utils');\r\nconst TerminusCodeSnippet = require('../../viewer/TerminusCodeSnippet');\r\n\r\nfunction SimpleTextbox(woql, width, height){\r\n\tthis.woql = woql;\r\n\tthis.placeholder = \"Enter Query ...\";\r\n\tthis.button = \"Submit\";\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n\tthis.format = \"js\";\r\n\tthis.input = document.createElement(\"textarea\");\r\n}\r\n\r\nSimpleTextbox.prototype.options = function(options){\r\n\tthis.format = (options && options.type ? options.type : \"js\");\r\n\treturn this;\r\n}\r\n\r\n\r\nSimpleTextbox.prototype.get = function(){\r\n\treturn this.woql.parseText(this.input.value);\r\n}\r\n\r\nSimpleTextbox.prototype.set = function(woq){\r\n\tthis.input.value = this.woql.serialise(woq, this.format);\r\n}\r\n\r\nSimpleTextbox.prototype.error = function(string){\r\n\tthis.viewer.inputError(string);\r\n}\r\n\r\nSimpleTextbox.prototype.render = function(){\r\n\treturn this.getAsDOM();\r\n}\r\n\r\n// myTest\r\nvar settings = {};\r\nsettings.pageLength = 5;\r\nsettings.start = 0;\r\nvar qObj = UTILS.getCurrentWoqlQueryObject('Show_All_Schema_Elements', settings);\r\n\r\nSimpleTextbox.prototype.getAsDOM = function(){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input terminus-query-section\");\r\n\r\n\r\n\t// myTest\r\n\tvar tcs = new TerminusCodeSnippet(qObj, 500, 'auto', 'edit');\r\n\t//qbox.appendChild(tcs.getAsDOM().dom);\r\n\r\n\tthis.input.setAttribute(\"class\", \"terminus-query-box\");\r\n\tif(this.placeholder){\r\n\t\tthis.input.setAttribute(\"placeholder\", this.placeholder);\r\n\t}\r\n\tif(this.width && this.height){\r\n\t\tthis.input.setAttribute(\"style\", \"width: \"+ this.width +\"px; height: \"+ this.height + \"px;\");\r\n\t}\r\n\tqbox.appendChild(this.input);\r\n\tvar self = this;\r\n\tif(this.button){\r\n\t\tvar qbut = document.createElement(\"button\");\r\n\t\tqbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\")\r\n\t\tqbut.appendChild(document.createTextNode(this.button));\r\n\t\tqbut.addEventListener(\"click\", function(){\r\n\t\t\tvar woq = self.get();\r\n\t\t\tif(woq){\r\n\t\t\t\tself.woql.submitQuery(woql);\r\n\t\t\t}\r\n\t\t});\r\n\t\tqbox.appendChild(qbut);\r\n\t}\r\n\treturn qbox;\r\n}\r\n\r\n\r\n\r\nmodule.exports = SimpleTextbox;\r\n","function SimpleChooser(){}\r\n\r\nSimpleChooser.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nSimpleChooser.prototype.render = function(chooser){\r\n\tif(chooser) this.chooser = chooser;\r\n\tif(this.chooser.config.show_empty() == false && this.chooser.count() < 1) return false;\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"woql-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", \" woql-chooser\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tself.chooser.set(this.value);\r\n\t});\r\n\tvar opts = [];\r\n\tif(this.chooser.config.show_empty()){\r\n\t\topts.push(this.getEmptyOption())\r\n\t}\r\n\twhile(choice = this.chooser.next()){\r\n\t\tvar opt = this.createOptionFromChoice(choice);\r\n\t\topts.push(opt);\r\n\t}\r\n\tfor(var i = 0; i<opts.length; i++){\r\n\t\tccsel.appendChild(opts[i]);\r\n\t}\r\n\tccdom.appendChild(ccsel);\r\n\treturn ccdom;\r\n}\r\n\r\nSimpleChooser.prototype.getEmptyOption = function(){\r\n\tvar choice = { id: \"\", label: this.chooser.config.show_empty()};\r\n\treturn this.createOptionFromChoice(choice);\r\n}\r\n\r\nSimpleChooser.prototype.createOptionFromChoice = function(choice){\r\n\tvar opt = document.createElement(\"option\");\r\n\topt.setAttribute(\"class\", \"terminus-woql-chooser-choice\");\r\n\topt.value = choice.id;\r\n\tif(choice.selected) opt.selected = true;\r\n\tif(typeof choice.label == \"string\"){\r\n\t\topt.appendChild(document.createTextNode(choice.label));\r\n\t}\r\n\telse if(choice.label){\r\n\t\topt.appendChild(choice.label);\r\n\t}\r\n\tif(choice.title){\r\n\t\topt.setAttribute(\"title\", choice.title);\r\n\t}\r\n\treturn opt;\r\n}\r\n\r\nmodule.exports = SimpleChooser;","function SimpleDocument(){}\r\n\r\nSimpleDocument.prototype.render = function(frame){\r\n\tvar s = document.createElement(\"div\");\r\n\tfor(var p in frame.properties){\r\n\t\t//s.appendChild(document.createTextNode(p));\r\n\t\tvar pr = this.renderProperty(frame.properties[p])\r\n\t\tif(pr) s.appendChild(pr);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nSimpleDocument.prototype.renderProperty = function(frame){\r\n\tvar s = document.createElement(\"div\");\r\n\ts.appendChild(document.createTextNode(frame.getLabel() + \": \"));\r\n\tfor(var i = 0 ; i < frame.values.length; i++){\r\n\t\tif(frame.values[i].isData()){\r\n\t\t\tvar pr = this.renderValue(frame.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar pr = this.render(frame.values[i]);\t\t\t\r\n\t\t}\r\n\t\tif(pr) s.appendChild(pr);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nSimpleDocument.prototype.renderValue = function(frame){\r\n\tvar s = document.createElement(\"span\");\r\n\ts.appendChild(document.createTextNode(frame.get() + \" \"));\r\n\treturn s;\r\n}\r\n\r\nmodule.exports = SimpleDocument;","function DocumentTable(){}\r\n\r\nDocumentTable.prototype.render = function(frame){\r\n\tvar t = this.getTableDOM(frame);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tfor(var p in frame.properties){\r\n\t\t//s.appendChild(document.createTextNode(p));\r\n\t\tvar pr = this.renderProperty(tbody, frame.properties[p]);\r\n\t\t//if(pr) tbody.appendChild(pr);\r\n\t}\r\n\tt.appendChild(tbody);\r\n\treturn t;\r\n}\r\n\r\nDocumentTable.prototype.getTableDOM = function(frame){\r\n\t//const columns = this.woqltable.getColumnsToRender();\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th = document.createElement(\"th\");\r\n\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\tth.setAttribute('colspan', 2);\r\n\tth.appendChild(document.createTextNode(frame.subject() + \", \" + frame.subjectClass()));\r\n\tthr.appendChild(th);\r\n\tthead.appendChild(thr);\t\r\n\ttab.appendChild(thead);\r\n\treturn tab;\r\n}\r\n\r\nDocumentTable.prototype.renderProperty = function(tbody, frame){\r\n\tfor(var i = 0 ; i < frame.values.length; i++){\r\n\t\tvar thr = document.createElement(\"tr\");\r\n\t\tvar td = document.createElement(\"td\");\r\n\t\ttd.appendChild(document.createTextNode(frame.getLabel()));\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\tif(frame.values[i].isData()){\r\n\t\t\ttd2.appendChild(this.renderValue(frame.values[i]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttd2.appendChild(this.render(frame.values[i]));\t\t\t\r\n\t\t}\r\n\t\tthr.appendChild(td);\t\r\n\t\tthr.appendChild(td2);\t\r\n\t\ttbody.appendChild(thr);\t\r\n\t}\r\n}\r\n\r\nDocumentTable.prototype.renderValue = function(frame){\r\n\treturn document.createTextNode(frame.get());\r\n}\r\n\r\nmodule.exports = DocumentTable;","function TerminusViolations(vios, ui){\r\n\tthis.ui = ui;\r\n\tthis.vios = [];\r\n\tvar nvios = [];\r\n\tfor(var i = 0; i<vios.length; i++){\r\n\t\tfor(var j = 0; j<nvios.length; j++){\r\n\t\t\tif(JSON.stringify(vios[i]) == JSON.stringify(nvios[j])) continue;\r\n\t\t}\r\n\t\tnvios.push(vios[i]);\r\n\t}\r\n\tfor(var i = 0; i<nvios.length; i++){\r\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\r\n\t}\r\n}\r\n\r\nTerminusViolations.prototype.getAsDOM = function(context_msg){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violations terminus-show-msg-vio\");\r\n\tvar vioHeading = document.createElement(\"div\");\r\n\tvioHeading.setAttribute('class', 'terminus-violations-heading');\r\n\tvdom.appendChild(vioHeading);\r\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\r\n\tif(context_msg) msg += \" \" + context_msg;\r\n\tvioHeading.appendChild(document.createTextNode(msg));\r\n\tfor(var i = 0; i<this.vios.length; i++){\r\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Class for displaying violation reports as HTML\r\n */\r\nfunction TerminusViolation(vio, ui){\r\n\tthis.ui = ui;\r\n\tthis.vio = vio;\r\n}\r\n\r\nTerminusViolation.prototype.getAsDOM = function(){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\r\n\tif(this.vio['@type']){\r\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\r\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\r\n\t}\r\n\tfor(var prop in this.vio){\r\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\r\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\r\n\t\t}\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\r\n\tvar pdom = document.createElement(\"div\");\r\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\r\n\tvar ldom = document.createElement(\"span\");\r\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\r\n\tldom.appendChild(document.createTextNode(prop));\r\n\tvar vdom = document.createElement(\"span\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\r\n\tvdom.appendChild(document.createTextNode(val[\"@value\"]));\r\n\tpdom.appendChild(ldom);\r\n\tpdom.appendChild(vdom);\r\n\treturn pdom;\r\n}\r\n\r\nmodule.exports=TerminusViolations\r\n","const TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusHTMLViewer = require(\"./TerminusHTMLViewer\");\r\nconst QueryPaneManager = require(\"./html/QueryPaneManager\");\r\n\r\nfunction TerminusQueryViewer(ui, options){\r\n\tthis.ui = ui;\r\n\tthis.options = options;\r\n\tthis.meta = {};\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.thv = new TerminusHTMLViewer(ui.client);\r\n\tthis.qpMan = new QueryPaneManager(ui.client);\r\n}\r\n\r\nTerminusQueryViewer.prototype.query = function(val, settings, tab){\r\n\tvar self = this;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tthis.wquery.execute(val)\r\n\t.then(function(result){\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, self.wquery, self.options, settings, true);\r\n\t\tvar nd = self.result.getAsDOM(self.resultDOM, true);\r\n\t\tif(nd){\r\n\t\t\t self.resultDOM.appendChild(nd);\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tself.ui.showError(err);\r\n\t});\r\n}\r\n\r\nTerminusQueryViewer.prototype.getResultViewDom = function(){\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\r\n}\r\n\r\n\r\n\r\nTerminusQueryViewer.prototype.getAsDOM = function(q){\r\n\tvar qvc = {\r\n\t\t\tinputs: {\"js\": {}, \"json\": {}},\r\n\t\t\tresults: {\"table\": {}, \"graph\": {}, \"stream\" : {}}\r\n\t\t};\r\n\r\n\tvar qpm = this.qpMan.getAsDOM();\r\n\tvar wqv = this.thv.querypane(q, this.qvc);\r\n\r\n\r\n\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-page\");\r\n\tqbox.setAttribute(\"style\", \"2px solid black\");\r\n\t/*if(wqv){\r\n\t\tqbox.appendChild(wqv);\r\n\t} */\r\n\r\n\tif(qpm){\r\n\t\tqbox.appendChild(qpm);\r\n\t}\r\n\r\n\t/*var woql = TerminusClient.WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(30).start(0).simpleGraphQuery();\r\n\tvar wqv = this.thv.woql(woql, this.qvc);\r\n\tif(wqv){\r\n\t\tqbox.appendChild(wqv);\r\n\t}\r\n\tif(this.hasGeneratorOptions()){\r\n\t\tqbox.appendChild(this.getQueryCreatorChoiceDOM(q));\r\n\t}\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results terminus-query-section\");\r\n\r\n\tvar qtHolder = document.createElement('span');\r\n\tqtHolder.setAttribute('style', 'display: flex;');\r\n\r\n\tthis.qTextBox = this.getQueryTextAreaDOM(q, qtHolder);\r\n\tthis.buttonsDOM = document.createElement(\"span\");\r\n\tthis.buttonsDOM.setAttribute(\"class\", \"terminus-query-input\");\r\n\tthis.buttonsDOM.appendChild(this.getQueryButtonsDOM(q, this.qTextBox));\r\n\r\n\tqtHolder.appendChild(this.buttonsDOM);\r\n\r\n\tqbox.appendChild(qtHolder);\r\n\tqbox.appendChild(this.resultDOM);*/\r\n\treturn qbox;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryCreatorChoiceDOM = function(){\r\n\tvar qcc = document.createElement(\"select\");\r\n\tqcc.setAttribute(\"class\", \"terminus-query-generator-selector\");\r\n\tfor(var c in this.generators){\r\n\t\tvar gen = this.generators[c];\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = (gen.value ? gen.value : c);\r\n\t\tvar lab = (gen.label ? gen.label : c);\r\n\t\topt.appendChild(document.createTextNode(lab));\r\n\t\tqcc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tqcc.addEventListener(\"change\", function(){\r\n\t\tself.changeGenerator(this.value);\r\n\t});\r\n\treturn qcc;\r\n}\r\n\r\n\r\nmodule.exports=TerminusQueryViewer\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusHTMLViewer = require(\"../TerminusHTMLViewer\");\r\nconst TerminusCodeSnippet = require('../viewer/TerminusCodeSnippet');\r\nconst WOQLRule = require(\"../viewer/WOQLRule\");\r\n\r\nfunction QueryPaneManager(client){\r\n    this.client = client;\r\n}\r\n\r\nQueryPaneManager.prototype.queryEditor = function(){\r\n    var woql = TerminusClient.WOQL;\r\n\tvar tcs = new TerminusCodeSnippet({}, 500, 250, 'Enter Query ...', 'edit');\r\n\tvar snippet = tcs.getAsDOM();\r\n\treturn snippet;\r\n}\r\n\r\nQueryPaneManager.prototype.ruleEditor = function(){\r\n    var woql = TerminusClient.WOQL;\r\n\tvar tcs = new TerminusCodeSnippet({}, 300, 250, 'Enter Rules ...', 'edit');\r\n\tvar snippet = tcs.getAsDOM();\r\n\treturn snippet;\r\n}\r\n\r\n/*\r\n    qObj: woql object\r\n    woql:\r\n*/\r\nQueryPaneManager.prototype.processResults = function(qObj, woql, thv, results){\r\n    let qres = new TerminusClient.WOQLResult(results, qObj);\r\n    console.log('woql.table()', woql.table());\r\n    var nt = thv.showResult(qres, woql.table());\r\n    this.container.appendChild(nt);\r\n    qres.first()\r\n    var n = thv.showResult(qres, woql.chooser());\r\n    this.container.appendChild(n);\r\n    qres.first();\r\n    var ng = thv.showResult(qres, woql.graph());\r\n    this.container.appendChild(ng);\r\n    qres.first();\r\n}\r\n\r\n// query string\r\nQueryPaneManager.prototype.getqObjFromInput = function(query){\r\n    var query = 'const WOQL = TerminusClient.WOQL ; return ' + 'WOQL.' + query;\r\n    var qObj = new Function(query)();\r\n    var qJson = qObj.json();\r\n    var newQObj= TerminusClient.WOQL.json(JSON.parse(JSON.stringify(qJson)))\r\n    return newQObj;\r\n}\r\n\r\n// rules\r\nQueryPaneManager.prototype.showRuleEditor = function(woql){\r\n    var snippet = this.ruleEditor();\r\n    this.container.appendChild(snippet.dom);\r\n    var self = this;\r\n    snippet.actionButton.addEventListener('click', function(){\r\n        var rObj = self.getqObjFromInput(snippet.snippetText.value);\r\n        var n = this.self.showResult(self.qres, rObj);\r\n        this.container.appendChild(n);\r\n    })\r\n}\r\n\r\nQueryPaneManager.prototype.showConfig = function(woql){\r\n    var cbtn = document.createElement('button');\r\n    cbtn.appendChild(document.createTextNode('Config'));\r\n    this.container.appendChild(cbtn);\r\n    var self = this;\r\n    cbtn.addEventListener('click', function(){\r\n        self.showRuleEditor(woql);\r\n    })\r\n}\r\n\r\nQueryPaneManager.prototype.submitQuery = function(snippet){\r\n    let thv = new TerminusHTMLViewer(this.client);\r\n    let WOQL = TerminusClient.WOQL;\r\n    var self = this;\r\n    snippet.actionButton.addEventListener('click', function(){\r\n        let qObj = self.getqObjFromInput(snippet.snippetText.value);\r\n        qObj.execute(self.client).then((results) => {\r\n            self.processResults(qObj, WOQL, thv, results);\r\n            self.showConfig(WOQL);\r\n        })\r\n    })\r\n}\r\n\r\nQueryPaneManager.prototype.queryPane = function(){\r\n    var cont = document.createElement('div');\r\n    this.container = cont;\r\n    cont.setAttribute('style', '1px solid black');\r\n    var snippet = this.queryEditor();\r\n    cont.appendChild(snippet.dom);\r\n    this.submitQuery(snippet);\r\n    return cont;\r\n}\r\n\r\nQueryPaneManager.prototype.getAsDOM = function(){\r\n    return this.queryPane();\r\n}\r\n\r\nmodule.exports = QueryPaneManager;\r\n","/*\r\n * Draws the screen for viewing and updating the schema\r\n * and provides wrappers around the client's schema API\r\n */\r\nconst TerminusClassChooser = require('./client/TerminusClassChooser');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst UTILS=require('./Utils')\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusSchemaViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.mode = \"view\";\r\n\tthis.format = \"turtle\";\r\n\tthis.confirm_before_update = false;\r\n}\r\n\r\n/*\r\n * Retrieves schema from API and writes the response into the page\r\n */\r\nTerminusSchemaViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\r\n\tthis.loadSchema();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Fetching Database Schema\");\r\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.schema = response;\r\n\t\tself.refreshPage(msg, msgtype);\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.controldom);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaSaveButtons());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaImportActionButtons());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getShowSchemaButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n\telse if(this.mode == \"view\"){\r\n\t\tif(this.ui.showControl(\"update_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getSchemaEditButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"import_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getImportButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"schema_format\")){\r\n\t\t\tthis.controldom.appendChild(this.getFormatChoices());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\r\n\tvar fc = document.createElement(\"select\");\r\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\r\n\tvar tc = document.createElement(\"option\");\r\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\r\n\ttc.value = \"turtle\";\r\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\r\n\tif(this.format == \"turtle\") tc.selected = true;\r\n\tfc.appendChild(tc);\r\n\tvar tj = document.createElement(\"option\");\r\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\r\n\ttj.value = \"jsonld\";\r\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\r\n\tif(this.format == \"jsonld\") tj.selected = true;\r\n\tfc.appendChild(tj);\r\n\tvar self = this;\r\n\tfc.addEventListener(\"change\", function(e){\r\n\t\tself.format = this.value;\r\n\t\tself.loadSchema();\r\n\t});\r\n\treturn fc;\r\n}\r\n\r\n\r\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\r\n\tif(this.controldom) this.resetControlDOM();\r\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\r\n\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\tif(this.mode == 'view'){\r\n\t\tthis.pagedom.appendChild(this.getSchemaViewDOM());\r\n\t}\r\n\telse if(this.mode == \"edit\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaEditDOM());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaImportDOM());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tthis.pagedom.appendChild(this.getClassFrameDOM());\r\n\t}\r\n\tif(msg){\r\n\t\tthis.ui.showMessage(msg, msgtype);\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\tssb.appendChild(this.getSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\r\n\tssb.appendChild(this.getCancelButton(true));\r\n\tssb.appendChild(this.getImportSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"preview\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getCancelButton = function(is_import){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tif(is_import){\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(typeof self.doImport == \"function\"){\r\n\t\t\tself.doImport();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tvar text = self.schema_edit_dom.value;\r\n\t\tif(typeof(self.schema) == \"object\"){\r\n\t\t\ttext = JSON.parse(text);\r\n\t\t}\r\n\t\treturn self.updateSchema(text, {\"terminus:encoding\": \"terminus:\" + self.format});\r\n\t}\r\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"import\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Import New Schema\", \"import_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\r\n\tvar opt = document.createElement(\"button\");\r\n\topt.appendChild(document.createTextNode(label));\r\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\r\n\topt.addEventListener(\"click\", func);\r\n\treturn opt;\r\n}\r\n\r\n/*\r\n * Updates schema, then fetches updated version and updates the page with it\r\n */\r\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts){\r\n\tthis.ui.showBusy(\"Updating Database Schema\");\r\n\tvar self = this;\r\n\treturn this.ui.client.updateSchema(false, text, opts)\r\n\t.then(function(response){\r\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\r\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\r\n\t\t\tself.mode = \"view\";\r\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\r\n\t\t}\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"schema\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/*\r\n * Imports a schema from the passed url\r\n * mode: replace | append\r\n */\r\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\r\n\tvar self = this;\r\n\tmode = (mode ? mode : \"replace\");\r\n\tthis.ui.showBusy(\"Loading schema from \" + url);\r\n\tvar origurl = this.ui.client.connectionConfig.schemaURL();\r\n\treturn this.ui.client.getSchema(url, {\"terminus:user_key\": key, \"terminus:encoding\" : \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\r\n\t\tif(self.confirm_before_update){\r\n\t\t\t//reconnect to original db\r\n\t\t\tself.ui.showResult(\"Schema retrieved - click save to deploy\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.showConfirmPage(newschema);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showBusy(\"Updating schema\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.updateSchema(newschema, {\"terminus:encoding\": \"terminus:\" + self.format}).then(function(response){\r\n\t\t\t\tself.mode = \"view\";\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tself.ui.redraw();\r\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\r\n\tvar nschema = this.schema;\r\n\tif(this.format == 'turtle'){\r\n\t\tnschema = this.schema + s2;\r\n\t}\r\n\telse if(this.format == 'jsonld'){\r\n\t\tfor(var i in s2){\r\n\t\t\tnschema[i] = s2[i];\r\n\t\t}\r\n\t}\r\n\treturn nschema;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameChooser = function(){\r\n\tvar np = document.createElement(\"span\");\r\n\tnp.setAttribute(\"class\", \"terminus-class frame-chooser\");\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"View Individual Class Frames\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.cls = new_class;\r\n\t\t\tif(self.mode != \"class_frame\"){\r\n\t\t\t\tself.mode = \"class_frame\";\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.refreshMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM();\r\n\tnp.appendChild(tcdom);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-classframe-page\");\r\n\tvar docviewer = new TerminusDocumentViewer(this.ui, \"model\");\r\n\tdocviewer.loadCreateDocument(this.cls);\r\n\tdocviewer.page_config = \"model\";\r\n\tnp.appendChild(docviewer.getAsDOM());\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\r\n\tthis.schema = newschema;\r\n\tthis.confirm_before_update = false;\r\n\tthis.mode = \"edit\";\r\n\tthis.refreshPage(\"Confirm new schema\");\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\r\n\tvar ipval = document.createElement(\"textarea\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\r\n\tipval.setAttribute(\"width\", \"100%\");\r\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tipval.innerHTML = this.schema;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tthis.schema_edit_dom = ipval;\r\n\tnp.appendChild(ipval);\r\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\r\n\tvar self = this;\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\r\n\tvar ipval = document.createElement(\"pre\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\r\n         .replace(/</g, \"&lt;\")\r\n         .replace(/>/g, \"&gt;\")\r\n         .replace(/\"/g, \"&quot;\")\r\n         .replace(/'/g, \"&#039;\");\r\n\t\tipval.innerHTML = txt;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\r\n\tif(!cm) np.appendChild(ipval);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form-border terminus-schema-page terminus-schema-import-page\");\r\n\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"URL\"));\r\n\tsci.appendChild(slab);\r\n\tvar inpUrl  = document.createElement(\"input\");\r\n\tinpUrl.setAttribute(\"type\", \"text\");\r\n\tinpUrl.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-form-url terminus-url-connect\");\r\n\tinpUrl.setAttribute(\"placeholder\", \"Enter URL of DB to import from\");\r\n\tsci.appendChild(inpUrl);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label  terminus-control-label terminus-import_mode-input\");\r\n\tklab.appendChild(document.createTextNode(\"Import Mode\"));\r\n\tsci.appendChild(klab);\r\n\tvar modes = document.createElement(\"select\");\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\r\n\r\n\tvar overwrite = document.createElement(\"option\");\r\n\toverwrite.value = \"replace\";\r\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\r\n\tmodes.appendChild(overwrite);\r\n\tvar append = document.createElement(\"option\");\r\n\tappend.value = \"append\";\r\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\r\n\tmodes.appendChild(append);\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(modes);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input terminus-control-label\");\r\n\tklab.appendChild(document.createTextNode(\"Key\"))\r\n\tvar key = document.createElement(\"input\");\r\n\tkey.setAttribute(\"type\", \"text\");\r\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-url-key\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(key);\r\n\tscd.appendChild(sci);\r\n\tvar self = this;\r\n\tthis.doImport = function(){\r\n\t\tif(inpUrl.value){\r\n\t\t\tself.load(inpUrl.value, key.value, modes.value);\r\n\t\t}\r\n\t}\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports=TerminusSchemaViewer\r\n","/* User interface elements that relate to server context\r\n *\r\n * TerminusServerController is a control widget that invokes server actions\r\n * TerminusServerViewer is a window that displays server actions and server screens\r\n *\r\n */\r\n const Datatables = require('./plugins/datatables.terminus');\r\n const UTILS =require('./Utils');\r\n const HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\n const TerminusHTMLViewer = require(\"./TerminusHTMLViewer\");\r\n const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n function TerminusServerController(ui){\r\n\t this.ui = ui;\r\n }\r\n\r\nTerminusServerController.prototype.getAsDOM = function(){\r\n\tvar rsc = document.createElement(\"div\");\r\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\r\n\tvar self = this;\r\n\tif(this.ui && this.ui.server()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-connection\");\r\n        var nav = document.createElement('div');\r\n        nav.setAttribute('class', 'span3');\r\n        var ul = document.createElement('ul');\r\n        ul.setAttribute('class', 'terminus-ul');\r\n        nav.appendChild(ul);\r\n        rsc.appendChild(nav);\r\n        // connected to server\r\n        var a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Server: ' + this.ui.server();\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n        // change server\r\n        if(this.ui.showControl(\"change-server\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                self.ui.showLoadURLPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Change Server');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        // view databases\r\n        if(this.ui.showControl(\"db\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showServerMainPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('View Databases');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        if(this.ui.showControl(\"create_database\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showCreateDBPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Create New Database');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n\t}\r\n\treturn rsc;\r\n}\r\n\r\nTerminusServerController.prototype.getServerLabelDOM = function(){\r\n\tvar srec = this.ui.client.connection.getServerRecord();\r\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\r\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\r\n\tdesc += \" Server URL: \"+ this.ui.server();\r\n\tvar val = document.createElement(\"span\");\r\n\tval.setAttribute(\"class\", \"terminus-server-value\");\r\n\tval.setAttribute(\"title\", desc);\r\n\tval.appendChild(document.createTextNode(lab));\r\n    val =  document.createElement('div');\r\n\treturn val;\r\n}\r\n\r\nfunction TerminusServerViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.max_cell_size = 500;\r\n\tthis.max_word_size = 40;\r\n}\r\n\r\nTerminusServerViewer.prototype.getAsDOM = function(selected){\r\n\tvar self = this;\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\r\n\tif(this.ui.server()){\r\n\t\tvar scd = document.createElement(\"span\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\r\n\t\tif(this.ui.showView(\"server\")){\r\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\r\n\t\t}\r\n\t\tif(this.ui.showView(\"change-server\")){\r\n\t\t\tvar csbut = document.createElement(\"button\");\r\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\r\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\r\n\t\t\tcsbut.addEventListener(\"click\", function(){\r\n\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t//self.ui.clearServer();\r\n\t\t\t\tself.ui.showLoadURLPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(csbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"create_database\")){\r\n\t\t\tvar crbut = document.createElement(\"button\");\r\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\r\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\r\n\t\t\tcrbut.addEventListener(\"click\", function(){\r\n\t\t\t\tif(self.ui.db()){\r\n\t\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t}\r\n\t\t\t\tself.ui.clearMessages();\r\n\t\t\t\tself.ui.showCreateDBPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(crbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"db\")){\r\n\t\t\t//scd.appendChild(this.getNDBListDOM());\r\n\t\t\tscd.appendChild(this.getDBListDOM());\r\n\t\t}\r\n\t\tpd.appendChild(scd);\r\n\t}\r\n\telse {\r\n\t\tself.ui.showLoadURLPage();\r\n\r\n\t\t//pd.appendChild(this.getLoadURLPage());\r\n\t}\r\n\treturn pd;\r\n}\r\n\r\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\r\n\tvar scl = document.createElement(\"span\");\r\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\r\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\r\n\tscs.appendChild(document.createTextNode(this.ui.server()))\r\n\tscd.appendChild(scl);\r\n\tscd.appendChild(scs);\r\n\treturn scd;\r\n}\r\n\r\nTerminusServerViewer.prototype.wrapTableLinkCell = function(tdElement,dbid, text){\r\n\tvar self = this;\r\n\tvar wrap = document.createElement(\"p\");\r\n//\twrap.setAttribute(\"href\", \"#\");\r\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\tHTMLFrameHelper.wrapShortenedText(wrap, text, this.max_cell_size, this.max_word_size);\r\n\ttdElement.addEventListener(\"click\", function(){\r\n\t\tself.ui.connectToDB(dbid);\r\n\t\tself.ui.showDBMainPage();\r\n\t});\r\n\treturn wrap;\r\n}\r\n\r\nTerminusServerViewer.prototype.getNDBListDOM = function(){\r\n\tvar whtml = new TerminusHTMLViewer(this.ui.client);\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\t\r\n\t//var tab = whtml.table(); \r\n}\r\n\r\nTerminusServerViewer.prototype.getDBListDOM = function(){\r\n\tvar self = this;\r\n\tvar sec = document.createElement(\"div\");\r\n\tvar lihed = document.createElement(\"h3\");\r\n\tlihed.setAttribute(\"class\", \"terminus-db-list-title terminus-module-head\");\r\n\tlihed.appendChild(document.createTextNode(\"Available Databases\"));\r\n\tsec.appendChild(lihed);\r\n\tvar scd = document.createElement(\"table\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th1 = document.createElement(\"th\");\r\n\tth1.appendChild(document.createTextNode(\"ID\"));\r\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-header-full-css\");\r\n\tvar th2 = document.createElement(\"th\");\r\n\tth2.appendChild(document.createTextNode(\"Title\"));\r\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-header-full-css\");\r\n\tvar th3 = document.createElement(\"th\");\r\n\tth3.appendChild(document.createTextNode(\"Description\"));\r\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-header-full-css\");\r\n\tvar th4 = document.createElement(\"th\");\r\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-header-full-css\");\r\n\tth4.appendChild(document.createTextNode(\"Size\"));\r\n\tvar th5 = document.createElement(\"th\");\r\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-header-full-css\");\r\n\tth5.appendChild(document.createTextNode(\"Created\"));\r\n\tvar th6 = document.createElement(\"th\");\r\n\tth6.appendChild(document.createTextNode(\"Delete\"));\r\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-header-full-css\");\r\n\tthr.appendChild(th1);\r\n\tthr.appendChild(th2);\r\n\tthr.appendChild(th3);\r\n\t//thr.appendChild(th4);\r\n\t//thr.appendChild(th5);\r\n\tthr.appendChild(th6);\r\n\tthead.appendChild(thr);\r\n\tscd.appendChild(thead);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\tfor(let fullid in dbrecs){\r\n\t\tlet dbrec = dbrecs[fullid];\r\n\t\tconst dbid = fullid.split(\":\")[1];\r\n\t\tlet tr = document.createElement(\"tr\");\r\n\t\tvar td1 = document.createElement(\"td\");\r\n\t\ttd1.appendChild(this.wrapTableLinkCell(td1,dbid, dbid));\r\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id terminus-db-pointer\");\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\r\n\t\ttd2.appendChild(this.wrapTableLinkCell(td2,dbid, txt));\r\n\t\tvar td3 = document.createElement(\"td\");\r\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\r\n\t\ttd3.appendChild(this.wrapTableLinkCell(td3,dbid, txt));\r\n\t\tvar td4 = document.createElement(\"td\");\r\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\r\n\t\ttd4.appendChild(this.wrapTableLinkCell(td4,dbid, txt));\r\n\t\tvar td5 = document.createElement(\"td\");\r\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\r\n\t\ttd5.appendChild(this.wrapTableLinkCell(td5,dbid, txt));\r\n\t\tvar td6 = document.createElement(\"td\");\r\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\r\n        if(this.deleteDBPermitted(dbid)){\r\n            if(this.ui.pluginAvailable(\"font-awesome\")){\r\n                var delbut = document.createElement('i');\r\n        \t\tdelbut.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-times-circle\");\r\n        \t}\r\n            else{\r\n                var delbut = document.createElement(\"button\");\r\n    \t\t\tdelbut.appendChild(document.createTextNode(\"Delete\"));\r\n    \t\t\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\r\n            }\r\n\t\t\t// function to fix db in a closure\r\n\t\t\tvar delDB = function(db){\r\n\t\t\t\treturn function(){\r\n\t\t\t\t\tlet deleteConfirm = confirm(`Do you want to delete ${db} Database?`);\r\n\t\t\t\t\tif (deleteConfirm == true) {\r\n\t\t\t  \t\t\tself.ui.deleteDatabase(db);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//self.ui.deleteDatabase(db);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdelbut.addEventListener(\"click\", delDB(dbid));\r\n\t\t\ttd6.appendChild(delbut);\r\n\t\t}\r\n\r\n\t\ttr.appendChild(td1);\r\n\t\ttr.appendChild(td2);\r\n\t\ttr.appendChild(td3);\r\n\t\t//tr.appendChild(td4);\r\n\t\t//tr.appendChild(td5);\r\n\t\ttr.appendChild(td6);\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\tscd.appendChild(tbody);\r\n\tsec.appendChild(scd);\r\n\r\n\tif(this.ui.pluginAvailable(\"datatables\")){\r\n        var dt = new Datatables.CspDatatables(this.ui);\r\n\t\tvar tab = dt.draw(scd);\r\n\t}\r\n\treturn sec;\r\n}\r\n\r\nTerminusServerViewer.prototype.deleteDBPermitted = function(dbid){\r\n\tif(dbid == \"terminus\") return false;\r\n\tif(this.ui.client.connection.capabilitiesPermit(\"delete_database\", dbid)) return true;\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = {TerminusServerViewer,TerminusServerController}\r\n","function TerminusURLLoader(ui, val){\r\n\tthis.ui = ui;\r\n\tthis.val = val;\r\n\tthis.url_input = false;\r\n\tthis.key_input = false;\r\n}\r\n\r\nTerminusURLLoader.prototype.getLabelDOM = function(){\r\n\treturn document.createTextNode(\"Connect\");\r\n}\r\n\r\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-form-field terminus-field-\"+fname);\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\r\n\tlab.appendChild(document.createTextNode(ltxt))\r\n\tip.setAttribute(\"type\", \"text\");\r\n\tip.setAttribute(\"placeholder\", pholder);\r\n\tsci.appendChild(lab);\r\n\tsci.appendChild(ip);\r\n\treturn sci;\r\n}\r\n\r\nTerminusURLLoader.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\r\n\tvar stit = document.createElement(\"h3\");\r\n\tstit.setAttribute(\"class\", \"terminus-form-header terminus-connect-header terminus-module-head\");\r\n\tstit.appendChild(document.createTextNode(\"Connect To Terminus Server\"));\r\n\tscd.appendChild(stit);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tthis.url_input = document.createElement(\"input\");\r\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\r\n\tif(this.val){\r\n\t\tthis.url_input.value = this.val;\r\n\t}\r\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\r\n\tthis.key_input = document.createElement(\"input\");\r\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\r\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\r\n\tvar loadbuts = document.createElement(\"div\");\r\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tif(self.url_input.value){\r\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\r\n\t\t}\r\n\t});\r\n\tloadbuts.appendChild(loadbut);\r\n\tmfd.appendChild(loadbuts);\r\n\treturn scd;\r\n}\r\n\r\n\r\nmodule.exports=TerminusURLLoader\r\n"],"sourceRoot":""}